<div align="right">
  <details>
    <summary >ğŸŒ ì–¸ì–´</summary>
    <div>
      <div align="center">
        <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=en">English</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=zh-CN">ç®€ä½“ä¸­æ–‡</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=zh-TW">ç¹é«”ä¸­æ–‡</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=ja">æ—¥æœ¬èª</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=ko">í•œêµ­ì–´</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=hi">à¤¹à¤¿à¤¨à¥à¤¦à¥€</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=th">à¹„à¸—à¸¢</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=fr">FranÃ§ais</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=de">Deutsch</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=es">EspaÃ±ol</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=it">Italiano</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=ru">Ğ ÑƒÑÑĞºĞ¸Ğ¹</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=pt">PortuguÃªs</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=nl">Nederlands</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=pl">Polski</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=ar">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=fa">ÙØ§Ø±Ø³ÛŒ</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=tr">TÃ¼rkÃ§e</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=vi">Tiáº¿ng Viá»‡t</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=id">Bahasa Indonesia</a>
      </div>
    </div>
  </details>
</div>

<div align="center">

# ğŸš€ í›ˆë ¨í•  ì‹œê°„ ì—†ì–´!  
### í›ˆë ¨ ì—†ëŠ” ì°¸ì¡° ê¸°ë°˜ ì¸ìŠ¤í„´ìŠ¤ ë¶„í•   
[![GitHub](https://img.shields.io/badge/%E2%80%8B-No%20Time%20To%20Train-black?logo=github)](https://github.com/miquel-espinosa/no-time-to-train)
[![Website](https://img.shields.io/badge/ğŸŒ-Project%20Page-grey)](https://miquel-espinosa.github.io/no-time-to-train/)
[![arXiv](https://img.shields.io/badge/arXiv-2507.02798-b31b1b)](https://arxiv.org/abs/2507.02798)

**ìµœì‹  ì„±ëŠ¥ (Papers with Code)**

[**_1-shot_**](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-1-shot?p=no-time-to-train-training-free-reference) | [![PWC](https://img.shields.io/endpoint.svg?url=https://paperswithcode.com/badge/no-time-to-train-training-free-reference/few-shot-object-detection-on-ms-coco-1-shot)](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-1-shot?p=no-time-to-train-training-free-reference)

[**_10-shot_**](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-10-shot?p=no-time-to-train-training-free-reference) | [![PWC](https://img.shields.io/endpoint.svg?url=https://paperswithcode.com/badge/no-time-to-train-training-free-reference/few-shot-object-detection-on-ms-coco-10-shot)](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-10-shot?p=no-time-to-train-training-free-reference)

[**_30-shot_**](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-30-shot?p=no-time-to-train-training-free-reference) | [![PWC](https://img.shields.io/endpoint.svg?url=https://paperswithcode.com/badge/no-time-to-train-training-free-reference/few-shot-object-detection-on-ms-coco-30-shot)](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-30-shot?p=no-time-to-train-training-free-reference)

</div>

---

> ğŸ”” **ì—…ë°ì´íŠ¸ (2025ë…„ 7ì›”):** ì½”ë“œê°€ ì§€ì¹¨ê³¼ í•¨ê»˜ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤!

---

## ğŸ“‹ ëª©ì°¨

- [ğŸ¯ ì£¼ìš” íŠ¹ì§•](#-highlights)
- [ğŸ“œ ì´ˆë¡](#-abstract)
- [ğŸ§  ì•„í‚¤í…ì²˜](#-architecture)
- [ğŸ› ï¸ ì„¤ì¹˜ ì•ˆë‚´](#ï¸-installation-instructions)
  - [1. ì €ì¥ì†Œ ë³µì œ](#1-clone-the-repository)
  - [2. conda í™˜ê²½ ìƒì„±](#2-create-conda-environment)
  - [3. SAM2 ë° DinoV2 ì„¤ì¹˜](#3-install-sam2-and-dinov2)
  - [4. ë°ì´í„°ì…‹ ë‹¤ìš´ë¡œë“œ](#4-download-datasets)
  - [5. SAM2 ë° DinoV2 ì²´í¬í¬ì¸íŠ¸ ë‹¤ìš´ë¡œë“œ](#5-download-sam2-and-dinov2-checkpoints)
- [ğŸ“Š ì¶”ë¡  ì½”ë“œ: Few-shot COCOì—ì„œ 30-shot SOTA ê²°ê³¼ ì¬í˜„](#-inference-code)
  - [0. ì°¸ì¡° ì„¸íŠ¸ ìƒì„±](#0-create-reference-set)
  - [1. ì°¸ì¡°ë¡œ ë©”ëª¨ë¦¬ ì±„ìš°ê¸°](#1-fill-memory-with-references)
  - [2. ë©”ëª¨ë¦¬ ë±…í¬ í›„ì²˜ë¦¬](#2-post-process-memory-bank)
  - [3. ëŒ€ìƒ ì´ë¯¸ì§€ì—ì„œ ì¶”ë¡ ](#3-inference-on-target-images)
  - [ê²°ê³¼](#results)
- [ğŸ” ì¸ìš©](#-citation)


## ğŸ¯ ì£¼ìš” íŠ¹ì§•
- ğŸ’¡ **í›ˆë ¨ í•„ìš” ì—†ìŒ**: íŒŒì¸íŠœë‹ì´ë‚˜ í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§ ì—†ì´, ì°¸ì¡° ì´ë¯¸ì§€ë§Œ ì‚¬ìš©  
- ğŸ–¼ï¸ **ì°¸ì¡° ê¸°ë°˜**: ëª‡ ê°œì˜ ì˜ˆì‹œë¡œ ìƒˆë¡œìš´ ê°ì²´ ë¶„í•   
- ğŸ”¥ **ìµœì‹  ì„±ëŠ¥**: COCO, PASCAL VOC, Cross-Domain FSODì—ì„œ ê¸°ì¡´ í›ˆë ¨ ì—†ëŠ” ë°©ë²•ë³´ë‹¤ ìš°ìˆ˜í•œ ì„±ëŠ¥

**ë§í¬:**
- ğŸ§¾ [**arXiv ë…¼ë¬¸**](https://arxiv.org/abs/2507.02798)  
- ğŸŒ [**í”„ë¡œì íŠ¸ ì›¹ì‚¬ì´íŠ¸**](https://miquel-espinosa.github.io/no-time-to-train/)  
- ğŸ“ˆ [**Papers with Code**](https://paperswithcode.com/paper/no-time-to-train-training-free-reference)

## ğŸ“œ ì´ˆë¡

> ì´ë¯¸ì§€ ë¶„í•  ëª¨ë¸ì˜ ì„±ëŠ¥ì€ ëŒ€ê·œëª¨ ì£¼ì„ ë°ì´í„° ìˆ˜ì§‘ì˜ ë†’ì€ ë¹„ìš©ì— ì˜í•´ ì—­ì‚¬ì ìœ¼ë¡œ ì œí•œë˜ì–´ ì™”ìŠµë‹ˆë‹¤. Segment Anything Model(SAM)ì€ í”„ë¡¬í”„íŠ¸ ê¸°ë°˜, ì˜ë¯¸ ë¶ˆê°€ì§€ë¡ ì  ë¶„í•  íŒ¨ëŸ¬ë‹¤ì„ì„ í†µí•´ ì´ ë¬¸ì œë¥¼ ì™„í™”í•˜ì§€ë§Œ ì—¬ì „íˆ ìƒˆë¡œìš´ ì´ë¯¸ì§€ë¥¼ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ ìˆ˜ë™ ì‹œê° í”„ë¡¬í”„íŠ¸ë‚˜ ë³µì¡í•œ ë„ë©”ì¸ ì¢…ì† í”„ë¡¬í”„íŠ¸ ìƒì„± ê·œì¹™ì´ í•„ìš”í•©ë‹ˆë‹¤. ì´ ìƒˆë¡œìš´ ë¶€ë‹´ì„ ì¤„ì´ê¸° ìœ„í•´, ë³¸ ì—°êµ¬ëŠ” ì†Œìˆ˜ì˜ ì°¸ì¡° ì´ë¯¸ì§€ë§Œ ì œê³µë˜ëŠ” ê°ì²´ ë¶„í•  ì‘ì—…ì„ íƒêµ¬í•©ë‹ˆë‹¤. ìš°ë¦¬ì˜ í•µì‹¬ í†µì°°ì€ íŒŒìš´ë°ì´ì…˜ ëª¨ë¸ì´ í•™ìŠµí•œ ê°•ë ¥í•œ ì˜ë¯¸ë¡ ì  ì‚¬ì „ ì§€ì‹ì„ í™œìš©í•˜ì—¬ ì°¸ì¡° ì´ë¯¸ì§€ì™€ ëŒ€ìƒ ì´ë¯¸ì§€ ê°„ì˜ ëŒ€ì‘ ì˜ì—­ì„ ì‹ë³„í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì´ëŸ¬í•œ ëŒ€ì‘ì€ ë‹¤ìš´ìŠ¤íŠ¸ë¦¼ ì‘ì—…ì„ ìœ„í•œ ì¸ìŠ¤í„´ìŠ¤ ìˆ˜ì¤€ ë¶„í•  ë§ˆìŠ¤í¬ì˜ ìë™ ìƒì„±ì„ ê°€ëŠ¥í•˜ê²Œ í•˜ë©°, (1) ë©”ëª¨ë¦¬ ë±…í¬ êµ¬ì¶•, (2) í‘œí˜„ ì§‘ê³„, (3) ì˜ë¯¸ ì¸ì‹ íŠ¹ì„± ë§¤ì¹­ì„ í†µí•©í•œ ë‹¤ë‹¨ê³„ í›ˆë ¨ ì—†ëŠ” ë°©ë²•ìœ¼ë¡œ êµ¬í˜„ë©ë‹ˆë‹¤. ì‹¤í—˜ ê²°ê³¼, COCO FSOD(36.8% nAP), PASCAL VOC Few-Shot(71.2% nAP50), Cross-Domain FSOD ë²¤ì¹˜ë§ˆí¬(22.4% nAP)ì—ì„œ ìµœì‹  ì„±ëŠ¥ì„ ë‹¬ì„±í•˜ë©° ë¶„í•  ì§€í‘œì—ì„œ ìƒë‹¹í•œ ê°œì„ ì„ ë³´ì˜€ìŠµë‹ˆë‹¤.

![cdfsod-results-final-comic-sans-min](https://github.com/user-attachments/assets/ab302c02-c080-4042-99fc-0e181ba8abb9)


## ğŸ§  ì•„í‚¤í…ì²˜

![training-free-architecture-comic-sans-min](https://github.com/user-attachments/assets/d84dd83a-505e-45a0-8ce3-98e1838017f9)


## ğŸ› ï¸ ì„¤ì¹˜ ì•ˆë‚´

### 1. ì €ì¥ì†Œ ë³µì œ


```bash
git clone https://github.com/miquel-espinosa/no-time-to-train.git
cd no-time-to-train
```
### 2. conda í™˜ê²½ ìƒì„±

í•„ìš”í•œ íŒ¨í‚¤ì§€ë¥¼ í¬í•¨í•œ conda í™˜ê²½ì„ ìƒì„±í•©ë‹ˆë‹¤.

```bash
conda env create -f environment.yml
conda activate no-time-to-train
```
### 3. SAM2 ë° DinoV2 ì„¤ì¹˜

ìš°ë¦¬ëŠ” SAM2ì™€ DinoV2ë¥¼ ì†ŒìŠ¤ì—ì„œ ì„¤ì¹˜í•  ê²ƒì…ë‹ˆë‹¤.

```bash
pip install -e .
cd dinov2
pip install -e .
cd ..
```
### 4. ë°ì´í„°ì…‹ ë‹¤ìš´ë¡œë“œ

COCO ë°ì´í„°ì…‹ì„ ë‹¤ìš´ë¡œë“œí•˜ì—¬ `data/coco`ì— ì €ì¥í•˜ì„¸ìš”.

### 5. SAM2 ë° DinoV2 ì²´í¬í¬ì¸íŠ¸ ë‹¤ìš´ë¡œë“œ

ë…¼ë¬¸ì—ì„œ ì‚¬ìš©ëœ ì •í™•í•œ SAM2 ì²´í¬í¬ì¸íŠ¸ë¥¼ ë‹¤ìš´ë¡œë“œí•  ê²ƒì…ë‹ˆë‹¤.
(ë‹¨, SAM2.1 ì²´í¬í¬ì¸íŠ¸ëŠ” ì´ë¯¸ ì œê³µë˜ê³  ìˆìœ¼ë©° ë” ë‚˜ì€ ì„±ëŠ¥ì„ ë³´ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.)


```bash
mkdir -p checkpoints/dinov2
cd checkpoints
wget https://dl.fbaipublicfiles.com/segment_anything_2/072824/sam2_hiera_large.pt
cd dinov2
wget https://dl.fbaipublicfiles.com/dinov2/dinov2_vitl14/dinov2_vitl14_pretrain.pth
cd ../..
```
<translate-content>

## ğŸ“Š ì¶”ë¡  ì½”ë“œ

âš ï¸ ë©´ì±… ì¡°í•­: ì´ ì½”ë“œëŠ” ì—°êµ¬ìš©ì…ë‹ˆë‹¤ â€” ì•½ê°„ì˜ í˜¼ë€ì´ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤!

### Few-shot COCOì—ì„œ 30-shot SOTA ê²°ê³¼ ì¬í˜„í•˜ê¸°

ìœ ìš©í•œ ë³€ìˆ˜ë¥¼ ì •ì˜í•˜ê³  ê²°ê³¼ë¥¼ ìœ„í•œ í´ë”ë¥¼ ë§Œë“­ë‹ˆë‹¤:
</translate-content>
```bash
CONFIG=./dev_hongyi/new_exps/coco_fewshot_10shot_Sam2L.yaml
CLASS_SPLIT="few_shot_classes"
RESULTS_DIR=work_dirs/few_shot_results
SHOTS=30
SEED=33
GPUS=4

mkdir -p $RESULTS_DIR
FILENAME=few_shot_${SHOTS}shot_seed${SEED}.pkl
```
#### 0. ì°¸ì¡° ì„¸íŠ¸ ìƒì„±


```bash
python dev_hongyi/dataset/few_shot_sampling.py \
        --n-shot $SHOTS \
        --out-path ${RESULTS_DIR}/${FILENAME} \
        --seed $SEED \
        --dataset $CLASS_SPLIT
```
#### 1. ì°¸ì¡°ë¡œ ë©”ëª¨ë¦¬ ì±„ìš°ê¸°


```bash
python run_lightening.py test --config $CONFIG \
                              --model.test_mode fill_memory \
                              --out_path ${RESULTS_DIR}/memory.ckpt \
                              --model.init_args.model_cfg.memory_bank_cfg.length $SHOTS \
                              --model.init_args.dataset_cfgs.fill_memory.memory_pkl ${RESULTS_DIR}/${FILENAME} \
                              --model.init_args.dataset_cfgs.fill_memory.memory_length $SHOTS \
                              --model.init_args.dataset_cfgs.fill_memory.class_split $CLASS_SPLIT \
                              --trainer.logger.save_dir ${RESULTS_DIR}/ \
                              --trainer.devices $GPUS
```
#### 2. í›„ì²˜ë¦¬ ë©”ëª¨ë¦¬ ë±…í¬


```bash
python run_lightening.py test --config $CONFIG \
                              --model.test_mode postprocess_memory \
                              --model.init_args.model_cfg.memory_bank_cfg.length $SHOTS \
                              --ckpt_path ${RESULTS_DIR}/memory.ckpt \
                              --out_path ${RESULTS_DIR}/memory_postprocessed.ckpt \
                              --trainer.devices 1
```
#### 3. ëŒ€ìƒ ì´ë¯¸ì§€ì— ëŒ€í•œ ì¶”ë¡ 


```bash
python run_lightening.py test --config $CONFIG  \
                              --ckpt_path ${RESULTS_DIR}/memory_postprocessed.ckpt \
                              --model.init_args.test_mode test \
                              --model.init_args.model_cfg.memory_bank_cfg.length $SHOTS \
                              --model.init_args.model_cfg.dataset_name $CLASS_SPLIT \
                              --model.init_args.dataset_cfgs.test.class_split $CLASS_SPLIT \
                              --trainer.logger.save_dir ${RESULTS_DIR}/ \
                              --trainer.devices $GPUS
```
<translate-content>
ì˜¨ë¼ì¸ìœ¼ë¡œ ì¶”ë¡  ê²°ê³¼ë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ í™•ì¸í•˜ê³  ì‹¶ë‹¤ë©´ `dev_hongyi/models/Sam2MatchingBaseline_noAMG.py` íŒŒì¼ì˜ 1746-1749í–‰ì˜ ì£¼ì„ì„ í•´ì œí•˜ì„¸ìš” [ì—¬ê¸°](https://github.com/miquel-espinosa/no-time-to-train/blob/main/dev_hongyi/models/Sam2MatchingBaseline_noAMG.py#L1746).
ë” ë§ê±°ë‚˜ ì ì€ ë¶„í• ëœ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë³´ë ¤ë©´ `score_thr` ì ìˆ˜ ì„ê³„ê°’ íŒŒë¼ë¯¸í„°ë¥¼ í•„ìš”ì— ë”°ë¼ ì¡°ì •í•˜ì„¸ìš”.
ì´ë¯¸ì§€ëŠ” ì´ì œ `results_analysis/few_shot_classes/`ì— ì €ì¥ë©ë‹ˆë‹¤. ì™¼ìª½ ì´ë¯¸ì§€ëŠ” ì‹¤ì œ ì •ë‹µì„, ì˜¤ë¥¸ìª½ ì´ë¯¸ì§€ëŠ” í•™ìŠµ ì—†ëŠ” ë°©ë²•ìœ¼ë¡œ ì°¾ì€ ë¶„í•  ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤.

ì´ ì˜ˆì œì—ì„œëŠ” `few_shot_classes` ë¶„í• ì„ ì‚¬ìš©í•˜ë¯€ë¡œ, ì´ ë¶„í• ì— í¬í•¨ëœ í´ë˜ìŠ¤ì˜ ë¶„í•  ì¸ìŠ¤í„´ìŠ¤ë§Œ ë³¼ ìˆ˜ ìˆì–´ì•¼ í•©ë‹ˆë‹¤ (COCOì˜ ëª¨ë“  í´ë˜ìŠ¤ëŠ” ì•„ë‹˜).

#### ê²°ê³¼

ê²€ì¦ ì„¸íŠ¸ì˜ ëª¨ë“  ì´ë¯¸ì§€ë¥¼ ì‹¤í–‰í•œ í›„ì—ëŠ” ë‹¤ìŒì„ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤:
</translate-content>
```
BBOX RESULTS:
  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.368

SEGM RESULTS:
  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.342
```
---


## ğŸ” Citation

If you use this work, please cite us:

```bibtex
@article{espinosa2025notimetotrain,
  title={No time to train! Training-Free Reference-Based Instance Segmentation},
  author={Miguel Espinosa and Chenhongyi Yang and Linus Ericsson and Steven McDonagh and Elliot J. Crowley},
  journal={arXiv preprint arXiv:2507.02798},
  year={2025},
  primaryclass={cs.CV}
}
```

---

Tranlated By [Open Ai Tx](https://github.com/OpenAiTx/OpenAiTx) | Last indexed: 2025-07-22

---