<div align="right">
  <details>
    <summary >ЁЯМР рднрд╛рд╖рд╛</summary>
    <div>
      <div align="center">
        <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=en">English</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=zh-CN">чоАф╜Уф╕нцЦЗ</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=zh-TW">ч╣БщлФф╕нцЦЗ</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=ja">цЧецЬмшкЮ</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=ko">эХЬъ╡ньЦ┤</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=hi">рд╣рд┐рдиреНрджреА</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=th">р╣Др╕Чр╕в</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=fr">Fran├зais</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=de">Deutsch</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=es">Espa├▒ol</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=it">Italiano</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=ru">╨а╤Г╤Б╤Б╨║╨╕╨╣</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=pt">Portugu├кs</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=nl">Nederlands</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=pl">Polski</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=ar">╪з┘Д╪╣╪▒╪и┘К╪й</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=fa">┘Б╪з╪▒╪│█М</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=tr">T├╝rk├зe</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=vi">Tiс║┐ng Viс╗Зt</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=id">Bahasa Indonesia</a>
      </div>
    </div>
  </details>
</div>

<div align="center">

# ЁЯЪА рдЯреНрд░реЗрдирд┐рдВрдЧ рдХрд╛ рд╕рдордп рдирд╣реАрдВ рд╣реИ!  
### рдЯреНрд░реЗрдирд┐рдВрдЧ-рдлреНрд░реА рд░реЗрдлрд░реЗрдВрд╕-рдЖрдзрд╛рд░рд┐рдд рдЗрдВрд╕реНрдЯреЗрдВрд╕ рд╕реЗрдЧрдореЗрдВрдЯреЗрд╢рди  
[![GitHub](https://img.shields.io/badge/%E2%80%8B-No%20Time%20To%20Train-black?logo=github)](https://github.com/miquel-espinosa/no-time-to-train)
[![Website](https://img.shields.io/badge/ЁЯМР-Project%20Page-grey)](https://miquel-espinosa.github.io/no-time-to-train/)
[![arXiv](https://img.shields.io/badge/arXiv-2507.02798-b31b1b)](https://arxiv.org/abs/2507.02798)

**рд╕реНрдЯреЗрдЯ-рдСрдл-рдж-рдЖрд░реНрдЯ (Papers with Code)**

[**_1-shot_**](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-1-shot?p=no-time-to-train-training-free-reference) | [![PWC](https://img.shields.io/endpoint.svg?url=https://paperswithcode.com/badge/no-time-to-train-training-free-reference/few-shot-object-detection-on-ms-coco-1-shot)](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-1-shot?p=no-time-to-train-training-free-reference)

[**_10-shot_**](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-10-shot?p=no-time-to-train-training-free-reference) | [![PWC](https://img.shields.io/endpoint.svg?url=https://paperswithcode.com/badge/no-time-to-train-training-free-reference/few-shot-object-detection-on-ms-coco-10-shot)](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-10-shot?p=no-time-to-train-training-free-reference)

[**_30-shot_**](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-30-shot?p=no-time-to-train-training-free-reference) | [![PWC](https://img.shields.io/endpoint.svg?url=https://paperswithcode.com/badge/no-time-to-train-training-free-reference/few-shot-object-detection-on-ms-coco-30-shot)](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-30-shot?p=no-time-to-train-training-free-reference)

</div>

---

> ЁЯФФ **рдЕрдкрдбреЗрдЯ (рдЬреБрд▓рд╛рдИ 2025):** рдХреЛрдб рдХреЛ рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреЗ рд╕рд╛рде рдЕрдкрдбреЗрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ!

---

## ЁЯУЛ рд╕рд╛рдордЧреНрд░реА рд╕реВрдЪреА

- [ЁЯОп рдореБрдЦреНрдп рдЖрдХрд░реНрд╖рдг](#-highlights)
- [ЁЯУЬ рд╕рд╛рд░рд╛рдВрд╢](#-abstract)
- [ЁЯза рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░](#-architecture)
- [ЁЯЫая╕П рдЗрдВрд╕реНрдЯреЙрд▓реЗрд╢рди рдирд┐рд░реНрджреЗрд╢](#я╕П-installation-instructions)
  - [1. рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдХреНрд▓реЛрди рдХрд░реЗрдВ](#1-clone-the-repository)
  - [2. рдХреЛрдВрдбрд╛ рдПрдирд╡рд╛рдпрд░рдирдореЗрдВрдЯ рдмрдирд╛рдПрдВ](#2-create-conda-environment)
  - [3. SAM2 рдФрд░ DinoV2 рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░реЗрдВ](#3-install-sam2-and-dinov2)
  - [4. рдбреЗрдЯрд╛рд╕реЗрдЯ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ](#4-download-datasets)
  - [5. SAM2 рдФрд░ DinoV2 рдЪреЗрдХрдкреЙрдЗрдВрдЯреНрд╕ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ](#5-download-sam2-and-dinov2-checkpoints)
- [ЁЯУК рдЗрдВрдлрд░реЗрдВрд╕ рдХреЛрдб: Few-shot COCO рдореЗрдВ 30-shot SOTA рдкрд░рд┐рдгрд╛рдо рдкреБрди: рдЙрддреНрдкрдиреНрди рдХрд░реЗрдВ](#-inference-code)
  - [0. рд░реЗрдлрд░реЗрдВрд╕ рд╕реЗрдЯ рдмрдирд╛рдПрдВ](#0-create-reference-set)
  - [1. рд░реЗрдлрд░реЗрдВрд╕ рдХреЗ рд╕рд╛рде рдореЗрдореЛрд░реА рднрд░реЗрдВ](#1-fill-memory-with-references)
  - [2. рдореЗрдореЛрд░реА рдмреИрдВрдХ рдкреЛрд╕реНрдЯ-рдкреНрд░реЛрд╕реЗрд╕ рдХрд░реЗрдВ](#2-post-process-memory-bank)
  - [3. рдЯрд╛рд░рдЧреЗрдЯ рдЗрдореЗрдЬ рдкрд░ рдЗрдВрдлрд░реЗрдВрд╕ рдХрд░реЗрдВ](#3-inference-on-target-images)
  - [рдкрд░рд┐рдгрд╛рдо](#results)
- [ЁЯФН рд╕рдВрджрд░реНрдн](#-citation)


## ЁЯОп рдореБрдЦреНрдп рдЖрдХрд░реНрд╖рдг
- ЁЯТб **рдЯреНрд░реЗрдирд┐рдВрдЧ-рдлреНрд░реА**: рди рдлрд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧ, рди рд╣реА рдкреНрд░реЙрдореНрдкреНрдЯ рдЗрдВрдЬреАрдирд┐рдпрд░рд┐рдВрдЧтАФрд╕рд┐рд░реНрдл рдПрдХ рд░реЗрдлрд░реЗрдВрд╕ рдЗрдореЗрдЬред  
- ЁЯЦ╝я╕П **рд░реЗрдлрд░реЗрдВрд╕-рдЖрдзрд╛рд░рд┐рдд**: рдХреБрдЫ рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреЗ рд╕рд╛рде рдирдП рдСрдмреНрдЬреЗрдХреНрдЯреНрд╕ рдХрд╛ рд╕реЗрдЧрдореЗрдВрдЯреЗрд╢рди рдХрд░реЗрдВред  
- ЁЯФе **SOTA рдкреНрд░рджрд░реНрд╢рди**: COCO, PASCAL VOC, рдФрд░ Cross-Domain FSOD рдкрд░ рдкрд┐рдЫрд▓реА рдЯреНрд░реЗрдирд┐рдВрдЧ-рдлреНрд░реА рд╡рд┐рдзрд┐рдпреЛрдВ рд╕реЗ рдмреЗрд╣рддрд░ рдкреНрд░рджрд░реНрд╢рдиред

**рд▓рд┐рдВрдХ:**
- ЁЯз╛ [**arXiv рдкреЗрдкрд░**](https://arxiv.org/abs/2507.02798)  
- ЁЯМР [**рдкреНрд░реЛрдЬреЗрдХреНрдЯ рд╡реЗрдмрд╕рд╛рдЗрдЯ**](https://miquel-espinosa.github.io/no-time-to-train/)  
- ЁЯУИ [**Papers with Code**](https://paperswithcode.com/paper/no-time-to-train-training-free-reference)

## ЁЯУЬ рд╕рд╛рд░рд╛рдВрд╢

> рдЗрдореЗрдЬ рд╕реЗрдЧрдореЗрдВрдЯреЗрд╢рди рдореЙрдбрд▓реНрд╕ рдХрд╛ рдкреНрд░рджрд░реНрд╢рди рдРрддрд┐рд╣рд╛рд╕рд┐рдХ рд░реВрдк рд╕реЗ рдмрдбрд╝реЗ рдкреИрдорд╛рдиреЗ рдкрд░ рдПрдиреЛрдЯреЗрдЯреЗрдб рдбреЗрдЯрд╛ рдПрдХрддреНрд░ рдХрд░рдиреЗ рдХреА рдЙрдЪреНрдЪ рд▓рд╛рдЧрдд рд╕реЗ рд╕реАрдорд┐рдд рд░рд╣рд╛ рд╣реИред рд╕реЗрдЧрдореЗрдВрдЯ рдПрдиреАрдерд┐рдВрдЧ рдореЙрдбрд▓ (SAM) рдЗрд╕ рдореВрд▓ рд╕рдорд╕реНрдпрд╛ рдХреЛ рдПрдХ рдкреНрд░реЙрдореНрдкреНрдЯреЗрдмрд▓, рд╕реИрдореЗрдВрдЯрд┐рдХреНрд╕-рдПрдЧреНрдиреЙрд╕реНрдЯрд┐рдХ рд╕реЗрдЧрдореЗрдВрдЯреЗрд╢рди рдкреИрд░рд╛рдбрд╛рдЗрдо рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╣рд▓ рдХрд░рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдлрд┐рд░ рднреА рдирдИ рдЗрдореЗрдЬ рдкреНрд░реЛрд╕реЗрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдореИрдиреНрдпреБрдЕрд▓ рд╡рд┐рдЬрд╝реБрдЕрд▓-рдкреНрд░реЙрдореНрдкреНрдЯреНрд╕ рдпрд╛ рдЬрдЯрд┐рд▓ рдбреЛрдореЗрди-рдирд┐рд░реНрднрд░ рдкреНрд░реЙрдореНрдкреНрдЯ-рдЬреЗрдирд░реЗрд╢рди рдирд┐рдпрдореЛрдВ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред рдЗрд╕ рдирдИ рдЪреБрдиреМрддреА рдХреЛ рдХрдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдорд╛рд░рд╛ рдХрд╛рд░реНрдп рд╡рд╕реНрддреБ рд╕реЗрдЧрдореЗрдВрдЯреЗрд╢рди рдХрд╛ рдЕрдзреНрдпрдпрди рдХрд░рддрд╛ рд╣реИ рдЬрдм рдХреЗрд╡рд▓ рдХреБрдЫ рд░реЗрдлрд░реЗрдВрд╕ рдЗрдореЗрдЬ рдЙрдкрд▓рдмреНрдз рд╣реЛрдВред рд╣рдорд╛рд░реА рдореБрдЦреНрдп рдЕрдВрддрд░реНрджреГрд╖реНрдЯрд┐ рдпрд╣ рд╣реИ рдХрд┐ рдлрд╛рдЙрдВрдбреЗрд╢рди рдореЙрдбрд▓реНрд╕ рджреНрд╡рд╛рд░рд╛ рд╕реАрдЦреЗ рдЧрдП рдордЬрдмреВрдд рд╕реИрдореЗрдВрдЯрд┐рдХ рдкреНрд░рд╛рдпрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░реЗрдлрд░реЗрдВрд╕ рдФрд░ рдЯрд╛рд░рдЧреЗрдЯ рдЗрдореЗрдЬ рдХреЗ рдмреАрдЪ рд╕рдВрдмрдВрдзрд┐рдд рдХреНрд╖реЗрддреНрд░реЛрдВ рдХреА рдкрд╣рдЪрд╛рди рдХреА рдЬрд╛рдПред рд╣рдо рдкрд╛рддреЗ рд╣реИрдВ рдХрд┐ рдпреЗ рд╕рдВрдмрдВрдзрд┐рддрддрд╛ рдбрд╛рдЙрдирд╕реНрдЯреНрд░реАрдо рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рд╕реНрд╡рддрдГ рдЗрдВрд╕реНрдЯреЗрдВрд╕-рд╕реНрддрд░реАрдп рд╕реЗрдЧрдореЗрдВрдЯреЗрд╢рди рдорд╛рд╕реНрдХ рдЬрдирд░реЗрдЯ рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрддреА рд╣реИ, рдФрд░ рд╣рдо рдЕрдкрдиреЗ рд╡рд┐рдЪрд╛рд░реЛрдВ рдХреЛ рдПрдХ рдорд▓реНрдЯреА-рд╕реНрдЯреЗрдЬ, рдЯреНрд░реЗрдирд┐рдВрдЧ-рдлреНрд░реА рд╡рд┐рдзрд┐ рджреНрд╡рд╛рд░рд╛ рд▓рд╛рдЧреВ рдХрд░рддреЗ рд╣реИрдВ рдЬрд┐рд╕рдореЗрдВ (1) рдореЗрдореЛрд░реА рдмреИрдВрдХ рдирд┐рд░реНрдорд╛рдг; (2) рд░рд┐рдкреНрд░реЗрдЬреЗрдВрдЯреЗрд╢рди рдПрдЧреНрд░реАрдЧреЗрд╢рди рдФрд░ (3) рд╕реИрдореЗрдВрдЯрд┐рдХ-рдЕрд╡реЗрдпрд░ рдлреАрдЪрд░ рдореИрдЪрд┐рдВрдЧ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред рд╣рдорд╛рд░реЗ рдкреНрд░рдпреЛрдЧ рд╕реЗрдЧрдореЗрдВрдЯреЗрд╢рди рдореЗрдЯреНрд░рд┐рдХреНрд╕ рдкрд░ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╕реБрдзрд╛рд░ рджрд░реНрд╢рд╛рддреЗ рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ COCO FSOD (36.8% nAP), PASCAL VOC Few-Shot (71.2% nAP50) рдкрд░ рд╕реНрдЯреЗрдЯ-рдСрдл-рдж-рдЖрд░реНрдЯ рдкреНрд░рджрд░реНрд╢рди рдорд┐рд▓рддрд╛ рд╣реИ рдФрд░ Cross-Domain FSOD рдмреЗрдВрдЪрдорд╛рд░реНрдХ (22.4% nAP) рдкрд░ рдореМрдЬреВрджрд╛ рдЯреНрд░реЗрдирд┐рдВрдЧ-рдлреНрд░реА рд╡рд┐рдзрд┐рдпреЛрдВ рд╕реЗ рдмреЗрд╣рддрд░ рдкрд░рд┐рдгрд╛рдо рдорд┐рд▓рддреЗ рд╣реИрдВред

![cdfsod-results-final-comic-sans-min](https://github.com/user-attachments/assets/ab302c02-c080-4042-99fc-0e181ba8abb9)


## ЁЯза рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░

![training-free-architecture-comic-sans-min](https://github.com/user-attachments/assets/d84dd83a-505e-45a0-8ce3-98e1838017f9)


## ЁЯЫая╕П рдЗрдВрд╕реНрдЯреЙрд▓реЗрд╢рди рдирд┐рд░реНрджреЗрд╢

### 1. рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдХреНрд▓реЛрди рдХрд░реЗрдВ


```bash
git clone https://github.com/miquel-espinosa/no-time-to-train.git
cd no-time-to-train
```
### 2. рдХреЙрдиреНрдбрд╛ рд╡рд╛рддрд╛рд╡рд░рдг рдмрдирд╛рдПрдВ

рд╣рдо рдЖрд╡рд╢реНрдпрдХ рдкреИрдХреЗрдЬреЛрдВ рдХреЗ рд╕рд╛рде рдПрдХ рдХреЙрдиреНрдбрд╛ рд╡рд╛рддрд╛рд╡рд░рдг рдмрдирд╛рдПрдВрдЧреЗред

```bash
conda env create -f environment.yml
conda activate no-time-to-train
```
### 3. SAM2 рдФрд░ DinoV2 рд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдВ

рд╣рдо рд╕реНрд░реЛрдд рд╕реЗ SAM2 рдФрд░ DinoV2 рд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдВрдЧреЗред

```bash
pip install -e .
cd dinov2
pip install -e .
cd ..
```
### 4. рдбреЗрдЯрд╛рд╕реЗрдЯ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ

рдХреГрдкрдпрд╛ COCO рдбреЗрдЯрд╛рд╕реЗрдЯ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ рдФрд░ рдЗрд╕реЗ `data/coco` рдореЗрдВ рд░рдЦреЗрдВ

### 5. SAM2 рдФрд░ DinoV2 рдЪреЗрдХрдкреЙрдЗрдВрдЯреНрд╕ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ

рд╣рдо рд╡рд╣реА SAM2 рдЪреЗрдХрдкреЙрдЗрдВрдЯреНрд╕ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВрдЧреЗ рдЬреЛ рдкреЗрдкрд░ рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП рдереЗред
(рдзреНрдпрд╛рди рджреЗрдВ, рд╣рд╛рд▓рд╛рдВрдХрд┐, SAM2.1 рдЪреЗрдХрдкреЙрдЗрдВрдЯреНрд╕ рдкрд╣рд▓реЗ рд╕реЗ рдЙрдкрд▓рдмреНрдз рд╣реИрдВ рдФрд░ рд╕рдВрднрд╡рддрдГ рдмреЗрд╣рддрд░ рдкреНрд░рджрд░реНрд╢рди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред)


```bash
mkdir -p checkpoints/dinov2
cd checkpoints
wget https://dl.fbaipublicfiles.com/segment_anything_2/072824/sam2_hiera_large.pt
cd dinov2
wget https://dl.fbaipublicfiles.com/dinov2/dinov2_vitl14/dinov2_vitl14_pretrain.pth
cd ../..
```
## ЁЯУК рдЕрдиреБрдорд╛рди рдХреЛрдб

тЪая╕П рдЕрд╕реНрд╡реАрдХрд░рдг: рдпрд╣ рдЕрдиреБрд╕рдВрдзрд╛рди рдХреЛрдб рд╣реИ тАФ рдЗрд╕рдореЗрдВ рдереЛрдбрд╝реА рдЕрд╡реНрдпрд╡рд╕реНрдерд╛ рд╣реЛ рд╕рдХрддреА рд╣реИ!

### Few-shot COCO рдореЗрдВ 30-shot SOTA рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреА рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐

рдЙрдкрдпреЛрдЧреА рд╡реЗрд░рд┐рдПрдмрд▓реНрд╕ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░реЗрдВ рдФрд░ рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рдлрд╝реЛрд▓реНрдбрд░ рдмрдирд╛рдПрдВ:



```bash
CONFIG=./dev_hongyi/new_exps/coco_fewshot_10shot_Sam2L.yaml
CLASS_SPLIT="few_shot_classes"
RESULTS_DIR=work_dirs/few_shot_results
SHOTS=30
SEED=33
GPUS=4

mkdir -p $RESULTS_DIR
FILENAME=few_shot_${SHOTS}shot_seed${SEED}.pkl
```
#### 0. рд╕рдВрджрд░реНрдн рд╕реЗрдЯ рдмрдирд╛рдПрдВ


```bash
python dev_hongyi/dataset/few_shot_sampling.py \
        --n-shot $SHOTS \
        --out-path ${RESULTS_DIR}/${FILENAME} \
        --seed $SEED \
        --dataset $CLASS_SPLIT
```
#### 1. рдореЗрдореЛрд░реА рдХреЛ рд░реЗрдлрд░реЗрдВрд╕ рдХреЗ рд╕рд╛рде рднрд░реЗрдВ


```bash
python run_lightening.py test --config $CONFIG \
                              --model.test_mode fill_memory \
                              --out_path ${RESULTS_DIR}/memory.ckpt \
                              --model.init_args.model_cfg.memory_bank_cfg.length $SHOTS \
                              --model.init_args.dataset_cfgs.fill_memory.memory_pkl ${RESULTS_DIR}/${FILENAME} \
                              --model.init_args.dataset_cfgs.fill_memory.memory_length $SHOTS \
                              --model.init_args.dataset_cfgs.fill_memory.class_split $CLASS_SPLIT \
                              --trainer.logger.save_dir ${RESULTS_DIR}/ \
                              --trainer.devices $GPUS
```
#### 2. рдкреЛрд╕реНрдЯ-рдкреНрд░реЛрд╕реЗрд╕ рдореЗрдореЛрд░реА рдмреИрдВрдХ


```bash
python run_lightening.py test --config $CONFIG \
                              --model.test_mode postprocess_memory \
                              --model.init_args.model_cfg.memory_bank_cfg.length $SHOTS \
                              --ckpt_path ${RESULTS_DIR}/memory.ckpt \
                              --out_path ${RESULTS_DIR}/memory_postprocessed.ckpt \
                              --trainer.devices 1
```
#### 3. рд▓рдХреНрд╖реНрдп рдЪрд┐рддреНрд░реЛрдВ рдкрд░ рдЕрдиреБрдХрд░рдг (рдЗрдиреНрдлреЗрд░реЗрдВрд╕)


```bash
python run_lightening.py test --config $CONFIG  \
                              --ckpt_path ${RESULTS_DIR}/memory_postprocessed.ckpt \
                              --model.init_args.test_mode test \
                              --model.init_args.model_cfg.memory_bank_cfg.length $SHOTS \
                              --model.init_args.model_cfg.dataset_name $CLASS_SPLIT \
                              --model.init_args.dataset_cfgs.test.class_split $CLASS_SPLIT \
                              --trainer.logger.save_dir ${RESULTS_DIR}/ \
                              --trainer.devices $GPUS
```
рдпрджрд┐ рдЖрдк рдЗрдирдлреЗрд░реЗрдВрд╕ рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреЛ рдСрдирд▓рд╛рдЗрди (рдЬреИрд╕реЗ рд╣реА рд╡реЗ рдЧрдгрдирд╛ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ) рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ `dev_hongyi/models/Sam2MatchingBaseline_noAMG.py` рдореЗрдВ рдкрдВрдХреНрддрд┐рдпрд╛рдБ 1746-1749 рдХреЛ рдЕрдирдХрдореЗрдВрдЯ рдХрд░реЗрдВ [рдпрд╣рд╛рдБ](https://github.com/miquel-espinosa/no-time-to-train/blob/main/dev_hongyi/models/Sam2MatchingBaseline_noAMG.py#L1746)ред
рдЬрд╝рд░реВрд░рдд рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдЕрдзрд┐рдХ рдпрд╛ рдХрдо рд╕реЗрдЧрдореЗрдВрдЯреЗрдб рдЗрдВрд╕реНрдЯреЗрдВрд╕ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рд╕реНрдХреЛрд░ рдереНрд░реЗрд╢реЛрд▓реНрдб `score_thr` рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд░реЗрдВред
рдЕрдм рдЫрд╡рд┐рдпрд╛рдБ `results_analysis/few_shot_classes/` рдореЗрдВ рд╕рд╣реЗрдЬреА рдЬрд╛рдПрдВрдЧреАред рдмрд╛рдИрдВ рдУрд░ рдХреА рдЫрд╡рд┐ рдЧреНрд░рд╛рдЙрдВрдб рдЯреНрд░реБрде рджрд┐рдЦрд╛рддреА рд╣реИ, рджрд╛рдИрдВ рдУрд░ рдХреА рдЫрд╡рд┐ рд╣рдорд╛рд░реЗ рдЯреНрд░реЗрдирд┐рдВрдЧ-рдлреНрд░реА рддрд░реАрдХреЗ рджреНрд╡рд╛рд░рд╛ рдкрд╛рдП рдЧрдП рд╕реЗрдЧрдореЗрдВрдЯреЗрдб рдЗрдВрд╕реНрдЯреЗрдВрд╕ рджрд┐рдЦрд╛рддреА рд╣реИред

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рд╣рдо `few_shot_classes` рд╕реНрдкреНрд▓рд┐рдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рд╣рдореЗрдВ рдХреЗрд╡рд▓ рдЗрд╕ рд╕реНрдкреНрд▓рд┐рдЯ рдореЗрдВ рджреА рдЧрдИ рдХреНрд▓рд╛рд╕реЗрдЬрд╝ рдХреЗ рд╕реЗрдЧрдореЗрдВрдЯреЗрдб рдЗрдВрд╕реНрдЯреЗрдВрд╕ рд╣реА рджреЗрдЦрдиреЗ рдХреА рдЕрдкреЗрдХреНрд╖рд╛ рдХрд░рдиреА рдЪрд╛рд╣рд┐рдП (COCO рдХреА рд╕рднреА рдХреНрд▓рд╛рд╕реЗрдЬрд╝ рдирд╣реАрдВ)ред

#### рдкрд░рд┐рдгрд╛рдо

рд╕рднреА рдЗрдореЗрдЬреЗрдЬрд╝ рдХреЛ рд╡реЗрд▓рд┐рдбреЗрд╢рди рд╕реЗрдЯ рдореЗрдВ рдЪрд▓рд╛рдиреЗ рдХреЗ рдмрд╛рдж, рдЖрдкрдХреЛ рдирд┐рдореНрди рдкреНрд░рд╛рдкреНрдд рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП:


```
BBOX RESULTS:
  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.368

SEGM RESULTS:
  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.342
```
---


## ЁЯФН Citation

If you use this work, please cite us:

```bibtex
@article{espinosa2025notimetotrain,
  title={No time to train! Training-Free Reference-Based Instance Segmentation},
  author={Miguel Espinosa and Chenhongyi Yang and Linus Ericsson and Steven McDonagh and Elliot J. Crowley},
  journal={arXiv preprint arXiv:2507.02798},
  year={2025},
  primaryclass={cs.CV}
}
```

---

Tranlated By [Open Ai Tx](https://github.com/OpenAiTx/OpenAiTx) | Last indexed: 2025-07-22

---