<div align="right">
  <details>
    <summary >ЁЯМР рднрд╛рд╖рд╛</summary>
    <div>
      <div align="center">
        <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=en">English</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=zh-CN">чоАф╜Уф╕нцЦЗ</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=zh-TW">ч╣БщлФф╕нцЦЗ</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=ja">цЧецЬмшкЮ</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=ko">эХЬъ╡ньЦ┤</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=hi">рд╣рд┐рдиреНрджреА</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=th">р╣Др╕Чр╕в</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=fr">Fran├зais</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=de">Deutsch</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=es">Espa├▒ol</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=it">Italiano</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=ru">╨а╤Г╤Б╤Б╨║╨╕╨╣</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=pt">Portugu├кs</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=nl">Nederlands</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=pl">Polski</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=ar">╪з┘Д╪╣╪▒╪и┘К╪й</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=fa">┘Б╪з╪▒╪│█М</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=tr">T├╝rk├зe</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=vi">Tiс║┐ng Viс╗Зt</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=id">Bahasa Indonesia</a>
      </div>
    </div>
  </details>
</div>

<div align="center">

# ЁЯЪА рдЯреНрд░реЗрдирд┐рдВрдЧ рдХрд╛ рд╕рдордп рдирд╣реАрдВ!  
### рдкреНрд░рд╢рд┐рдХреНрд╖рдг-рд░рд╣рд┐рдд рд╕рдВрджрд░реНрдн-рдЖрдзрд╛рд░рд┐рдд рдЗрдВрд╕реНрдЯреЗрдВрд╕ рд╕реЗрдЧрдореЗрдВрдЯреЗрд╢рди  
[![GitHub](https://img.shields.io/badge/%E2%80%8B-No%20Time%20To%20Train-black?logo=github)](https://github.com/miquel-espinosa/no-time-to-train)
[![Website](https://img.shields.io/badge/ЁЯМР-Project%20Page-grey)](https://miquel-espinosa.github.io/no-time-to-train/)
[![arXiv](https://img.shields.io/badge/arXiv-2507.02798-b31b1b)](https://arxiv.org/abs/2507.02798)

**рд╕реНрдЯреЗрдЯ-рдСрдл-рдж-рдЖрд░реНрдЯ (Papers with Code)**

[**_SOTA 1-shot_**](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-1-shot?p=no-time-to-train-training-free-reference) | [![PWC](https://img.shields.io/badge/State%20of%20the%20Art-Few--Shot%20Object%20Detection%20on%20MS--COCO%20(1--shot)-21CBCE?style=flat&logo=paperswithcode)](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-1-shot?p=no-time-to-train-training-free-reference)

[**_SOTA 10-shot_**](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-10-shot?p=no-time-to-train-training-free-reference) | [![PWC](https://img.shields.io/badge/State%20of%20the%20Art-Few--Shot%20Object%20Detection%20on%20MS--COCO%20(10--shot)-21CBCE?style=flat&logo=paperswithcode)](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-10-shot?p=no-time-to-train-training-free-reference)

[**_SOTA 30-shot_**](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-30-shot?p=no-time-to-train-training-free-reference) | [![PWC](https://img.shields.io/badge/State%20of%20the%20Art-Few--Shot%20Object%20Detection%20on%20MS--COCO%20(30--shot)-21CBCE?style=flat&logo=paperswithcode)](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-30-shot?p=no-time-to-train-training-free-reference)

<!-- [**_SOTA 1-shot_**](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-1-shot?p=no-time-to-train-training-free-reference) | [![PWC](https://img.shields.io/endpoint.svg?url=https://paperswithcode.com/badge/no-time-to-train-training-free-reference/few-shot-object-detection-on-ms-coco-1-shot)](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-1-shot?p=no-time-to-train-training-free-reference)

[**_SOTA 10-shot_**](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-10-shot?p=no-time-to-train-training-free-reference) | [![PWC](https://img.shields.io/endpoint.svg?url=https://paperswithcode.com/badge/no-time-to-train-training-free-reference/few-shot-object-detection-on-ms-coco-10-shot)](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-10-shot?p=no-time-to-train-training-free-reference)

[**_SOTA 30-shot_**](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-30-shot?p=no-time-to-train-training-free-reference) | [![PWC](https://img.shields.io/endpoint.svg?url=https://paperswithcode.com/badge/no-time-to-train-training-free-reference/few-shot-object-detection-on-ms-coco-30-shot)](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-30-shot?p=no-time-to-train-training-free-reference) -->

</div>

---

> ЁЯЪи **рдЕрдкрдбреЗрдЯ (22 рдЬреБрд▓рд╛рдИ 2025):** рдХрд╕реНрдЯрдо рдбреЗрдЯрд╛рд╕реЗрдЯ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджреЗрд╢ рдЬреЛрдбрд╝ рджрд┐рдП рдЧрдП рд╣реИрдВ!
> 
> ЁЯФФ **рдЕрдкрдбреЗрдЯ (16 рдЬреБрд▓рд╛рдИ 2025):** рдХреЛрдб рдХреЛ рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреЗ рд╕рд╛рде рдЕрдкрдбреЗрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ!

---

## ЁЯУЛ рд╕рд╛рдордЧреНрд░реА рд╕реВрдЪреА

- [ЁЯОп рдореБрдЦреНрдп рдЖрдХрд░реНрд╖рдг](#-highlights)
- [ЁЯУЬ рд╕рд╛рд░рд╛рдВрд╢](#-abstract)
- [ЁЯза рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░](#-architecture)
- [ЁЯЫая╕П рдЗрдВрд╕реНрдЯреЙрд▓реЗрд╢рди рдирд┐рд░реНрджреЗрд╢](#я╕П-installation-instructions)
  - [1. рд░реЗрдкреЛ рдХреНрд▓реЛрди рдХрд░реЗрдВ](#1-clone-the-repository)
  - [2. рдХреЙрдиреНрдбрд╛ рдПрдирд╡рд╛рдпрд░рдирдореЗрдВрдЯ рдмрдирд╛рдПрдВ](#2-create-conda-environment)
  - [3. SAM2 рдФрд░ DinoV2 рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░реЗрдВ](#3-install-sam2-and-dinov2)
  - [4. рдбреЗрдЯрд╛рд╕реЗрдЯ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ](#4-download-datasets)
  - [5. SAM2 рдФрд░ DinoV2 рдЪреЗрдХрдкреЙрдЗрдВрдЯреНрд╕ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ](#5-download-sam2-and-dinov2-checkpoints)
- [ЁЯУК рдЗрдирдлрд░реЗрдВрд╕ рдХреЛрдб: Few-shot COCO рдореЗрдВ 30-shot SOTA рдкрд░рд┐рдгрд╛рдо рдкреБрди: рдЙрддреНрдкрдиреНрди рдХрд░реЗрдВ](#-inference-code)
  - [0. рд╕рдВрджрд░реНрдн рд╕реЗрдЯ рдмрдирд╛рдПрдВ](#0-create-reference-set)
  - [1. рдореЗрдореЛрд░реА рдореЗрдВ рд╕рдВрджрд░реНрдн рднрд░реЗрдВ](#1-fill-memory-with-references)
  - [2. рдореЗрдореЛрд░реА рдмреИрдВрдХ рдкреЛрд╕реНрдЯ-рдкреНрд░реЛрд╕реЗрд╕ рдХрд░реЗрдВ](#2-post-process-memory-bank)
  - [3. рдЯрд╛рд░рдЧреЗрдЯ рдЗрдореЗрдЬреЗрдЬ рдкрд░ рдЗрдирдлрд░реЗрдВрд╕ рдХрд░реЗрдВ](#3-inference-on-target-images)
  - [рдкрд░рд┐рдгрд╛рдо](#results)
- [ЁЯФН рдХрд╕реНрдЯрдо рдбреЗрдЯрд╛рд╕реЗрдЯ](#-custom-dataset)
  - [0. рдХрд╕реНрдЯрдо рдбреЗрдЯрд╛рд╕реЗрдЯ рддреИрдпрд╛рд░ рдХрд░реЗрдВ тЫ╡ЁЯРж](#0-prepare-a-custom-dataset)
  - [0.1 рдпрджрд┐ рдХреЗрд╡рд▓ bbox рдПрдиреЛрдЯреЗрд╢рди рдЙрдкрд▓рдмреНрдз рд╣реИрдВ](#01-if-only-bbox-annotations-are-available)
  - [0.2 COCO рдПрдиреЛрдЯреЗрд╢рди рдХреЛ рдкрд┐рдХрд▓ рдлрд╛рдЗрд▓ рдореЗрдВ рдХрдирд╡рд░реНрдЯ рдХрд░реЗрдВ](#02-convert-coco-annotations-to-pickle-file)
  - [1. рдореЗрдореЛрд░реА рдореЗрдВ рд╕рдВрджрд░реНрдн рднрд░реЗрдВ](#1-fill-memory-with-references)
  - [2. рдореЗрдореЛрд░реА рдмреИрдВрдХ рдкреЛрд╕реНрдЯ-рдкреНрд░реЛрд╕реЗрд╕ рдХрд░реЗрдВ](#2-post-process-memory-bank)
- [ЁЯУЪ рд╕рдВрджрд░реНрдн/рдЙрджреНрдзрд░рдг](#-citation)


## ЁЯОп рдореБрдЦреНрдп рдЖрдХрд░реНрд╖рдг
- ЁЯТб **рдкреНрд░рд╢рд┐рдХреНрд╖рдг-рд░рд╣рд┐рдд**: рдХреЛрдИ рдлрд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧ рдирд╣реАрдВ, рдХреЛрдИ рдкреНрд░реЙрдореНрдкреНрдЯ рдЗрдВрдЬреАрдирд┐рдпрд░рд┐рдВрдЧ рдирд╣реАрдВтАФрд╕рд┐рд░реНрдл рдПрдХ рд╕рдВрджрд░реНрдн рдЗрдореЗрдЬред
- ЁЯЦ╝я╕П **рд╕рдВрджрд░реНрдн-рдЖрдзрд╛рд░рд┐рдд**: рдХреЗрд╡рд▓ рдХреБрдЫ рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рдирдП рдСрдмреНрдЬреЗрдХреНрдЯреНрд╕ рдХреЛ рд╕реЗрдЧрдореЗрдВрдЯ рдХрд░реЗрдВред
- ЁЯФе **SOTA рдкреНрд░рджрд░реНрд╢рди**: COCO, PASCAL VOC, рдФрд░ Cross-Domain FSOD рдкрд░ рдкрд┐рдЫрд▓реЗ рдкреНрд░рд╢рд┐рдХреНрд╖рдг-рд░рд╣рд┐рдд рджреГрд╖реНрдЯрд┐рдХреЛрдгреЛрдВ рд╕реЗ рдмреЗрд╣рддрд░ред

**рд▓рд┐рдВрдХ:**
- ЁЯз╛ [**arXiv рдкреЗрдкрд░**](https://arxiv.org/abs/2507.02798)  
- ЁЯМР [**рдкреНрд░реЛрдЬреЗрдХреНрдЯ рд╡реЗрдмрд╕рд╛рдЗрдЯ**](https://miquel-espinosa.github.io/no-time-to-train/)  
- ЁЯУИ [**Papers with Code**](https://paperswithcode.com/paper/no-time-to-train-training-free-reference)

## ЁЯУЬ рд╕рд╛рд░рд╛рдВрд╢


> The performance of image segmentation models has historically been constrained by the high cost of collecting large-scale annotated data. The Segment Anything Model (SAM) alleviates this original problem through a promptable, semantics-agnostic, segmentation paradigm and yet still requires manual visual-prompts or complex domain-dependent prompt-generation rules to process a new image. Towards reducing this new burden, our work investigates the task of object segmentation when provided with, alternatively, only a small set of reference images. Our key insight is to leverage strong semantic priors, as learned by foundation models, to identify corresponding regions between a reference and a target image. We find that correspondences enable automatic generation of instance-level segmentation masks for downstream tasks and instantiate our ideas via a multi-stage, training-free method incorporating (1) memory bank construction; (2) representation aggregation and (3) semantic-aware feature matching. Our experiments show significant improvements on segmentation metrics, leading to state-of-the-art performance on COCO FSOD (36.8% nAP), PASCAL VOC Few-Shot (71.2% nAP50) and outperforming existing training-free approaches on the Cross-Domain FSOD benchmark (22.4% nAP).

![cdfsod-results-final-comic-sans-min](https://github.com/user-attachments/assets/ab302c02-c080-4042-99fc-0e181ba8abb9)


## ЁЯза Architecture

![training-free-architecture-comic-sans-min](https://github.com/user-attachments/assets/d84dd83a-505e-45a0-8ce3-98e1838017f9)


## ЁЯЫая╕П Installation instructions

### 1. Clone the repository

```bash
git clone https://github.com/miquel-espinosa/no-time-to-train.git
cd no-time-to-train
```
### 2. рдХреЙрдиреНрдбрд╛ рд╡рд╛рддрд╛рд╡рд░рдг рдмрдирд╛рдПрдВ

рд╣рдо рдЖрд╡рд╢реНрдпрдХ рдкреИрдХреЗрдЬреЛрдВ рдХреЗ рд╕рд╛рде рдПрдХ рдХреЙрдиреНрдбрд╛ рд╡рд╛рддрд╛рд╡рд░рдг рдмрдирд╛рдПрдВрдЧреЗред

```bash
conda env create -f environment.yml
conda activate no-time-to-train
```
### 3. SAM2 рдФрд░ DinoV2 рд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдВ

рд╣рдо рд╕реНрд░реЛрдд рд╕реЗ SAM2 рдФрд░ DinoV2 рд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдВрдЧреЗред

```bash
pip install -e .
cd dinov2
pip install -e .
cd ..
```
### 4. рдбреЗрдЯрд╛рд╕реЗрдЯ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ

рдХреГрдкрдпрд╛ COCO рдбреЗрдЯрд╛рд╕реЗрдЯ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ рдФрд░ рдЗрд╕реЗ `data/coco` рдореЗрдВ рд░рдЦреЗрдВ

### 5. SAM2 рдФрд░ DinoV2 рдЪреЗрдХрдкреЙрдЗрдВрдЯреНрд╕ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ

рд╣рдо рд╡рд╣реА SAM2 рдЪреЗрдХрдкреЙрдЗрдВрдЯреНрд╕ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВрдЧреЗ рдЬреЛ рдкреЗрдкрд░ рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП рдереЗред
(рдзреНрдпрд╛рди рджреЗрдВ, рд╣рд╛рд▓рд╛рдВрдХрд┐, SAM2.1 рдЪреЗрдХрдкреЙрдЗрдВрдЯреНрд╕ рдкрд╣рд▓реЗ рд╕реЗ рдЙрдкрд▓рдмреНрдз рд╣реИрдВ рдФрд░ рд╕рдВрднрд╡рддрдГ рдмреЗрд╣рддрд░ рдкреНрд░рджрд░реНрд╢рди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред)


```bash
mkdir -p checkpoints/dinov2
cd checkpoints
wget https://dl.fbaipublicfiles.com/segment_anything_2/072824/sam2_hiera_large.pt
cd dinov2
wget https://dl.fbaipublicfiles.com/dinov2/dinov2_vitl14/dinov2_vitl14_pretrain.pth
cd ../..
```
## ЁЯУК рдЕрдиреБрдорд╛рди рдХреЛрдб

тЪая╕П рдЕрд╕реНрд╡реАрдХрд░рдг: рдпрд╣ рдЕрдиреБрд╕рдВрдзрд╛рди рдХреЛрдб рд╣реИ тАФ рдЗрд╕рдореЗрдВ рдереЛрдбрд╝реА рдЕрд╡реНрдпрд╡рд╕реНрдерд╛ рд╣реЛ рд╕рдХрддреА рд╣реИ!

### Few-shot COCO рдореЗрдВ 30-shot SOTA рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреА рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐

рдЙрдкрдпреЛрдЧреА рд╡реЗрд░рд┐рдПрдмрд▓реНрд╕ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░реЗрдВ рдФрд░ рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рдлрд╝реЛрд▓реНрдбрд░ рдмрдирд╛рдПрдВ:



```bash
CONFIG=./no_time_to_train/new_exps/coco_fewshot_10shot_Sam2L.yaml
CLASS_SPLIT="few_shot_classes"
RESULTS_DIR=work_dirs/few_shot_results
SHOTS=30
SEED=33
GPUS=4

mkdir -p $RESULTS_DIR
FILENAME=few_shot_${SHOTS}shot_seed${SEED}.pkl
```
#### 0. рд╕рдВрджрд░реНрдн рд╕реЗрдЯ рдмрдирд╛рдПрдВ


```bash
python no_time_to_train/dataset/few_shot_sampling.py \
        --n-shot $SHOTS \
        --out-path ${RESULTS_DIR}/${FILENAME} \
        --seed $SEED \
        --dataset $CLASS_SPLIT
```
#### 1. рдореЗрдореЛрд░реА рдХреЛ рд░реЗрдлрд░реЗрдВрд╕ рдХреЗ рд╕рд╛рде рднрд░реЗрдВ


```bash
python run_lightening.py test --config $CONFIG \
                              --model.test_mode fill_memory \
                              --out_path ${RESULTS_DIR}/memory.ckpt \
                              --model.init_args.model_cfg.memory_bank_cfg.length $SHOTS \
                              --model.init_args.dataset_cfgs.fill_memory.memory_pkl ${RESULTS_DIR}/${FILENAME} \
                              --model.init_args.dataset_cfgs.fill_memory.memory_length $SHOTS \
                              --model.init_args.dataset_cfgs.fill_memory.class_split $CLASS_SPLIT \
                              --trainer.logger.save_dir ${RESULTS_DIR}/ \
                              --trainer.devices $GPUS
```
#### 2. рдкреЛрд╕реНрдЯ-рдкреНрд░реЛрд╕реЗрд╕ рдореЗрдореЛрд░реА рдмреИрдВрдХ


```bash
python run_lightening.py test --config $CONFIG \
                              --model.test_mode postprocess_memory \
                              --model.init_args.model_cfg.memory_bank_cfg.length $SHOTS \
                              --ckpt_path ${RESULTS_DIR}/memory.ckpt \
                              --out_path ${RESULTS_DIR}/memory_postprocessed.ckpt \
                              --trainer.devices 1
```
#### 3. рд▓рдХреНрд╖реНрдп рдЪрд┐рддреНрд░реЛрдВ рдкрд░ рдЕрдиреБрдХрд░рдг (рдЗрдиреНрдлреЗрд░реЗрдВрд╕)


```bash
python run_lightening.py test --config $CONFIG  \
                              --ckpt_path ${RESULTS_DIR}/memory_postprocessed.ckpt \
                              --model.init_args.test_mode test \
                              --model.init_args.model_cfg.memory_bank_cfg.length $SHOTS \
                              --model.init_args.model_cfg.dataset_name $CLASS_SPLIT \
                              --model.init_args.dataset_cfgs.test.class_split $CLASS_SPLIT \
                              --trainer.logger.save_dir ${RESULTS_DIR}/ \
                              --trainer.devices $GPUS
```
рдпрджрд┐ рдЖрдк рдЕрдиреБрдорд╛рди рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреЛ рдСрдирд▓рд╛рдЗрди (рдЬреИрд╕реЗ рд╣реА рд╡реЗ рдЧрдгрдирд╛ рд╣реЛрддреЗ рд╣реИрдВ) рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ `no_time_to_train/models/Sam2MatchingBaseline_noAMG.py` рдХреА рдкрдВрдХреНрддрд┐рдпрд╛рдБ 1746-1749 рдХреЛ рдЕрдирдХрдореЗрдВрдЯ рдХрд░реЗрдВ [рдпрд╣рд╛рдБ](https://github.com/miquel-espinosa/no-time-to-train/blob/main/no_time_to_train/models/Sam2MatchingBaseline_noAMG.py#L1746)ред
рд╕реНрдХреЛрд░ рдереНрд░реЗрд╢реЛрд▓реНрдб `score_thr` рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ рдЖрд╡рд╢реНрдпрдХрддрд╛рдиреБрд╕рд╛рд░ рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд░реЗрдВ, рддрд╛рдХрд┐ рдЖрдк рдЕрдзрд┐рдХ рдпрд╛ рдХрдо рд╕реЗрдЧрдореЗрдВрдЯреЗрдб рдЙрджрд╛рд╣рд░рдг рджреЗрдЦ рд╕рдХреЗрдВред
рдЕрдм рдЫрд╡рд┐рдпрд╛рдБ `results_analysis/few_shot_classes/` рдореЗрдВ рд╕рд╣реЗрдЬреА рдЬрд╛рдПрдВрдЧреАред рдмрд╛рдИрдВ рдУрд░ рдХреА рдЫрд╡рд┐ рдЧреНрд░рд╛рдЙрдВрдб рдЯреНрд░реБрде рджрд┐рдЦрд╛рддреА рд╣реИ, рджрд╛рдИрдВ рдУрд░ рдХреА рдЫрд╡рд┐ рд╣рдорд╛рд░реЗ рдкреНрд░рд╢рд┐рдХреНрд╖рдг-рдореБрдХреНрдд рддрд░реАрдХреЗ рд╕реЗ рдкрд╛рдП рдЧрдП рд╕реЗрдЧрдореЗрдВрдЯреЗрдб рдЙрджрд╛рд╣рд░рдг рджрд┐рдЦрд╛рддреА рд╣реИред

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рд╣рдо `few_shot_classes` рд╡рд┐рднрд╛рдЬрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рдЕрддрдГ рд╣рдореЗрдВ рдХреЗрд╡рд▓ рдЗрд╕ рд╡рд┐рднрд╛рдЬрди рдХреА рдХрдХреНрд╖рд╛рдУрдВ рдХреЗ рд╕реЗрдЧрдореЗрдВрдЯреЗрдб рдЙрджрд╛рд╣рд░рдг рд╣реА рджреЗрдЦрдиреЗ рдХреА рдЕрдкреЗрдХреНрд╖рд╛ рдХрд░рдиреА рдЪрд╛рд╣рд┐рдП (COCO рдХреА рд╕рднреА рдХрдХреНрд╖рд╛рдУрдВ рдХреЗ рдирд╣реАрдВ)ред

#### рдкрд░рд┐рдгрд╛рдо

рд╕рддреНрдпрд╛рдкрди рд╕реЗрдЯ рдореЗрдВ рд╕рднреА рдЫрд╡рд┐рдпреЛрдВ рдХреЛ рдЪрд▓рд╛рдиреЗ рдХреЗ рдмрд╛рдж, рдЖрдкрдХреЛ рдкреНрд░рд╛рдкреНрдд рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП:


```
BBOX RESULTS:
  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.368

SEGM RESULTS:
  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.342
```
---

## ЁЯФН рдХрд╕реНрдЯрдо рдбреЗрдЯрд╛рд╕реЗрдЯ

рд╣рдо рдЕрдкрдиреЗ рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдХреЛ рдХрд╕реНрдЯрдо рдбреЗрдЯрд╛рд╕реЗрдЯ рдкрд░ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджреЗрд╢ рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВред рдПрдиреЛрдЯреЗрд╢рди рдлреЙрд░реНрдореЗрдЯ рд╣рдореЗрд╢рд╛ COCO рдлреЙрд░реНрдореЗрдЯ рдореЗрдВ рд╣реА рд╣реЛрддрд╛ рд╣реИред

> **рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ;** рдпрджрд┐ рдЖрдк рд╕реАрдзреЗ *рдХрд╕реНрдЯрдо рдбреЗрдЯрд╛рд╕реЗрдЯреНрд╕* рдкрд░ рдкреВрд░реА рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдХреИрд╕реЗ рдЪрд▓рд╛рдПрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ `scripts/matching_cdfsod_pipeline.sh` рджреЗрдЦреЗрдВ, рд╕рд╛рде рд╣реА CD-FSOD рдбреЗрдЯрд╛рд╕реЗрдЯреНрд╕ рдХреЗ рдЙрджрд╛рд╣рд░рдг рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕ (рдЬреИрд╕реЗ `scripts/dior_fish.sh`) рднреА рджреЗрдЦреЗрдВред

### 0. рдПрдХ рдХрд╕реНрдЯрдо рдбреЗрдЯрд╛рд╕реЗрдЯ рддреИрдпрд╛рд░ рдХрд░реЗрдВ тЫ╡ЁЯРж

рдорд╛рди рд▓реАрдЬрд┐рдП рд╣рдо рдПрдХ рдХрд╕реНрдЯрдо рдбреЗрдЯрд╛рд╕реЗрдЯ рдореЗрдВ **рдирд╛рд╡реЗрдВ**тЫ╡ рдФрд░ **рдкрдХреНрд╖реА**ЁЯРж рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВред рд╣рдорд╛рд░реА рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА:
- рдкреНрд░рддреНрдпреЗрдХ рд╢реНрд░реЗрдгреА рдХреЗ рд▓рд┐рдП рдХрдо рд╕реЗ рдХрдо 1 *рдПрдиреЛрдЯреЗрдЯреЗрдб* рд░реЗрдлрд░реЗрдВрд╕ рдЗрдореЗрдЬ (рдЬреИрд╕реЗ рдирд╛рд╡ рдХреЗ рд▓рд┐рдП 1 рдФрд░ рдкрдХреНрд╖реА рдХреЗ рд▓рд┐рдП 1 рд░реЗрдлрд░реЗрдВрд╕ рдЗрдореЗрдЬ)
- рдХрдИ рд▓рдХреНрд╖реНрдп рдЗрдореЗрдЬ рдЬрд┐рдирдореЗрдВ рд╣рдорд╛рд░реЗ рд╡рд╛рдВрдЫрд┐рдд рд╢реНрд░реЗрдгрд┐рдпреЛрдВ рдХреЗ рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдорд┐рд▓ рд╕рдХреЗрдВред

рд╣рдордиреЗ COCO рдЗрдореЗрдЬреЗрд╕ рдХреЗ рд╕рд╛рде рдХрд╕реНрдЯрдо рдбреЗрдЯрд╛рд╕реЗрдЯ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЯреЙрдп рд╕реНрдХреНрд░рд┐рдкреНрдЯ рддреИрдпрд╛рд░ рдХреА рд╣реИ, **1-рд╢реЙрдЯ** рд╕реЗрдЯрд┐рдВрдЧ рдХреЗ рд▓рд┐рдПред
```bash
python scripts/make_custom_dataset.py
```
рдпрд╣ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдлрд╝реЛрд▓реНрдбрд░ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рд╕рд╛рде рдПрдХ рдХрд╕реНрдЯрдо рдбреЗрдЯрд╛рд╕реЗрдЯ рдмрдирд╛рдПрдЧрд╛:
```
data/my_custom_dataset/
    тФЬтФАтФА annotations/
    тФВ   тФЬтФАтФА custom_references.json
    тФВ   тФЬтФАтФА custom_targets.json
    тФВ   тФФтФАтФА references_visualisations/
    тФВ       тФЬтФАтФА bird_1.jpg
    тФВ       тФФтФАтФА boat_1.jpg
    тФФтФАтФА images/
        тФЬтФАтФА 429819.jpg
        тФЬтФАтФА 101435.jpg
        тФФтФАтФА (all target and reference images)
```
**рд╕рдВрджрд░реНрдн рдЫрд╡рд┐рдпреЛрдВ рдХрд╛ рджреГрд╢реНрдпрд╛рдВрдХрди (1-рд╢реЙрдЯ):**

| BIRD ЁЯРж рдХреЗ рд▓рд┐рдП 1-рд╢реЙрдЯ рд╕рдВрджрд░реНрдн рдЫрд╡рд┐ | BOAT тЫ╡ рдХреЗ рд▓рд┐рдП 1-рд╢реЙрдЯ рд╕рдВрджрд░реНрдн рдЫрд╡рд┐ |
|:-------------------------------:|:-------------------------------:|
| <img src="https://github.com/user-attachments/assets/e59e580d-a7db-42ac-b386-892af211fc85" alt="bird_1" width="500"/> | <img src="https://github.com/user-attachments/assets/f94ee025-ae37-4a45-9c3e-0cfe8f8cd2bc" alt="boat_1" width="500"/> |


### 0.1 рдпрджрд┐ рдХреЗрд╡рд▓ bbox рдПрдиреЛрдЯреЗрд╢рди рдЙрдкрд▓рдмреНрдз рд╣реИрдВ

рд╣рдо рдПрдХ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рднреА рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВ рдЬреЛ SAM2 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрдВрд╕реНрдЯреЗрдВрд╕-рд▓реЗрд╡рд▓ рд╕реЗрдЧрдореЗрдВрдЯреЗрд╢рди рдорд╛рд╕реНрдХ рдЙрддреНрдкрдиреНрди рдХрд░рддреА рд╣реИред рдпрд╣ рддрдм рдЙрдкрдпреЛрдЧреА рд╣реИ рдЬрдм рдЖрдкрдХреЗ рдкрд╛рд╕ рд╕рдВрджрд░реНрдн рдЫрд╡рд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдХреЗрд╡рд▓ рдмреЙрдХреНрд╕ рдПрдиреЛрдЯреЗрд╢рди рдЙрдкрд▓рдмреНрдз рд╣реЛрдВред


```bash
# Download sam_h checkpoint. Feel free to use more recent checkpoints (note: code might need to be adapted)
wget https://dl.fbaipublicfiles.com/segment_anything/sam_vit_h_4b8939.pth -O checkpoints/sam_vit_h_4b8939.pth
# Run automatic instance segmentation from ground truth bounding boxes.
python no_time_to_train/dataset/sam_bbox_to_segm_batch.py \
    --input_json data/my_custom_dataset/annotations/custom_references.json \
    --image_dir data/my_custom_dataset/images \
    --sam_checkpoint checkpoints/sam_vit_h_4b8939.pth \
    --model_type vit_h \
    --device cuda \
    --batch_size 8 \
    --visualize
```
**рдЗрдВрд╕реНрдЯреЗрдВрд╕-рд╕реНрддрд░реАрдп рд╕реЗрдЧрдореЗрдВрдЯреЗрд╢рди рдорд╛рд╕реНрдХ рдХреЗ рд╕рд╛рде рд╕рдВрджрд░реНрдн рдЫрд╡рд┐рдпрд╛рдБ (gt рдмреЙрдХреНрд╕ рд╕реЗ SAM2 рджреНрд╡рд╛рд░рд╛ рдЙрддреНрдкрдиреНрди, 1-рд╢реЙрдЯ):**

рдЙрддреНрдкрдиреНрди рд╕реЗрдЧрдореЗрдВрдЯреЗрд╢рди рдорд╛рд╕реНрдХ рдХрд╛ рджреГрд╢реНрдпрд╛рд╡рд▓реЛрдХрди `data/my_custom_dataset/annotations/custom_references_with_SAM_segm/references_visualisations/` рдореЗрдВ рд╕рд╣реЗрдЬрд╛ рдЧрдпрд╛ рд╣реИред

| BIRD ЁЯРж рдХреЗ рд▓рд┐рдП 1-рд╢реЙрдЯ рд╕рдВрджрд░реНрдн рдЫрд╡рд┐ (SAM рджреНрд╡рд╛рд░рд╛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд╕реЗрдЧрдореЗрдВрдЯреЗрд╢рди рдХреЗ рд╕рд╛рде) | BOAT тЫ╡ рдХреЗ рд▓рд┐рдП 1-рд╢реЙрдЯ рд╕рдВрджрд░реНрдн рдЫрд╡рд┐ (SAM рджреНрд╡рд╛рд░рд╛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд╕реЗрдЧрдореЗрдВрдЯреЗрд╢рди рдХреЗ рд╕рд╛рде) |
|:---------------------------------:|:----------------------------------:|
| <img src="https://github.com/user-attachments/assets/65d38dc4-1454-43cd-9600-e8efc67b3a82" alt="bird_1_with_SAM_segm" width="500"/> | <img src="https://github.com/user-attachments/assets/43a558ad-50ca-4715-8285-9aa3268843c6" alt="boat_1_with_SAM_segm" width="500"/> |

### 0.2 рдХреЛрдХреЛ рдПрдиреЛрдЯреЗрд╢рди рдХреЛ рдкрд┐рдХрд▓ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдмрджрд▓реЗрдВ




```bash
python no_time_to_train/dataset/coco_to_pkl.py \
    data/my_custom_dataset/annotations/custom_references_with_segm.json \
    data/my_custom_dataset/annotations/custom_references_with_segm.pkl \
    1
```
### 1. рдореЗрдореЛрд░реА рдХреЛ рд╕рдВрджрд░реНрднреЛрдВ рд╕реЗ рднрд░реЗрдВ

рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдЙрдкрдпреЛрдЧреА рд╡реЗрд░рд┐рдПрдмрд▓реНрд╕ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░реЗрдВ рдФрд░ рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рдлрд╝реЛрд▓реНрдбрд░ рдмрдирд╛рдПрдВред рд▓реЗрдмрд▓реНрд╕ рдХрд╛ рд╕рд╣реА рджреГрд╢реНрдпрдХрд░рдг рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╡рд░реНрдЧ рдирд╛рдореЛрдВ рдХреЛ рдЙрд╕реА рдХреНрд░рдо рдореЗрдВ рд░рдЦрдирд╛ рдЪрд╛рд╣рд┐рдП рдЬреИрд╕рд╛ рдХрд┐ рд╡реЗ json рдлрд╝рд╛рдЗрд▓ рдореЗрдВ category id рдХреЗ рдЕрдиреБрд╕рд╛рд░ рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, `bird` рдХрд╛ category id `16` рд╣реИ, `boat` рдХрд╛ category id `9` рд╣реИред рдЕрддрдГ, `CAT_NAMES=boat,bird`ред


```bash
DATASET_NAME=my_custom_dataset
DATASET_PATH=data/my_custom_dataset
CAT_NAMES=boat,bird
CATEGORY_NUM=2
SHOT=1
YAML_PATH=no_time_to_train/pl_configs/matching_cdfsod_template.yaml
PATH_TO_SAVE_CKPTS=./tmp_ckpts/my_custom_dataset
mkdir -p $PATH_TO_SAVE_CKPTS
```
рдЪрд░рдг 1 рдЪрд▓рд╛рдПрдБ:

```bash
python run_lightening.py test --config $YAML_PATH \
    --model.test_mode fill_memory \
    --out_path $PATH_TO_SAVE_CKPTS/$DATASET_NAME\_$SHOT\_refs_memory.pth \
    --model.init_args.dataset_cfgs.fill_memory.root $DATASET_PATH/images \
    --model.init_args.dataset_cfgs.fill_memory.json_file $DATASET_PATH/annotations/custom_references_with_segm.json \
    --model.init_args.dataset_cfgs.fill_memory.memory_pkl $DATASET_PATH/annotations/custom_references_with_segm.pkl \
    --model.init_args.dataset_cfgs.fill_memory.memory_length $SHOT \
    --model.init_args.dataset_cfgs.fill_memory.cat_names $CAT_NAMES \
    --model.init_args.model_cfg.dataset_name $DATASET_NAME \
    --model.init_args.model_cfg.memory_bank_cfg.length $SHOT \
    --model.init_args.model_cfg.memory_bank_cfg.category_num $CATEGORY_NUM \
    --trainer.devices 1
```
### 2. рдкреЛрд╕реНрдЯ-рдкреНрд░реЛрд╕реЗрд╕ рдореЗрдореЛрд░реА рдмреИрдВрдХ


```bash
python run_lightening.py test --config $YAML_PATH \
    --model.test_mode postprocess_memory \
    --ckpt_path $PATH_TO_SAVE_CKPTS/$DATASET_NAME\_$SHOT\_refs_memory.pth \
    --out_path $PATH_TO_SAVE_CKPTS/$DATASET_NAME\_$SHOT\_refs_memory_postprocessed.pth \
    --model.init_args.model_cfg.dataset_name $DATASET_NAME \
    --model.init_args.model_cfg.memory_bank_cfg.length $SHOT \
    --model.init_args.model_cfg.memory_bank_cfg.category_num $CATEGORY_NUM \
    --trainer.devices 1
```
### 3. рд▓рдХреНрд╖реНрдп рдЗрдореЗрдЬреЛрдВ рдкрд░ рдЕрдиреБрдорд╛рди

рдпрджрд┐ `ONLINE_VIS` рдХреЛ True рдкрд░ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХреЗ рдкрд░рд┐рдгрд╛рдо `results_analysis/my_custom_dataset/` рдореЗрдВ рд╕рд╣реЗрдЬреЗ рдЬрд╛рдПрдВрдЧреЗ рдФрд░ рдЬреИрд╕реЗ рд╣реА рд╡реЗ рдЧрдгрдирд╛ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, рд╡реИрд╕реЗ рд╣реА рдкреНрд░рджрд░реНрд╢рд┐рдд рд╣реЛрдВрдЧреЗред рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдСрдирд▓рд╛рдЗрди рд╡рд┐рдЬрд╝реБрдЕрд▓рд╛рдЗрдЬрд╝реЗрд╢рди рдХреЗ рд╕рд╛рде рдЪрд▓рд╛рдирд╛ рдХрд╛рдлреА рдзреАрдорд╛ рд╣реЛрддрд╛ рд╣реИред

рдЖрдк рд╕реНрдХреЛрд░ рдереНрд░реЗрд╢реЛрд▓реНрдб `VIS_THR` рдХреЛ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдЕрдзрд┐рдХ рдпрд╛ рдХрдо рд╕реЗрдЧрдореЗрдВрдЯреЗрдб рдЗрдВрд╕реНрдЯреЗрдВрд╕ рджреЗрдЦ рд╕рдХреЗрдВред

```bash
ONLINE_VIS=True
VIS_THR=0.4
python run_lightening.py test --config $YAML_PATH \
    --model.test_mode test \
    --ckpt_path $PATH_TO_SAVE_CKPTS/$DATASET_NAME\_$SHOT\_refs_memory_postprocessed.pth \
    --model.init_args.model_cfg.dataset_name $DATASET_NAME \
    --model.init_args.model_cfg.memory_bank_cfg.length $SHOT \
    --model.init_args.model_cfg.memory_bank_cfg.category_num $CATEGORY_NUM \
    --model.init_args.model_cfg.test.imgs_path $DATASET_PATH/images \
    --model.init_args.model_cfg.test.online_vis $ONLINE_VIS \
    --model.init_args.model_cfg.test.vis_thr $VIS_THR \
    --model.init_args.dataset_cfgs.test.root $DATASET_PATH/images \
    --model.init_args.dataset_cfgs.test.json_file $DATASET_PATH/annotations/custom_targets.json \
    --model.init_args.dataset_cfgs.test.cat_names $CAT_NAMES \
    --trainer.devices 1
```
### рдкрд░рд┐рдгрд╛рдо

рдкреНрд░рджрд░реНрд╢рди рдореАрдЯреНрд░рд┐рдХ (рдКрдкрд░ рджрд┐рдП рдЧрдП рдХрдорд╛рдВрдбреНрд╕ рдХреЗ рд╕рдорд╛рди рд╕рдЯреАрдХ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд╕рд╛рде) рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдП:


```
BBOX RESULTS:
  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.478

SEGM RESULTS:
  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.458
```
рджреГрд╢реНрдп рдкрд░рд┐рдгрд╛рдо `results_analysis/my_custom_dataset/` рдореЗрдВ рд╕рд╣реЗрдЬреЗ рдЬрд╛рддреЗ рд╣реИрдВред рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рд╣рдорд╛рд░реА рд╡рд┐рдзрд┐ рдЭреВрдареЗ рдирдХрд╛рд░рд╛рддреНрдордХ рдорд╛рдорд▓реЛрдВ рдХреЗ рд▓рд┐рдП рдХрд╛рдо рдХрд░рддреА рд╣реИ, рдпрд╛рдиреА рд╡реЗ рдЫрд╡рд┐рдпрд╛рдБ рдЬрд┐рдирдореЗрдВ рд╡рд╛рдВрдЫрд┐рдд рд╡рд░реНрдЧреЛрдВ рдХреА рдХреЛрдИ рднреА рдЗрдХрд╛рдИ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИред

*рдЫрд╡рд┐рдпреЛрдВ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ рдмрдбрд╝рд╛ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП тмЗя╕П*

| рдирд╛рд╡реЛрдВ рд╡рд╛рд▓реА рд▓рдХреНрд╖рд┐рдд рдЫрд╡рд┐ тЫ╡ (рдмрд╛рдПрдВ GT, рджрд╛рдПрдВ рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди) | рдкрдХреНрд╖рд┐рдпреЛрдВ рд╡рд╛рд▓реА рд▓рдХреНрд╖рд┐рдд рдЫрд╡рд┐ ЁЯРж (рдмрд╛рдПрдВ GT, рджрд╛рдПрдВ рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди) |
|:----------------------:|:----------------------:|
| ![000000459673](https://github.com/user-attachments/assets/678dc15a-dd3b-49d5-9287-6290da16aa6b) | ![000000407180](https://github.com/user-attachments/assets/fe306e48-af49-4d83-ac82-76fac6c456d1) |

| рдирд╛рд╡реЛрдВ рдФрд░ рдкрдХреНрд╖рд┐рдпреЛрдВ рд╡рд╛рд▓реА рд▓рдХреНрд╖рд┐рдд рдЫрд╡рд┐ тЫ╡ЁЯРж (рдмрд╛рдПрдВ GT, рджрд╛рдПрдВ рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди) | рдмрд┐рдирд╛ рдирд╛рд╡ рдпрд╛ рдкрдХреНрд╖рд┐рдпреЛрдВ рд╡рд╛рд▓реА рд▓рдХреНрд╖рд┐рдд рдЫрд╡рд┐ ЁЯЪл (рдмрд╛рдПрдВ GT, рджрд╛рдПрдВ рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди) |
|:---------------------------------:|:----------------------------------:|
| ![000000517410](https://github.com/user-attachments/assets/9849b227-7f43-43d7-81ea-58010a623ad5) | ![000000460598](https://github.com/user-attachments/assets/7587700c-e09d-4cf6-8590-3df129c2568e) |


## ЁЯУЪ рд╕рдВрджрд░реНрдн

рдпрджрд┐ рдЖрдк рдЗрд╕ рдХрд╛рд░реНрдп рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдХреГрдкрдпрд╛ рд╣рдореЗрдВ рдЙрджреНрдзреГрдд рдХрд░реЗрдВ:


```bibtex
@article{espinosa2025notimetotrain,
  title={No time to train! Training-Free Reference-Based Instance Segmentation},
  author={Miguel Espinosa and Chenhongyi Yang and Linus Ericsson and Steven McDonagh and Elliot J. Crowley},
  journal={arXiv preprint arXiv:2507.02798},
  year={2025},
  primaryclass={cs.CV}
}
```


---

Tranlated By [Open Ai Tx](https://github.com/OpenAiTx/OpenAiTx) | Last indexed: 2025-07-24

---