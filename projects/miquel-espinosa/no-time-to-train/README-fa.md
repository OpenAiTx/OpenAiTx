<div align="right">
  <details>
    <summary >ğŸŒ Ø²Ø¨Ø§Ù†</summary>
    <div>
      <div align="center">
        <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=en">Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒ</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=zh-CN">ç®€ä½“ä¸­æ–‡</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=zh-TW">ç¹é«”ä¸­æ–‡</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=ja">Ú˜Ø§Ù¾Ù†ÛŒ</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=ko">Ú©Ø±Ù‡â€ŒØ§ÛŒ</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=hi">Ù‡Ù†Ø¯ÛŒ</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=th">ØªØ§ÛŒÙ„Ù†Ø¯ÛŒ</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=fr">ÙØ±Ø§Ù†Ø³ÙˆÛŒ</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=de">Ø¢Ù„Ù…Ø§Ù†ÛŒ</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=es">Ø§Ø³Ù¾Ø§Ù†ÛŒØ§ÛŒÛŒ</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=it">Ø§ÛŒØªØ§Ù„ÛŒØ§ÛŒÛŒ</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=ru">Ø±ÙˆØ³ÛŒ</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=pt">Ù¾Ø±ØªØºØ§Ù„ÛŒ</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=nl">Ù‡Ù„Ù†Ø¯ÛŒ</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=pl">Ù„Ù‡Ø³ØªØ§Ù†ÛŒ</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=ar">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=fa">ÙØ§Ø±Ø³ÛŒ</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=tr">ØªØ±Ú©ÛŒ</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=vi">ÙˆÛŒØªÙ†Ø§Ù…ÛŒ</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=id">Ø§Ù†Ø¯ÙˆÙ†Ø²ÛŒØ§ÛŒÛŒ</a>
      </div>
    </div>
  </details>
</div>

<div align="center">

# ğŸš€ Ø²Ù…Ø§Ù† Ø¢Ù…ÙˆØ²Ø´ Ù†Ø¯Ø§Ø±Ù…!  
### ØªÙ‚Ø³ÛŒÙ…â€ŒØ¨Ù†Ø¯ÛŒ Ù†Ù…ÙˆÙ†Ù‡ Ù…Ø¨ØªÙ†ÛŒ Ø¨Ø± Ù…Ø±Ø¬Ø¹ Ø¨Ø¯ÙˆÙ† Ù†ÛŒØ§Ø² Ø¨Ù‡ Ø¢Ù…ÙˆØ²Ø´  
[![GitHub](https://img.shields.io/badge/%E2%80%8B-No%20Time%20To%20Train-black?logo=github)](https://github.com/miquel-espinosa/no-time-to-train)
[![Website](https://img.shields.io/badge/ğŸŒ-Project%20Page-grey)](https://miquel-espinosa.github.io/no-time-to-train/)
[![arXiv](https://img.shields.io/badge/arXiv-2507.02798-b31b1b)](https://arxiv.org/abs/2507.02798)

**Ù¾ÛŒØ´Ø±ÙØªÙ‡â€ŒØªØ±ÛŒÙ† Ø±ÙˆØ´â€ŒÙ‡Ø§ (Ù…Ù‚Ø§Ù„Ø§Øª Ø¨Ø§ Ú©Ø¯)**

[**_Ø¨Ù‡ØªØ±ÛŒÙ† Ø¹Ù…Ù„Ú©Ø±Ø¯ 1 Ù†Ù…ÙˆÙ†Ù‡â€ŒØ§ÛŒ_**](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-1-shot?p=no-time-to-train-training-free-reference) | [![PWC](https://img.shields.io/badge/State%20of%20the%20Art-Few--Shot%20Object%20Detection%20on%20MS--COCO%20(1--shot)-21CBCE?style=flat&logo=paperswithcode)](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-1-shot?p=no-time-to-train-training-free-reference)

[**_Ø¨Ù‡ØªØ±ÛŒÙ† Ø¹Ù…Ù„Ú©Ø±Ø¯ 10 Ù†Ù…ÙˆÙ†Ù‡â€ŒØ§ÛŒ_**](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-10-shot?p=no-time-to-train-training-free-reference) | [![PWC](https://img.shields.io/badge/State%20of%20the%20Art-Few--Shot%20Object%20Detection%20on%20MS--COCO%20(10--shot)-21CBCE?style=flat&logo=paperswithcode)](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-10-shot?p=no-time-to-train-training-free-reference)

[**_Ø¨Ù‡ØªØ±ÛŒÙ† Ø¹Ù…Ù„Ú©Ø±Ø¯ 30 Ù†Ù…ÙˆÙ†Ù‡â€ŒØ§ÛŒ_**](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-30-shot?p=no-time-to-train-training-free-reference) | [![PWC](https://img.shields.io/badge/State%20of%20the%20Art-Few--Shot%20Object%20Detection%20on%20MS--COCO%20(30--shot)-21CBCE?style=flat&logo=paperswithcode)](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-30-shot?p=no-time-to-train-training-free-reference)

<!-- [**_Ø¨Ù‡ØªØ±ÛŒÙ† Ø¹Ù…Ù„Ú©Ø±Ø¯ 1 Ù†Ù…ÙˆÙ†Ù‡â€ŒØ§ÛŒ_**](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-1-shot?p=no-time-to-train-training-free-reference) | [![PWC](https://img.shields.io/endpoint.svg?url=https://paperswithcode.com/badge/no-time-to-train-training-free-reference/few-shot-object-detection-on-ms-coco-1-shot)](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-1-shot?p=no-time-to-train-training-free-reference)

[**_Ø¨Ù‡ØªØ±ÛŒÙ† Ø¹Ù…Ù„Ú©Ø±Ø¯ 10 Ù†Ù…ÙˆÙ†Ù‡â€ŒØ§ÛŒ_**](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-10-shot?p=no-time-to-train-training-free-reference) | [![PWC](https://img.shields.io/endpoint.svg?url=https://paperswithcode.com/badge/no-time-to-train-training-free-reference/few-shot-object-detection-on-ms-coco-10-shot)](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-10-shot?p=no-time-to-train-training-free-reference)

[**_Ø¨Ù‡ØªØ±ÛŒÙ† Ø¹Ù…Ù„Ú©Ø±Ø¯ 30 Ù†Ù…ÙˆÙ†Ù‡â€ŒØ§ÛŒ_**](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-30-shot?p=no-time-to-train-training-free-reference) | [![PWC](https://img.shields.io/endpoint.svg?url=https://paperswithcode.com/badge/no-time-to-train-training-free-reference/few-shot-object-detection-on-ms-coco-30-shot)](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-30-shot?p=no-time-to-train-training-free-reference) -->

</div>

---

> ğŸš¨ **Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ (Û²Û² ØªÛŒØ± Û±Û´Û°Û´):** Ø¯Ø³ØªÙˆØ±Ø§Ù„Ø¹Ù…Ù„â€ŒÙ‡Ø§ Ø¨Ø±Ø§ÛŒ Ù…Ø¬Ù…ÙˆØ¹Ù‡ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø³ÙØ§Ø±Ø´ÛŒ Ø§ÙØ²ÙˆØ¯Ù‡ Ø´Ø¯Ù†Ø¯!
> 
> ğŸ”” **Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ (Û±Û¶ ØªÛŒØ± Û±Û´Û°Û´):** Ú©Ø¯ Ø¨Ø§ Ø¯Ø³ØªÙˆØ±Ø§Ù„Ø¹Ù…Ù„â€ŒÙ‡Ø§ Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø´Ø¯!

---

## ğŸ“‹ ÙÙ‡Ø±Ø³Øª Ù…Ø·Ø§Ù„Ø¨

- [ğŸ¯ Ù†Ú©Ø§Øª Ø¨Ø±Ø¬Ø³ØªÙ‡](#-highlights)
- [ğŸ“œ Ú†Ú©ÛŒØ¯Ù‡](#-abstract)
- [ğŸ§  Ù…Ø¹Ù…Ø§Ø±ÛŒ](#-architecture)
- [ğŸ› ï¸ Ø¯Ø³ØªÙˆØ±Ø§Ù„Ø¹Ù…Ù„ Ù†ØµØ¨](#ï¸-installation-instructions)
  - [1. Ú©Ù„ÙˆÙ† Ú©Ø±Ø¯Ù† Ù…Ø®Ø²Ù†](#1-clone-the-repository)
  - [2. Ø³Ø§Ø®Øª Ù…Ø­ÛŒØ· Ú©Ø§Ù†Ø¯Ø§](#2-create-conda-environment)
  - [3. Ù†ØµØ¨ SAM2 Ùˆ DinoV2](#3-install-sam2-and-dinov2)
  - [4. Ø¯Ø§Ù†Ù„ÙˆØ¯ Ù…Ø¬Ù…ÙˆØ¹Ù‡ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§](#4-download-datasets)
  - [5. Ø¯Ø§Ù†Ù„ÙˆØ¯ Ù…Ø¯Ù„â€ŒÙ‡Ø§ÛŒ Ø§Ø² Ù¾ÛŒØ´ Ø¢Ù…ÙˆØ²Ø´â€ŒØ¯ÛŒØ¯Ù‡ SAM2 Ùˆ DinoV2](#5-download-sam2-and-dinov2-checkpoints)
- [ğŸ“Š Ú©Ø¯ Ø§Ø³ØªÙ†ØªØ§Ø¬: Ø¨Ø§Ø²ØªÙˆÙ„ÛŒØ¯ Ù†ØªØ§ÛŒØ¬ SOTA 30 Ù†Ù…ÙˆÙ†Ù‡â€ŒØ§ÛŒ Ø¯Ø± Few-shot COCO](#-inference-code)
  - [0. Ø³Ø§Ø®Øª Ù…Ø¬Ù…ÙˆØ¹Ù‡ Ù…Ø±Ø¬Ø¹](#0-create-reference-set)
  - [1. Ù¾Ø± Ú©Ø±Ø¯Ù† Ø­Ø§ÙØ¸Ù‡ Ø¨Ø§ Ù…Ø±Ø¬Ø¹â€ŒÙ‡Ø§](#1-fill-memory-with-references)
  - [2. Ù¾Ø³â€ŒÙ¾Ø±Ø¯Ø§Ø²Ø´ Ø¨Ø§Ù†Ú© Ø­Ø§ÙØ¸Ù‡](#2-post-process-memory-bank)
  - [3. Ø§Ø³ØªÙ†ØªØ§Ø¬ Ø±ÙˆÛŒ ØªØµØ§ÙˆÛŒØ± Ù‡Ø¯Ù](#3-inference-on-target-images)
  - [Ù†ØªØ§ÛŒØ¬](#results)

- [ğŸ” Ø¯ÛŒØªØ§Ø³Øª Ø³ÙØ§Ø±Ø´ÛŒ](#-custom-dataset)
  - [0. Ø¢Ù…Ø§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø¯ÛŒØªØ§Ø³Øª Ø³ÙØ§Ø±Ø´ÛŒ â›µğŸ¦](#0-prepare-a-custom-dataset)
  - [0.1 Ø§Ú¯Ø± ÙÙ‚Ø· Ù†Ø´Ø§Ù†Ù‡â€ŒÚ¯Ø°Ø§Ø±ÛŒâ€ŒÙ‡Ø§ÛŒ bbox Ù…ÙˆØ¬ÙˆØ¯ Ø§Ø³Øª](#01-if-only-bbox-annotations-are-available)
  - [0.2 ØªØ¨Ø¯ÛŒÙ„ Ù†Ø´Ø§Ù†Ù‡â€ŒÚ¯Ø°Ø§Ø±ÛŒâ€ŒÙ‡Ø§ÛŒ coco Ø¨Ù‡ ÙØ§ÛŒÙ„ pickle](#02-convert-coco-annotations-to-pickle-file)
  - [1. Ù¾Ø± Ú©Ø±Ø¯Ù† Ø­Ø§ÙØ¸Ù‡ Ø¨Ø§ Ù…Ø±Ø§Ø¬Ø¹](#1-fill-memory-with-references)
  - [2. Ù¾Ø±Ø¯Ø§Ø²Ø´ Ù¾Ø³ÛŒÙ† Ø¨Ø§Ù†Ú© Ø­Ø§ÙØ¸Ù‡](#2-post-process-memory-bank)
- [ğŸ“š Ø§Ø³ØªÙ†Ø§Ø¯](#-citation)


## ğŸ¯ Ù†Ú©Ø§Øª Ø¨Ø±Ø¬Ø³ØªÙ‡
- ğŸ’¡ **Ø¨Ø¯ÙˆÙ† Ø¢Ù…ÙˆØ²Ø´**: Ø¨Ø¯ÙˆÙ† ØªÙ†Ø¸ÛŒÙ… Ø¯Ù‚ÛŒÙ‚ØŒ Ø¨Ø¯ÙˆÙ† Ù…Ù‡Ù†Ø¯Ø³ÛŒ Ù¾Ø±Ø§Ù…Ù¾Øªâ€”ØªÙ†Ù‡Ø§ Ø¨Ø§ ÛŒÚ© ØªØµÙˆÛŒØ± Ù…Ø±Ø¬Ø¹.  
- ğŸ–¼ï¸ **Ù…Ø¨ØªÙ†ÛŒ Ø¨Ø± Ù…Ø±Ø¬Ø¹**: ØªÙ‚Ø³ÛŒÙ…â€ŒØ¨Ù†Ø¯ÛŒ Ø§Ø´ÛŒØ§ÛŒ Ø¬Ø¯ÛŒØ¯ ØªÙ†Ù‡Ø§ Ø¨Ø§ Ú†Ù†Ø¯ Ù†Ù…ÙˆÙ†Ù‡.  
- ğŸ”¥ **Ø¹Ù…Ù„Ú©Ø±Ø¯ SOTA**: Ø¹Ù…Ù„Ú©Ø±Ø¯ Ø¨Ù‡ØªØ± Ù†Ø³Ø¨Øª Ø¨Ù‡ Ø±ÙˆÛŒÚ©Ø±Ø¯Ù‡Ø§ÛŒ Ø¨Ø¯ÙˆÙ† Ø¢Ù…ÙˆØ²Ø´ Ù‚Ø¨Ù„ÛŒ Ø¯Ø± COCOØŒ PASCAL VOC Ùˆ FSOD Ø¨ÛŒÙ† Ø¯Ø§Ù…Ù†Ù‡â€ŒØ§ÛŒ.

**Ù„ÛŒÙ†Ú©â€ŒÙ‡Ø§:**
- ğŸ§¾ [**Ù…Ù‚Ø§Ù„Ù‡ arXiv**](https://arxiv.org/abs/2507.02798)  
- ğŸŒ [**ÙˆØ¨Ø³Ø§ÛŒØª Ù¾Ø±ÙˆÚ˜Ù‡**](https://miquel-espinosa.github.io/no-time-to-train/)  
- ğŸ“ˆ [**Papers with Code**](https://paperswithcode.com/paper/no-time-to-train-training-free-reference)

## ğŸ“œ Ú†Ú©ÛŒØ¯Ù‡

> The performance of image segmentation models has historically been constrained by the high cost of collecting large-scale annotated data. The Segment Anything Model (SAM) alleviates this original problem through a promptable, semantics-agnostic, segmentation paradigm and yet still requires manual visual-prompts or complex domain-dependent prompt-generation rules to process a new image. Towards reducing this new burden, our work investigates the task of object segmentation when provided with, alternatively, only a small set of reference images. Our key insight is to leverage strong semantic priors, as learned by foundation models, to identify corresponding regions between a reference and a target image. We find that correspondences enable automatic generation of instance-level segmentation masks for downstream tasks and instantiate our ideas via a multi-stage, training-free method incorporating (1) memory bank construction; (2) representation aggregation and (3) semantic-aware feature matching. Our experiments show significant improvements on segmentation metrics, leading to state-of-the-art performance on COCO FSOD (36.8% nAP), PASCAL VOC Few-Shot (71.2% nAP50) and outperforming existing training-free approaches on the Cross-Domain FSOD benchmark (22.4% nAP).

![cdfsod-results-final-comic-sans-min](https://github.com/user-attachments/assets/ab302c02-c080-4042-99fc-0e181ba8abb9)


## ğŸ§  Architecture

![training-free-architecture-comic-sans-min](https://github.com/user-attachments/assets/d84dd83a-505e-45a0-8ce3-98e1838017f9)


## ğŸ› ï¸ Installation instructions

### 1. Clone the repository

```bash
git clone https://github.com/miquel-espinosa/no-time-to-train.git
cd no-time-to-train
```
### Û². Ø§ÛŒØ¬Ø§Ø¯ Ù…Ø­ÛŒØ· conda

Ù…Ø§ ÛŒÚ© Ù…Ø­ÛŒØ· conda Ø¨Ø§ Ø¨Ø³ØªÙ‡â€ŒÙ‡Ø§ÛŒ Ù…ÙˆØ±Ø¯ Ù†ÛŒØ§Ø² Ø§ÛŒØ¬Ø§Ø¯ Ø®ÙˆØ§Ù‡ÛŒÙ… Ú©Ø±Ø¯.

```bash
conda env create -f environment.yml
conda activate no-time-to-train
```
### 3. Ù†ØµØ¨ SAM2 Ùˆ DinoV2

Ù…Ø§ SAM2 Ùˆ DinoV2 Ø±Ø§ Ø§Ø² Ø³ÙˆØ±Ø³ Ù†ØµØ¨ Ø®ÙˆØ§Ù‡ÛŒÙ… Ú©Ø±Ø¯.

```bash
pip install -e .
cd dinov2
pip install -e .
cd ..
```
### Û´. Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø¯ÛŒØªØ§Ø³Øªâ€ŒÙ‡Ø§

Ù„Ø·ÙØ§Ù‹ Ø¯ÛŒØªØ§Ø³Øª COCO Ø±Ø§ Ø¯Ø§Ù†Ù„ÙˆØ¯ Ú©Ø±Ø¯Ù‡ Ùˆ Ø¯Ø± Ù…Ø³ÛŒØ± `data/coco` Ù‚Ø±Ø§Ø± Ø¯Ù‡ÛŒØ¯

### Ûµ. Ø¯Ø§Ù†Ù„ÙˆØ¯ Ú†Ú©â€ŒÙ¾ÙˆÛŒÙ†Øªâ€ŒÙ‡Ø§ÛŒ SAM2 Ùˆ DinoV2

Ù…Ø§ Ø¯Ù‚ÛŒÙ‚Ø§Ù‹ Ù‡Ù…Ø§Ù† Ú†Ú©â€ŒÙ¾ÙˆÛŒÙ†Øªâ€ŒÙ‡Ø§ÛŒ SAM2 Ú©Ù‡ Ø¯Ø± Ù…Ù‚Ø§Ù„Ù‡ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø´Ø¯Ù‡ Ø±Ø§ Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø®ÙˆØ§Ù‡ÛŒÙ… Ú©Ø±Ø¯.
(Ø¨Ø§ Ø§ÛŒÙ† Ø­Ø§Ù„ ØªÙˆØ¬Ù‡ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´ÛŒØ¯ Ú©Ù‡ Ú†Ú©â€ŒÙ¾ÙˆÛŒÙ†Øªâ€ŒÙ‡Ø§ÛŒ SAM2.1 Ù‡Ù…â€ŒØ§Ú©Ù†ÙˆÙ† Ø¯Ø± Ø¯Ø³ØªØ±Ø³ Ù‡Ø³ØªÙ†Ø¯ Ùˆ Ù…Ù…Ú©Ù† Ø§Ø³Øª Ø¹Ù…Ù„Ú©Ø±Ø¯ Ø¨Ù‡ØªØ±ÛŒ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ù†Ø¯.)


```bash
mkdir -p checkpoints/dinov2
cd checkpoints
wget https://dl.fbaipublicfiles.com/segment_anything_2/072824/sam2_hiera_large.pt
cd dinov2
wget https://dl.fbaipublicfiles.com/dinov2/dinov2_vitl14/dinov2_vitl14_pretrain.pth
cd ../..
```
## ğŸ“Š Ú©Ø¯ Ø§Ø³ØªÙ†ØªØ§Ø¬

âš ï¸ Ø³Ù„Ø¨ Ù…Ø³Ø¦ÙˆÙ„ÛŒØª: Ø§ÛŒÙ† Ú©Ø¯ Ù¾Ú˜ÙˆÙ‡Ø´ÛŒ Ø§Ø³Øª â€” Ø§Ù†ØªØ¸Ø§Ø± Ú©Ù…ÛŒ Ø¨ÛŒâ€ŒÙ†Ø¸Ù…ÛŒ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´ÛŒØ¯!

### Ø¨Ø§Ø²ØªÙˆÙ„ÛŒØ¯ Ù†ØªØ§ÛŒØ¬ 30-Ø´Ø§Øª SOTA Ø¯Ø± Few-shot COCO

Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ Ù…ÙÛŒØ¯ Ø±Ø§ ØªØ¹Ø±ÛŒÙ Ú©Ù†ÛŒØ¯ Ùˆ ÛŒÚ© Ù¾ÙˆØ´Ù‡ Ø¨Ø±Ø§ÛŒ Ù†ØªØ§ÛŒØ¬ Ø§ÛŒØ¬Ø§Ø¯ Ù†Ù…Ø§ÛŒÛŒØ¯:



```bash
CONFIG=./no_time_to_train/new_exps/coco_fewshot_10shot_Sam2L.yaml
CLASS_SPLIT="few_shot_classes"
RESULTS_DIR=work_dirs/few_shot_results
SHOTS=30
SEED=33
GPUS=4

mkdir -p $RESULTS_DIR
FILENAME=few_shot_${SHOTS}shot_seed${SEED}.pkl
```
#### Û°. Ø§ÛŒØ¬Ø§Ø¯ Ù…Ø¬Ù…ÙˆØ¹Ù‡ Ù…Ø±Ø¬Ø¹


```bash
python no_time_to_train/dataset/few_shot_sampling.py \
        --n-shot $SHOTS \
        --out-path ${RESULTS_DIR}/${FILENAME} \
        --seed $SEED \
        --dataset $CLASS_SPLIT
```
#### 1. Ø­Ø§ÙØ¸Ù‡ Ø±Ø§ Ø¨Ø§ Ø§Ø±Ø¬Ø§Ø¹Ø§Øª Ù¾Ø± Ú©Ù†ÛŒØ¯


```bash
python run_lightening.py test --config $CONFIG \
                              --model.test_mode fill_memory \
                              --out_path ${RESULTS_DIR}/memory.ckpt \
                              --model.init_args.model_cfg.memory_bank_cfg.length $SHOTS \
                              --model.init_args.dataset_cfgs.fill_memory.memory_pkl ${RESULTS_DIR}/${FILENAME} \
                              --model.init_args.dataset_cfgs.fill_memory.memory_length $SHOTS \
                              --model.init_args.dataset_cfgs.fill_memory.class_split $CLASS_SPLIT \
                              --trainer.logger.save_dir ${RESULTS_DIR}/ \
                              --trainer.devices $GPUS
```
#### 2. Ù¾Ø±Ø¯Ø§Ø²Ø´ Ù¾Ø³â€ŒØ§Ø²Ø¢Ù† Ø¨Ø§Ù†Ú© Ø­Ø§ÙØ¸Ù‡


```bash
python run_lightening.py test --config $CONFIG \
                              --model.test_mode postprocess_memory \
                              --model.init_args.model_cfg.memory_bank_cfg.length $SHOTS \
                              --ckpt_path ${RESULTS_DIR}/memory.ckpt \
                              --out_path ${RESULTS_DIR}/memory_postprocessed.ckpt \
                              --trainer.devices 1
```
#### 3. Ø§Ø³ØªÙ†ØªØ§Ø¬ Ø¨Ø± Ø±ÙˆÛŒ ØªØµØ§ÙˆÛŒØ± Ù‡Ø¯Ù


```bash
python run_lightening.py test --config $CONFIG  \
                              --ckpt_path ${RESULTS_DIR}/memory_postprocessed.ckpt \
                              --model.init_args.test_mode test \
                              --model.init_args.model_cfg.memory_bank_cfg.length $SHOTS \
                              --model.init_args.model_cfg.dataset_name $CLASS_SPLIT \
                              --model.init_args.dataset_cfgs.test.class_split $CLASS_SPLIT \
                              --trainer.logger.save_dir ${RESULTS_DIR}/ \
                              --trainer.devices $GPUS
```
Ø§Ú¯Ø± Ù…Ø§ÛŒÙ„ÛŒØ¯ Ù†ØªØ§ÛŒØ¬ Ø§Ø³ØªÙ†ØªØ§Ø¬ Ø±Ø§ Ø¨Ù‡ ØµÙˆØ±Øª Ø¢Ù†Ù„Ø§ÛŒÙ† (Ù‡Ù…Ø²Ù…Ø§Ù† Ø¨Ø§ Ù…Ø­Ø§Ø³Ø¨Ù‡) Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ú©Ù†ÛŒØ¯ØŒ Ø§ÛŒÙ† Ø¢Ø±Ú¯ÙˆÙ…Ø§Ù† Ø±Ø§ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒØ¯:

```bash
    --model.init_args.model_cfg.test.online_vis True
```
Ø¨Ø±Ø§ÛŒ ØªÙ†Ø¸ÛŒÙ… Ù¾Ø§Ø±Ø§Ù…ØªØ± Ø¢Ø³ØªØ§Ù†Ù‡ Ø§Ù…ØªÛŒØ§Ø² `score_thr`ØŒ Ø¢Ø±Ú¯ÙˆÙ…Ø§Ù† Ø±Ø§ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒØ¯ (Ø¨Ø±Ø§ÛŒ Ù…Ø«Ø§Ù„ØŒ Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù‡Ù…Ù‡ Ù†Ù…ÙˆÙ†Ù‡â€ŒÙ‡Ø§ÛŒÛŒ Ø¨Ø§ Ø§Ù…ØªÛŒØ§Ø² Ø¨Ø§Ù„Ø§ØªØ± Ø§Ø² `0.4`):
```bash
    --model.init_args.model_cfg.test.vis_thr 0.4
```
ØªØµØ§ÙˆÛŒØ± Ø§Ú©Ù†ÙˆÙ† Ø¯Ø± Ù…Ø³ÛŒØ± `results_analysis/few_shot_classes/` Ø°Ø®ÛŒØ±Ù‡ Ø®ÙˆØ§Ù‡Ù†Ø¯ Ø´Ø¯. ØªØµÙˆÛŒØ± Ø³Ù…Øª Ú†Ù¾ Ø­Ù‚ÛŒÙ‚Øª Ø²Ù…ÛŒÙ†ÛŒ Ø±Ø§ Ù†Ø´Ø§Ù† Ù…ÛŒâ€ŒØ¯Ù‡Ø¯ØŒ ØªØµÙˆÛŒØ± Ø³Ù…Øª Ø±Ø§Ø³Øª Ù†Ù…ÙˆÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ø¨Ø®Ø´â€ŒØ¨Ù†Ø¯ÛŒâ€ŒØ´Ø¯Ù‡ Ø±Ø§ Ú©Ù‡ ØªÙˆØ³Ø· Ø±ÙˆØ´ Ø¨Ø¯ÙˆÙ† Ø¢Ù…ÙˆØ²Ø´ Ù…Ø§ ÛŒØ§ÙØª Ø´Ø¯Ù‡â€ŒØ§Ù†Ø¯ Ù†Ø´Ø§Ù† Ù…ÛŒâ€ŒØ¯Ù‡Ø¯.

ØªÙˆØ¬Ù‡ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´ÛŒØ¯ Ú©Ù‡ Ø¯Ø± Ø§ÛŒÙ† Ù…Ø«Ø§Ù„ Ù…Ø§ Ø§Ø² ØªÙ‚Ø³ÛŒÙ…â€ŒØ¨Ù†Ø¯ÛŒ `few_shot_classes` Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ…ØŒ Ø¨Ù†Ø§Ø¨Ø±Ø§ÛŒÙ† Ø¨Ø§ÛŒØ¯ Ø§Ù†ØªØ¸Ø§Ø± Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´ÛŒÙ… ÙÙ‚Ø· Ù†Ù…ÙˆÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ø¨Ø®Ø´â€ŒØ¨Ù†Ø¯ÛŒâ€ŒØ´Ø¯Ù‡ Ú©Ù„Ø§Ø³â€ŒÙ‡Ø§ÛŒ Ù…ÙˆØ¬ÙˆØ¯ Ø¯Ø± Ø§ÛŒÙ† ØªÙ‚Ø³ÛŒÙ…â€ŒØ¨Ù†Ø¯ÛŒ Ø±Ø§ Ø¨Ø¨ÛŒÙ†ÛŒÙ… (Ù†Ù‡ Ù‡Ù…Ù‡ Ú©Ù„Ø§Ø³â€ŒÙ‡Ø§ Ø¯Ø± COCO).

#### Ù†ØªØ§ÛŒØ¬

Ù¾Ø³ Ø§Ø² Ø§Ø¬Ø±Ø§ÛŒ Ù‡Ù…Ù‡ ØªØµØ§ÙˆÛŒØ± Ù…Ø¬Ù…ÙˆØ¹Ù‡ Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒØŒ Ø¨Ø§ÛŒØ¯ Ø¨Ù‡ Ù…ÙˆØ§Ø±Ø¯ Ø²ÛŒØ± Ø¯Ø³Øª ÛŒØ§Ø¨ÛŒØ¯:

```
BBOX RESULTS:
  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.368

SEGM RESULTS:
  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.342
```
---

## ğŸ” Ø¯ÛŒØªØ§Ø³Øª Ø³ÙØ§Ø±Ø´ÛŒ

Ù…Ø§ Ø¯Ø³ØªÙˆØ±Ø§Ù„Ø¹Ù…Ù„â€ŒÙ‡Ø§ÛŒÛŒ Ø¨Ø±Ø§ÛŒ Ø§Ø¬Ø±Ø§ÛŒ Ù¾Ø§ÛŒÙ¾Ù„Ø§ÛŒÙ† Ø®ÙˆØ¯ Ø¨Ø± Ø±ÙˆÛŒ Ø¯ÛŒØªØ§Ø³Øª Ø³ÙØ§Ø±Ø´ÛŒ Ø§Ø±Ø§Ø¦Ù‡ Ù…ÛŒâ€ŒØ¯Ù‡ÛŒÙ…. ÙØ±Ù…Øª Ø­Ø§Ø´ÛŒÙ‡â€ŒÙ†ÙˆÛŒØ³ÛŒ Ù‡Ù…ÛŒØ´Ù‡ Ø¨Ù‡ ØµÙˆØ±Øª COCO Ø§Ø³Øª.

> **Ø®Ù„Ø§ØµÙ‡Ø›** Ø¨Ø±Ø§ÛŒ Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù…Ø³ØªÙ‚ÛŒÙ… Ù†Ø­ÙˆÙ‡ Ø§Ø¬Ø±Ø§ÛŒ Ú©Ø§Ù…Ù„ Ù¾Ø§ÛŒÙ¾Ù„Ø§ÛŒÙ† Ø¨Ø± Ø±ÙˆÛŒ *Ø¯ÛŒØªØ§Ø³Øªâ€ŒÙ‡Ø§ÛŒ Ø³ÙØ§Ø±Ø´ÛŒ*ØŒ ÙØ§ÛŒÙ„ `scripts/matching_cdfsod_pipeline.sh` Ø±Ø§ Ø¨Ù‡ Ù‡Ù…Ø±Ø§Ù‡ Ø§Ø³Ú©Ø±ÛŒÙ¾Øªâ€ŒÙ‡Ø§ÛŒ Ù†Ù…ÙˆÙ†Ù‡ Ø¯ÛŒØªØ§Ø³Øªâ€ŒÙ‡Ø§ÛŒ CD-FSOD (Ù…Ø§Ù†Ù†Ø¯ `scripts/dior_fish.sh`) Ø¨ÛŒØ§Ø¨ÛŒØ¯.

### Û°. Ø¢Ù…Ø§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø¯ÛŒØªØ§Ø³Øª Ø³ÙØ§Ø±Ø´ÛŒ â›µğŸ¦

ÙØ±Ø¶ Ú©Ù†ÛŒÙ… Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒÙ… **Ù‚Ø§ÛŒÙ‚â€ŒÙ‡Ø§**â›µ Ùˆ **Ù¾Ø±Ù†Ø¯Ú¯Ø§Ù†**ğŸ¦ Ø±Ø§ Ø¯Ø± ÛŒÚ© Ø¯ÛŒØªØ§Ø³Øª Ø³ÙØ§Ø±Ø´ÛŒ Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ú©Ù†ÛŒÙ…. Ø¨Ø±Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø±ÙˆØ´ Ù…Ø§ Ø¨Ù‡ Ù…ÙˆØ§Ø±Ø¯ Ø²ÛŒØ± Ù†ÛŒØ§Ø² Ø¯Ø§Ø±ÛŒÙ…:
- Ø­Ø¯Ø§Ù‚Ù„ Û± ØªØµÙˆÛŒØ± Ù…Ø±Ø¬Ø¹ *Ø­Ø§Ø´ÛŒÙ‡â€ŒÙ†ÙˆÛŒØ³ÛŒâ€ŒØ´Ø¯Ù‡* Ø¨Ø±Ø§ÛŒ Ù‡Ø± Ú©Ù„Ø§Ø³ (ÛŒØ¹Ù†ÛŒ Û± ØªØµÙˆÛŒØ± Ù…Ø±Ø¬Ø¹ Ø¨Ø±Ø§ÛŒ Ù‚Ø§ÛŒÙ‚ Ùˆ Û± ØªØµÙˆÛŒØ± Ù…Ø±Ø¬Ø¹ Ø¨Ø±Ø§ÛŒ Ù¾Ø±Ù†Ø¯Ù‡)
- Ú†Ù†Ø¯ÛŒÙ† ØªØµÙˆÛŒØ± Ù‡Ø¯Ù Ø¨Ø±Ø§ÛŒ ÛŒØ§ÙØªÙ† Ù†Ù…ÙˆÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ú©Ù„Ø§Ø³â€ŒÙ‡Ø§ÛŒ Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø± Ù…Ø§.

Ù…Ø§ ÛŒÚ© Ø§Ø³Ú©Ø±ÛŒÙ¾Øª Ù†Ù…ÙˆÙ†Ù‡ Ø¨Ø±Ø§ÛŒ Ø§ÛŒØ¬Ø§Ø¯ ÛŒÚ© Ø¯ÛŒØªØ§Ø³Øª Ø³ÙØ§Ø±Ø´ÛŒ Ø¨Ø§ ØªØµØ§ÙˆÛŒØ± coco Ø¨Ø±Ø§ÛŒ ØªÙ†Ø¸ÛŒÙ…Ø§Øª **Û±-Ø´Ø§Øª** Ø¢Ù…Ø§Ø¯Ù‡ Ú©Ø±Ø¯Ù‡â€ŒØ§ÛŒÙ….
```bash
mkdir -p data/my_custom_dataset
python scripts/make_custom_dataset.py
```
Ø§ÛŒÙ† Ú©Ø§Ø± ÛŒÚ© Ù…Ø¬Ù…ÙˆØ¹Ù‡ Ø¯Ø§Ø¯Ù‡ Ø³ÙØ§Ø±Ø´ÛŒ Ø¨Ø§ Ø³Ø§Ø®ØªØ§Ø± Ù¾ÙˆØ´Ù‡ Ø²ÛŒØ± Ø§ÛŒØ¬Ø§Ø¯ Ø®ÙˆØ§Ù‡Ø¯ Ú©Ø±Ø¯:
```
data/my_custom_dataset/
    â”œâ”€â”€ annotations/
    â”‚   â”œâ”€â”€ custom_references.json
    â”‚   â”œâ”€â”€ custom_targets.json
    â”‚   â””â”€â”€ references_visualisations/
    â”‚       â”œâ”€â”€ bird_1.jpg
    â”‚       â””â”€â”€ boat_1.jpg
    â””â”€â”€ images/
        â”œâ”€â”€ 429819.jpg
        â”œâ”€â”€ 101435.jpg
        â””â”€â”€ (all target and reference images)
```
**Ø¨ØµØ±ÛŒâ€ŒØ³Ø§Ø²ÛŒ ØªØµØ§ÙˆÛŒØ± Ù…Ø±Ø¬Ø¹ (Û±-Ù†Ù…ÙˆÙ†Ù‡â€ŒØ§ÛŒ):**

| ØªØµÙˆÛŒØ± Ù…Ø±Ø¬Ø¹ Û±-Ù†Ù…ÙˆÙ†Ù‡â€ŒØ§ÛŒ Ø¨Ø±Ø§ÛŒ Ù¾Ø±Ù†Ø¯Ù‡ ğŸ¦ | ØªØµÙˆÛŒØ± Ù…Ø±Ø¬Ø¹ Û±-Ù†Ù…ÙˆÙ†Ù‡â€ŒØ§ÛŒ Ø¨Ø±Ø§ÛŒ Ù‚Ø§ÛŒÙ‚ â›µ |
|:---------------------------------:|:----------------------------------:|
| <img src="https://github.com/user-attachments/assets/e59e580d-a7db-42ac-b386-892af211fc85" alt="bird_1" width="500"/> | <img src="https://github.com/user-attachments/assets/f94ee025-ae37-4a45-9c3e-0cfe8f8cd2bc" alt="boat_1" width="500"/> |


### Û°.Û± Ø§Ú¯Ø± ØªÙ†Ù‡Ø§ Ù†Ø´Ø§Ù†Ù‡â€ŒÚ¯Ø°Ø§Ø±ÛŒâ€ŒÙ‡Ø§ÛŒ bbox Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø§Ø´Ø¯

Ù…Ø§ Ù‡Ù…Ú†Ù†ÛŒÙ† ÛŒÚ© Ø§Ø³Ú©Ø±ÛŒÙ¾Øª Ø¨Ø±Ø§ÛŒ ØªÙˆÙ„ÛŒØ¯ Ù…Ø§Ø³Ú©â€ŒÙ‡Ø§ÛŒ Ø¨Ø®Ø´â€ŒØ¨Ù†Ø¯ÛŒ Ø³Ø·Ø­ Ù†Ù…ÙˆÙ†Ù‡ Ø¨Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² SAM2 Ø§Ø±Ø§Ø¦Ù‡ Ù…ÛŒâ€ŒØ¯Ù‡ÛŒÙ…. Ø§ÛŒÙ† Ø§Ø¨Ø²Ø§Ø± Ø²Ù…Ø§Ù†ÛŒ Ù…ÙÛŒØ¯ Ø§Ø³Øª Ú©Ù‡ ØªÙ†Ù‡Ø§ Ù†Ø´Ø§Ù†Ù‡â€ŒÚ¯Ø°Ø§Ø±ÛŒâ€ŒÙ‡Ø§ÛŒ Ø¬Ø¹Ø¨Ù‡ Ù…Ø­Ø§Ø·ÛŒ Ø¨Ø±Ø§ÛŒ ØªØµØ§ÙˆÛŒØ± Ù…Ø±Ø¬Ø¹ Ø¯Ø± Ø§Ø®ØªÛŒØ§Ø± Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´ÛŒØ¯.


```bash
# Download sam_h checkpoint. Feel free to use more recent checkpoints (note: code might need to be adapted)
wget https://dl.fbaipublicfiles.com/segment_anything/sam_vit_h_4b8939.pth -O checkpoints/sam_vit_h_4b8939.pth
# Run automatic instance segmentation from ground truth bounding boxes.
python no_time_to_train/dataset/sam_bbox_to_segm_batch.py \
    --input_json data/my_custom_dataset/annotations/custom_references.json \
    --image_dir data/my_custom_dataset/images \
    --sam_checkpoint checkpoints/sam_vit_h_4b8939.pth \
    --model_type vit_h \
    --device cuda \
    --batch_size 8 \
    --visualize
```
**ØªØµØ§ÙˆÛŒØ± Ù…Ø±Ø¬Ø¹ Ø¨Ø§ Ù…Ø§Ø³Ú©â€ŒÙ‡Ø§ÛŒ Ø³Ú¯Ù…Ù†ØªÛŒØ´Ù† Ø¯Ø± Ø³Ø·Ø­ Ù†Ù…ÙˆÙ†Ù‡ (ØªÙˆÙ„ÛŒØ¯ Ø´Ø¯Ù‡ ØªÙˆØ³Ø· SAM2 Ø§Ø² Ø¬Ø¹Ø¨Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ø±Ø¬Ø¹ ÙˆØ§Ù‚Ø¹ÛŒØªØŒ 1-Ø´Ø§Øª):**

ØªØµØ§ÙˆÛŒØ± Ø¨ØµØ±ÛŒ Ø§Ø² Ù…Ø§Ø³Ú©â€ŒÙ‡Ø§ÛŒ Ø³Ú¯Ù…Ù†ØªÛŒØ´Ù† ØªÙˆÙ„ÛŒØ¯ Ø´Ø¯Ù‡ Ø¯Ø± Ù…Ø³ÛŒØ± `data/my_custom_dataset/annotations/custom_references_with_SAM_segm/references_visualisations/` Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯Ù‡â€ŒØ§Ù†Ø¯.


| ØªØµÙˆÛŒØ± Ù…Ø±Ø¬Ø¹ 1-Ø´Ø§Øª Ø¨Ø±Ø§ÛŒ Ù¾Ø±Ù†Ø¯Ù‡ ğŸ¦ (Ø³Ú¯Ù…Ù†Øª Ø´Ø¯Ù‡ Ø¨Ù‡ Ø·ÙˆØ± Ø®ÙˆØ¯Ú©Ø§Ø± Ø¨Ø§ SAM) | ØªØµÙˆÛŒØ± Ù…Ø±Ø¬Ø¹ 1-Ø´Ø§Øª Ø¨Ø±Ø§ÛŒ Ù‚Ø§ÛŒÙ‚ â›µ (Ø³Ú¯Ù…Ù†Øª Ø´Ø¯Ù‡ Ø¨Ù‡ Ø·ÙˆØ± Ø®ÙˆØ¯Ú©Ø§Ø± Ø¨Ø§ SAM) |
|:---------------------------------:|:----------------------------------:|
| <img src="https://github.com/user-attachments/assets/65d38dc4-1454-43cd-9600-e8efc67b3a82" alt="bird_1_with_SAM_segm" width="500"/> | <img src="https://github.com/user-attachments/assets/43a558ad-50ca-4715-8285-9aa3268843c6" alt="boat_1_with_SAM_segm" width="500"/> |


### Û°.Û² ØªØ¨Ø¯ÛŒÙ„ Ø­Ø§Ø´ÛŒÙ‡â€ŒÙ†ÙˆÛŒØ³ÛŒâ€ŒÙ‡Ø§ÛŒ coco Ø¨Ù‡ ÙØ§ÛŒÙ„ pickle


```bash
python no_time_to_train/dataset/coco_to_pkl.py \
    data/my_custom_dataset/annotations/custom_references_with_segm.json \
    data/my_custom_dataset/annotations/custom_references_with_segm.pkl \
    1
```
### 1. Ø­Ø§ÙØ¸Ù‡ Ø±Ø§ Ø¨Ø§ Ø§Ø±Ø¬Ø§Ø¹Ø§Øª Ù¾Ø± Ú©Ù†ÛŒØ¯

Ø§Ø¨ØªØ¯Ø§ Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ Ù…ÙÛŒØ¯ Ø±Ø§ ØªØ¹Ø±ÛŒÙ Ú©Ø±Ø¯Ù‡ Ùˆ ÛŒÚ© Ù¾ÙˆØ´Ù‡ Ø¨Ø±Ø§ÛŒ Ù†ØªØ§ÛŒØ¬ Ø§ÛŒØ¬Ø§Ø¯ Ú©Ù†ÛŒØ¯. Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ ØµØ­ÛŒØ­ Ø¨Ø±Ú†Ø³Ø¨â€ŒÙ‡Ø§ØŒ Ù†Ø§Ù… Ú©Ù„Ø§Ø³â€ŒÙ‡Ø§ Ø¨Ø§ÛŒØ¯ Ø¨Ø± Ø§Ø³Ø§Ø³ Ø´Ù†Ø§Ø³Ù‡ Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ Ø¨Ù‡ Ù‡Ù…Ø§Ù† ØªØ±ØªÛŒØ¨ÛŒ Ú©Ù‡ Ø¯Ø± ÙØ§ÛŒÙ„ json Ø¸Ø§Ù‡Ø± Ù…ÛŒâ€ŒØ´ÙˆØ¯ØŒ Ù…Ø±ØªØ¨ Ø´ÙˆÙ†Ø¯. Ø¨Ù‡ Ø¹Ù†ÙˆØ§Ù† Ù…Ø«Ø§Ù„ØŒ `bird` Ø´Ù†Ø§Ø³Ù‡ Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ `16` Ø±Ø§ Ø¯Ø§Ø±Ø¯ØŒ `boat` Ø´Ù†Ø§Ø³Ù‡ Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ `9` Ø±Ø§ Ø¯Ø§Ø±Ø¯. Ø¨Ù†Ø§Ø¨Ø±Ø§ÛŒÙ†ØŒ `CAT_NAMES=boat,bird`.


```bash
DATASET_NAME=my_custom_dataset
DATASET_PATH=data/my_custom_dataset
CAT_NAMES=boat,bird
CATEGORY_NUM=2
SHOT=1
YAML_PATH=no_time_to_train/pl_configs/matching_cdfsod_template.yaml
PATH_TO_SAVE_CKPTS=./tmp_ckpts/my_custom_dataset
mkdir -p $PATH_TO_SAVE_CKPTS
```
Ù…Ø±Ø­Ù„Ù‡ 1 Ø±Ø§ Ø§Ø¬Ø±Ø§ Ú©Ù†ÛŒØ¯:

```bash
python run_lightening.py test --config $YAML_PATH \
    --model.test_mode fill_memory \
    --out_path $PATH_TO_SAVE_CKPTS/$DATASET_NAME\_$SHOT\_refs_memory.pth \
    --model.init_args.dataset_cfgs.fill_memory.root $DATASET_PATH/images \
    --model.init_args.dataset_cfgs.fill_memory.json_file $DATASET_PATH/annotations/custom_references_with_segm.json \
    --model.init_args.dataset_cfgs.fill_memory.memory_pkl $DATASET_PATH/annotations/custom_references_with_segm.pkl \
    --model.init_args.dataset_cfgs.fill_memory.memory_length $SHOT \
    --model.init_args.dataset_cfgs.fill_memory.cat_names $CAT_NAMES \
    --model.init_args.model_cfg.dataset_name $DATASET_NAME \
    --model.init_args.model_cfg.memory_bank_cfg.length $SHOT \
    --model.init_args.model_cfg.memory_bank_cfg.category_num $CATEGORY_NUM \
    --trainer.devices 1
```
### 2. Ø¨Ø§Ù†Ú© Ø­Ø§ÙØ¸Ù‡ Ù¾Ø³â€ŒÙ¾Ø±Ø¯Ø§Ø²Ø´


```bash
python run_lightening.py test --config $YAML_PATH \
    --model.test_mode postprocess_memory \
    --ckpt_path $PATH_TO_SAVE_CKPTS/$DATASET_NAME\_$SHOT\_refs_memory.pth \
    --out_path $PATH_TO_SAVE_CKPTS/$DATASET_NAME\_$SHOT\_refs_memory_postprocessed.pth \
    --model.init_args.model_cfg.dataset_name $DATASET_NAME \
    --model.init_args.model_cfg.memory_bank_cfg.length $SHOT \
    --model.init_args.model_cfg.memory_bank_cfg.category_num $CATEGORY_NUM \
    --trainer.devices 1
```

#### Û².Û± ØªØ¬Ø³Ù… Ø¨Ø§Ù†Ú© Ø­Ø§ÙØ¸Ù‡ Ù¾Ø³â€ŒÙ¾Ø±Ø¯Ø§Ø²Ø´â€ŒØ´Ø¯Ù‡

```bash
python run_lightening.py test --config $YAML_PATH \
    --model.test_mode vis_memory \
    --ckpt_path $PATH_TO_SAVE_CKPTS/$DATASET_NAME\_$SHOT\_refs_memory_postprocessed.pth \
    --model.init_args.dataset_cfgs.fill_memory.root $DATASET_PATH/images \
    --model.init_args.dataset_cfgs.fill_memory.json_file $DATASET_PATH/annotations/custom_references_with_segm.json \
    --model.init_args.dataset_cfgs.fill_memory.memory_pkl $DATASET_PATH/annotations/custom_references_with_segm.pkl \
    --model.init_args.dataset_cfgs.fill_memory.memory_length $SHOT \
    --model.init_args.dataset_cfgs.fill_memory.cat_names $CAT_NAMES \
    --model.init_args.model_cfg.dataset_name $DATASET_NAME \
    --model.init_args.model_cfg.memory_bank_cfg.length $SHOT \
    --model.init_args.model_cfg.memory_bank_cfg.category_num $CATEGORY_NUM \
    --trainer.devices 1
```
ØªØ¬Ø³Ù…â€ŒÙ‡Ø§ÛŒ PCA Ùˆ K-means Ø¨Ø±Ø§ÛŒ ØªØµØ§ÙˆÛŒØ± Ø¨Ø§Ù†Ú© Ø­Ø§ÙØ¸Ù‡ Ø¯Ø± Ù…Ø³ÛŒØ± `results_analysis/memory_vis/my_custom_dataset` Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯.

### Û³. Ø§Ø³ØªÙ†ØªØ§Ø¬ Ø±ÙˆÛŒ ØªØµØ§ÙˆÛŒØ± Ù‡Ø¯Ù

Ø§Ú¯Ø± Ù…Ù‚Ø¯Ø§Ø± `ONLINE_VIS` Ø¨Ø±Ø§Ø¨Ø± Ø¨Ø§ True Ø¨Ø§Ø´Ø¯ØŒ Ù†ØªØ§ÛŒØ¬ Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ Ø¯Ø± Ù…Ø³ÛŒØ± `results_analysis/my_custom_dataset/` Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯Ù‡ Ùˆ Ù‡Ù†Ú¯Ø§Ù… Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯. ØªÙˆØ¬Ù‡ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´ÛŒØ¯ Ú©Ù‡ Ø§Ø¬Ø±Ø§ÛŒ Ø§ÛŒÙ† Ú¯Ø²ÛŒÙ†Ù‡ Ø¨Ø§ ØªØ¬Ø³Ù… Ø¢Ù†Ù„Ø§ÛŒÙ† Ø¨Ø³ÛŒØ§Ø± Ú©Ù†Ø¯ØªØ± Ø§Ø³Øª.

Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø¢Ø³ØªØ§Ù†Ù‡ Ø§Ù…ØªÛŒØ§Ø² `VIS_THR` Ø±Ø§ ØªØºÛŒÛŒØ± Ø¯Ù‡ÛŒØ¯ ØªØ§ Ù†Ù…ÙˆÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ù‚Ø·Ø¹Ù‡â€ŒØ¨Ù†Ø¯ÛŒâ€ŒØ´Ø¯Ù‡ Ø¨ÛŒØ´ØªØ±ÛŒ ÛŒØ§ Ú©Ù…ØªØ±ÛŒ Ø±Ø§ Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ú©Ù†ÛŒØ¯.
```bash
ONLINE_VIS=True
VIS_THR=0.4
python run_lightening.py test --config $YAML_PATH \
    --model.test_mode test \
    --ckpt_path $PATH_TO_SAVE_CKPTS/$DATASET_NAME\_$SHOT\_refs_memory_postprocessed.pth \
    --model.init_args.model_cfg.dataset_name $DATASET_NAME \
    --model.init_args.model_cfg.memory_bank_cfg.length $SHOT \
    --model.init_args.model_cfg.memory_bank_cfg.category_num $CATEGORY_NUM \
    --model.init_args.model_cfg.test.imgs_path $DATASET_PATH/images \
    --model.init_args.model_cfg.test.online_vis $ONLINE_VIS \
    --model.init_args.model_cfg.test.vis_thr $VIS_THR \
    --model.init_args.dataset_cfgs.test.root $DATASET_PATH/images \
    --model.init_args.dataset_cfgs.test.json_file $DATASET_PATH/annotations/custom_targets.json \
    --model.init_args.dataset_cfgs.test.cat_names $CAT_NAMES \
    --trainer.devices 1
```
### Ù†ØªØ§ÛŒØ¬

Ø´Ø§Ø®Øµâ€ŒÙ‡Ø§ÛŒ Ø¹Ù…Ù„Ú©Ø±Ø¯ (Ø¨Ø§ Ø¯Ù‚ÛŒÙ‚Ø§Ù‹ Ù‡Ù…Ø§Ù† Ù¾Ø§Ø±Ø§Ù…ØªØ±Ù‡Ø§ÛŒ Ø¯Ø³ØªÙˆØ±Ø§Øª Ø¨Ø§Ù„Ø§) Ø¨Ø§ÛŒØ¯ Ø¨Ù‡ Ø´Ø±Ø­ Ø²ÛŒØ± Ø¨Ø§Ø´Ù†Ø¯:


```
BBOX RESULTS:
  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.478

SEGM RESULTS:
  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.458
```
Ù†ØªØ§ÛŒØ¬ Ø¨ØµØ±ÛŒ Ø¯Ø± Ù…Ø³ÛŒØ± `results_analysis/my_custom_dataset/` Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯. ØªÙˆØ¬Ù‡ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´ÛŒØ¯ Ú©Ù‡ Ø±ÙˆØ´ Ù…Ø§ Ø¨Ø±Ø§ÛŒ ØªØ´Ø®ÛŒØµ Ù…Ù†ÙÛŒâ€ŒÙ‡Ø§ÛŒ Ú©Ø§Ø°Ø¨ Ú©Ø§Ø± Ù…ÛŒâ€ŒÚ©Ù†Ø¯ØŒ ÛŒØ¹Ù†ÛŒ ØªØµØ§ÙˆÛŒØ±ÛŒ Ú©Ù‡ Ù‡ÛŒÚ† Ù†Ù…ÙˆÙ†Ù‡â€ŒØ§ÛŒ Ø§Ø² Ú©Ù„Ø§Ø³â€ŒÙ‡Ø§ÛŒ Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø± Ø±Ø§ Ù†Ø¯Ø§Ø±Ù†Ø¯.

*Ø¨Ø±Ø§ÛŒ Ø¨Ø²Ø±Ú¯â€ŒÙ†Ù…Ø§ÛŒÛŒ Ø±ÙˆÛŒ ØªØµØ§ÙˆÛŒØ± Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯ â¬‡ï¸*

| ØªØµÙˆÛŒØ± Ù‡Ø¯Ù Ø¨Ø§ Ù‚Ø§ÛŒÙ‚â€ŒÙ‡Ø§ â›µ (Ú†Ù¾ GTØŒ Ø±Ø§Ø³Øª Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ) | ØªØµÙˆÛŒØ± Ù‡Ø¯Ù Ø¨Ø§ Ù¾Ø±Ù†Ø¯Ú¯Ø§Ù† ğŸ¦ (Ú†Ù¾ GTØŒ Ø±Ø§Ø³Øª Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ) |
|:----------------------:|:----------------------:|
| ![000000459673](https://github.com/user-attachments/assets/678dc15a-dd3b-49d5-9287-6290da16aa6b) | ![000000407180](https://github.com/user-attachments/assets/fe306e48-af49-4d83-ac82-76fac6c456d1) |

| ØªØµÙˆÛŒØ± Ù‡Ø¯Ù Ø¨Ø§ Ù‚Ø§ÛŒÙ‚â€ŒÙ‡Ø§ Ùˆ Ù¾Ø±Ù†Ø¯Ú¯Ø§Ù† â›µğŸ¦ (Ú†Ù¾ GTØŒ Ø±Ø§Ø³Øª Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ) | ØªØµÙˆÛŒØ± Ù‡Ø¯Ù Ø¨Ø¯ÙˆÙ† Ù‚Ø§ÛŒÙ‚ ÛŒØ§ Ù¾Ø±Ù†Ø¯Ù‡ ğŸš« (Ú†Ù¾ GTØŒ Ø±Ø§Ø³Øª Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ) |
|:---------------------------------:|:----------------------------------:|
| ![000000517410](https://github.com/user-attachments/assets/9849b227-7f43-43d7-81ea-58010a623ad5) | ![000000460598](https://github.com/user-attachments/assets/7587700c-e09d-4cf6-8590-3df129c2568e) |


## ğŸ“š Ø§Ø±Ø¬Ø§Ø¹

Ø§Ú¯Ø± Ø§Ø² Ø§ÛŒÙ† Ú©Ø§Ø± Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†ÛŒØ¯ØŒ Ù„Ø·ÙØ§Ù‹ Ù…Ø§ Ø±Ø§ Ø§Ø±Ø¬Ø§Ø¹ Ø¯Ù‡ÛŒØ¯:


```bibtex
@article{espinosa2025notimetotrain,
  title={No time to train! Training-Free Reference-Based Instance Segmentation},
  author={Miguel Espinosa and Chenhongyi Yang and Linus Ericsson and Steven McDonagh and Elliot J. Crowley},
  journal={arXiv preprint arXiv:2507.02798},
  year={2025},
  primaryclass={cs.CV}
}
```


---

Tranlated By [Open Ai Tx](https://github.com/OpenAiTx/OpenAiTx) | Last indexed: 2026-01-15

---