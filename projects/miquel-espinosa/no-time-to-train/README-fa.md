<div align="right">
  <details>
    <summary >🌐 زبان</summary>
    <div>
      <div align="center">
        <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=en">English</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=zh-CN">简体中文</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=zh-TW">繁體中文</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=ja">日本語</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=ko">한국어</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=hi">हिन्दी</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=th">ไทย</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=fr">Français</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=de">Deutsch</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=es">Español</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=it">Italiano</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=ru">Русский</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=pt">Português</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=nl">Nederlands</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=pl">Polski</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=ar">العربية</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=fa">فارسی</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=tr">Türkçe</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=vi">Tiếng Việt</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=id">Bahasa Indonesia</a>
      </div>
    </div>
  </details>
</div>

<div align="center">

# 🚀 زمانی برای آموزش نیست!  
### بخش‌بندی نمونه مبتنی بر مرجع بدون نیاز به آموزش  
[![GitHub](https://img.shields.io/badge/%E2%80%8B-No%20Time%20To%20Train-black?logo=github)](https://github.com/miquel-espinosa/no-time-to-train)
[![Website](https://img.shields.io/badge/🌐-Project%20Page-grey)](https://miquel-espinosa.github.io/no-time-to-train/)
[![arXiv](https://img.shields.io/badge/arXiv-2507.02798-b31b1b)](https://arxiv.org/abs/2507.02798)

**پیشرفته‌ترین روش‌ها (Papers with Code)**

[**_SOTA 1-shot_**](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-1-shot?p=no-time-to-train-training-free-reference) | [![PWC](https://img.shields.io/endpoint.svg?url=https://paperswithcode.com/badge/no-time-to-train-training-free-reference/few-shot-object-detection-on-ms-coco-1-shot)](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-1-shot?p=no-time-to-train-training-free-reference)

[**_SOTA 10-shot_**](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-10-shot?p=no-time-to-train-training-free-reference) | [![PWC](https://img.shields.io/endpoint.svg?url=https://paperswithcode.com/badge/no-time-to-train-training-free-reference/few-shot-object-detection-on-ms-coco-10-shot)](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-10-shot?p=no-time-to-train-training-free-reference)

[**_SOTA 30-shot_**](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-30-shot?p=no-time-to-train-training-free-reference) | [![PWC](https://img.shields.io/endpoint.svg?url=https://paperswithcode.com/badge/no-time-to-train-training-free-reference/few-shot-object-detection-on-ms-coco-30-shot)](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-30-shot?p=no-time-to-train-training-free-reference)

</div>

---

> 🚨 **به‌روزرسانی (۲۲ ژوئیه ۲۰۲۵):** دستورالعمل‌ها برای داده‌مجموعه‌های سفارشی افزوده شد!
> 
> 🔔 **به‌روزرسانی (۱۶ ژوئیه ۲۰۲۵):** کد با راهنماهای جدید به‌روزرسانی شد!

---

## 📋 فهرست مطالب

- [🎯 نکات برجسته](#-highlights)
- [📜 چکیده](#-abstract)
- [🧠 معماری](#-architecture)
- [🛠️ دستورالعمل نصب](#️-installation-instructions)
  - [1. کلون کردن مخزن](#1-clone-the-repository)
  - [2. ایجاد محیط کاندا](#2-create-conda-environment)
  - [3. نصب SAM2 و DinoV2](#3-install-sam2-and-dinov2)
  - [4. دانلود داده‌مجموعه‌ها](#4-download-datasets)
  - [5. دانلود مدل‌های SAM2 و DinoV2](#5-download-sam2-and-dinov2-checkpoints)
- [📊 کد استنتاج: بازتولید نتایج SOTA با ۳۰ نمونه در Few-shot COCO](#-inference-code)
  - [0. ایجاد مجموعه مرجع](#0-create-reference-set)
  - [1. پر کردن حافظه با مراجع](#1-fill-memory-with-references)
  - [2. پس‌پردازش بانک حافظه](#2-post-process-memory-bank)
  - [3. استنتاج روی تصاویر هدف](#3-inference-on-target-images)
  - [نتایج](#results)
- [🔍 داده‌مجموعه سفارشی](#-custom-dataset)
  - [0. آماده‌سازی داده‌مجموعه سفارشی ⛵🐦](#0-prepare-a-custom-dataset)
  - [0.1 اگر تنها حاشیه‌نویسی bbox موجود است](#01-if-only-bbox-annotations-are-available)
  - [0.2 تبدیل حاشیه‌نویسی کوکو به فایل pickle](#02-convert-coco-annotations-to-pickle-file)
  - [1. پر کردن حافظه با مراجع](#1-fill-memory-with-references)
  - [2. پس‌پردازش بانک حافظه](#2-post-process-memory-bank)
- [📚 استناد](#-citation)


## 🎯 نکات برجسته
- 💡 **بدون نیاز به آموزش**: بدون ریزتنظیم، بدون مهندسی prompt — فقط یک تصویر مرجع.  
- 🖼️ **مبتنی بر مرجع**: بخش‌بندی اشیای جدید با تنها چند نمونه.  
- 🔥 **عملکرد SOTA**: عملکرد بهتر نسبت به روش‌های بدون آموزش پیشین در COCO، PASCAL VOC و Cross-Domain FSOD.

**پیوندها:**
- 🧾 [**مقاله arXiv**](https://arxiv.org/abs/2507.02798)  
- 🌐 [**وب‌سایت پروژه**](https://miquel-espinosa.github.io/no-time-to-train/)  
- 📈 [**Papers with Code**](https://paperswithcode.com/paper/no-time-to-train-training-free-reference)

## 📜 چکیده

> عملکرد مدل‌های بخش‌بندی تصویر همواره به دلیل هزینه بالای جمع‌آوری داده‌های برچسب‌خورده در مقیاس وسیع محدود بوده است. مدل Segment Anything (SAM) این مشکل اولیه را با ارائه رویکرد بخش‌بندی مبتنی بر prompt و بی‌تفاوت به معنا کاهش داده اما هنوز نیازمند promptهای بصری دستی یا قوانین پیچیده تولید prompt وابسته به دامنه برای پردازش تصاویر جدید است. به منظور کاهش این بار جدید، کار ما به بررسی بخش‌بندی شیء با داشتن تنها مجموعه کوچکی از تصاویر مرجع می‌پردازد. بینش کلیدی ما استفاده از پیش‌فرض‌های معنایی قدرتمند است که مدل‌های بنیادی فراگرفته‌اند تا نواحی متناظر میان تصویر مرجع و تصویر هدف را شناسایی کنند. ما دریافتیم که این متناظرات امکان تولید خودکار ماسک‌های بخش‌بندی سطح نمونه را برای وظایف پایین‌دستی فراهم می‌کند و ایده‌های خود را از طریق روشی چندمرحله‌ای و بدون آموزش شامل (۱) ساخت بانک حافظه؛ (۲) تجمیع بازنمایی‌ها و (۳) تطبیق ویژگی آگاه از معنا پیاده‌سازی می‌کنیم. آزمایش‌های ما بهبود قابل توجهی در معیارهای بخش‌بندی نشان می‌دهد که منجر به عملکرد پیشرفته در COCO FSOD (۳۶.۸٪ nAP)، PASCAL VOC Few-Shot (۷۱.۲٪ nAP50) و برتری نسبت به روش‌های بدون آموزش موجود در ارزیابی Cross-Domain FSOD (۲۲.۴٪ nAP) شده است.

![cdfsod-results-final-comic-sans-min](https://github.com/user-attachments/assets/ab302c02-c080-4042-99fc-0e181ba8abb9)




## 🧠 معماری

![training-free-architecture-comic-sans-min](https://github.com/user-attachments/assets/d84dd83a-505e-45a0-8ce3-98e1838017f9)


## 🛠️ دستورالعمل نصب

### 1. مخزن را کلون کنید

```bash
git clone https://github.com/miquel-espinosa/no-time-to-train.git
cd no-time-to-train
```
### ۲. ایجاد محیط conda

ما یک محیط conda با بسته‌های مورد نیاز ایجاد خواهیم کرد.

```bash
conda env create -f environment.yml
conda activate no-time-to-train
```
### 3. نصب SAM2 و DinoV2

ما SAM2 و DinoV2 را از سورس نصب خواهیم کرد.

```bash
pip install -e .
cd dinov2
pip install -e .
cd ..
```
### ۴. دانلود دیتاست‌ها

لطفاً دیتاست COCO را دانلود کرده و در مسیر `data/coco` قرار دهید

### ۵. دانلود چک‌پوینت‌های SAM2 و DinoV2

ما دقیقاً همان چک‌پوینت‌های SAM2 که در مقاله استفاده شده را دانلود خواهیم کرد.
(با این حال توجه داشته باشید که چک‌پوینت‌های SAM2.1 هم‌اکنون در دسترس هستند و ممکن است عملکرد بهتری داشته باشند.)


```bash
mkdir -p checkpoints/dinov2
cd checkpoints
wget https://dl.fbaipublicfiles.com/segment_anything_2/072824/sam2_hiera_large.pt
cd dinov2
wget https://dl.fbaipublicfiles.com/dinov2/dinov2_vitl14/dinov2_vitl14_pretrain.pth
cd ../..
```
## 📊 کد استنتاج

⚠️ سلب مسئولیت: این کد پژوهشی است — انتظار کمی بی‌نظمی داشته باشید!

### بازتولید نتایج 30-شات SOTA در Few-shot COCO

متغیرهای مفید را تعریف کنید و یک پوشه برای نتایج ایجاد نمایید:



```bash
CONFIG=./no_time_to_train/new_exps/coco_fewshot_10shot_Sam2L.yaml
CLASS_SPLIT="few_shot_classes"
RESULTS_DIR=work_dirs/few_shot_results
SHOTS=30
SEED=33
GPUS=4

mkdir -p $RESULTS_DIR
FILENAME=few_shot_${SHOTS}shot_seed${SEED}.pkl
```
#### ۰. ایجاد مجموعه مرجع


```bash
python no_time_to_train/dataset/few_shot_sampling.py \
        --n-shot $SHOTS \
        --out-path ${RESULTS_DIR}/${FILENAME} \
        --seed $SEED \
        --dataset $CLASS_SPLIT
```
#### 1. حافظه را با ارجاعات پر کنید


```bash
python run_lightening.py test --config $CONFIG \
                              --model.test_mode fill_memory \
                              --out_path ${RESULTS_DIR}/memory.ckpt \
                              --model.init_args.model_cfg.memory_bank_cfg.length $SHOTS \
                              --model.init_args.dataset_cfgs.fill_memory.memory_pkl ${RESULTS_DIR}/${FILENAME} \
                              --model.init_args.dataset_cfgs.fill_memory.memory_length $SHOTS \
                              --model.init_args.dataset_cfgs.fill_memory.class_split $CLASS_SPLIT \
                              --trainer.logger.save_dir ${RESULTS_DIR}/ \
                              --trainer.devices $GPUS
```
#### 2. پردازش پس‌ازآن بانک حافظه


```bash
python run_lightening.py test --config $CONFIG \
                              --model.test_mode postprocess_memory \
                              --model.init_args.model_cfg.memory_bank_cfg.length $SHOTS \
                              --ckpt_path ${RESULTS_DIR}/memory.ckpt \
                              --out_path ${RESULTS_DIR}/memory_postprocessed.ckpt \
                              --trainer.devices 1
```
#### 3. استنتاج بر روی تصاویر هدف


```bash
python run_lightening.py test --config $CONFIG  \
                              --ckpt_path ${RESULTS_DIR}/memory_postprocessed.ckpt \
                              --model.init_args.test_mode test \
                              --model.init_args.model_cfg.memory_bank_cfg.length $SHOTS \
                              --model.init_args.model_cfg.dataset_name $CLASS_SPLIT \
                              --model.init_args.dataset_cfgs.test.class_split $CLASS_SPLIT \
                              --trainer.logger.save_dir ${RESULTS_DIR}/ \
                              --trainer.devices $GPUS
```
اگر می‌خواهید نتایج استنتاج را به صورت آنلاین (در همان زمان که محاسبه می‌شوند) مشاهده کنید، خطوط 1746-1749 در فایل `no_time_to_train/models/Sam2MatchingBaseline_noAMG.py` را [در اینجا](https://github.com/miquel-espinosa/no-time-to-train/blob/main/no_time_to_train/models/Sam2MatchingBaseline_noAMG.py#L1746) از حالت کامنت خارج کنید.
پارامتر آستانه امتیاز `score_thr` را بسته به نیاز تنظیم کنید تا نمونه‌های بخش‌بندی شده بیشتری یا کمتری را مشاهده کنید.
اکنون تصاویر در مسیر `results_analysis/few_shot_classes/` ذخیره خواهند شد. تصویر سمت چپ حقیقت زمینه را نشان می‌دهد و تصویر سمت راست نمونه‌های بخش‌بندی شده‌ای را که توسط روش بدون آموزش ما پیدا شده‌اند، نمایش می‌دهد.

توجه داشته باشید که در این مثال ما از تقسیم‌بندی `few_shot_classes` استفاده می‌کنیم؛ بنابراین باید فقط انتظار دیدن نمونه‌های بخش‌بندی شده از کلاس‌های این تقسیم را داشته باشیم (نه همه کلاس‌های COCO).

#### نتایج

پس از اجرای تمام تصاویر در مجموعه اعتبارسنجی، باید به این نتیجه برسید:


```
BBOX RESULTS:
  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.368

SEGM RESULTS:
  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.342
```
---

## 🔍 دیتاست سفارشی

ما دستورالعمل‌هایی برای اجرای پایپلاین خود بر روی دیتاست سفارشی ارائه می‌دهیم. فرمت حاشیه‌نویسی همیشه به صورت COCO است.

> **خلاصه؛** برای مشاهده مستقیم نحوه اجرای کامل پایپلاین بر روی *دیتاست‌های سفارشی*، فایل `scripts/matching_cdfsod_pipeline.sh` را به همراه اسکریپت‌های نمونه دیتاست‌های CD-FSOD (مانند `scripts/dior_fish.sh`) بیابید.

### ۰. آماده‌سازی دیتاست سفارشی ⛵🐦

فرض کنیم می‌خواهیم **قایق‌ها**⛵ و **پرندگان**🐦 را در یک دیتاست سفارشی شناسایی کنیم. برای استفاده از روش ما به موارد زیر نیاز داریم:
- حداقل ۱ تصویر مرجع *حاشیه‌نویسی‌شده* برای هر کلاس (یعنی ۱ تصویر مرجع برای قایق و ۱ تصویر مرجع برای پرنده)
- چندین تصویر هدف برای یافتن نمونه‌های کلاس‌های مورد نظر ما.

ما یک اسکریپت نمونه برای ایجاد یک دیتاست سفارشی با تصاویر coco برای تنظیمات **۱-شات** آماده کرده‌ایم.
```bash
python scripts/make_custom_dataset.py
```
این کار یک مجموعه داده سفارشی با ساختار پوشه زیر ایجاد خواهد کرد:
```
data/my_custom_dataset/
    ├── annotations/
    │   ├── custom_references.json
    │   ├── custom_targets.json
    │   └── references_visualisations/
    │       ├── bird_1.jpg
    │       └── boat_1.jpg
    └── images/
        ├── 429819.jpg
        ├── 101435.jpg
        └── (all target and reference images)
```
**بصری‌سازی تصاویر مرجع (۱-نمونه‌ای):**

| تصویر مرجع ۱-نمونه‌ای برای پرنده 🐦 | تصویر مرجع ۱-نمونه‌ای برای قایق ⛵ |
|:---------------------------------:|:----------------------------------:|
| <img src="https://github.com/user-attachments/assets/e59e580d-a7db-42ac-b386-892af211fc85" alt="bird_1" width="500"/> | <img src="https://github.com/user-attachments/assets/f94ee025-ae37-4a45-9c3e-0cfe8f8cd2bc" alt="boat_1" width="500"/> |


### ۰.۱ اگر تنها نشانه‌گذاری‌های bbox موجود باشد

ما همچنین یک اسکریپت برای تولید ماسک‌های بخش‌بندی سطح نمونه با استفاده از SAM2 ارائه می‌دهیم. این ابزار زمانی مفید است که تنها نشانه‌گذاری‌های جعبه محاطی برای تصاویر مرجع در اختیار داشته باشید.


```bash
# Download sam_h checkpoint. Feel free to use more recent checkpoints (note: code might need to be adapted)
wget https://dl.fbaipublicfiles.com/segment_anything/sam_vit_h_4b8939.pth -O checkpoints/sam_vit_h_4b8939.pth
# Run automatic instance segmentation from ground truth bounding boxes.
python no_time_to_train/dataset/sam_bbox_to_segm_batch.py \
    --input_json data/my_custom_dataset/annotations/custom_references.json \
    --image_dir data/my_custom_dataset/images \
    --sam_checkpoint checkpoints/sam_vit_h_4b8939.pth \
    --model_type vit_h \
    --device cuda \
    --batch_size 8 \
    --visualize
```
**تصاویر مرجع با ماسک‌های سگمنتیشن در سطح نمونه (تولید شده توسط SAM2 از جعبه‌های مرجع واقعیت، 1-شات):**

تصاویر بصری از ماسک‌های سگمنتیشن تولید شده در مسیر `data/my_custom_dataset/annotations/custom_references_with_SAM_segm/references_visualisations/` ذخیره شده‌اند.


| تصویر مرجع 1-شات برای پرنده 🐦 (سگمنت شده به طور خودکار با SAM) | تصویر مرجع 1-شات برای قایق ⛵ (سگمنت شده به طور خودکار با SAM) |
|:---------------------------------:|:----------------------------------:|
| <img src="https://github.com/user-attachments/assets/65d38dc4-1454-43cd-9600-e8efc67b3a82" alt="bird_1_with_SAM_segm" width="500"/> | <img src="https://github.com/user-attachments/assets/43a558ad-50ca-4715-8285-9aa3268843c6" alt="boat_1_with_SAM_segm" width="500"/> |


### ۰.۲ تبدیل حاشیه‌نویسی‌های coco به فایل pickle


```bash
python no_time_to_train/dataset/coco_to_pkl.py \
    data/my_custom_dataset/annotations/custom_references_with_segm.json \
    data/my_custom_dataset/annotations/custom_references_with_segm.pkl \
    1
```
### 1. حافظه را با ارجاعات پر کنید

ابتدا متغیرهای مفید را تعریف کرده و یک پوشه برای نتایج ایجاد کنید. برای نمایش صحیح برچسب‌ها، نام کلاس‌ها باید بر اساس شناسه دسته‌بندی به همان ترتیبی که در فایل json ظاهر می‌شود، مرتب شوند. به عنوان مثال، `bird` شناسه دسته‌بندی `16` را دارد، `boat` شناسه دسته‌بندی `9` را دارد. بنابراین، `CAT_NAMES=boat,bird`.


```bash
DATASET_NAME=my_custom_dataset
DATASET_PATH=data/my_custom_dataset
CAT_NAMES=boat,bird
CATEGORY_NUM=2
SHOT=1
YAML_PATH=no_time_to_train/pl_configs/matching_cdfsod_template.yaml
PATH_TO_SAVE_CKPTS=./tmp_ckpts/my_custom_dataset
mkdir -p $PATH_TO_SAVE_CKPTS
```
مرحله 1 را اجرا کنید:

```bash
python run_lightening.py test --config $YAML_PATH \
    --model.test_mode fill_memory \
    --out_path $PATH_TO_SAVE_CKPTS/$DATASET_NAME\_$SHOT\_refs_memory.pth \
    --model.init_args.dataset_cfgs.fill_memory.root $DATASET_PATH/images \
    --model.init_args.dataset_cfgs.fill_memory.json_file $DATASET_PATH/annotations/custom_references_with_segm.json \
    --model.init_args.dataset_cfgs.fill_memory.memory_pkl $DATASET_PATH/annotations/custom_references_with_segm.pkl \
    --model.init_args.dataset_cfgs.fill_memory.memory_length $SHOT \
    --model.init_args.dataset_cfgs.fill_memory.cat_names $CAT_NAMES \
    --model.init_args.model_cfg.dataset_name $DATASET_NAME \
    --model.init_args.model_cfg.memory_bank_cfg.length $SHOT \
    --model.init_args.model_cfg.memory_bank_cfg.category_num $CATEGORY_NUM \
    --trainer.devices 1
```
### 2. بانک حافظه پس‌پردازش


```bash
python run_lightening.py test --config $YAML_PATH \
    --model.test_mode postprocess_memory \
    --ckpt_path $PATH_TO_SAVE_CKPTS/$DATASET_NAME\_$SHOT\_refs_memory.pth \
    --out_path $PATH_TO_SAVE_CKPTS/$DATASET_NAME\_$SHOT\_refs_memory_postprocessed.pth \
    --model.init_args.model_cfg.dataset_name $DATASET_NAME \
    --model.init_args.model_cfg.memory_bank_cfg.length $SHOT \
    --model.init_args.model_cfg.memory_bank_cfg.category_num $CATEGORY_NUM \
    --trainer.devices 1
```
### 3. استنتاج بر روی تصاویر هدف

اگر مقدار `ONLINE_VIS` برابر با True باشد، نتایج پیش‌بینی در مسیر `results_analysis/my_custom_dataset/` ذخیره شده و همزمان با محاسبه نمایش داده می‌شوند. توجه داشته باشید که اجرای برنامه با نمایش آنلاین بسیار کندتر است.

می‌توانید آستانه امتیاز `VIS_THR` را تغییر دهید تا نمونه‌های قطعه‌بندی شده بیشتری یا کمتری را مشاهده کنید.

```bash
ONLINE_VIS=True
VIS_THR=0.4
python run_lightening.py test --config $YAML_PATH \
    --model.test_mode test \
    --ckpt_path $PATH_TO_SAVE_CKPTS/$DATASET_NAME\_$SHOT\_refs_memory_postprocessed.pth \
    --model.init_args.model_cfg.dataset_name $DATASET_NAME \
    --model.init_args.model_cfg.memory_bank_cfg.length $SHOT \
    --model.init_args.model_cfg.memory_bank_cfg.category_num $CATEGORY_NUM \
    --model.init_args.model_cfg.test.imgs_path $DATASET_PATH/images \
    --model.init_args.model_cfg.test.online_vis $ONLINE_VIS \
    --model.init_args.model_cfg.test.vis_thr $VIS_THR \
    --model.init_args.dataset_cfgs.test.root $DATASET_PATH/images \
    --model.init_args.dataset_cfgs.test.json_file $DATASET_PATH/annotations/custom_targets.json \
    --model.init_args.dataset_cfgs.test.cat_names $CAT_NAMES \
    --trainer.devices 1
```
### نتایج

شاخص‌های عملکرد (با دقیقاً همان پارامترهای دستورات بالا) باید به شرح زیر باشند:


```
BBOX RESULTS:
  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.478

SEGM RESULTS:
  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.458
```
نتایج بصری در مسیر `results_analysis/my_custom_dataset/` ذخیره می‌شوند. توجه داشته باشید که روش ما برای تشخیص منفی‌های کاذب کار می‌کند، یعنی تصاویری که هیچ نمونه‌ای از کلاس‌های مورد نظر را ندارند.

*برای بزرگ‌نمایی روی تصاویر کلیک کنید ⬇️*

| تصویر هدف با قایق‌ها ⛵ (چپ GT، راست پیش‌بینی) | تصویر هدف با پرندگان 🐦 (چپ GT، راست پیش‌بینی) |
|:----------------------:|:----------------------:|
| ![000000459673](https://github.com/user-attachments/assets/678dc15a-dd3b-49d5-9287-6290da16aa6b) | ![000000407180](https://github.com/user-attachments/assets/fe306e48-af49-4d83-ac82-76fac6c456d1) |

| تصویر هدف با قایق‌ها و پرندگان ⛵🐦 (چپ GT، راست پیش‌بینی) | تصویر هدف بدون قایق یا پرنده 🚫 (چپ GT، راست پیش‌بینی) |
|:---------------------------------:|:----------------------------------:|
| ![000000517410](https://github.com/user-attachments/assets/9849b227-7f43-43d7-81ea-58010a623ad5) | ![000000460598](https://github.com/user-attachments/assets/7587700c-e09d-4cf6-8590-3df129c2568e) |


## 📚 ارجاع

اگر از این کار استفاده می‌کنید، لطفاً ما را ارجاع دهید:


```bibtex
@article{espinosa2025notimetotrain,
  title={No time to train! Training-Free Reference-Based Instance Segmentation},
  author={Miguel Espinosa and Chenhongyi Yang and Linus Ericsson and Steven McDonagh and Elliot J. Crowley},
  journal={arXiv preprint arXiv:2507.02798},
  year={2025},
  primaryclass={cs.CV}
}
```


---

Tranlated By [Open Ai Tx](https://github.com/OpenAiTx/OpenAiTx) | Last indexed: 2025-07-23

---