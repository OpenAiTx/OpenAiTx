
<div align="right">
  <details>
    <summary >üåê –Ø–∑—ã–∫</summary>
    <div>
      <div align="center">
        <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=en">English</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=zh-CN">ÁÆÄ‰Ωì‰∏≠Êñá</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=zh-TW">ÁπÅÈ´î‰∏≠Êñá</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=ja">Êó•Êú¨Ë™û</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=ko">ÌïúÍµ≠Ïñ¥</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=th">‡πÑ‡∏ó‡∏¢</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=fr">Fran√ßais</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=de">Deutsch</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=es">Espa√±ol</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=it">Italiano</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=ru">–†—É—Å—Å–∫–∏–π</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=pt">Portugu√™s</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=nl">Nederlands</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=pl">Polski</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=ar">ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=fa">ŸÅÿßÿ±ÿ≥€å</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=tr">T√ºrk√ße</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=vi">Ti·∫øng Vi·ªát</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=id">Bahasa Indonesia</a>
      </div>
    </div>
  </details>
</div>

<div align="center">

# üöÄ –ù–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –æ–±—É—á–µ–Ω–∏–µ!  
### –°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ –ø–æ –æ–±—Ä–∞–∑—Ü—É –±–µ–∑ –æ–±—É—á–µ–Ω–∏—è  
[![GitHub](https://img.shields.io/badge/%E2%80%8B-No%20Time%20To%20Train-black?logo=github)](https://github.com/miquel-espinosa/no-time-to-train)
[![Website](https://img.shields.io/badge/üåê-Project%20Page-grey)](https://miquel-espinosa.github.io/no-time-to-train/)
[![arXiv](https://img.shields.io/badge/arXiv-2507.02798-b31b1b)](https://arxiv.org/abs/2507.02798)

**–ü–µ—Ä–µ–¥–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã (Papers with Code)**
[**_SOTA 1-shot_**](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-1-shot?p=no-time-to-train-training-free-reference) | [![PWC](https://img.shields.io/badge/State%20of%20the%20Art-Few--Shot%20Object%20Detection%20on%20MS--COCO%20(1--shot)-21CBCE?style=flat&logo=paperswithcode)](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-1-shot?p=no-time-to-train-training-free-reference)

[**_SOTA 10-shot_**](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-10-shot?p=no-time-to-train-training-free-reference) | [![PWC](https://img.shields.io/badge/State%20of%20the%20Art-Few--Shot%20Object%20Detection%20on%20MS--COCO%20(10--shot)-21CBCE?style=flat&logo=paperswithcode)](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-10-shot?p=no-time-to-train-training-free-reference)

[**_SOTA 30-shot_**](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-30-shot?p=no-time-to-train-training-free-reference) | [![PWC](https://img.shields.io/badge/State%20of%20the%20Art-Few--Shot%20Object%20Detection%20on%20MS--COCO%20(30--shot)-21CBCE?style=flat&logo=paperswithcode)](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-30-shot?p=no-time-to-train-training-free-reference)

<!-- [**_SOTA 1-shot_**](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-1-shot?p=no-time-to-train-training-free-reference) | [![PWC](https://img.shields.io/endpoint.svg?url=https://paperswithcode.com/badge/no-time-to-train-training-free-reference/few-shot-object-detection-on-ms-coco-1-shot)](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-1-shot?p=no-time-to-train-training-free-reference)

[**_SOTA 10-shot_**](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-10-shot?p=no-time-to-train-training-free-reference) | [![PWC](https://img.shields.io/endpoint.svg?url=https://paperswithcode.com/badge/no-time-to-train-training-free-reference/few-shot-object-detection-on-ms-coco-10-shot)](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-10-shot?p=no-time-to-train-training-free-reference)

[**_SOTA 30-shot_**](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-30-shot?p=no-time-to-train-training-free-reference) | [![PWC](https://img.shields.io/endpoint.svg?url=https://paperswithcode.com/badge/no-time-to-train-training-free-reference/few-shot-object-detection-on-ms-coco-30-shot)](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-30-shot?p=no-time-to-train-training-free-reference) -->

</div>

---

> üö® **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ (22 –∏—é–ª—è 2025):** –î–æ–±–∞–≤–ª–µ–Ω—ã –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç–æ–≤!
> 
> üîî **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ (16 –∏—é–ª—è 2025):** –ö–æ–¥ –æ–±–Ω–æ–≤–ª—ë–Ω —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏!

---

## üìã –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

- [üéØ –û—Å–Ω–æ–≤–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã](#-highlights)
- [üìú –ê–Ω–Ω–æ—Ç–∞—Ü–∏—è](#-abstract)
- [üß† –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#-architecture)
- [üõ†Ô∏è –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ](#Ô∏è-installation-instructions)
  - [1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π](#1-clone-the-repository)
  - [2. –°–æ–∑–¥–∞—Ç—å –æ–∫—Ä—É–∂–µ–Ω–∏–µ conda](#2-create-conda-environment)
  - [3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å SAM2 –∏ DinoV2](#3-install-sam2-and-dinov2)
  - [4. –°–∫–∞—á–∞—Ç—å –¥–∞—Ç–∞—Å–µ—Ç—ã](#4-download-datasets)
  - [5. –°–∫–∞—á–∞—Ç—å –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏ SAM2 –∏ DinoV2](#5-download-sam2-and-dinov2-checkpoints)
- [üìä –ö–æ–¥ –¥–ª—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞: –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ SOTA —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã 30-shot –Ω–∞ Few-shot COCO](#-inference-code)
  - [0. –°–æ–∑–¥–∞—Ç—å —Ä–µ—Ñ–µ—Ä–µ–Ω—Å–Ω—ã–π –Ω–∞–±–æ—Ä](#0-create-reference-set)
  - [1. –ó–∞–ø–æ–ª–Ω–∏—Ç—å –ø–∞–º—è—Ç—å —Ä–µ—Ñ–µ—Ä–µ–Ω—Å–∞–º–∏](#1-fill-memory-with-references)
  - [2. –ü–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∫–∞ –±–∞–Ω–∫–∞ –ø–∞–º—è—Ç–∏](#2-post-process-memory-bank)
  - [3. –ò–Ω—Ñ–µ—Ä–µ–Ω—Å –Ω–∞ —Ü–µ–ª–µ–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö](#3-inference-on-target-images)
  - [–†–µ–∑—É–ª—å—Ç–∞—Ç—ã](#results)

- [üîç –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö](#-custom-dataset)
  - [0. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö ‚õµüê¶](#0-prepare-a-custom-dataset)
  - [0.1 –ï—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ bbox](#01-if-only-bbox-annotations-are-available)
  - [0.2 –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π COCO –≤ —Ñ–∞–π–ª pickle](#02-convert-coco-annotations-to-pickle-file)
  - [1. –ó–∞–ø–æ–ª–Ω–∏—Ç—å –ø–∞–º—è—Ç—å —ç—Ç–∞–ª–æ–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏](#1-fill-memory-with-references)
  - [2. –ü–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∫–∞ –±–∞–Ω–∫–∞ –ø–∞–º—è—Ç–∏](#2-post-process-memory-bank)
- [üìö –¶–∏—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](#-citation)


## üéØ –û—Å–Ω–æ–≤–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã
- üí° **–ë–µ–∑ –æ–±—É—á–µ–Ω–∏—è**: –ë–µ–∑ –¥–æ–æ–±—É—á–µ–Ω–∏—è, –±–µ–∑ –ø–æ–¥–±–æ—Ä–∞ –ø–æ–¥—Å–∫–∞–∑–æ–∫ ‚Äî —Ç–æ–ª—å–∫–æ —ç—Ç–∞–ª–æ–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ.  
- üñºÔ∏è **–ù–∞ –æ—Å–Ω–æ–≤–µ —ç—Ç–∞–ª–æ–Ω–∞**: –°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è –Ω–æ–≤—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ —Å –ø–æ–º–æ—â—å—é –≤—Å–µ–≥–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø—Ä–∏–º–µ—Ä–æ–≤.  
- üî• **SOTA-—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã**: –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–∏—Ç –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –±–µ–∑–æ–±—É—á–∞—é—â–∏–µ –º–µ—Ç–æ–¥—ã –Ω–∞ COCO, PASCAL VOC –∏ Cross-Domain FSOD.

**–°—Å—ã–ª–∫–∏:**
- üßæ [**arXiv —Å—Ç–∞—Ç—å—è**](https://arxiv.org/abs/2507.02798)  
- üåê [**–°–∞–π—Ç –ø—Ä–æ–µ–∫—Ç–∞**](https://miquel-espinosa.github.io/no-time-to-train/)  
- üìà [**Papers with Code**](https://paperswithcode.com/paper/no-time-to-train-training-free-reference)

## üìú –ê–Ω–Ω–æ—Ç–∞—Ü–∏—è

> The performance of image segmentation models has historically been constrained by the high cost of collecting large-scale annotated data. The Segment Anything Model (SAM) alleviates this original problem through a promptable, semantics-agnostic, segmentation paradigm and yet still requires manual visual-prompts or complex domain-dependent prompt-generation rules to process a new image. Towards reducing this new burden, our work investigates the task of object segmentation when provided with, alternatively, only a small set of reference images. Our key insight is to leverage strong semantic priors, as learned by foundation models, to identify corresponding regions between a reference and a target image. We find that correspondences enable automatic generation of instance-level segmentation masks for downstream tasks and instantiate our ideas via a multi-stage, training-free method incorporating (1) memory bank construction; (2) representation aggregation and (3) semantic-aware feature matching. Our experiments show significant improvements on segmentation metrics, leading to state-of-the-art performance on COCO FSOD (36.8% nAP), PASCAL VOC Few-Shot (71.2% nAP50) and outperforming existing training-free approaches on the Cross-Domain FSOD benchmark (22.4% nAP).

![cdfsod-results-final-comic-sans-min](https://github.com/user-attachments/assets/ab302c02-c080-4042-99fc-0e181ba8abb9)


## üß† Architecture

![training-free-architecture-comic-sans-min](https://github.com/user-attachments/assets/d84dd83a-505e-45a0-8ce3-98e1838017f9)


## üõ†Ô∏è Installation instructions

### 1. Clone the repository

```bash
git clone https://github.com/miquel-espinosa/no-time-to-train.git
cd no-time-to-train
```
### 2. –°–æ–∑–¥–∞–π—Ç–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ conda

–ú—ã —Å–æ–∑–¥–∞–¥–∏–º –æ–∫—Ä—É–∂–µ–Ω–∏–µ conda —Å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–º–∏ –ø–∞–∫–µ—Ç–∞–º–∏.

```bash
conda env create -f environment.yml
conda activate no-time-to-train
```
### 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ SAM2 –∏ DinoV2

–ú—ã —É—Å—Ç–∞–Ω–æ–≤–∏–º SAM2 –∏ DinoV2 –∏–∑ –∏—Å—Ö–æ–¥–Ω—ã—Ö –∫–æ–¥–æ–≤.

```bash
pip install -e .
cd dinov2
pip install -e .
cd ..
```
### 4. –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞–±–æ—Ä–æ–≤ –¥–∞–Ω–Ω—ã—Ö

–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–∫–∞—á–∞–π—Ç–µ –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö COCO –∏ –ø–æ–º–µ—Å—Ç–∏—Ç–µ –µ–≥–æ –≤ `data/coco`

### 5. –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã—Ö —Ç–æ—á–µ–∫ SAM2 –∏ DinoV2

–ú—ã –∑–∞–≥—Ä—É–∑–∏–º –∏–º–µ–Ω–Ω–æ —Ç–µ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏ SAM2, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –≤ —Å—Ç–∞—Ç—å–µ.
(–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏ SAM2.1 —É–∂–µ –¥–æ—Å—Ç—É–ø–Ω—ã –∏ –º–æ–≥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –ª—É—á—à–µ.)


```bash
mkdir -p checkpoints/dinov2
cd checkpoints
wget https://dl.fbaipublicfiles.com/segment_anything_2/072824/sam2_hiera_large.pt
cd dinov2
wget https://dl.fbaipublicfiles.com/dinov2/dinov2_vitl14/dinov2_vitl14_pretrain.pth
cd ../..
```
## üìä –ö–æ–¥ –¥–ª—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞

‚ö†Ô∏è –û—Ç–∫–∞–∑ –æ—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏: –≠—Ç–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∫–æ–¥ ‚Äî –æ–∂–∏–¥–∞–π—Ç–µ –Ω–µ–∫–æ—Ç–æ—Ä–æ–≥–æ —Ö–∞–æ—Å–∞!

### –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ SOTA —Å 30 –ø—Ä–∏–º–µ—Ä–∞–º–∏ –Ω–∞ Few-shot COCO

–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –ø–æ–ª–µ–∑–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ —Å–æ–∑–¥–∞–π—Ç–µ –ø–∞–ø–∫—É –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:



```bash
CONFIG=./no_time_to_train/new_exps/coco_fewshot_10shot_Sam2L.yaml
CLASS_SPLIT="few_shot_classes"
RESULTS_DIR=work_dirs/few_shot_results
SHOTS=30
SEED=33
GPUS=4

mkdir -p $RESULTS_DIR
FILENAME=few_shot_${SHOTS}shot_seed${SEED}.pkl
```
#### 0. –°–æ–∑–¥–∞–π—Ç–µ —ç—Ç–∞–ª–æ–Ω–Ω—ã–π –Ω–∞–±–æ—Ä


```bash
python no_time_to_train/dataset/few_shot_sampling.py \
        --n-shot $SHOTS \
        --out-path ${RESULTS_DIR}/${FILENAME} \
        --seed $SEED \
        --dataset $CLASS_SPLIT
```
#### 1. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–∞–º—è—Ç—å —Å—Å—ã–ª–∫–∞–º–∏


```bash
python run_lightening.py test --config $CONFIG \
                              --model.test_mode fill_memory \
                              --out_path ${RESULTS_DIR}/memory.ckpt \
                              --model.init_args.model_cfg.memory_bank_cfg.length $SHOTS \
                              --model.init_args.dataset_cfgs.fill_memory.memory_pkl ${RESULTS_DIR}/${FILENAME} \
                              --model.init_args.dataset_cfgs.fill_memory.memory_length $SHOTS \
                              --model.init_args.dataset_cfgs.fill_memory.class_split $CLASS_SPLIT \
                              --trainer.logger.save_dir ${RESULTS_DIR}/ \
                              --trainer.devices $GPUS
```
#### 2. –ü–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∫–∞ –±–∞–Ω–∫–∞ –ø–∞–º—è—Ç–∏


```bash
python run_lightening.py test --config $CONFIG \
                              --model.test_mode postprocess_memory \
                              --model.init_args.model_cfg.memory_bank_cfg.length $SHOTS \
                              --ckpt_path ${RESULTS_DIR}/memory.ckpt \
                              --out_path ${RESULTS_DIR}/memory_postprocessed.ckpt \
                              --trainer.devices 1
```
#### 3. –ò–Ω—Ñ–µ—Ä–µ–Ω—Å –Ω–∞ —Ü–µ–ª–µ–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö


```bash
python run_lightening.py test --config $CONFIG  \
                              --ckpt_path ${RESULTS_DIR}/memory_postprocessed.ckpt \
                              --model.init_args.test_mode test \
                              --model.init_args.model_cfg.memory_bank_cfg.length $SHOTS \
                              --model.init_args.model_cfg.dataset_name $CLASS_SPLIT \
                              --model.init_args.dataset_cfgs.test.class_split $CLASS_SPLIT \
                              --trainer.logger.save_dir ${RESULTS_DIR}/ \
                              --trainer.devices $GPUS
```
–ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –≤–∏–¥–µ—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—ã–≤–æ–¥–∞ –æ–Ω–ª–∞–π–Ω (–ø–æ –º–µ—Ä–µ –∏—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏—è), –¥–æ–±–∞–≤—å—Ç–µ –∞—Ä–≥—É–º–µ–Ω—Ç:

```bash
    --model.init_args.model_cfg.test.online_vis True
```
–ß—Ç–æ–±—ã –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–æ—Ä–æ–≥–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `score_thr`, –¥–æ–±–∞–≤—å—Ç–µ –∞—Ä–≥—É–º–µ–Ω—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –≤—Å–µ—Ö —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ —Å –æ—Ü–µ–Ω–∫–æ–π –≤—ã—à–µ `0.4`):
```bash
    --model.init_args.model_cfg.test.vis_thr 0.4
```
–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–µ–ø–µ—Ä—å –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è –≤ `results_analysis/few_shot_classes/`. –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–ª–µ–≤–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —ç—Ç–∞–ª–æ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–ø—Ä–∞–≤–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–µ–≥–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —ç–∫–∑–µ–º–ø–ª—è—Ä—ã, –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –Ω–∞—à–∏–º –º–µ—Ç–æ–¥–æ–º –±–µ–∑ –æ–±—É—á–µ–Ω–∏—è.

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –≤ —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ä–∞–∑–±–∏–µ–Ω–∏–µ `few_shot_classes`, –ø–æ—ç—Ç–æ–º—É –º—ã –¥–æ–ª–∂–Ω—ã –æ–∂–∏–¥–∞—Ç—å —É–≤–∏–¥–µ—Ç—å —Ç–æ–ª—å–∫–æ —Å–µ–≥–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —ç–∫–∑–µ–º–ø–ª—è—Ä—ã –∫–ª–∞—Å—Å–æ–≤ –∏–∑ —ç—Ç–æ–≥–æ —Ä–∞–∑–±–∏–µ–Ω–∏—è (–∞ –Ω–µ –≤—Å–µ—Ö –∫–ª–∞—Å—Å–æ–≤ COCO).

#### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

–ü–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—Å–µ—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏–∑ –Ω–∞–±–æ—Ä–∞ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤—ã –¥–æ–ª–∂–Ω—ã –ø–æ–ª—É—á–∏—Ç—å:

```
BBOX RESULTS:
  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.368

SEGM RESULTS:
  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.342
```
---

## üîç –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –¥–∞—Ç–∞—Å–µ—Ç

–ú—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∑–∞–ø—É—Å–∫—É –Ω–∞—à–µ–≥–æ –ø–∞–π–ø–ª–∞–π–Ω–∞ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–º –¥–∞—Ç–∞—Å–µ—Ç–µ. –§–æ—Ä–º–∞—Ç –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π –≤—Å–µ–≥–¥–∞ COCO.

> **–ö—Ä–∞—Ç–∫–æ;** –ß—Ç–æ–±—ã —Å—Ä–∞–∑—É —É–≤–∏–¥–µ—Ç—å, –∫–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ–ª–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω –Ω–∞ *–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç–∞—Ö*, —Å–º–æ—Ç—Ä–∏—Ç–µ `scripts/matching_cdfsod_pipeline.sh` –≤–º–µ—Å—Ç–µ —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ —Å–∫—Ä–∏–ø—Ç–æ–≤ –¥–ª—è –¥–∞—Ç–∞—Å–µ—Ç–æ–≤ CD-FSOD (–Ω–∞–ø—Ä–∏–º–µ—Ä, `scripts/dior_fish.sh`)

### 0. –ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –¥–∞—Ç–∞—Å–µ—Ç ‚õµüê¶

–ü—Ä–µ–¥—Å—Ç–∞–≤–∏–º, —á—Ç–æ –º—ã —Ö–æ—Ç–∏–º –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞—Ç—å **–ª–æ–¥–∫–∏**‚õµ –∏ **–ø—Ç–∏—Ü**üê¶ –≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–º –¥–∞—Ç–∞—Å–µ—Ç–µ. –ß—Ç–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞—à –º–µ—Ç–æ–¥, –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è:
- –ö–∞–∫ –º–∏–Ω–∏–º—É–º 1 *–∞–Ω–Ω–æ—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ* —ç—Ç–∞–ª–æ–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞ (—Ç.–µ. 1 —ç—Ç–∞–ª–æ–Ω –¥–ª—è –ª–æ–¥–∫–∏ –∏ 1 —ç—Ç–∞–ª–æ–Ω –¥–ª—è –ø—Ç–∏—Ü—ã)
- –ù–µ—Å–∫–æ–ª—å–∫–æ —Ü–µ–ª–µ–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è –ø–æ–∏—Å–∫–∞ —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ –Ω—É–∂–Ω—ã—Ö –Ω–∞–º –∫–ª–∞—Å—Å–æ–≤.

–ú—ã –ø–æ–¥–≥–æ—Ç–æ–≤–∏–ª–∏ –ø—Ä–æ—Å—Ç–æ–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ coco –¥–ª—è **1-shot** —Å—Ü–µ–Ω–∞—Ä–∏—è.
```bash
mkdir -p data/my_custom_dataset
python scripts/make_custom_dataset.py
```
–≠—Ç–æ —Å–æ–∑–¥–∞—Å—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö —Å–æ —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π –ø–∞–ø–æ–∫:
```
data/my_custom_dataset/
    ‚îú‚îÄ‚îÄ annotations/
    ‚îÇ   ‚îú‚îÄ‚îÄ custom_references.json
    ‚îÇ   ‚îú‚îÄ‚îÄ custom_targets.json
    ‚îÇ   ‚îî‚îÄ‚îÄ references_visualisations/
    ‚îÇ       ‚îú‚îÄ‚îÄ bird_1.jpg
    ‚îÇ       ‚îî‚îÄ‚îÄ boat_1.jpg
    ‚îî‚îÄ‚îÄ images/
        ‚îú‚îÄ‚îÄ 429819.jpg
        ‚îú‚îÄ‚îÄ 101435.jpg
        ‚îî‚îÄ‚îÄ (all target and reference images)
```
**–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —ç—Ç–∞–ª–æ–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (1-shot):**

| 1-shot —ç—Ç–∞–ª–æ–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –ü–¢–ò–¶–´ üê¶ | 1-shot —ç—Ç–∞–ª–æ–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –õ–û–î–ö–ò ‚õµ |
|:-----------------------------------------:|:------------------------------------------:|
| <img src="https://github.com/user-attachments/assets/e59e580d-a7db-42ac-b386-892af211fc85" alt="bird_1" width="500"/> | <img src="https://github.com/user-attachments/assets/f94ee025-ae37-4a45-9c3e-0cfe8f8cd2bc" alt="boat_1" width="500"/> |


### 0.1 –ï—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ bbox

–ú—ã —Ç–∞–∫–∂–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º —Å–∫—Ä–∏–ø—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –º–∞—Å–æ–∫ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –æ–±—ä–µ–∫—Ç–æ–≤ —Å –ø–æ–º–æ—â—å—é SAM2. –≠—Ç–æ –ø–æ–ª–µ–∑–Ω–æ, –µ—Å–ª–∏ –¥–ª—è —ç—Ç–∞–ª–æ–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏–º–∏ —Ä–∞–º–∫–∞–º–∏.


```bash
# Download sam_h checkpoint. Feel free to use more recent checkpoints (note: code might need to be adapted)
wget https://dl.fbaipublicfiles.com/segment_anything/sam_vit_h_4b8939.pth -O checkpoints/sam_vit_h_4b8939.pth
# Run automatic instance segmentation from ground truth bounding boxes.
python no_time_to_train/dataset/sam_bbox_to_segm_batch.py \
    --input_json data/my_custom_dataset/annotations/custom_references.json \
    --image_dir data/my_custom_dataset/images \
    --sam_checkpoint checkpoints/sam_vit_h_4b8939.pth \
    --model_type vit_h \
    --device cuda \
    --batch_size 8 \
    --visualize
```
**–†–µ—Ñ–µ—Ä–µ–Ω—Å–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å –º–∞—Å–∫–∞–º–∏ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ (—Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ SAM2 –∏–∑ gt-–±–∞—É–Ω–¥–∏–Ω–≥-–±–æ–∫—Å–æ–≤, 1-shot):**

–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –º–∞—Å–æ–∫ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤ `data/my_custom_dataset/annotations/custom_references_with_SAM_segm/references_visualisations/`.


| 1-shot —Ä–µ—Ñ–µ—Ä–µ–Ω—Å–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ü–¢–ò–¶–´ üê¶ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–µ–≥–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ SAM) | 1-shot —Ä–µ—Ñ–µ—Ä–µ–Ω—Å–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –õ–û–î–ö–ò ‚õµ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–µ–≥–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ SAM) |
|:---------------------------------:|:----------------------------------:|
| <img src="https://github.com/user-attachments/assets/65d38dc4-1454-43cd-9600-e8efc67b3a82" alt="bird_1_with_SAM_segm" width="500"/> | <img src="https://github.com/user-attachments/assets/43a558ad-50ca-4715-8285-9aa3268843c6" alt="boat_1_with_SAM_segm" width="500"/> |


### 0.2 –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π coco –≤ —Ñ–∞–π–ª pickle


```bash
python no_time_to_train/dataset/coco_to_pkl.py \
    data/my_custom_dataset/annotations/custom_references_with_segm.json \
    data/my_custom_dataset/annotations/custom_references_with_segm.pkl \
    1
```
### 1. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–∞–º—è—Ç—å —Å—Å—ã–ª–∫–∞–º–∏

–°–Ω–∞—á–∞–ª–∞ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –ø–æ–ª–µ–∑–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ —Å–æ–∑–¥–∞–π—Ç–µ –ø–∞–ø–∫—É –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤. –î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –º–µ—Ç–æ–∫ –∏–º–µ–Ω–∞ –∫–ª–∞—Å—Å–æ–≤ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —É–ø–æ—Ä—è–¥–æ—á–µ–Ω—ã –ø–æ id –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, –∫–∞–∫ —É–∫–∞–∑–∞–Ω–æ –≤ —Ñ–∞–π–ª–µ json. –ù–∞–ø—Ä–∏–º–µ—Ä, —É `bird` id –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ `16`, —É `boat` id –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ `9`. –°–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, `CAT_NAMES=boat,bird`.


```bash
DATASET_NAME=my_custom_dataset
DATASET_PATH=data/my_custom_dataset
CAT_NAMES=boat,bird
CATEGORY_NUM=2
SHOT=1
YAML_PATH=no_time_to_train/pl_configs/matching_cdfsod_template.yaml
PATH_TO_SAVE_CKPTS=./tmp_ckpts/my_custom_dataset
mkdir -p $PATH_TO_SAVE_CKPTS
```
–í—ã–ø–æ–ª–Ω–∏—Ç–µ —à–∞–≥ 1:

```bash
python run_lightening.py test --config $YAML_PATH \
    --model.test_mode fill_memory \
    --out_path $PATH_TO_SAVE_CKPTS/$DATASET_NAME\_$SHOT\_refs_memory.pth \
    --model.init_args.dataset_cfgs.fill_memory.root $DATASET_PATH/images \
    --model.init_args.dataset_cfgs.fill_memory.json_file $DATASET_PATH/annotations/custom_references_with_segm.json \
    --model.init_args.dataset_cfgs.fill_memory.memory_pkl $DATASET_PATH/annotations/custom_references_with_segm.pkl \
    --model.init_args.dataset_cfgs.fill_memory.memory_length $SHOT \
    --model.init_args.dataset_cfgs.fill_memory.cat_names $CAT_NAMES \
    --model.init_args.model_cfg.dataset_name $DATASET_NAME \
    --model.init_args.model_cfg.memory_bank_cfg.length $SHOT \
    --model.init_args.model_cfg.memory_bank_cfg.category_num $CATEGORY_NUM \
    --trainer.devices 1
```
### 2. –ü–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∫–∞ –±–∞–Ω–∫–∞ –ø–∞–º—è—Ç–∏


```bash
python run_lightening.py test --config $YAML_PATH \
    --model.test_mode postprocess_memory \
    --ckpt_path $PATH_TO_SAVE_CKPTS/$DATASET_NAME\_$SHOT\_refs_memory.pth \
    --out_path $PATH_TO_SAVE_CKPTS/$DATASET_NAME\_$SHOT\_refs_memory_postprocessed.pth \
    --model.init_args.model_cfg.dataset_name $DATASET_NAME \
    --model.init_args.model_cfg.memory_bank_cfg.length $SHOT \
    --model.init_args.model_cfg.memory_bank_cfg.category_num $CATEGORY_NUM \
    --trainer.devices 1
```

#### 2.1 –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–≥–æ –±–∞–Ω–∫–∞ –ø–∞–º—è—Ç–∏

```bash
python run_lightening.py test --config $YAML_PATH \
    --model.test_mode vis_memory \
    --ckpt_path $PATH_TO_SAVE_CKPTS/$DATASET_NAME\_$SHOT\_refs_memory_postprocessed.pth \
    --model.init_args.dataset_cfgs.fill_memory.root $DATASET_PATH/images \
    --model.init_args.dataset_cfgs.fill_memory.json_file $DATASET_PATH/annotations/custom_references_with_segm.json \
    --model.init_args.dataset_cfgs.fill_memory.memory_pkl $DATASET_PATH/annotations/custom_references_with_segm.pkl \
    --model.init_args.dataset_cfgs.fill_memory.memory_length $SHOT \
    --model.init_args.dataset_cfgs.fill_memory.cat_names $CAT_NAMES \
    --model.init_args.model_cfg.dataset_name $DATASET_NAME \
    --model.init_args.model_cfg.memory_bank_cfg.length $SHOT \
    --model.init_args.model_cfg.memory_bank_cfg.category_num $CATEGORY_NUM \
    --trainer.devices 1
```
–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ PCA –∏ K-means –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏–∑ –±–∞–Ω–∫–∞ –ø–∞–º—è—Ç–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `results_analysis/memory_vis/my_custom_dataset`.

### 3. –ò–Ω—Ñ–µ—Ä–µ–Ω—Å –Ω–∞ —Ü–µ–ª–µ–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö

–ï—Å–ª–∏ `ONLINE_VIS` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ True, —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ `results_analysis/my_custom_dataset/` –∏ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –ø–æ –º–µ—Ä–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è. –û–ë–†–ê–¢–ò–¢–ï –í–ù–ò–ú–ê–ù–ò–ï, —á—Ç–æ –∑–∞–ø—É—Å–∫ —Å –æ–Ω–ª–∞–π–Ω-–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –º–µ–¥–ª–µ–Ω–Ω–µ–µ.

–í—ã –º–æ–∂–µ—Ç–µ —Å–≤–æ–±–æ–¥–Ω–æ –∏–∑–º–µ–Ω—è—Ç—å –ø–æ—Ä–æ–≥ –æ—Ü–µ–Ω–∫–∏ `VIS_THR`, —á—Ç–æ–±—ã –≤–∏–¥–µ—Ç—å –±–æ–ª—å—à–µ –∏–ª–∏ –º–µ–Ω—å—à–µ —Å–µ–≥–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤.
```bash
ONLINE_VIS=True
VIS_THR=0.4
python run_lightening.py test --config $YAML_PATH \
    --model.test_mode test \
    --ckpt_path $PATH_TO_SAVE_CKPTS/$DATASET_NAME\_$SHOT\_refs_memory_postprocessed.pth \
    --model.init_args.model_cfg.dataset_name $DATASET_NAME \
    --model.init_args.model_cfg.memory_bank_cfg.length $SHOT \
    --model.init_args.model_cfg.memory_bank_cfg.category_num $CATEGORY_NUM \
    --model.init_args.model_cfg.test.imgs_path $DATASET_PATH/images \
    --model.init_args.model_cfg.test.online_vis $ONLINE_VIS \
    --model.init_args.model_cfg.test.vis_thr $VIS_THR \
    --model.init_args.dataset_cfgs.test.root $DATASET_PATH/images \
    --model.init_args.dataset_cfgs.test.json_file $DATASET_PATH/annotations/custom_targets.json \
    --model.init_args.dataset_cfgs.test.cat_names $CAT_NAMES \
    --trainer.devices 1
```
### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

–ü–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (—Å —Ç–µ–º–∏ –∂–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏, —á—Ç–æ –∏ –≤ –ø—Ä–∏–≤–µ–¥—ë–Ω–Ω—ã—Ö –≤—ã—à–µ –∫–æ–º–∞–Ω–¥–∞—Ö), –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–ª–µ–¥—É—é—â–∏–º–∏:


```
BBOX RESULTS:
  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.478

SEGM RESULTS:
  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.458
```
–í–∏–∑—É–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `results_analysis/my_custom_dataset/`. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –Ω–∞—à –º–µ—Ç–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –¥–ª—è –ª–æ–∂–Ω–æ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤, —Ç–æ –µ—Å—Ç—å –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç —ç–∫–∑–µ–º–ø–ª—è—Ä—ã –Ω—É–∂–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤.

*–ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, —á—Ç–æ–±—ã —É–≤–µ–ª–∏—á–∏—Ç—å ‚¨áÔ∏è*

| –¶–µ–ª–µ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å –ª–æ–¥–∫–∞–º–∏ ‚õµ (—Å–ª–µ–≤–∞ GT, —Å–ø—Ä–∞–≤–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è) | –¶–µ–ª–µ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å –ø—Ç–∏—Ü–∞–º–∏ üê¶ (—Å–ª–µ–≤–∞ GT, —Å–ø—Ä–∞–≤–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è) |
|:----------------------:|:----------------------:|
| ![000000459673](https://github.com/user-attachments/assets/678dc15a-dd3b-49d5-9287-6290da16aa6b) | ![000000407180](https://github.com/user-attachments/assets/fe306e48-af49-4d83-ac82-76fac6c456d1) |

| –¶–µ–ª–µ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å –ª–æ–¥–∫–∞–º–∏ –∏ –ø—Ç–∏—Ü–∞–º–∏ ‚õµüê¶ (—Å–ª–µ–≤–∞ GT, —Å–ø—Ä–∞–≤–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è) | –¶–µ–ª–µ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±–µ–∑ –ª–æ–¥–æ–∫ –∏ –ø—Ç–∏—Ü üö´ (—Å–ª–µ–≤–∞ GT, —Å–ø—Ä–∞–≤–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è) |
|:---------------------------------:|:----------------------------------:|
| ![000000517410](https://github.com/user-attachments/assets/9849b227-7f43-43d7-81ea-58010a623ad5) | ![000000460598](https://github.com/user-attachments/assets/7587700c-e09d-4cf6-8590-3df129c2568e) |


## üìö –¶–∏—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ —ç—Ç—É —Ä–∞–±–æ—Ç—É, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, —Ü–∏—Ç–∏—Ä—É–π—Ç–µ –Ω–∞—Å:


```bibtex
@article{espinosa2025notimetotrain,
  title={No time to train! Training-Free Reference-Based Instance Segmentation},
  author={Miguel Espinosa and Chenhongyi Yang and Linus Ericsson and Steven McDonagh and Elliot J. Crowley},
  journal={arXiv preprint arXiv:2507.02798},
  year={2025},
  primaryclass={cs.CV}
}
```


---

Tranlated By [Open Ai Tx](https://github.com/OpenAiTx/OpenAiTx) | Last indexed: 2026-01-15

---