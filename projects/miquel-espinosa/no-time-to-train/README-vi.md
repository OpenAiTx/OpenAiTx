<div align="right">
  <details>
    <summary >üåê Ng√¥n ng·ªØ</summary>
    <div>
      <div align="center">
        <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=en">English</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=zh-CN">ÁÆÄ‰Ωì‰∏≠Êñá</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=zh-TW">ÁπÅÈ´î‰∏≠Êñá</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=ja">Êó•Êú¨Ë™û</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=ko">ÌïúÍµ≠Ïñ¥</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=th">‡πÑ‡∏ó‡∏¢</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=fr">Fran√ßais</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=de">Deutsch</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=es">Espa√±ol</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=it">Italiano</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=ru">–†—É—Å—Å–∫–∏–π</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=pt">Portugu√™s</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=nl">Nederlands</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=pl">Polski</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=ar">ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=fa">ŸÅÿßÿ±ÿ≥€å</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=tr">T√ºrk√ße</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=vi">Ti·∫øng Vi·ªát</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=id">Bahasa Indonesia</a>
      </div>
    </div>
  </details>
</div>

<div align="center">

# üöÄ Kh√¥ng C·∫ßn Th·ªùi Gian ƒê·ªÉ Hu·∫•n Luy·ªán!  
### Ph√¢n ƒêo·∫°n ƒê·ªëi T∆∞·ª£ng Tham Chi·∫øu Kh√¥ng C·∫ßn Hu·∫•n Luy·ªán  
[![GitHub](https://img.shields.io/badge/%E2%80%8B-No%20Time%20To%20Train-black?logo=github)](https://github.com/miquel-espinosa/no-time-to-train)
[![Website](https://img.shields.io/badge/üåê-Project%20Page-grey)](https://miquel-espinosa.github.io/no-time-to-train/)
[![arXiv](https://img.shields.io/badge/arXiv-2507.02798-b31b1b)](https://arxiv.org/abs/2507.02798)

**Hi·ªán ƒë·∫°i nh·∫•t (Papers with Code)**

[**_1-shot_**](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-1-shot?p=no-time-to-train-training-free-reference) | [![PWC](https://img.shields.io/endpoint.svg?url=https://paperswithcode.com/badge/no-time-to-train-training-free-reference/few-shot-object-detection-on-ms-coco-1-shot)](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-1-shot?p=no-time-to-train-training-free-reference)

[**_10-shot_**](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-10-shot?p=no-time-to-train-training-free-reference) | [![PWC](https://img.shields.io/endpoint.svg?url=https://paperswithcode.com/badge/no-time-to-train-training-free-reference/few-shot-object-detection-on-ms-coco-10-shot)](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-10-shot?p=no-time-to-train-training-free-reference)

[**_30-shot_**](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-30-shot?p=no-time-to-train-training-free-reference) | [![PWC](https://img.shields.io/endpoint.svg?url=https://paperswithcode.com/badge/no-time-to-train-training-free-reference/few-shot-object-detection-on-ms-coco-30-shot)](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-30-shot?p=no-time-to-train-training-free-reference)

</div>

---

> üîî **C·∫≠p nh·∫≠t (Th√°ng 7/2025):** M√£ ngu·ªìn ƒë√£ ƒë∆∞·ª£c c·∫≠p nh·∫≠t k√®m h∆∞·ªõng d·∫´n!

---

## üìã M·ª•c L·ª•c

- [üéØ ƒêi·ªÉm n·ªïi b·∫≠t](#-highlights)
- [üìú T√≥m t·∫Øt](#-abstract)
- [üß† Ki·∫øn tr√∫c](#-architecture)
- [üõ†Ô∏è H∆∞·ªõng d·∫´n c√†i ƒë·∫∑t](#Ô∏è-installation-instructions)
  - [1. Sao ch√©p kho l∆∞u tr·ªØ](#1-clone-the-repository)
  - [2. T·∫°o m√¥i tr∆∞·ªùng conda](#2-create-conda-environment)
  - [3. C√†i ƒë·∫∑t SAM2 v√† DinoV2](#3-install-sam2-and-dinov2)
  - [4. T·∫£i xu·ªëng b·ªô d·ªØ li·ªáu](#4-download-datasets)
  - [5. T·∫£i xu·ªëng c√°c checkpoint SAM2 v√† DinoV2](#5-download-sam2-and-dinov2-checkpoints)
- [üìä M√£ suy lu·∫≠n: T√°i t·∫°o k·∫øt qu·∫£ SOTA 30-shot tr√™n Few-shot COCO](#-inference-code)
  - [0. T·∫°o b·ªô tham chi·∫øu](#0-create-reference-set)
  - [1. ƒê·ªï b·ªô nh·ªõ v·ªõi c√°c tham chi·∫øu](#1-fill-memory-with-references)
  - [2. X·ª≠ l√Ω h·∫≠u k·ª≥ b·ªô nh·ªõ](#2-post-process-memory-bank)
  - [3. Suy lu·∫≠n tr√™n ·∫£nh m·ª•c ti√™u](#3-inference-on-target-images)
  - [K·∫øt qu·∫£](#results)
- [üîç Tr√≠ch d·∫´n](#-citation)


## üéØ ƒêi·ªÉm n·ªïi b·∫≠t
- üí° **Kh√¥ng c·∫ßn hu·∫•n luy·ªán**: Kh√¥ng tinh ch·ªânh, kh√¥ng c·∫ßn thi·∫øt k·∫ø prompt‚Äîch·ªâ c·∫ßn ·∫£nh tham chi·∫øu.  
- üñºÔ∏è **D·ª±a tr√™n tham chi·∫øu**: Ph√¢n ƒëo·∫°n ƒë·ªëi t∆∞·ª£ng m·ªõi ch·ªâ v·ªõi m·ªôt v√†i v√≠ d·ª•.  
- üî• **Hi·ªáu nƒÉng SOTA**: V∆∞·ª£t tr·ªôi c√°c ph∆∞∆°ng ph√°p kh√¥ng c·∫ßn hu·∫•n luy·ªán tr∆∞·ªõc tr√™n COCO, PASCAL VOC v√† Cross-Domain FSOD.

**Li√™n k·∫øt:**
- üßæ [**B√†i b√°o arXiv**](https://arxiv.org/abs/2507.02798)  
- üåê [**Trang d·ª± √°n**](https://miquel-espinosa.github.io/no-time-to-train/)  
- üìà [**Papers with Code**](https://paperswithcode.com/paper/no-time-to-train-training-free-reference)

## üìú T√≥m t·∫Øt

> Hi·ªáu su·∫•t c·ªßa c√°c m√¥ h√¨nh ph√¢n ƒëo·∫°n ·∫£nh t·ª´ tr∆∞·ªõc t·ªõi nay b·ªã gi·ªõi h·∫°n b·ªüi chi ph√≠ cao trong vi·ªác thu th·∫≠p d·ªØ li·ªáu ƒë∆∞·ª£c g√°n nh√£n quy m√¥ l·ªõn. M√¥ h√¨nh Segment Anything (SAM) ƒë√£ gi·∫£m b·ªõt v·∫•n ƒë·ªÅ n√†y nh·ªù m√¥ h√¨nh ph√¢n ƒëo·∫°n kh√¥ng ph·ª• thu·ªôc ng·ªØ nghƒ©a v·ªõi kh·∫£ nƒÉng nh·∫≠n prompt, tuy nhi√™n v·∫´n c·∫ßn prompt h√¨nh ·∫£nh th·ªß c√¥ng ho·∫∑c c√°c quy t·∫Øc t·∫°o prompt ph·ª©c t·∫°p ph·ª• thu·ªôc v√†o mi·ªÅn ƒë·ªÉ x·ª≠ l√Ω ·∫£nh m·ªõi. Nh·∫±m gi·∫£m g√°nh n·∫∑ng n√†y, nghi√™n c·ª©u c·ªßa ch√∫ng t√¥i kh·∫£o s√°t b√†i to√°n ph√¢n ƒëo·∫°n ƒë·ªëi t∆∞·ª£ng khi ch·ªâ c√≥ m·ªôt t·∫≠p nh·ªè ·∫£nh tham chi·∫øu. Quan s√°t ch√≠nh l√† t·∫≠n d·ª•ng c√°c prior ng·ªØ nghƒ©a m·∫°nh m·∫Ω ƒë∆∞·ª£c h·ªçc b·ªüi c√°c m√¥ h√¨nh n·ªÅn t·∫£ng ƒë·ªÉ x√°c ƒë·ªãnh v√πng t∆∞∆°ng ·ª©ng gi·ªØa ·∫£nh tham chi·∫øu v√† ·∫£nh m·ª•c ti√™u. Ch√∫ng t√¥i nh·∫≠n th·∫•y vi·ªác t√¨m t∆∞∆°ng ·ª©ng n√†y cho ph√©p t·ª± ƒë·ªông t·∫°o m·∫∑t n·∫° ph√¢n ƒëo·∫°n c·∫•p ƒë·ªëi t∆∞·ª£ng ph·ª•c v·ª• c√°c t√°c v·ª• ph√≠a sau, v√† hi·ªán th·ª±c h√≥a √Ω t∆∞·ªüng th√¥ng qua ph∆∞∆°ng ph√°p nhi·ªÅu giai ƒëo·∫°n, kh√¥ng c·∫ßn hu·∫•n luy·ªán bao g·ªìm (1) x√¢y d·ª±ng b·ªô nh·ªõ; (2) t·ªïng h·ª£p bi·ªÉu di·ªÖn v√† (3) gh√©p ƒë·∫∑c tr∆∞ng nh·∫≠n bi·∫øt ng·ªØ nghƒ©a. Th√≠ nghi·ªám cho th·∫•y c·∫£i thi·ªán ƒë√°ng k·ªÉ v·ªÅ ch·ªâ s·ªë ph√¢n ƒëo·∫°n, ƒë·∫°t hi·ªáu nƒÉng h√†ng ƒë·∫ßu tr√™n COCO FSOD (36.8% nAP), PASCAL VOC Few-Shot (71.2% nAP50) v√† v∆∞·ª£t c√°c ph∆∞∆°ng ph√°p kh√¥ng c·∫ßn hu·∫•n luy·ªán tr∆∞·ªõc tr√™n benchmark Cross-Domain FSOD (22.4% nAP).

![cdfsod-results-final-comic-sans-min](https://github.com/user-attachments/assets/ab302c02-c080-4042-99fc-0e181ba8abb9)


## üß† Ki·∫øn tr√∫c

![training-free-architecture-comic-sans-min](https://github.com/user-attachments/assets/d84dd83a-505e-45a0-8ce3-98e1838017f9)


## üõ†Ô∏è H∆∞·ªõng d·∫´n c√†i ƒë·∫∑t

### 1. Sao ch√©p kho l∆∞u tr·ªØ


```bash
git clone https://github.com/miquel-espinosa/no-time-to-train.git
cd no-time-to-train
```
### 2. T·∫°o m√¥i tr∆∞·ªùng conda

Ch√∫ng ta s·∫Ω t·∫°o m·ªôt m√¥i tr∆∞·ªùng conda v·ªõi c√°c g√≥i c·∫ßn thi·∫øt.

```bash
conda env create -f environment.yml
conda activate no-time-to-train
```
### 3. C√†i ƒë·∫∑t SAM2 v√† DinoV2

Ch√∫ng ta s·∫Ω c√†i ƒë·∫∑t SAM2 v√† DinoV2 t·ª´ m√£ ngu·ªìn.

```bash
pip install -e .
cd dinov2
pip install -e .
cd ..
```
### 4. T·∫£i xu·ªëng c√°c b·ªô d·ªØ li·ªáu

Vui l√≤ng t·∫£i xu·ªëng b·ªô d·ªØ li·ªáu COCO v√† ƒë·∫∑t n√≥ v√†o `data/coco`

### 5. T·∫£i xu·ªëng c√°c checkpoint SAM2 v√† DinoV2

Ch√∫ng ta s·∫Ω t·∫£i xu·ªëng c√°c checkpoint SAM2 ch√≠nh x√°c ƒë√£ ƒë∆∞·ª£c s·ª≠ d·ª•ng trong b√†i b√°o.
(Tuy nhi√™n, l∆∞u √Ω r·∫±ng c√°c checkpoint SAM2.1 ƒë√£ c√≥ s·∫µn v√† c√≥ th·ªÉ ho·∫°t ƒë·ªông t·ªët h∆°n.)


```bash
mkdir -p checkpoints/dinov2
cd checkpoints
wget https://dl.fbaipublicfiles.com/segment_anything_2/072824/sam2_hiera_large.pt
cd dinov2
wget https://dl.fbaipublicfiles.com/dinov2/dinov2_vitl14/dinov2_vitl14_pretrain.pth
cd ../..
```
## üìä M√£ suy lu·∫≠n

‚ö†Ô∏è L∆∞u √Ω: ƒê√¢y l√† m√£ nghi√™n c·ª©u ‚Äî c√≥ th·ªÉ s·∫Ω h∆°i l·ªôn x·ªôn!

### T√°i t·∫°o k·∫øt qu·∫£ SOTA 30-shot trong Few-shot COCO

ƒê·ªãnh nghƒ©a c√°c bi·∫øn h·ªØu √≠ch v√† t·∫°o m·ªôt th∆∞ m·ª•c cho k·∫øt qu·∫£:



```bash
CONFIG=./dev_hongyi/new_exps/coco_fewshot_10shot_Sam2L.yaml
CLASS_SPLIT="few_shot_classes"
RESULTS_DIR=work_dirs/few_shot_results
SHOTS=30
SEED=33
GPUS=4

mkdir -p $RESULTS_DIR
FILENAME=few_shot_${SHOTS}shot_seed${SEED}.pkl
```
#### 0. T·∫°o b·ªô tham chi·∫øu


```bash
python dev_hongyi/dataset/few_shot_sampling.py \
        --n-shot $SHOTS \
        --out-path ${RESULTS_DIR}/${FILENAME} \
        --seed $SEED \
        --dataset $CLASS_SPLIT
```
#### 1. L·∫•p ƒë·∫ßy b·ªô nh·ªõ b·∫±ng c√°c tham chi·∫øu


```bash
python run_lightening.py test --config $CONFIG \
                              --model.test_mode fill_memory \
                              --out_path ${RESULTS_DIR}/memory.ckpt \
                              --model.init_args.model_cfg.memory_bank_cfg.length $SHOTS \
                              --model.init_args.dataset_cfgs.fill_memory.memory_pkl ${RESULTS_DIR}/${FILENAME} \
                              --model.init_args.dataset_cfgs.fill_memory.memory_length $SHOTS \
                              --model.init_args.dataset_cfgs.fill_memory.class_split $CLASS_SPLIT \
                              --trainer.logger.save_dir ${RESULTS_DIR}/ \
                              --trainer.devices $GPUS
```
#### 2. X·ª≠ l√Ω h·∫≠u k·ª≥ b·ªô nh·ªõ ng√¢n h√†ng


```bash
python run_lightening.py test --config $CONFIG \
                              --model.test_mode postprocess_memory \
                              --model.init_args.model_cfg.memory_bank_cfg.length $SHOTS \
                              --ckpt_path ${RESULTS_DIR}/memory.ckpt \
                              --out_path ${RESULTS_DIR}/memory_postprocessed.ckpt \
                              --trainer.devices 1
```
#### 3. Suy lu·∫≠n tr√™n c√°c h√¨nh ·∫£nh m·ª•c ti√™u


```bash
python run_lightening.py test --config $CONFIG  \
                              --ckpt_path ${RESULTS_DIR}/memory_postprocessed.ckpt \
                              --model.init_args.test_mode test \
                              --model.init_args.model_cfg.memory_bank_cfg.length $SHOTS \
                              --model.init_args.model_cfg.dataset_name $CLASS_SPLIT \
                              --model.init_args.dataset_cfgs.test.class_split $CLASS_SPLIT \
                              --trainer.logger.save_dir ${RESULTS_DIR}/ \
                              --trainer.devices $GPUS
```
N·∫øu b·∫°n mu·ªën xem k·∫øt qu·∫£ suy lu·∫≠n tr·ª±c tuy·∫øn (khi ch√∫ng ƒë∆∞·ª£c t√≠nh to√°n), h√£y b·ªè ch√∫ th√≠ch c√°c d√≤ng 1746-1749 trong `dev_hongyi/models/Sam2MatchingBaseline_noAMG.py` [t·∫°i ƒë√¢y](https://github.com/miquel-espinosa/no-time-to-train/blob/main/dev_hongyi/models/Sam2MatchingBaseline_noAMG.py#L1746).
ƒêi·ªÅu ch·ªânh tham s·ªë ng∆∞·ª°ng ƒëi·ªÉm s·ªë `score_thr` n·∫øu c·∫ßn ƒë·ªÉ xem nhi·ªÅu ho·∫∑c √≠t h∆°n c√°c ƒë·ªëi t∆∞·ª£ng ƒë∆∞·ª£c ph√¢n ƒëo·∫°n.
H√¨nh ·∫£nh b√¢y gi·ªù s·∫Ω ƒë∆∞·ª£c l∆∞u trong `results_analysis/few_shot_classes/`. H√¨nh b√™n tr√°i th·ªÉ hi·ªán nh√£n th·ª±c t·∫ø, h√¨nh b√™n ph·∫£i th·ªÉ hi·ªán c√°c ƒë·ªëi t∆∞·ª£ng ƒë∆∞·ª£c ph√¢n ƒëo·∫°n do ph∆∞∆°ng ph√°p kh√¥ng c·∫ßn hu·∫•n luy·ªán c·ªßa ch√∫ng t√¥i t√¨m th·∫•y.

L∆∞u √Ω r·∫±ng trong v√≠ d·ª• n√†y ch√∫ng ta ƒëang s·ª≠ d·ª•ng t·∫≠p chia `few_shot_classes`, do ƒë√≥, ch√∫ng ta ch·ªâ n√™n k·ª≥ v·ªçng s·∫Ω th·∫•y c√°c ƒë·ªëi t∆∞·ª£ng ƒë∆∞·ª£c ph√¢n ƒëo·∫°n thu·ªôc c√°c l·ªõp trong t·∫≠p n√†y (kh√¥ng ph·∫£i t·∫•t c·∫£ c√°c l·ªõp trong COCO).

#### K·∫øt qu·∫£

Sau khi ch·∫°y t·∫•t c·∫£ h√¨nh ·∫£nh trong t·∫≠p ki·ªÉm tra, b·∫°n s·∫Ω nh·∫≠n ƒë∆∞·ª£c:


```
BBOX RESULTS:
  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.368

SEGM RESULTS:
  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.342
```
---


## üîç Citation

If you use this work, please cite us:

```bibtex
@article{espinosa2025notimetotrain,
  title={No time to train! Training-Free Reference-Based Instance Segmentation},
  author={Miguel Espinosa and Chenhongyi Yang and Linus Ericsson and Steven McDonagh and Elliot J. Crowley},
  journal={arXiv preprint arXiv:2507.02798},
  year={2025},
  primaryclass={cs.CV}
}
```

---

Tranlated By [Open Ai Tx](https://github.com/OpenAiTx/OpenAiTx) | Last indexed: 2025-07-22

---