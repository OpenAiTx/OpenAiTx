<div align="right">
  <details>
    <summary >ğŸŒ èªè¨€</summary>
    <div>
      <div align="center">
        <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=en">English</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=zh-CN">ç®€ä½“ä¸­æ–‡</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=zh-TW">ç¹é«”ä¸­æ–‡</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=ja">æ—¥æœ¬èª</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=ko">í•œêµ­ì–´</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=hi">à¤¹à¤¿à¤¨à¥à¤¦à¥€</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=th">à¹„à¸—à¸¢</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=fr">FranÃ§ais</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=de">Deutsch</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=es">EspaÃ±ol</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=it">Italiano</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=ru">Ğ ÑƒÑÑĞºĞ¸Ğ¹</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=pt">PortuguÃªs</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=nl">Nederlands</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=pl">Polski</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=ar">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=fa">ÙØ§Ø±Ø³ÛŒ</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=tr">TÃ¼rkÃ§e</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=vi">Tiáº¿ng Viá»‡t</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=id">Bahasa Indonesia</a>
      </div>
    </div>
  </details>
</div>

<div align="center">

# ğŸš€ æ²’æœ‰æ™‚é–“è¨“ç·´ï¼  
### ç„¡éœ€è¨“ç·´çš„åƒè€ƒå¼å¯¦ä¾‹åˆ†å‰²  
[![GitHub](https://img.shields.io/badge/%E2%80%8B-No%20Time%20To%20Train-black?logo=github)](https://github.com/miquel-espinosa/no-time-to-train)
[![Website](https://img.shields.io/badge/ğŸŒ-Project%20Page-grey)](https://miquel-espinosa.github.io/no-time-to-train/)
[![arXiv](https://img.shields.io/badge/arXiv-2507.02798-b31b1b)](https://arxiv.org/abs/2507.02798)

**æœ€å…ˆé€²æŠ€è¡“ï¼ˆPapers with Codeï¼‰**

[**_1æ¬¡_**](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-1-shot?p=no-time-to-train-training-free-reference) | [![PWC](https://img.shields.io/endpoint.svg?url=https://paperswithcode.com/badge/no-time-to-train-training-free-reference/few-shot-object-detection-on-ms-coco-1-shot)](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-1-shot?p=no-time-to-train-training-free-reference)

[**_10æ¬¡_**](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-10-shot?p=no-time-to-train-training-free-reference) | [![PWC](https://img.shields.io/endpoint.svg?url=https://paperswithcode.com/badge/no-time-to-train-training-free-reference/few-shot-object-detection-on-ms-coco-10-shot)](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-10-shot?p=no-time-to-train-training-free-reference)

[**_30æ¬¡_**](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-30-shot?p=no-time-to-train-training-free-reference) | [![PWC](https://img.shields.io/endpoint.svg?url=https://paperswithcode.com/badge/no-time-to-train-training-free-reference/few-shot-object-detection-on-ms-coco-30-shot)](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-30-shot?p=no-time-to-train-training-free-reference)

</div>

---

> ğŸ”” **æ›´æ–°ï¼ˆ2025å¹´7æœˆï¼‰ï¼š** ç¨‹å¼ç¢¼å·²æ›´æ–°ä¸¦é™„ä¸Šæ“ä½œèªªæ˜ï¼

---

## ğŸ“‹ ç›®éŒ„

- [ğŸ¯ äº®é»](#-highlights)
- [ğŸ“œ æ‘˜è¦](#-abstract)
- [ğŸ§  æ¶æ§‹](#-architecture)
- [ğŸ› ï¸ å®‰è£èªªæ˜](#ï¸-installation-instructions)
  - [1. è¤‡è£½å„²å­˜åº«](#1-clone-the-repository)
  - [2. å»ºç«‹condaç’°å¢ƒ](#2-create-conda-environment)
  - [3. å®‰è£SAM2èˆ‡DinoV2](#3-install-sam2-and-dinov2)
  - [4. ä¸‹è¼‰æ•¸æ“šé›†](#4-download-datasets)
  - [5. ä¸‹è¼‰SAM2èˆ‡DinoV2æª¢æŸ¥é»](#5-download-sam2-and-dinov2-checkpoints)
- [ğŸ“Š æ¨è«–ç¨‹å¼ç¢¼ï¼šåœ¨Few-shot COCOå¾©ç¾30-shot SOTAçµæœ](#-inference-code)
  - [0. å»ºç«‹åƒè€ƒé›†](#0-create-reference-set)
  - [1. ç”¨åƒè€ƒåœ–å¡«å……è¨˜æ†¶é«”](#1-fill-memory-with-references)
  - [2. å¾Œè™•ç†è¨˜æ†¶åº«](#2-post-process-memory-bank)
  - [3. åœ¨ç›®æ¨™åœ–åƒä¸Šæ¨è«–](#3-inference-on-target-images)
  - [çµæœ](#results)
- [ğŸ” å¼•ç”¨](#-citation)


## ğŸ¯ äº®é»
- ğŸ’¡ **ç„¡éœ€è¨“ç·´**ï¼šç„¡éœ€å¾®èª¿ï¼Œç„¡éœ€æç¤ºå·¥ç¨‹â€”â€”åªéœ€ä¸€å¼µåƒè€ƒåœ–åƒã€‚  
- ğŸ–¼ï¸ **åƒè€ƒå¼**ï¼šåƒ…ç”¨å°‘é‡ç¯„ä¾‹å³å¯åˆ†å‰²æ–°ç‰©é«”ã€‚  
- ğŸ”¥ **SOTAè¡¨ç¾**ï¼šåœ¨COCOã€PASCAL VOCå’Œè·¨åŸŸFSODä¸Šè¶…è¶Šä»¥å¾€ç„¡éœ€è¨“ç·´æ–¹æ³•ã€‚

**é€£çµï¼š**
- ğŸ§¾ [**arXiv è«–æ–‡**](https://arxiv.org/abs/2507.02798)  
- ğŸŒ [**å°ˆæ¡ˆç¶²ç«™**](https://miquel-espinosa.github.io/no-time-to-train/)  
- ğŸ“ˆ [**Papers with Code**](https://paperswithcode.com/paper/no-time-to-train-training-free-reference)

## ğŸ“œ æ‘˜è¦

> åœ–åƒåˆ†å‰²æ¨¡å‹çš„æ•ˆèƒ½æ­·ä¾†å—é™æ–¼æ”¶é›†å¤§è¦æ¨¡æ¨™è¨»æ•¸æ“šçš„é«˜æ˜‚æˆæœ¬ã€‚Segment Anything Modelï¼ˆSAMï¼‰é€šéå¯æç¤ºã€èªç¾©ç„¡é—œçš„åˆ†å‰²ç¯„å¼ï¼Œç·©è§£äº†é€™ä¸€åŸå§‹å•é¡Œï¼Œä½†åœ¨è™•ç†æ–°åœ–åƒæ™‚ä»éœ€äººå·¥è¦–è¦ºæç¤ºæˆ–è¤‡é›œçš„é ˜åŸŸä¾è³´æç¤ºç”Ÿæˆè¦å‰‡ã€‚ç‚ºæ¸›è¼•é€™ä¸€æ–°è² æ“”ï¼Œæˆ‘å€‘æ¢è¨äº†åœ¨åªæä¾›ä¸€å°çµ„åƒè€ƒåœ–åƒçš„æƒ…å¢ƒä¸‹çš„ç‰©é«”åˆ†å‰²ä»»å‹™ã€‚æˆ‘å€‘çš„é—œéµæ´å¯Ÿæ˜¯åˆ©ç”¨åŸºç¤æ¨¡å‹å­¸åˆ°çš„å¼·å¤§èªç¾©å…ˆé©—ï¼Œä¾†è­˜åˆ¥åƒè€ƒåœ–åƒèˆ‡ç›®æ¨™åœ–åƒä¹‹é–“çš„å°æ‡‰å€åŸŸã€‚æˆ‘å€‘ç™¼ç¾é€™ç¨®å°æ‡‰é—œä¿‚èƒ½å¤ è‡ªå‹•ç”Ÿæˆç”¨æ–¼ä¸‹æ¸¸ä»»å‹™çš„å¯¦ä¾‹ç´šåˆ†å‰²é®ç½©ï¼Œä¸¦é€šéä¸€ç¨®å¤šéšæ®µã€ç„¡éœ€è¨“ç·´çš„æ–¹æ³•ä¾†å¯¦ç¾æˆ‘å€‘çš„ç†å¿µï¼ŒåŒ…æ‹¬ï¼ˆ1ï¼‰è¨˜æ†¶åº«æ§‹å»ºï¼›ï¼ˆ2ï¼‰è¡¨ç¤ºèšåˆï¼›ï¼ˆ3ï¼‰èªç¾©æ„ŸçŸ¥ç‰¹å¾µåŒ¹é…ã€‚æˆ‘å€‘çš„å¯¦é©—åœ¨åˆ†å‰²æŒ‡æ¨™ä¸Šé¡¯è‘—æå‡ï¼Œåœ¨COCO FSODï¼ˆ36.8% nAPï¼‰ã€PASCAL VOCå°‘æ¨£æœ¬ï¼ˆ71.2% nAP50ï¼‰ä¸Šé”åˆ°æœ€å…ˆé€²æ°´æº–ï¼Œä¸¦åœ¨è·¨åŸŸFSODåŸºæº–ä¸Šè¶…è¶Šç¾æœ‰ç„¡éœ€è¨“ç·´æ–¹æ³•ï¼ˆ22.4% nAPï¼‰ã€‚

![cdfsod-results-final-comic-sans-min](https://github.com/user-attachments/assets/ab302c02-c080-4042-99fc-0e181ba8abb9)


## ğŸ§  æ¶æ§‹

![training-free-architecture-comic-sans-min](https://github.com/user-attachments/assets/d84dd83a-505e-45a0-8ce3-98e1838017f9)


## ğŸ› ï¸ å®‰è£èªªæ˜

### 1. è¤‡è£½å„²å­˜åº«


```bash
git clone https://github.com/miquel-espinosa/no-time-to-train.git
cd no-time-to-train
```
### 2. å»ºç«‹ conda ç’°å¢ƒ

æˆ‘å€‘å°‡å»ºç«‹ä¸€å€‹åŒ…å«æ‰€éœ€å¥—ä»¶çš„ conda ç’°å¢ƒã€‚

```bash
conda env create -f environment.yml
conda activate no-time-to-train
```
### 3. å®‰è£ SAM2 å’Œ DinoV2

æˆ‘å€‘å°‡å¾åŸå§‹ç¢¼å®‰è£ SAM2 å’Œ DinoV2ã€‚

```bash
pip install -e .
cd dinov2
pip install -e .
cd ..
```
### 4. ä¸‹è¼‰æ•¸æ“šé›†

è«‹ä¸‹è¼‰ COCO æ•¸æ“šé›†ä¸¦å°‡å…¶æ”¾ç½®æ–¼ `data/coco`

### 5. ä¸‹è¼‰ SAM2 å’Œ DinoV2 æ¬Šé‡æª”

æˆ‘å€‘å°‡ä¸‹è¼‰è«–æ–‡ä¸­ä½¿ç”¨çš„ SAM2 æ¬Šé‡æª”ã€‚
ï¼ˆä½†è«‹æ³¨æ„ï¼ŒSAM2.1 æ¬Šé‡æª”å·²ç¶“å¯ç”¨ï¼Œä¸”å¯èƒ½æœ‰æ›´å¥½çš„è¡¨ç¾ã€‚ï¼‰


```bash
mkdir -p checkpoints/dinov2
cd checkpoints
wget https://dl.fbaipublicfiles.com/segment_anything_2/072824/sam2_hiera_large.pt
cd dinov2
wget https://dl.fbaipublicfiles.com/dinov2/dinov2_vitl14/dinov2_vitl14_pretrain.pth
cd ../..
```
## ğŸ“Š æ¨è«–ç¨‹å¼ç¢¼

âš ï¸ å…è²¬è²æ˜ï¼šé€™æ˜¯ç ”ç©¶ç”¨ç¨‹å¼ç¢¼â€”â€”è«‹é æœŸæœƒæœ‰ä¸€äº›æ··äº‚ï¼

### åœ¨ Few-shot COCO ä¸­é‡ç¾ 30-shot SOTA çµæœ

å®šç¾©æœ‰ç”¨çš„è®Šæ•¸ä¸¦ç‚ºçµæœå»ºç«‹è³‡æ–™å¤¾ï¼š



```bash
CONFIG=./dev_hongyi/new_exps/coco_fewshot_10shot_Sam2L.yaml
CLASS_SPLIT="few_shot_classes"
RESULTS_DIR=work_dirs/few_shot_results
SHOTS=30
SEED=33
GPUS=4

mkdir -p $RESULTS_DIR
FILENAME=few_shot_${SHOTS}shot_seed${SEED}.pkl
```
#### 0. å»ºç«‹åƒè€ƒé›†


```bash
python dev_hongyi/dataset/few_shot_sampling.py \
        --n-shot $SHOTS \
        --out-path ${RESULTS_DIR}/${FILENAME} \
        --seed $SEED \
        --dataset $CLASS_SPLIT
```
#### 1. ç”¨åƒè€ƒå¡«å……è¨˜æ†¶é«”


```bash
python run_lightening.py test --config $CONFIG \
                              --model.test_mode fill_memory \
                              --out_path ${RESULTS_DIR}/memory.ckpt \
                              --model.init_args.model_cfg.memory_bank_cfg.length $SHOTS \
                              --model.init_args.dataset_cfgs.fill_memory.memory_pkl ${RESULTS_DIR}/${FILENAME} \
                              --model.init_args.dataset_cfgs.fill_memory.memory_length $SHOTS \
                              --model.init_args.dataset_cfgs.fill_memory.class_split $CLASS_SPLIT \
                              --trainer.logger.save_dir ${RESULTS_DIR}/ \
                              --trainer.devices $GPUS
```
#### 2. å¾Œè™•ç†è¨˜æ†¶é«”åº«


```bash
python run_lightening.py test --config $CONFIG \
                              --model.test_mode postprocess_memory \
                              --model.init_args.model_cfg.memory_bank_cfg.length $SHOTS \
                              --ckpt_path ${RESULTS_DIR}/memory.ckpt \
                              --out_path ${RESULTS_DIR}/memory_postprocessed.ckpt \
                              --trainer.devices 1
```
#### 3. åœ¨ç›®æ¨™å½±åƒä¸Šé€²è¡Œæ¨è«–


```bash
python run_lightening.py test --config $CONFIG  \
                              --ckpt_path ${RESULTS_DIR}/memory_postprocessed.ckpt \
                              --model.init_args.test_mode test \
                              --model.init_args.model_cfg.memory_bank_cfg.length $SHOTS \
                              --model.init_args.model_cfg.dataset_name $CLASS_SPLIT \
                              --model.init_args.dataset_cfgs.test.class_split $CLASS_SPLIT \
                              --trainer.logger.save_dir ${RESULTS_DIR}/ \
                              --trainer.devices $GPUS
```
å¦‚æœæ‚¨æƒ³è¦å³æ™‚æŸ¥çœ‹æ¨è«–çµæœï¼ˆç•¶å®ƒå€‘è¢«è¨ˆç®—æ™‚ï¼‰ï¼Œè«‹å–æ¶ˆè¨»è§£ `dev_hongyi/models/Sam2MatchingBaseline_noAMG.py` ä¸­ç¬¬ 1746-1749 è¡Œ [é€™è£¡](https://github.com/miquel-espinosa/no-time-to-train/blob/main/dev_hongyi/models/Sam2MatchingBaseline_noAMG.py#L1746)ã€‚
æ ¹æ“šéœ€è¦èª¿æ•´åˆ†æ•¸é–¾å€¼ `score_thr` åƒæ•¸ï¼Œä»¥æŸ¥çœ‹æ›´å¤šæˆ–æ›´å°‘çš„åˆ†å‰²å¯¦ä¾‹ã€‚
å½±åƒå°‡æœƒè¢«å„²å­˜åœ¨ `results_analysis/few_shot_classes/`ã€‚å·¦å´çš„å½±åƒé¡¯ç¤ºçš„æ˜¯çœŸå¯¦æ¨™è¨»ï¼Œå³å´çš„å½±åƒé¡¯ç¤ºçš„æ˜¯æˆ‘å€‘ç„¡éœ€è¨“ç·´æ–¹æ³•æ‰¾åˆ°çš„åˆ†å‰²å¯¦ä¾‹ã€‚

è«‹æ³¨æ„ï¼Œåœ¨æ­¤ç¯„ä¾‹ä¸­æˆ‘å€‘ä½¿ç”¨çš„æ˜¯ `few_shot_classes` åˆ†å‰²ï¼Œå› æ­¤ï¼Œæˆ‘å€‘åªæ‡‰è©²çœ‹åˆ°è©²åˆ†å‰²ä¸­çš„é¡åˆ¥è¢«åˆ†å‰²å‡ºä¾†çš„å¯¦ä¾‹ï¼ˆè€Œä¸æ˜¯ COCO ä¸­çš„æ‰€æœ‰é¡åˆ¥ï¼‰ã€‚

#### çµæœ

åœ¨å°é©—è­‰é›†ä¸­çš„æ‰€æœ‰å½±åƒé€²è¡Œæ¨è«–å¾Œï¼Œæ‚¨æ‡‰è©²æœƒå¾—åˆ°ï¼š


```
BBOX RESULTS:
  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.368

SEGM RESULTS:
  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.342
```
---


## ğŸ” Citation

If you use this work, please cite us:

```bibtex
@article{espinosa2025notimetotrain,
  title={No time to train! Training-Free Reference-Based Instance Segmentation},
  author={Miguel Espinosa and Chenhongyi Yang and Linus Ericsson and Steven McDonagh and Elliot J. Crowley},
  journal={arXiv preprint arXiv:2507.02798},
  year={2025},
  primaryclass={cs.CV}
}
```

---

Tranlated By [Open Ai Tx](https://github.com/OpenAiTx/OpenAiTx) | Last indexed: 2025-07-22

---