<div align="right">
  <details>
    <summary >ğŸŒ Ø§Ù„Ù„ØºØ©</summary>
    <div>
      <div align="center">
        <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=en">English</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=zh-CN">ç®€ä½“ä¸­æ–‡</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=zh-TW">ç¹é«”ä¸­æ–‡</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=ja">æ—¥æœ¬èª</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=ko">í•œêµ­ì–´</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=hi">à¤¹à¤¿à¤¨à¥à¤¦à¥€</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=th">à¹„à¸—à¸¢</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=fr">FranÃ§ais</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=de">Deutsch</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=es">EspaÃ±ol</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=it">Italiano</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=ru">Ğ ÑƒÑÑĞºĞ¸Ğ¹</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=pt">PortuguÃªs</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=nl">Nederlands</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=pl">Polski</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=ar">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=fa">ÙØ§Ø±Ø³ÛŒ</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=tr">TÃ¼rkÃ§e</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=vi">Tiáº¿ng Viá»‡t</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=id">Bahasa Indonesia</a>
      </div>
    </div>
  </details>
</div>

<div align="center">

# ğŸš€ Ù„Ø§ ÙˆÙ‚Øª Ù„Ù„ØªØ¯Ø±ÙŠØ¨!
### ØªÙ‚Ø³ÙŠÙ… Ø§Ù„ÙƒØ§Ø¦Ù†Ø§Øª Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø±Ø¬Ø¹ Ø¨Ø¯ÙˆÙ† ØªØ¯Ø±ÙŠØ¨
[![GitHub](https://img.shields.io/badge/%E2%80%8B-No%20Time%20To%20Train-black?logo=github)](https://github.com/miquel-espinosa/no-time-to-train)
[![Website](https://img.shields.io/badge/ğŸŒ-Project%20Page-grey)](https://miquel-espinosa.github.io/no-time-to-train/)
[![arXiv](https://img.shields.io/badge/arXiv-2507.02798-b31b1b)](https://arxiv.org/abs/2507.02798)

**Ø£Ø­Ø¯Ø« Ù…Ø§ ØªÙˆØµÙ„Øª Ø¥Ù„ÙŠÙ‡ Ø§Ù„ØªÙ‚Ù†ÙŠØ© (Papers with Code)**

[**_Ø§Ù„Ø£ÙØ¶Ù„ ÙÙŠ Ù„Ù‚Ø·Ø© ÙˆØ§Ø­Ø¯Ø© (1-shot)_**](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-1-shot?p=no-time-to-train-training-free-reference) | [![PWC](https://img.shields.io/badge/State%20of%20the%20Art-Few--Shot%20Object%20Detection%20on%20MS--COCO%20(1--shot)-21CBCE?style=flat&logo=paperswithcode)](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-1-shot?p=no-time-to-train-training-free-reference)

[**_Ø§Ù„Ø£ÙØ¶Ù„ ÙÙŠ Ø¹Ø´Ø± Ù„Ù‚Ø·Ø§Øª (10-shot)_**](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-10-shot?p=no-time-to-train-training-free-reference) | [![PWC](https://img.shields.io/badge/State%20of%20the%20Art-Few--Shot%20Object%20Detection%20on%20MS--COCO%20(10--shot)-21CBCE?style=flat&logo=paperswithcode)](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-10-shot?p=no-time-to-train-training-free-reference)

[**_Ø§Ù„Ø£ÙØ¶Ù„ ÙÙŠ Ø«Ù„Ø§Ø«ÙŠÙ† Ù„Ù‚Ø·Ø© (30-shot)_**](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-30-shot?p=no-time-to-train-training-free-reference) | [![PWC](https://img.shields.io/badge/State%20of%20the%20Art-Few--Shot%20Object%20Detection%20on%20MS--COCO%20(30--shot)-21CBCE?style=flat&logo=paperswithcode)](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-30-shot?p=no-time-to-train-training-free-reference)

<!-- [**_SOTA 1-shot_**](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-1-shot?p=no-time-to-train-training-free-reference) | [![PWC](https://img.shields.io/endpoint.svg?url=https://paperswithcode.com/badge/no-time-to-train-training-free-reference/few-shot-object-detection-on-ms-coco-1-shot)](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-1-shot?p=no-time-to-train-training-free-reference)

[**_SOTA 10-shot_**](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-10-shot?p=no-time-to-train-training-free-reference) | [![PWC](https://img.shields.io/endpoint.svg?url=https://paperswithcode.com/badge/no-time-to-train-training-free-reference/few-shot-object-detection-on-ms-coco-10-shot)](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-10-shot?p=no-time-to-train-training-free-reference)

[**_SOTA 30-shot_**](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-30-shot?p=no-time-to-train-training-free-reference) | [![PWC](https://img.shields.io/endpoint.svg?url=https://paperswithcode.com/badge/no-time-to-train-training-free-reference/few-shot-object-detection-on-ms-coco-30-shot)](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-30-shot?p=no-time-to-train-training-free-reference) -->

</div>

---

> ğŸš¨ **ØªØ­Ø¯ÙŠØ« (22 ÙŠÙˆÙ„ÙŠÙˆ 2025):** ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© ØªØ¹Ù„ÙŠÙ…Ø§Øª Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø®ØµØµØ©!
> 
> ğŸ”” **ØªØ­Ø¯ÙŠØ« (16 ÙŠÙˆÙ„ÙŠÙˆ 2025):** ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙƒÙˆØ¯ Ù…Ø¹ Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª!

---

## ğŸ“‹ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙŠØ§Øª

- [ğŸ¯ Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ø¨Ø§Ø±Ø²Ø©](#-highlights)
- [ğŸ“œ Ø§Ù„Ù…Ù„Ø®Øµ](#-abstract)
- [ğŸ§  Ø§Ù„Ù‡ÙŠÙƒÙ„ÙŠØ©](#-architecture)
- [ğŸ› ï¸ ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„ØªØ«Ø¨ÙŠØª](#ï¸-installation-instructions)
  - [1. Ø§Ø³ØªÙ†Ø³Ø§Ø® Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹](#1-clone-the-repository)
  - [2. Ø¥Ù†Ø´Ø§Ø¡ Ø¨ÙŠØ¦Ø© conda](#2-create-conda-environment)
  - [3. ØªØ«Ø¨ÙŠØª SAM2 Ùˆ DinoV2](#3-install-sam2-and-dinov2)
  - [4. ØªØ­Ù…ÙŠÙ„ Ù…Ø¬Ù…ÙˆØ¹Ø§Øª Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª](#4-download-datasets)
  - [5. ØªØ­Ù…ÙŠÙ„ Ù†Ù‚Ø§Ø· ØªØ­Ù‚Ù‚ SAM2 Ùˆ DinoV2](#5-download-sam2-and-dinov2-checkpoints)
- [ğŸ“Š ÙƒÙˆØ¯ Ø§Ù„Ø§Ø³ØªØ¯Ù„Ø§Ù„: Ø¥Ø¹Ø§Ø¯Ø© Ø¥Ù†ØªØ§Ø¬ Ù†ØªØ§Ø¦Ø¬ SOTA ÙÙŠ 30 Ù„Ù‚Ø·Ø© Ø¹Ù„Ù‰ Few-shot COCO](#-inference-code)
  - [0. Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¬Ù…ÙˆØ¹Ø© Ù…Ø±Ø¬Ø¹ÙŠØ©](#0-create-reference-set)
  - [1. ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ø¨Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹](#1-fill-memory-with-references)
  - [2. Ù…Ø¹Ø§Ù„Ø¬Ø© Ø¨Ù†Ùƒ Ø§Ù„Ø°Ø§ÙƒØ±Ø©](#2-post-process-memory-bank)
  - [3. Ø§Ù„Ø§Ø³ØªØ¯Ù„Ø§Ù„ Ø¹Ù„Ù‰ Ø§Ù„ØµÙˆØ± Ø§Ù„Ù‡Ø¯Ù](#3-inference-on-target-images)
  - [Ø§Ù„Ù†ØªØ§Ø¦Ø¬](#results)
- [ğŸ” Ù…Ø¬Ù…ÙˆØ¹Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø®ØµØµØ©](#-custom-dataset)
  - [0. ØªØ­Ø¶ÙŠØ± Ù…Ø¬Ù…ÙˆØ¹Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø®ØµØµØ© â›µğŸ¦](#0-prepare-a-custom-dataset)
  - [0.1 Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª Ø§Ù„ØªÙˆØ¶ÙŠØ­ÙŠØ© Ù„Ù„Ø¥Ø·Ø§Ø±Ø§Øª ÙÙ‚Ø· Ù…ØªÙˆÙØ±Ø©](#01-if-only-bbox-annotations-are-available)
  - [0.2 ØªØ­ÙˆÙŠÙ„ ØªØ¹Ù„ÙŠÙ‚Ø§Øª coco Ø¥Ù„Ù‰ Ù…Ù„Ù pickle](#02-convert-coco-annotations-to-pickle-file)
  - [1. ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ø¨Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹](#1-fill-memory-with-references)
  - [2. Ù…Ø¹Ø§Ù„Ø¬Ø© Ø¨Ù†Ùƒ Ø§Ù„Ø°Ø§ÙƒØ±Ø©](#2-post-process-memory-bank)
- [ğŸ“š Ø§Ù„Ø§Ù‚ØªØ¨Ø§Ø³](#-citation)


## ğŸ¯ Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ø¨Ø§Ø±Ø²Ø©
- ğŸ’¡ **Ø¨Ø¯ÙˆÙ† ØªØ¯Ø±ÙŠØ¨**: Ù„Ø§ Ø­Ø§Ø¬Ø© Ù„Ø¶Ø¨Ø· Ø¯Ù‚ÙŠÙ‚ ÙˆÙ„Ø§ Ù‡Ù†Ø¯Ø³Ø© Ù…ÙˆØ¬Ù‡Ø§Øªâ€”ÙÙ‚Ø· ØµÙˆØ±Ø© Ù…Ø±Ø¬Ø¹ÙŠØ©.
- ğŸ–¼ï¸ **Ø§Ø³ØªÙ†Ø§Ø¯Ù‹Ø§ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø±Ø¬Ø¹**: Ù‚Ø³Ù‘Ù… Ø§Ù„ÙƒØ§Ø¦Ù†Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø£Ù…Ø«Ù„Ø© Ù‚Ù„ÙŠÙ„Ø© ÙÙ‚Ø·.
- ğŸ”¥ **Ø£Ø¯Ø§Ø¡ Ù…ØªÙ‚Ø¯Ù… (SOTA)**: ÙŠØªÙÙˆÙ‚ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø³Ø§Ù„ÙŠØ¨ Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© Ø¨Ø¯ÙˆÙ† ØªØ¯Ø±ÙŠØ¨ Ø¹Ù„Ù‰ Ù…Ø¬Ù…ÙˆØ¹Ø§Øª COCO Ùˆ PASCAL VOC Ùˆ Cross-Domain FSOD.

**Ø±ÙˆØ§Ø¨Ø·:**
- ğŸ§¾ [**ÙˆØ±Ù‚Ø© arXiv**](https://arxiv.org/abs/2507.02798)  
- ğŸŒ [**Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹**](https://miquel-espinosa.github.io/no-time-to-train/)  
- ğŸ“ˆ [**Papers with Code**](https://paperswithcode.com/paper/no-time-to-train-training-free-reference)

## ğŸ“œ Ø§Ù„Ù…Ù„Ø®Øµ


> The performance of image segmentation models has historically been constrained by the high cost of collecting large-scale annotated data. The Segment Anything Model (SAM) alleviates this original problem through a promptable, semantics-agnostic, segmentation paradigm and yet still requires manual visual-prompts or complex domain-dependent prompt-generation rules to process a new image. Towards reducing this new burden, our work investigates the task of object segmentation when provided with, alternatively, only a small set of reference images. Our key insight is to leverage strong semantic priors, as learned by foundation models, to identify corresponding regions between a reference and a target image. We find that correspondences enable automatic generation of instance-level segmentation masks for downstream tasks and instantiate our ideas via a multi-stage, training-free method incorporating (1) memory bank construction; (2) representation aggregation and (3) semantic-aware feature matching. Our experiments show significant improvements on segmentation metrics, leading to state-of-the-art performance on COCO FSOD (36.8% nAP), PASCAL VOC Few-Shot (71.2% nAP50) and outperforming existing training-free approaches on the Cross-Domain FSOD benchmark (22.4% nAP).

![cdfsod-results-final-comic-sans-min](https://github.com/user-attachments/assets/ab302c02-c080-4042-99fc-0e181ba8abb9)


## ğŸ§  Architecture

![training-free-architecture-comic-sans-min](https://github.com/user-attachments/assets/d84dd83a-505e-45a0-8ce3-98e1838017f9)


## ğŸ› ï¸ Installation instructions

### 1. Clone the repository

```bash
git clone https://github.com/miquel-espinosa/no-time-to-train.git
cd no-time-to-train
```
### Ù¢. Ø¥Ù†Ø´Ø§Ø¡ Ø¨ÙŠØ¦Ø© ÙƒÙˆÙ†Ø¯Ø§

Ø³Ù†Ù‚ÙˆÙ… Ø¨Ø¥Ù†Ø´Ø§Ø¡ Ø¨ÙŠØ¦Ø© ÙƒÙˆÙ†Ø¯Ø§ Ù…Ø¹ Ø§Ù„Ø­Ø²Ù… Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©.

```bash
conda env create -f environment.yml
conda activate no-time-to-train
```
### 3. ØªØ«Ø¨ÙŠØª SAM2 Ùˆ DinoV2

Ø³ÙˆÙ Ù†Ù‚ÙˆÙ… Ø¨ØªØ«Ø¨ÙŠØª SAM2 Ùˆ DinoV2 Ù…Ù† Ø§Ù„Ù…ØµØ¯Ø±.

```bash
pip install -e .
cd dinov2
pip install -e .
cd ..
```
### 4. ØªÙ†Ø²ÙŠÙ„ Ù…Ø¬Ù…ÙˆØ¹Ø§Øª Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª

ÙŠØ±Ø¬Ù‰ ØªÙ†Ø²ÙŠÙ„ Ù…Ø¬Ù…ÙˆØ¹Ø© Ø¨ÙŠØ§Ù†Ø§Øª COCO ÙˆÙˆØ¶Ø¹Ù‡Ø§ ÙÙŠ `data/coco`

### 5. ØªÙ†Ø²ÙŠÙ„ Ù†Ù‚Ø§Ø· Ø§Ù„ØªØ­Ù‚Ù‚ Ù„Ù€ SAM2 Ùˆ DinoV2

Ø³Ù†Ù‚ÙˆÙ… Ø¨ØªÙ†Ø²ÙŠÙ„ Ù†Ù‚Ø§Ø· Ø§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ø®Ø§ØµØ© Ø¨Ù€ SAM2 Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø© ÙÙŠ Ø§Ù„ÙˆØ±Ù‚Ø© Ø§Ù„Ø¨Ø­Ø«ÙŠØ© Ø¨Ø§Ù„Ø¶Ø¨Ø·.
(ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø§Ø­Ø¸Ø© Ø£Ù† Ù†Ù‚Ø§Ø· Ø§Ù„ØªØ­Ù‚Ù‚ SAM2.1 Ù…ØªÙˆÙØ±Ø© Ø¨Ø§Ù„ÙØ¹Ù„ ÙˆÙ‚Ø¯ ØªØ¤Ø¯ÙŠ Ø¨Ø´ÙƒÙ„ Ø£ÙØ¶Ù„.)


```bash
mkdir -p checkpoints/dinov2
cd checkpoints
wget https://dl.fbaipublicfiles.com/segment_anything_2/072824/sam2_hiera_large.pt
cd dinov2
wget https://dl.fbaipublicfiles.com/dinov2/dinov2_vitl14/dinov2_vitl14_pretrain.pth
cd ../..
```
## ğŸ“Š ÙƒÙˆØ¯ Ø§Ù„Ø§Ø³ØªØ¯Ù„Ø§Ù„

âš ï¸ Ø¥Ø®Ù„Ø§Ø¡ Ù…Ø³Ø¤ÙˆÙ„ÙŠØ©: Ù‡Ø°Ø§ ÙƒÙˆØ¯ Ø¨Ø­Ø«ÙŠ â€” ØªÙˆÙ‚Ø¹ Ø¨Ø¹Ø¶ Ø§Ù„ÙÙˆØ¶Ù‰!

### Ø¥Ø¹Ø§Ø¯Ø© Ø¥Ù†ØªØ§Ø¬ Ù†ØªØ§Ø¦Ø¬ SOTA Ø¨Ø¹Ø¯Ø¯ 30 Ù„Ù‚Ø·Ø© ÙÙŠ Few-shot COCO

Ù‚Ù… Ø¨ØªØ¹Ø±ÙŠÙ Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ù…ÙÙŠØ¯Ø© ÙˆØ£Ù†Ø´Ø¦ Ù…Ø¬Ù„Ø¯Ù‹Ø§ Ù„Ù„Ù†ØªØ§Ø¦Ø¬:



```bash
CONFIG=./no_time_to_train/new_exps/coco_fewshot_10shot_Sam2L.yaml
CLASS_SPLIT="few_shot_classes"
RESULTS_DIR=work_dirs/few_shot_results
SHOTS=30
SEED=33
GPUS=4

mkdir -p $RESULTS_DIR
FILENAME=few_shot_${SHOTS}shot_seed${SEED}.pkl
```
#### 0. Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¬Ù…ÙˆØ¹Ø© Ù…Ø±Ø¬Ø¹ÙŠØ©


```bash
python no_time_to_train/dataset/few_shot_sampling.py \
        --n-shot $SHOTS \
        --out-path ${RESULTS_DIR}/${FILENAME} \
        --seed $SEED \
        --dataset $CLASS_SPLIT
```
#### 1. Ø§Ù…Ù„Ø£ Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ø¨Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹


```bash
python run_lightening.py test --config $CONFIG \
                              --model.test_mode fill_memory \
                              --out_path ${RESULTS_DIR}/memory.ckpt \
                              --model.init_args.model_cfg.memory_bank_cfg.length $SHOTS \
                              --model.init_args.dataset_cfgs.fill_memory.memory_pkl ${RESULTS_DIR}/${FILENAME} \
                              --model.init_args.dataset_cfgs.fill_memory.memory_length $SHOTS \
                              --model.init_args.dataset_cfgs.fill_memory.class_split $CLASS_SPLIT \
                              --trainer.logger.save_dir ${RESULTS_DIR}/ \
                              --trainer.devices $GPUS
```
#### 2. Ù…Ø¹Ø§Ù„Ø¬Ø© Ù„Ø§Ø­Ù‚Ø© Ù„Ø¨Ù†Ùƒ Ø§Ù„Ø°Ø§ÙƒØ±Ø©


```bash
python run_lightening.py test --config $CONFIG \
                              --model.test_mode postprocess_memory \
                              --model.init_args.model_cfg.memory_bank_cfg.length $SHOTS \
                              --ckpt_path ${RESULTS_DIR}/memory.ckpt \
                              --out_path ${RESULTS_DIR}/memory_postprocessed.ckpt \
                              --trainer.devices 1
```
#### 3. Ø§Ù„Ø§Ø³ØªØ¯Ù„Ø§Ù„ Ø¹Ù„Ù‰ Ø§Ù„ØµÙˆØ± Ø§Ù„Ù‡Ø¯Ù


```bash
python run_lightening.py test --config $CONFIG  \
                              --ckpt_path ${RESULTS_DIR}/memory_postprocessed.ckpt \
                              --model.init_args.test_mode test \
                              --model.init_args.model_cfg.memory_bank_cfg.length $SHOTS \
                              --model.init_args.model_cfg.dataset_name $CLASS_SPLIT \
                              --model.init_args.dataset_cfgs.test.class_split $CLASS_SPLIT \
                              --trainer.logger.save_dir ${RESULTS_DIR}/ \
                              --trainer.devices $GPUS
```
Ø¥Ø°Ø§ ÙƒÙ†Øª ØªØ±ØºØ¨ ÙÙŠ Ù…Ø´Ø§Ù‡Ø¯Ø© Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø§Ø³ØªØ¯Ù„Ø§Ù„ Ù…Ø¨Ø§Ø´Ø±Ø© Ø¹Ø¨Ø± Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª (Ø£Ø«Ù†Ø§Ø¡ Ø­Ø³Ø§Ø¨Ù‡Ø§)ØŒ Ù‚Ù… Ø¨Ø¥Ù„ØºØ§Ø¡ ØªØ¹Ù„ÙŠÙ‚ Ø§Ù„Ø£Ø³Ø·Ø± 1746-1749 ÙÙŠ Ø§Ù„Ù…Ù„Ù `no_time_to_train/models/Sam2MatchingBaseline_noAMG.py` [Ù‡Ù†Ø§](https://github.com/miquel-espinosa/no-time-to-train/blob/main/no_time_to_train/models/Sam2MatchingBaseline_noAMG.py#L1746).
Ù‚Ù… Ø¨Ø¶Ø¨Ø· Ù…Ø¹Ù„Ù…Ø© Ø­Ø¯ Ø§Ù„Ø¯Ø±Ø¬Ø© `score_thr` Ø­Ø³Ø¨ Ø§Ù„Ø­Ø§Ø¬Ø© Ù„Ø±Ø¤ÙŠØ© Ø§Ù„Ù…Ø²ÙŠØ¯ Ø£Ùˆ Ø§Ù„Ù‚Ù„ÙŠÙ„ Ù…Ù† Ø§Ù„ÙƒØ§Ø¦Ù†Ø§Øª Ø§Ù„Ù…ÙØ¬Ø²Ø£Ø©.
Ø³ÙŠØªÙ… Ø§Ù„Ø¢Ù† Ø­ÙØ¸ Ø§Ù„ØµÙˆØ± ÙÙŠ Ø§Ù„Ù…Ø¬Ù„Ø¯ `results_analysis/few_shot_classes/`. Ø§Ù„ØµÙˆØ±Ø© Ø¹Ù„Ù‰ Ø§Ù„ÙŠØ³Ø§Ø± ØªØ¹Ø±Ø¶ Ø§Ù„Ø­Ù‚ÙŠÙ‚Ø© Ø§Ù„Ø£Ø±Ø¶ÙŠØ©ØŒ ÙˆØ§Ù„ØµÙˆØ±Ø© Ø¹Ù„Ù‰ Ø§Ù„ÙŠÙ…ÙŠÙ† ØªØ¹Ø±Ø¶ Ø§Ù„ÙƒØ§Ø¦Ù†Ø§Øª Ø§Ù„Ù…ÙØ¬Ø²Ø£Ø© Ø§Ù„ØªÙŠ ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„ÙŠÙ‡Ø§ Ø¨ÙˆØ§Ø³Ø·Ø© Ø·Ø±ÙŠÙ‚ØªÙ†Ø§ Ø§Ù„Ø®Ø§Ù„ÙŠØ© Ù…Ù† Ø§Ù„ØªØ¯Ø±ÙŠØ¨.

Ù„Ø§Ø­Ø¸ Ø£Ù†Ù‡ ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø«Ø§Ù„ Ù†Ø³ØªØ®Ø¯Ù… ØªÙ‚Ø³ÙŠÙ…Ø© `few_shot_classes`ØŒ Ù„Ø°Ø§ ÙŠØ¬Ø¨ Ø£Ù† Ù†ØªÙˆÙ‚Ø¹ ÙÙ‚Ø· Ø±Ø¤ÙŠØ© ÙƒØ§Ø¦Ù†Ø§Øª Ù…ÙØ¬Ø²Ø£Ø© Ù…Ù† Ø§Ù„ÙØ¦Ø§Øª Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø© ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„ØªÙ‚Ø³ÙŠÙ…Ø© (ÙˆÙ„ÙŠØ³ Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙØ¦Ø§Øª ÙÙŠ COCO).

#### Ø§Ù„Ù†ØªØ§Ø¦Ø¬

Ø¨Ø¹Ø¯ ØªØ´ØºÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙˆØ± ÙÙŠ Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„ØªØ­Ù‚Ù‚ØŒ ÙŠØ¬Ø¨ Ø£Ù† ØªØ­ØµÙ„ Ø¹Ù„Ù‰:


```
BBOX RESULTS:
  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.368

SEGM RESULTS:
  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.342
```
---

## ğŸ” Ù…Ø¬Ù…ÙˆØ¹Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø®ØµØµØ©

Ù†Ø­Ù† Ù†ÙˆÙØ± Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª Ù„ØªØ´ØºÙŠÙ„ Ø®Ø· Ø§Ù„Ø£Ù†Ø§Ø¨ÙŠØ¨ Ø§Ù„Ø®Ø§Øµ Ø¨Ù†Ø§ Ø¹Ù„Ù‰ Ù…Ø¬Ù…ÙˆØ¹Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø®ØµØµØ©. ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª Ø§Ù„ØªÙˆØ¶ÙŠØ­ÙŠØ© Ø¯Ø§Ø¦Ù…Ù‹Ø§ Ø¨ØªÙ†Ø³ÙŠÙ‚ COCO.

> **Ø¨Ø§Ø®ØªØµØ§Ø±Ø›** Ù„Ø±Ø¤ÙŠØ© ÙƒÙŠÙÙŠØ© ØªØ´ØºÙŠÙ„ Ø®Ø· Ø§Ù„Ø£Ù†Ø§Ø¨ÙŠØ¨ Ø§Ù„ÙƒØ§Ù…Ù„ Ø¹Ù„Ù‰ *Ù…Ø¬Ù…ÙˆØ¹Ø§Øª Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø®ØµØµØ©* Ù…Ø¨Ø§Ø´Ø±Ø©Ù‹ØŒ Ø§Ø¨Ø­Ø« Ø¹Ù† `scripts/matching_cdfsod_pipeline.sh` Ù…Ø¹ Ø£Ù…Ø«Ù„Ø© Ù„Ø¨Ø±Ø§Ù…Ø¬ Ù…Ø¬Ù…ÙˆØ¹Ø§Øª Ø¨ÙŠØ§Ù†Ø§Øª CD-FSOD (Ù…Ø«Ù„ `scripts/dior_fish.sh`)

### 0. ØªØ¬Ù‡ÙŠØ² Ù…Ø¬Ù…ÙˆØ¹Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø®ØµØµØ© â›µğŸ¦

Ù„Ù†ØªØ®ÙŠÙ„ Ø£Ù†Ù†Ø§ Ù†Ø±ÙŠØ¯ Ø§ÙƒØªØ´Ø§Ù **Ø§Ù„Ù‚ÙˆØ§Ø±Ø¨**â›µ Ùˆ**Ø§Ù„Ø·ÙŠÙˆØ±**ğŸ¦ ÙÙŠ Ù…Ø¬Ù…ÙˆØ¹Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø®ØµØµØ©. Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø·Ø±ÙŠÙ‚ØªÙ†Ø§ Ø³Ù†Ø­ØªØ§Ø¬ Ø¥Ù„Ù‰:
- ØµÙˆØ±Ø© Ù…Ø±Ø¬Ø¹ÙŠØ© *Ù…Ø´Ø±ÙˆØ­Ø©* ÙˆØ§Ø­Ø¯Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ Ù„ÙƒÙ„ ÙØ¦Ø© (Ø£ÙŠ ØµÙˆØ±Ø© Ù…Ø±Ø¬Ø¹ÙŠØ© ÙˆØ§Ø­Ø¯Ø© Ù„Ù„Ù‚Ø§Ø±Ø¨ ÙˆØµÙˆØ±Ø© Ù…Ø±Ø¬Ø¹ÙŠØ© ÙˆØ§Ø­Ø¯Ø© Ù„Ù„Ø·Ø§Ø¦Ø±)
- Ø¹Ø¯Ø© ØµÙˆØ± Ù‡Ø¯Ù Ù„Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø£Ù…Ø«Ù„Ø© Ù„Ù„ÙØ¦Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©.

Ù„Ù‚Ø¯ Ø£Ø¹Ø¯Ø¯Ù†Ø§ Ø¨Ø±Ù†Ø§Ù…Ø¬Ù‹Ø§ Ù…Ø¨Ø³Ø·Ù‹Ø§ Ù„Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¬Ù…ÙˆØ¹Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø®ØµØµØ© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… ØµÙˆØ± cocoØŒ Ù„Ø¥Ø¹Ø¯Ø§Ø¯ **Ù„Ù‚Ø·Ø© ÙˆØ§Ø­Ø¯Ø©**.
```bash
python scripts/make_custom_dataset.py
```
Ø³ÙŠØ¤Ø¯ÙŠ Ù‡Ø°Ø§ Ø¥Ù„Ù‰ Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¬Ù…ÙˆØ¹Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø®ØµØµØ© Ø¨Ø§Ù„Ù‡ÙŠÙƒÙ„ÙŠØ© Ø§Ù„ØªØ§Ù„ÙŠØ© Ù„Ù„Ù…Ø¬Ù„Ø¯Ø§Øª:
```
data/my_custom_dataset/
    â”œâ”€â”€ annotations/
    â”‚   â”œâ”€â”€ custom_references.json
    â”‚   â”œâ”€â”€ custom_targets.json
    â”‚   â””â”€â”€ references_visualisations/
    â”‚       â”œâ”€â”€ bird_1.jpg
    â”‚       â””â”€â”€ boat_1.jpg
    â””â”€â”€ images/
        â”œâ”€â”€ 429819.jpg
        â”œâ”€â”€ 101435.jpg
        â””â”€â”€ (all target and reference images)
```
**ØªØµÙˆÙŠØ± ØµÙˆØ± Ø§Ù„Ù…Ø±Ø¬Ø¹ (Ù„Ù‚Ø·Ø© ÙˆØ§Ø­Ø¯Ø©):**

| ØµÙˆØ±Ø© Ù…Ø±Ø¬Ø¹ÙŠØ© ÙˆØ§Ø­Ø¯Ø© Ù„Ù„Ø·Ø§Ø¦Ø± ğŸ¦ | ØµÙˆØ±Ø© Ù…Ø±Ø¬Ø¹ÙŠØ© ÙˆØ§Ø­Ø¯Ø© Ù„Ù„Ù‚Ø§Ø±Ø¨ â›µ |
|:-----------------------------:|:-------------------------------:|
| <img src="https://github.com/user-attachments/assets/e59e580d-a7db-42ac-b386-892af211fc85" alt="bird_1" width="500"/> | <img src="https://github.com/user-attachments/assets/f94ee025-ae37-4a45-9c3e-0cfe8f8cd2bc" alt="boat_1" width="500"/> |


### 0.1 Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª Ø§Ù„ØªÙˆØ¶ÙŠØ­ÙŠØ© Ù„Ù„Ø¥Ø·Ø§Ø± Ø§Ù„Ù…Ø­ÙŠØ· ÙÙ‚Ø· Ù…ØªÙˆÙØ±Ø©

Ù†Ø­Ù† Ù†ÙˆÙØ± Ø£ÙŠØ¶Ù‹Ø§ Ù†ØµÙ‹Ø§ Ø¨Ø±Ù…Ø¬ÙŠÙ‹Ø§ Ù„ØªÙˆÙ„ÙŠØ¯ Ø£Ù‚Ù†Ø¹Ø© ØªÙ‚Ø³ÙŠÙ… Ø¹Ù„Ù‰ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ÙƒØ§Ø¦Ù† Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… SAM2. Ù‡Ø°Ø§ Ù…ÙÙŠØ¯ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù„Ø¯ÙŠÙƒ ÙÙ‚Ø· ØªØ¹Ù„ÙŠÙ‚Ø§Øª ØªÙˆØ¶ÙŠØ­ÙŠØ© Ù„Ù„Ø¥Ø·Ø§Ø± Ø§Ù„Ù…Ø­ÙŠØ· Ù„Ù„ØµÙˆØ± Ø§Ù„Ù…Ø±Ø¬Ø¹ÙŠØ©.


```bash
# Download sam_h checkpoint. Feel free to use more recent checkpoints (note: code might need to be adapted)
wget https://dl.fbaipublicfiles.com/segment_anything/sam_vit_h_4b8939.pth -O checkpoints/sam_vit_h_4b8939.pth
# Run automatic instance segmentation from ground truth bounding boxes.
python no_time_to_train/dataset/sam_bbox_to_segm_batch.py \
    --input_json data/my_custom_dataset/annotations/custom_references.json \
    --image_dir data/my_custom_dataset/images \
    --sam_checkpoint checkpoints/sam_vit_h_4b8939.pth \
    --model_type vit_h \
    --device cuda \
    --batch_size 8 \
    --visualize
```
**ØµÙˆØ± Ù…Ø±Ø¬Ø¹ÙŠØ© Ù…Ø¹ Ø£Ù‚Ù†Ø¹Ø© Ø§Ù„ØªÙ‚Ø³ÙŠÙ… Ø¹Ù„Ù‰ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ÙƒØ§Ø¦Ù† (ØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡Ø§ Ø¨ÙˆØ§Ø³Ø·Ø© SAM2 Ù…Ù† Ù…Ø±Ø¨Ø¹Ø§Øª Ø§Ù„Ø¥Ø­Ø§Ø·Ø© Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©ØŒ Ù„Ù‚Ø·Ø© ÙˆØ§Ø­Ø¯Ø©):**

ØªÙ… Ø­ÙØ¸ ØªØµÙˆÙ‘Ø± Ø£Ù‚Ù†Ø¹Ø© Ø§Ù„ØªÙ‚Ø³ÙŠÙ… Ø§Ù„Ù…ÙÙˆÙ„Ø¯Ø© ÙÙŠ `data/my_custom_dataset/annotations/custom_references_with_SAM_segm/references_visualisations/`.

| ØµÙˆØ±Ø© Ù…Ø±Ø¬Ø¹ÙŠØ© Ø¨Ù„Ù‚Ø·Ø© ÙˆØ§Ø­Ø¯Ø© Ù„Ø¹ØµÙÙˆØ± ğŸ¦ (ØªÙ… ØªÙ‚Ø³ÙŠÙ…Ù‡Ø§ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¨ÙˆØ§Ø³Ø·Ø© SAM) | ØµÙˆØ±Ø© Ù…Ø±Ø¬Ø¹ÙŠØ© Ø¨Ù„Ù‚Ø·Ø© ÙˆØ§Ø­Ø¯Ø© Ù„Ù‚Ø§Ø±Ø¨ â›µ (ØªÙ… ØªÙ‚Ø³ÙŠÙ…Ù‡Ø§ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¨ÙˆØ§Ø³Ø·Ø© SAM) |
|:---------------------------------:|:----------------------------------:|
| <img src="https://github.com/user-attachments/assets/65d38dc4-1454-43cd-9600-e8efc67b3a82" alt="bird_1_with_SAM_segm" width="500"/> | <img src="https://github.com/user-attachments/assets/43a558ad-50ca-4715-8285-9aa3268843c6" alt="boat_1_with_SAM_segm" width="500"/> |


### 0.2 ØªØ­ÙˆÙŠÙ„ ØªØ¹Ù„ÙŠÙ‚Ø§Øª coco Ø¥Ù„Ù‰ Ù…Ù„Ù pickle



```bash
python no_time_to_train/dataset/coco_to_pkl.py \
    data/my_custom_dataset/annotations/custom_references_with_segm.json \
    data/my_custom_dataset/annotations/custom_references_with_segm.pkl \
    1
```
### 1. Ù…Ù„Ø¡ Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ø¨Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹

Ø£ÙˆÙ„Ø§Ù‹ØŒ Ù‚Ù… Ø¨ØªØ¹Ø±ÙŠÙ Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ù…ÙÙŠØ¯Ø© ÙˆØ£Ù†Ø´Ø¦ Ù…Ø¬Ù„Ø¯Ù‹Ø§ Ù„Ù„Ù†ØªØ§Ø¦Ø¬. Ù…Ù† Ø£Ø¬Ù„ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„ØµØ­ÙŠØ­ Ù„Ù„ØªØ³Ù…ÙŠØ§ØªØŒ ÙŠØ¬Ø¨ ØªØ±ØªÙŠØ¨ Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„ÙØ¦Ø§Øª Ø­Ø³Ø¨ Ù…Ø¹Ø±Ù Ø§Ù„ÙØ¦Ø© ÙƒÙ…Ø§ ÙŠØ¸Ù‡Ø± ÙÙŠ Ù…Ù„Ù json. Ø¹Ù„Ù‰ Ø³Ø¨ÙŠÙ„ Ø§Ù„Ù…Ø«Ø§Ù„ØŒ Ø§Ù„ÙØ¦Ø© `bird` Ù„Ù‡Ø§ Ù…Ø¹Ø±Ù ÙØ¦Ø© `16`ØŒ ÙˆØ§Ù„ÙØ¦Ø© `boat` Ù„Ù‡Ø§ Ù…Ø¹Ø±Ù ÙØ¦Ø© `9`. Ù„Ø°Ø§ØŒ ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† `CAT_NAMES=boat,bird`.


```bash
DATASET_NAME=my_custom_dataset
DATASET_PATH=data/my_custom_dataset
CAT_NAMES=boat,bird
CATEGORY_NUM=2
SHOT=1
YAML_PATH=no_time_to_train/pl_configs/matching_cdfsod_template.yaml
PATH_TO_SAVE_CKPTS=./tmp_ckpts/my_custom_dataset
mkdir -p $PATH_TO_SAVE_CKPTS
```
Ù‚Ù… Ø¨ØªÙ†ÙÙŠØ° Ø§Ù„Ø®Ø·ÙˆØ© 1:

```bash
python run_lightening.py test --config $YAML_PATH \
    --model.test_mode fill_memory \
    --out_path $PATH_TO_SAVE_CKPTS/$DATASET_NAME\_$SHOT\_refs_memory.pth \
    --model.init_args.dataset_cfgs.fill_memory.root $DATASET_PATH/images \
    --model.init_args.dataset_cfgs.fill_memory.json_file $DATASET_PATH/annotations/custom_references_with_segm.json \
    --model.init_args.dataset_cfgs.fill_memory.memory_pkl $DATASET_PATH/annotations/custom_references_with_segm.pkl \
    --model.init_args.dataset_cfgs.fill_memory.memory_length $SHOT \
    --model.init_args.dataset_cfgs.fill_memory.cat_names $CAT_NAMES \
    --model.init_args.model_cfg.dataset_name $DATASET_NAME \
    --model.init_args.model_cfg.memory_bank_cfg.length $SHOT \
    --model.init_args.model_cfg.memory_bank_cfg.category_num $CATEGORY_NUM \
    --trainer.devices 1
```
### 2. Ø¨Ù†Ùƒ Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©


```bash
python run_lightening.py test --config $YAML_PATH \
    --model.test_mode postprocess_memory \
    --ckpt_path $PATH_TO_SAVE_CKPTS/$DATASET_NAME\_$SHOT\_refs_memory.pth \
    --out_path $PATH_TO_SAVE_CKPTS/$DATASET_NAME\_$SHOT\_refs_memory_postprocessed.pth \
    --model.init_args.model_cfg.dataset_name $DATASET_NAME \
    --model.init_args.model_cfg.memory_bank_cfg.length $SHOT \
    --model.init_args.model_cfg.memory_bank_cfg.category_num $CATEGORY_NUM \
    --trainer.devices 1
```
### 3. Ø§Ù„Ø§Ø³ØªØ¯Ù„Ø§Ù„ Ø¹Ù„Ù‰ Ø§Ù„ØµÙˆØ± Ø§Ù„Ù‡Ø¯Ù

Ø¥Ø°Ø§ ØªÙ… ØªØ¹ÙŠÙŠÙ† `ONLINE_VIS` Ø¥Ù„Ù‰ TrueØŒ Ø³ÙŠØªÙ… Ø­ÙØ¸ Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªÙ†Ø¨Ø¤ ÙÙŠ `results_analysis/my_custom_dataset/` ÙˆØ¹Ø±Ø¶Ù‡Ø§ Ø£Ø«Ù†Ø§Ø¡ Ø­Ø³Ø§Ø¨Ù‡Ø§. Ù…Ù„Ø§Ø­Ø¸Ø©: Ø§Ù„ØªØ´ØºÙŠÙ„ Ù…Ø¹ Ø§Ù„ØªØµÙˆØ± Ø§Ù„Ù„Ø­Ø¸ÙŠ Ø£Ø¨Ø·Ø£ Ø¨ÙƒØ«ÙŠØ±.

ÙŠÙ…ÙƒÙ†Ùƒ ØªØºÙŠÙŠØ± Ø¹ØªØ¨Ø© Ø§Ù„Ø¯Ø±Ø¬Ø§Øª `VIS_THR` Ù„Ø±Ø¤ÙŠØ© Ø§Ù„Ù…Ø²ÙŠØ¯ Ø£Ùˆ Ø§Ù„Ù‚Ù„ÙŠÙ„ Ù…Ù† Ø§Ù„ÙƒØ§Ø¦Ù†Ø§Øª Ø§Ù„Ù…Ù‚Ø³Ù…Ø©.

```bash
ONLINE_VIS=True
VIS_THR=0.4
python run_lightening.py test --config $YAML_PATH \
    --model.test_mode test \
    --ckpt_path $PATH_TO_SAVE_CKPTS/$DATASET_NAME\_$SHOT\_refs_memory_postprocessed.pth \
    --model.init_args.model_cfg.dataset_name $DATASET_NAME \
    --model.init_args.model_cfg.memory_bank_cfg.length $SHOT \
    --model.init_args.model_cfg.memory_bank_cfg.category_num $CATEGORY_NUM \
    --model.init_args.model_cfg.test.imgs_path $DATASET_PATH/images \
    --model.init_args.model_cfg.test.online_vis $ONLINE_VIS \
    --model.init_args.model_cfg.test.vis_thr $VIS_THR \
    --model.init_args.dataset_cfgs.test.root $DATASET_PATH/images \
    --model.init_args.dataset_cfgs.test.json_file $DATASET_PATH/annotations/custom_targets.json \
    --model.init_args.dataset_cfgs.test.cat_names $CAT_NAMES \
    --trainer.devices 1
```
### Ø§Ù„Ù†ØªØ§Ø¦Ø¬

ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ù…Ù‚Ø§ÙŠÙŠØ³ Ø§Ù„Ø£Ø¯Ø§Ø¡ (Ø¨Ù†ÙØ³ Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø© ÙÙŠ Ø§Ù„Ø£ÙˆØ§Ù…Ø± Ø£Ø¹Ù„Ø§Ù‡) ÙƒÙ…Ø§ ÙŠÙ„ÙŠ:


```
BBOX RESULTS:
  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.478

SEGM RESULTS:
  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.458
```
ÙŠØªÙ… Ø­ÙØ¸ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù…Ø±Ø¦ÙŠØ© ÙÙŠ `results_analysis/my_custom_dataset/`. Ù„Ø§Ø­Ø¸ Ø£Ù† Ø·Ø±ÙŠÙ‚ØªÙ†Ø§ ØªØ¹Ù…Ù„ Ù…Ø¹ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø³Ù„Ø¨ÙŠØ© Ø§Ù„ÙƒØ§Ø°Ø¨Ø©ØŒ Ø£ÙŠ Ø§Ù„ØµÙˆØ± Ø§Ù„ØªÙŠ Ù„Ø§ ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø£ÙŠ Ø£Ù…Ø«Ù„Ø© Ù…Ù† Ø§Ù„ÙØ¦Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©.

*Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„ØµÙˆØ± Ù„Ù„ØªÙƒØ¨ÙŠØ± â¬‡ï¸*

| ØµÙˆØ±Ø© Ø§Ù„Ù‡Ø¯Ù Ù…Ø¹ Ø§Ù„Ù‚ÙˆØ§Ø±Ø¨ â›µ (ÙŠØ³Ø§Ø± GTØŒ ÙŠÙ…ÙŠÙ† Ø§Ù„ØªÙˆÙ‚Ø¹Ø§Øª) | ØµÙˆØ±Ø© Ø§Ù„Ù‡Ø¯Ù Ù…Ø¹ Ø§Ù„Ø·ÙŠÙˆØ± ğŸ¦ (ÙŠØ³Ø§Ø± GTØŒ ÙŠÙ…ÙŠÙ† Ø§Ù„ØªÙˆÙ‚Ø¹Ø§Øª) |
|:----------------------:|:----------------------:|
| ![000000459673](https://github.com/user-attachments/assets/678dc15a-dd3b-49d5-9287-6290da16aa6b) | ![000000407180](https://github.com/user-attachments/assets/fe306e48-af49-4d83-ac82-76fac6c456d1) |

| ØµÙˆØ±Ø© Ø§Ù„Ù‡Ø¯Ù Ù…Ø¹ Ø§Ù„Ù‚ÙˆØ§Ø±Ø¨ ÙˆØ§Ù„Ø·ÙŠÙˆØ± â›µğŸ¦ (ÙŠØ³Ø§Ø± GTØŒ ÙŠÙ…ÙŠÙ† Ø§Ù„ØªÙˆÙ‚Ø¹Ø§Øª) | ØµÙˆØ±Ø© Ø§Ù„Ù‡Ø¯Ù Ø¨Ø¯ÙˆÙ† Ù‚ÙˆØ§Ø±Ø¨ Ø£Ùˆ Ø·ÙŠÙˆØ± ğŸš« (ÙŠØ³Ø§Ø± GTØŒ ÙŠÙ…ÙŠÙ† Ø§Ù„ØªÙˆÙ‚Ø¹Ø§Øª) |
|:---------------------------------:|:----------------------------------:|
| ![000000517410](https://github.com/user-attachments/assets/9849b227-7f43-43d7-81ea-58010a623ad5) | ![000000460598](https://github.com/user-attachments/assets/7587700c-e09d-4cf6-8590-3df129c2568e) |


## ğŸ“š Ø§Ù„Ø§Ù‚ØªØ¨Ø§Ø³

Ø¥Ø°Ø§ Ø§Ø³ØªØ®Ø¯Ù…Øª Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù…Ù„ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ø³ØªØ´Ù‡Ø§Ø¯ Ø¨Ù†Ø§:


```bibtex
@article{espinosa2025notimetotrain,
  title={No time to train! Training-Free Reference-Based Instance Segmentation},
  author={Miguel Espinosa and Chenhongyi Yang and Linus Ericsson and Steven McDonagh and Elliot J. Crowley},
  journal={arXiv preprint arXiv:2507.02798},
  year={2025},
  primaryclass={cs.CV}
}
```


---

Tranlated By [Open Ai Tx](https://github.com/OpenAiTx/OpenAiTx) | Last indexed: 2025-07-24

---