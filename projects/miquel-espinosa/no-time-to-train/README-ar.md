<div align="right">
  <details>
    <summary >๐ ุงููุบุฉ</summary>
    <div>
      <div align="center">
        <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=en">English</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=zh-CN">็ฎไฝไธญๆ</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=zh-TW">็น้ซไธญๆ</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=ja">ๆฅๆฌ่ช</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=ko">ํ๊ตญ์ด</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=hi">เคนเคฟเคจเฅเคฆเฅ</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=th">เนเธเธข</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=fr">Franรงais</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=de">Deutsch</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=es">Espaรฑol</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=it">Italiano</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=ru">ะัััะบะธะน</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=pt">Portuguรชs</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=nl">Nederlands</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=pl">Polski</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=ar">ุงูุนุฑุจูุฉ</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=fa">ูุงุฑุณ</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=tr">Tรผrkรงe</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=vi">Tiแบฟng Viแปt</a>
        | <a href="https://openaitx.github.io/view.html?user=miquel-espinosa&project=no-time-to-train&lang=id">Bahasa Indonesia</a>
      </div>
    </div>
  </details>
</div>

<div align="center">

# ๐ ูุง ููุช ููุชุฏุฑูุจ!  
### ุงูุชูุณูู ุงูููุฑู ููุนููุงุช ุงููุณุชูุฏ ุฅูู ุงููุฑุฌุน ุจุฏูู ุชุฏุฑูุจ  
[![GitHub](https://img.shields.io/badge/%E2%80%8B-No%20Time%20To%20Train-black?logo=github)](https://github.com/miquel-espinosa/no-time-to-train)
[![Website](https://img.shields.io/badge/๐-Project%20Page-grey)](https://miquel-espinosa.github.io/no-time-to-train/)
[![arXiv](https://img.shields.io/badge/arXiv-2507.02798-b31b1b)](https://arxiv.org/abs/2507.02798)

**ุฃุญุฏุซ ุงููุชุงุฆุฌ (Papers with Code)**

[**_ุงูุฃูุถู ูู ูุฆุฉ 1-shot_**](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-1-shot?p=no-time-to-train-training-free-reference) | [![PWC](https://img.shields.io/endpoint.svg?url=https://paperswithcode.com/badge/no-time-to-train-training-free-reference/few-shot-object-detection-on-ms-coco-1-shot)](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-1-shot?p=no-time-to-train-training-free-reference)

[**_ุงูุฃูุถู ูู ูุฆุฉ 10-shot_**](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-10-shot?p=no-time-to-train-training-free-reference) | [![PWC](https://img.shields.io/endpoint.svg?url=https://paperswithcode.com/badge/no-time-to-train-training-free-reference/few-shot-object-detection-on-ms-coco-10-shot)](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-10-shot?p=no-time-to-train-training-free-reference)

[**_ุงูุฃูุถู ูู ูุฆุฉ 30-shot_**](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-30-shot?p=no-time-to-train-training-free-reference) | [![PWC](https://img.shields.io/endpoint.svg?url=https://paperswithcode.com/badge/no-time-to-train-training-free-reference/few-shot-object-detection-on-ms-coco-30-shot)](https://paperswithcode.com/sota/few-shot-object-detection-on-ms-coco-30-shot?p=no-time-to-train-training-free-reference)

</div>

---

> ๐จ **ุชุญุฏูุซ (22 ููููู 2025):** ุชูุช ุฅุถุงูุฉ ุชุนูููุงุช ููุฌููุนุงุช ุงูุจูุงูุงุช ุงููุฎุตุตุฉ!
> 
> ๐ **ุชุญุฏูุซ (16 ููููู 2025):** ุชู ุชุญุฏูุซ ุงูููุฏ ูุน ุงูุฅุฑุดุงุฏุงุช!

---

## ๐ ุฌุฏูู ุงููุญุชููุงุช

- [๐ฏ ุฃุจุฑุฒ ุงูููุงุท](#-highlights)
- [๐ ุงูููุฎุต](#-abstract)
- [๐ง ุงููุนูุงุฑูุฉ](#-architecture)
- [๐๏ธ ุชุนูููุงุช ุงูุชุซุจูุช](#๏ธ-installation-instructions)
  - [1. ุงุณุชูุณุงุฎ ุงููุณุชูุฏุน](#1-clone-the-repository)
  - [2. ุฅูุดุงุก ุจูุฆุฉ conda](#2-create-conda-environment)
  - [3. ุชุซุจูุช SAM2 ูDinoV2](#3-install-sam2-and-dinov2)
  - [4. ุชุญููู ูุฌููุนุงุช ุงูุจูุงูุงุช](#4-download-datasets)
  - [5. ุชุญููู ููุงุท ุชุญูู SAM2 ูDinoV2](#5-download-sam2-and-dinov2-checkpoints)
- [๐ ููุฏ ุงูุงุณุชุฏูุงู: ุฅุนุงุฏุฉ ุฅูุชุงุฌ ูุชุงุฆุฌ 30-shot ุงูุฃูุถู ุนูู COCO](#-inference-code)
  - [0. ุฅูุดุงุก ูุฌููุนุฉ ูุฑุฌุนูุฉ](#0-create-reference-set)
  - [1. ููุก ุงูุฐุงูุฑุฉ ุจุงููุฑุฌุนูุงุช](#1-fill-memory-with-references)
  - [2. ูุนุงูุฌุฉ ุจูู ุงูุฐุงูุฑุฉ](#2-post-process-memory-bank)
  - [3. ุงูุงุณุชุฏูุงู ุนูู ุงูุตูุฑ ุงููุณุชูุฏูุฉ](#3-inference-on-target-images)
  - [ุงููุชุงุฆุฌ](#results)
- [๐ ูุฌููุนุฉ ุจูุงูุงุช ูุฎุตุตุฉ](#-custom-dataset)
  - [0. ุฅุนุฏุงุฏ ูุฌููุนุฉ ุจูุงูุงุช ูุฎุตุตุฉ โต๐ฆ](#0-prepare-a-custom-dataset)
  - [0.1 ุฅุฐุง ูุงูุช ุงูุชุนูููุงุช ุงููุชููุฑุฉ ููุท ูุฑุจุนุงุช ุงูุฅุญุงุทุฉ](#01-if-only-bbox-annotations-are-available)
  - [0.2 ุชุญููู ุชุนูููุงุช coco ุฅูู ููู pickle](#02-convert-coco-annotations-to-pickle-file)
  - [1. ููุก ุงูุฐุงูุฑุฉ ุจุงููุฑุฌุนูุงุช](#1-fill-memory-with-references)
  - [2. ูุนุงูุฌุฉ ุจูู ุงูุฐุงูุฑุฉ](#2-post-process-memory-bank)
- [๐ ุงูุงูุชุจุงุณ](#-citation)


## ๐ฏ ุฃุจุฑุฒ ุงูููุงุท
- ๐ก **ุจุฏูู ุชุฏุฑูุจ**: ูุง ุญุงุฌุฉ ูุถุจุท ุฏูููุ ููุง ููุฏุณุฉ ูุทุงูุจุงุชโููุท ุตูุฑุฉ ูุฑุฌุนูุฉ.  
- ๐ผ๏ธ **ุงุณุชูุงุฏูุง ุฅูู ุงููุฑุฌุน**: ุชูุณูู ูุงุฆูุงุช ุฌุฏูุฏุฉ ุจุงุณุชุฎุฏุงู ุนุฏุฏ ูููู ููุท ูู ุงูุฃูุซูุฉ.  
- ๐ฅ **ุฃุฏุงุก ูุชููู**: ูุชููู ุนูู ุงูููุฌ ุงูุณุงุจูุฉ ุงูุชู ูุง ุชุนุชูุฏ ุนูู ุงูุชุฏุฑูุจ ูู COCO ูPASCAL VOC ูFSOD ุนุจุฑ ุงููุฌุงูุงุช.

**ุฑูุงุจุท:**
- ๐งพ [**ูุฑูุฉ arXiv**](https://arxiv.org/abs/2507.02798)  
- ๐ [**ูููุน ุงููุดุฑูุน**](https://miquel-espinosa.github.io/no-time-to-train/)  
- ๐ [**Papers with Code**](https://paperswithcode.com/paper/no-time-to-train-training-free-reference)

## ๐ ุงูููุฎุต

> ูุงูุช ุฃุฏุงุก ููุงุฐุฌ ุชูุณูู ุงูุตูุฑ ุชุงุฑูุฎููุง ูุญุฏูุฏูุง ุจุณุจุจ ุงูุชูููุฉ ุงูุนุงููุฉ ูุฌูุน ุจูุงูุงุช ููุณููุฉ ุนูู ูุทุงู ูุงุณุน. ูููู ูููุฐุฌ Segment Anything (SAM) ุจุชุฎููู ูุฐู ุงููุดููุฉ ุงูุฃุตููุฉ ูู ุฎูุงู ูููุฐุฌ ุชูุณูู ูููู ุชุญููุฒูุ ุบูุฑ ูุนุชูุฏ ุนูู ุงูุฏูุงูุงุชุ ุฅูุง ุฃูู ูุง ูุฒุงู ูุญุชุงุฌ ุฅูู ูุทุงูุจุงุช ุจุตุฑูุฉ ูุฏููุฉ ุฃู ููุงุนุฏ ุชูููุฏ ูุทุงูุจุงุช ูุนูุฏุฉ ุชุนุชูุฏ ุนูู ุงููุฌุงู ููุนุงูุฌุฉ ุตูุฑุฉ ุฌุฏูุฏุฉ. ูู ุฃุฌู ุชูููู ูุฐุง ุงูุนุจุก ุงูุฌุฏูุฏุ ูุจุญุซ ุนูููุง ูู ูููุฉ ุชูุณูู ุงููุงุฆูุงุช ุนูุฏ ุชููุฑ ูุฌููุนุฉ ุตุบูุฑุฉ ููุท ูู ุงูุตูุฑ ุงููุฑุฌุนูุฉ. ุฑุคูุชูุง ุงูุฃุณุงุณูุฉ ูู ุงูุงุณุชูุงุฏุฉ ูู ุงููุนุฑูุฉ ุงูุฏูุงููุฉ ุงููููุฉ ุงูุชู ุชุนููุชูุง ุงูููุงุฐุฌ ุงูุฃุณุงุณูุฉ ูุชุญุฏูุฏ ุงูููุงุทู ุงููุทุงุจูุฉ ุจูู ุตูุฑุฉ ูุฑุฌุนูุฉ ูุตูุฑุฉ ูุฏู. ูุฌุฏูุง ุฃู ุงูุนูุงูุงุช ุงูุชูุงูููุฉ ุชุชูุญ ุชูููุฏ ุชููุงุฆู ูุฃููุนุฉ ุชูุณูู ุนูู ูุณุชูู ุงูุนููุงุช ูููุงู ุชุงููุฉ ููููุฐ ุฃููุงุฑูุง ุนุจุฑ ุทุฑููุฉ ูุชุนุฏุฏุฉ ุงููุฑุงุญู ูุจุฏูู ุชุฏุฑูุจ ุชุชุถูู (1) ุจูุงุก ุจูู ุฐุงูุฑุฉุ (2) ุชุฌููุน ุงูุชูุซููุงุช ู(3) ูุทุงุจูุฉ ุงูููุฒุงุช ุจูุงุกู ุนูู ุงูุฏูุงูุฉ. ุชุธูุฑ ุชุฌุงุฑุจูุง ุชุญุณููุงุช ููุญูุธุฉ ูู ููุงููุณ ุงูุชูุณููุ ููุง ูุคุฏู ุฅูู ุฃุฏุงุก ุฑุงุฆุฏ ูู COCO FSOD (36.8% nAP)ุ ูPASCAL VOC Few-Shot (71.2% nAP50) ููุชููู ุนูู ุงูููุฌ ุงูุณุงุจูุฉ ุงูุชู ูุง ุชุนุชูุฏ ุนูู ุงูุชุฏุฑูุจ ูู ูุนูุงุฑ Cross-Domain FSOD (22.4% nAP).

![cdfsod-results-final-comic-sans-min](https://github.com/user-attachments/assets/ab302c02-c080-4042-99fc-0e181ba8abb9)

</translate-content>

## ๐ง ุงููููููุฉ

![training-free-architecture-comic-sans-min](https://github.com/user-attachments/assets/d84dd83a-505e-45a0-8ce3-98e1838017f9)


## ๐๏ธ ุชุนูููุงุช ุงูุชุซุจูุช

### 1. ุงุณุชูุณุงุฎ ุงููุณุชูุฏุน

```bash
git clone https://github.com/miquel-espinosa/no-time-to-train.git
cd no-time-to-train
```
### ูข. ุฅูุดุงุก ุจูุฆุฉ ูููุฏุง

ุณูููู ุจุฅูุดุงุก ุจูุฆุฉ ูููุฏุง ูุน ุงูุญุฒู ุงููุทููุจุฉ.

```bash
conda env create -f environment.yml
conda activate no-time-to-train
```
### 3. ุชุซุจูุช SAM2 ู DinoV2

ุณูู ูููู ุจุชุซุจูุช SAM2 ู DinoV2 ูู ุงููุตุฏุฑ.

```bash
pip install -e .
cd dinov2
pip install -e .
cd ..
```
### 4. ุชูุฒูู ูุฌููุนุงุช ุงูุจูุงูุงุช

ูุฑุฌู ุชูุฒูู ูุฌููุนุฉ ุจูุงูุงุช COCO ููุถุนูุง ูู `data/coco`

### 5. ุชูุฒูู ููุงุท ุงูุชุญูู ูู SAM2 ู DinoV2

ุณูููู ุจุชูุฒูู ููุงุท ุงูุชุญูู ุงูุฎุงุตุฉ ุจู SAM2 ุงููุณุชุฎุฏูุฉ ูู ุงููุฑูุฉ ุงูุจุญุซูุฉ ุจุงูุถุจุท.
(ูุฑุฌู ููุงุญุธุฉ ุฃู ููุงุท ุงูุชุญูู SAM2.1 ูุชููุฑุฉ ุจุงููุนู ููุฏ ุชุคุฏู ุจุดูู ุฃูุถู.)


```bash
mkdir -p checkpoints/dinov2
cd checkpoints
wget https://dl.fbaipublicfiles.com/segment_anything_2/072824/sam2_hiera_large.pt
cd dinov2
wget https://dl.fbaipublicfiles.com/dinov2/dinov2_vitl14/dinov2_vitl14_pretrain.pth
cd ../..
```
## ๐ ููุฏ ุงูุงุณุชุฏูุงู

โ๏ธ ุฅุฎูุงุก ูุณุคูููุฉ: ูุฐุง ููุฏ ุจุญุซู โ ุชููุน ุจุนุถ ุงูููุถู!

### ุฅุนุงุฏุฉ ุฅูุชุงุฌ ูุชุงุฆุฌ SOTA ุจุนุฏุฏ 30 ููุทุฉ ูู Few-shot COCO

ูู ุจุชุนุฑูู ุงููุชุบูุฑุงุช ุงููููุฏุฉ ูุฃูุดุฆ ูุฌูุฏูุง ูููุชุงุฆุฌ:



```bash
CONFIG=./no_time_to_train/new_exps/coco_fewshot_10shot_Sam2L.yaml
CLASS_SPLIT="few_shot_classes"
RESULTS_DIR=work_dirs/few_shot_results
SHOTS=30
SEED=33
GPUS=4

mkdir -p $RESULTS_DIR
FILENAME=few_shot_${SHOTS}shot_seed${SEED}.pkl
```
#### 0. ุฅูุดุงุก ูุฌููุนุฉ ูุฑุฌุนูุฉ


```bash
python no_time_to_train/dataset/few_shot_sampling.py \
        --n-shot $SHOTS \
        --out-path ${RESULTS_DIR}/${FILENAME} \
        --seed $SEED \
        --dataset $CLASS_SPLIT
```
#### 1. ุงููุฃ ุงูุฐุงูุฑุฉ ุจุงููุฑุงุฌุน


```bash
python run_lightening.py test --config $CONFIG \
                              --model.test_mode fill_memory \
                              --out_path ${RESULTS_DIR}/memory.ckpt \
                              --model.init_args.model_cfg.memory_bank_cfg.length $SHOTS \
                              --model.init_args.dataset_cfgs.fill_memory.memory_pkl ${RESULTS_DIR}/${FILENAME} \
                              --model.init_args.dataset_cfgs.fill_memory.memory_length $SHOTS \
                              --model.init_args.dataset_cfgs.fill_memory.class_split $CLASS_SPLIT \
                              --trainer.logger.save_dir ${RESULTS_DIR}/ \
                              --trainer.devices $GPUS
```
#### 2. ูุนุงูุฌุฉ ูุงุญูุฉ ูุจูู ุงูุฐุงูุฑุฉ


```bash
python run_lightening.py test --config $CONFIG \
                              --model.test_mode postprocess_memory \
                              --model.init_args.model_cfg.memory_bank_cfg.length $SHOTS \
                              --ckpt_path ${RESULTS_DIR}/memory.ckpt \
                              --out_path ${RESULTS_DIR}/memory_postprocessed.ckpt \
                              --trainer.devices 1
```
#### 3. ุงูุงุณุชุฏูุงู ุนูู ุงูุตูุฑ ุงููุฏู


```bash
python run_lightening.py test --config $CONFIG  \
                              --ckpt_path ${RESULTS_DIR}/memory_postprocessed.ckpt \
                              --model.init_args.test_mode test \
                              --model.init_args.model_cfg.memory_bank_cfg.length $SHOTS \
                              --model.init_args.model_cfg.dataset_name $CLASS_SPLIT \
                              --model.init_args.dataset_cfgs.test.class_split $CLASS_SPLIT \
                              --trainer.logger.save_dir ${RESULTS_DIR}/ \
                              --trainer.devices $GPUS
```
ุฅุฐุง ููุช ุชุฑุบุจ ูู ูุดุงูุฏุฉ ูุชุงุฆุฌ ุงูุงุณุชุฏูุงู ูุจุงุดุฑุฉ ุนุจุฑ ุงูุฅูุชุฑูุช (ุฃุซูุงุก ุญุณุงุจูุง)ุ ูู ุจุฅูุบุงุก ุชุนููู ุงูุฃุณุทุฑ 1746-1749 ูู ุงูููู `no_time_to_train/models/Sam2MatchingBaseline_noAMG.py` [ููุง](https://github.com/miquel-espinosa/no-time-to-train/blob/main/no_time_to_train/models/Sam2MatchingBaseline_noAMG.py#L1746).
ูู ุจุถุจุท ูุนููุฉ ุญุฏ ุงูุฏุฑุฌุฉ `score_thr` ุญุณุจ ุงูุญุงุฌุฉ ูุฑุคูุฉ ุงููุฒูุฏ ุฃู ุงููููู ูู ุงููุงุฆูุงุช ุงูููุฌุฒุฃุฉ.
ุณูุชู ุงูุขู ุญูุธ ุงูุตูุฑ ูู ุงููุฌูุฏ `results_analysis/few_shot_classes/`. ุงูุตูุฑุฉ ุนูู ุงููุณุงุฑ ุชุนุฑุถ ุงูุญูููุฉ ุงูุฃุฑุถูุฉุ ูุงูุตูุฑุฉ ุนูู ุงููููู ุชุนุฑุถ ุงููุงุฆูุงุช ุงูููุฌุฒุฃุฉ ุงูุชู ุชู ุงูุนุซูุฑ ุนูููุง ุจูุงุณุทุฉ ุทุฑููุชูุง ุงูุฎุงููุฉ ูู ุงูุชุฏุฑูุจ.

ูุงุญุธ ุฃูู ูู ูุฐุง ุงููุซุงู ูุณุชุฎุฏู ุชูุณููุฉ `few_shot_classes`ุ ูุฐุง ูุฌุจ ุฃู ูุชููุน ููุท ุฑุคูุฉ ูุงุฆูุงุช ููุฌุฒุฃุฉ ูู ุงููุฆุงุช ุงูููุฌูุฏุฉ ูู ูุฐู ุงูุชูุณููุฉ (ูููุณ ุฌููุน ุงููุฆุงุช ูู COCO).

#### ุงููุชุงุฆุฌ

ุจุนุฏ ุชุดุบูู ุฌููุน ุงูุตูุฑ ูู ูุฌููุนุฉ ุงูุชุญููุ ูุฌุจ ุฃู ุชุญุตู ุนูู:


```
BBOX RESULTS:
  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.368

SEGM RESULTS:
  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.342
```
---

## ๐ ูุฌููุนุฉ ุจูุงูุงุช ูุฎุตุตุฉ

ูุญู ูููุฑ ุงูุชุนูููุงุช ูุชุดุบูู ุฎุท ุงูุฃูุงุจูุจ ุงูุฎุงุต ุจูุง ุนูู ูุฌููุนุฉ ุจูุงูุงุช ูุฎุตุตุฉ. ุชูุณููุงุช ุงูุชุนูููุงุช ุงูุชูุถูุญูุฉ ุฏุงุฆููุง ุจุชูุณูู COCO.

> **ุจุงุฎุชุตุงุฑุ** ูุฑุคูุฉ ููููุฉ ุชุดุบูู ุฎุท ุงูุฃูุงุจูุจ ุงููุงูู ุนูู *ูุฌููุนุงุช ุจูุงูุงุช ูุฎุตุตุฉ* ูุจุงุดุฑุฉูุ ุงุจุญุซ ุนู `scripts/matching_cdfsod_pipeline.sh` ูุน ุฃูุซูุฉ ูุจุฑุงูุฌ ูุฌููุนุงุช ุจูุงูุงุช CD-FSOD (ูุซู `scripts/dior_fish.sh`)

### 0. ุชุฌููุฒ ูุฌููุนุฉ ุจูุงูุงุช ูุฎุตุตุฉ โต๐ฆ

ููุชุฎูู ุฃููุง ูุฑูุฏ ุงูุชุดุงู **ุงูููุงุฑุจ**โต ู**ุงูุทููุฑ**๐ฆ ูู ูุฌููุนุฉ ุจูุงูุงุช ูุฎุตุตุฉ. ูุงุณุชุฎุฏุงู ุทุฑููุชูุง ุณูุญุชุงุฌ ุฅูู:
- ุตูุฑุฉ ูุฑุฌุนูุฉ *ูุดุฑูุญุฉ* ูุงุญุฏุฉ ุนูู ุงูุฃูู ููู ูุฆุฉ (ุฃู ุตูุฑุฉ ูุฑุฌุนูุฉ ูุงุญุฏุฉ ูููุงุฑุจ ูุตูุฑุฉ ูุฑุฌุนูุฉ ูุงุญุฏุฉ ููุทุงุฆุฑ)
- ุนุฏุฉ ุตูุฑ ูุฏู ููุนุซูุฑ ุนูู ุฃูุซูุฉ ูููุฆุงุช ุงููุทููุจุฉ.

ููุฏ ุฃุนุฏุฏูุง ุจุฑูุงูุฌูุง ูุจุณุทูุง ูุฅูุดุงุก ูุฌููุนุฉ ุจูุงูุงุช ูุฎุตุตุฉ ุจุงุณุชุฎุฏุงู ุตูุฑ cocoุ ูุฅุนุฏุงุฏ **ููุทุฉ ูุงุญุฏุฉ**.
```bash
python scripts/make_custom_dataset.py
```
ุณูุคุฏู ูุฐุง ุฅูู ุฅูุดุงุก ูุฌููุนุฉ ุจูุงูุงุช ูุฎุตุตุฉ ุจุงููููููุฉ ุงูุชุงููุฉ ูููุฌูุฏุงุช:
```
data/my_custom_dataset/
    โโโ annotations/
    โ   โโโ custom_references.json
    โ   โโโ custom_targets.json
    โ   โโโ references_visualisations/
    โ       โโโ bird_1.jpg
    โ       โโโ boat_1.jpg
    โโโ images/
        โโโ 429819.jpg
        โโโ 101435.jpg
        โโโ (all target and reference images)
```
**ุชุตููุฑ ุตูุฑ ุงููุฑุฌุน (ููุทุฉ ูุงุญุฏุฉ):**

| ุตูุฑุฉ ูุฑุฌุนูุฉ ูุงุญุฏุฉ ููุทุงุฆุฑ ๐ฆ | ุตูุฑุฉ ูุฑุฌุนูุฉ ูุงุญุฏุฉ ูููุงุฑุจ โต |
|:-----------------------------:|:-------------------------------:|
| <img src="https://github.com/user-attachments/assets/e59e580d-a7db-42ac-b386-892af211fc85" alt="bird_1" width="500"/> | <img src="https://github.com/user-attachments/assets/f94ee025-ae37-4a45-9c3e-0cfe8f8cd2bc" alt="boat_1" width="500"/> |


### 0.1 ุฅุฐุง ูุงูุช ุงูุชุนูููุงุช ุงูุชูุถูุญูุฉ ููุฅุทุงุฑ ุงููุญูุท ููุท ูุชููุฑุฉ

ูุญู ูููุฑ ุฃูุถูุง ูุตูุง ุจุฑูุฌููุง ูุชูููุฏ ุฃููุนุฉ ุชูุณูู ุนูู ูุณุชูู ุงููุงุฆู ุจุงุณุชุฎุฏุงู SAM2. ูุฐุง ูููุฏ ุฅุฐุง ูุงู ูุฏูู ููุท ุชุนูููุงุช ุชูุถูุญูุฉ ููุฅุทุงุฑ ุงููุญูุท ููุตูุฑ ุงููุฑุฌุนูุฉ.


```bash
# Download sam_h checkpoint. Feel free to use more recent checkpoints (note: code might need to be adapted)
wget https://dl.fbaipublicfiles.com/segment_anything/sam_vit_h_4b8939.pth -O checkpoints/sam_vit_h_4b8939.pth
# Run automatic instance segmentation from ground truth bounding boxes.
python no_time_to_train/dataset/sam_bbox_to_segm_batch.py \
    --input_json data/my_custom_dataset/annotations/custom_references.json \
    --image_dir data/my_custom_dataset/images \
    --sam_checkpoint checkpoints/sam_vit_h_4b8939.pth \
    --model_type vit_h \
    --device cuda \
    --batch_size 8 \
    --visualize
```
**ุตูุฑ ูุฑุฌุนูุฉ ูุน ุฃููุนุฉ ุงูุชูุณูู ุนูู ูุณุชูู ุงููุงุฆู (ุชู ุฅูุดุงุคูุง ุจูุงุณุทุฉ SAM2 ูู ูุฑุจุนุงุช ุงูุฅุญุงุทุฉ ุงูุญููููุฉุ ููุทุฉ ูุงุญุฏุฉ):**

ุชู ุญูุธ ุชุตููุฑ ุฃููุนุฉ ุงูุชูุณูู ุงูููููุฏุฉ ูู `data/my_custom_dataset/annotations/custom_references_with_SAM_segm/references_visualisations/`.

| ุตูุฑุฉ ูุฑุฌุนูุฉ ุจููุทุฉ ูุงุญุฏุฉ ูุนุตููุฑ ๐ฆ (ุชู ุชูุณูููุง ุชููุงุฆูุงู ุจูุงุณุทุฉ SAM) | ุตูุฑุฉ ูุฑุฌุนูุฉ ุจููุทุฉ ูุงุญุฏุฉ ููุงุฑุจ โต (ุชู ุชูุณูููุง ุชููุงุฆูุงู ุจูุงุณุทุฉ SAM) |
|:---------------------------------:|:----------------------------------:|
| <img src="https://github.com/user-attachments/assets/65d38dc4-1454-43cd-9600-e8efc67b3a82" alt="bird_1_with_SAM_segm" width="500"/> | <img src="https://github.com/user-attachments/assets/43a558ad-50ca-4715-8285-9aa3268843c6" alt="boat_1_with_SAM_segm" width="500"/> |


### 0.2 ุชุญููู ุชุนูููุงุช coco ุฅูู ููู pickle



```bash
python no_time_to_train/dataset/coco_to_pkl.py \
    data/my_custom_dataset/annotations/custom_references_with_segm.json \
    data/my_custom_dataset/annotations/custom_references_with_segm.pkl \
    1
```
### 1. ููุก ุงูุฐุงูุฑุฉ ุจุงููุฑุงุฌุน

ุฃููุงูุ ูู ุจุชุนุฑูู ุงููุชุบูุฑุงุช ุงููููุฏุฉ ูุฃูุดุฆ ูุฌูุฏูุง ูููุชุงุฆุฌ. ูู ุฃุฌู ุงูุนุฑุถ ุงูุตุญูุญ ููุชุณููุงุชุ ูุฌุจ ุชุฑุชูุจ ุฃุณูุงุก ุงููุฆุงุช ุญุณุจ ูุนุฑู ุงููุฆุฉ ููุง ูุธูุฑ ูู ููู json. ุนูู ุณุจูู ุงููุซุงูุ ุงููุฆุฉ `bird` ููุง ูุนุฑู ูุฆุฉ `16`ุ ูุงููุฆุฉ `boat` ููุง ูุนุฑู ูุฆุฉ `9`. ูุฐุงุ ูุฌุจ ุฃู ุชููู `CAT_NAMES=boat,bird`.


```bash
DATASET_NAME=my_custom_dataset
DATASET_PATH=data/my_custom_dataset
CAT_NAMES=boat,bird
CATEGORY_NUM=2
SHOT=1
YAML_PATH=no_time_to_train/pl_configs/matching_cdfsod_template.yaml
PATH_TO_SAVE_CKPTS=./tmp_ckpts/my_custom_dataset
mkdir -p $PATH_TO_SAVE_CKPTS
```
ูู ุจุชูููุฐ ุงูุฎุทูุฉ 1:

```bash
python run_lightening.py test --config $YAML_PATH \
    --model.test_mode fill_memory \
    --out_path $PATH_TO_SAVE_CKPTS/$DATASET_NAME\_$SHOT\_refs_memory.pth \
    --model.init_args.dataset_cfgs.fill_memory.root $DATASET_PATH/images \
    --model.init_args.dataset_cfgs.fill_memory.json_file $DATASET_PATH/annotations/custom_references_with_segm.json \
    --model.init_args.dataset_cfgs.fill_memory.memory_pkl $DATASET_PATH/annotations/custom_references_with_segm.pkl \
    --model.init_args.dataset_cfgs.fill_memory.memory_length $SHOT \
    --model.init_args.dataset_cfgs.fill_memory.cat_names $CAT_NAMES \
    --model.init_args.model_cfg.dataset_name $DATASET_NAME \
    --model.init_args.model_cfg.memory_bank_cfg.length $SHOT \
    --model.init_args.model_cfg.memory_bank_cfg.category_num $CATEGORY_NUM \
    --trainer.devices 1
```
### 2. ุจูู ุงูุฐุงูุฑุฉ ุจุนุฏ ุงููุนุงูุฌุฉ


```bash
python run_lightening.py test --config $YAML_PATH \
    --model.test_mode postprocess_memory \
    --ckpt_path $PATH_TO_SAVE_CKPTS/$DATASET_NAME\_$SHOT\_refs_memory.pth \
    --out_path $PATH_TO_SAVE_CKPTS/$DATASET_NAME\_$SHOT\_refs_memory_postprocessed.pth \
    --model.init_args.model_cfg.dataset_name $DATASET_NAME \
    --model.init_args.model_cfg.memory_bank_cfg.length $SHOT \
    --model.init_args.model_cfg.memory_bank_cfg.category_num $CATEGORY_NUM \
    --trainer.devices 1
```
### 3. ุงูุงุณุชุฏูุงู ุนูู ุงูุตูุฑ ุงููุฏู

ุฅุฐุง ุชู ุชุนููู `ONLINE_VIS` ุฅูู Trueุ ุณูุชู ุญูุธ ูุชุงุฆุฌ ุงูุชูุจุค ูู `results_analysis/my_custom_dataset/` ูุนุฑุถูุง ุฃุซูุงุก ุญุณุงุจูุง. ููุงุญุธุฉ: ุงูุชุดุบูู ูุน ุงูุชุตูุฑ ุงููุญุธู ุฃุจุทุฃ ุจูุซูุฑ.

ููููู ุชุบููุฑ ุนุชุจุฉ ุงูุฏุฑุฌุงุช `VIS_THR` ูุฑุคูุฉ ุงููุฒูุฏ ุฃู ุงููููู ูู ุงููุงุฆูุงุช ุงูููุณูุฉ.

```bash
ONLINE_VIS=True
VIS_THR=0.4
python run_lightening.py test --config $YAML_PATH \
    --model.test_mode test \
    --ckpt_path $PATH_TO_SAVE_CKPTS/$DATASET_NAME\_$SHOT\_refs_memory_postprocessed.pth \
    --model.init_args.model_cfg.dataset_name $DATASET_NAME \
    --model.init_args.model_cfg.memory_bank_cfg.length $SHOT \
    --model.init_args.model_cfg.memory_bank_cfg.category_num $CATEGORY_NUM \
    --model.init_args.model_cfg.test.imgs_path $DATASET_PATH/images \
    --model.init_args.model_cfg.test.online_vis $ONLINE_VIS \
    --model.init_args.model_cfg.test.vis_thr $VIS_THR \
    --model.init_args.dataset_cfgs.test.root $DATASET_PATH/images \
    --model.init_args.dataset_cfgs.test.json_file $DATASET_PATH/annotations/custom_targets.json \
    --model.init_args.dataset_cfgs.test.cat_names $CAT_NAMES \
    --trainer.devices 1
```
### ุงููุชุงุฆุฌ

ูุฌุจ ุฃู ุชููู ููุงููุณ ุงูุฃุฏุงุก (ุจููุณ ุงููุนููุงุช ุงููุณุชุฎุฏูุฉ ูู ุงูุฃูุงูุฑ ุฃุนูุงู) ููุง ููู:


```
BBOX RESULTS:
  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.478

SEGM RESULTS:
  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.458
```
ูุชู ุญูุธ ุงููุชุงุฆุฌ ุงููุฑุฆูุฉ ูู `results_analysis/my_custom_dataset/`. ูุงุญุธ ุฃู ุทุฑููุชูุง ุชุนูู ูุน ุงููุชุงุฆุฌ ุงูุณูุจูุฉ ุงููุงุฐุจุฉุ ุฃู ุงูุตูุฑ ุงูุชู ูุง ุชุญุชูู ุนูู ุฃู ุฃูุซูุฉ ูู ุงููุฆุงุช ุงููุทููุจุฉ.

*ุงููุฑ ุนูู ุงูุตูุฑ ููุชูุจูุฑ โฌ๏ธ*

| ุตูุฑุฉ ุงููุฏู ูุน ุงูููุงุฑุจ โต (ูุณุงุฑ GTุ ูููู ุงูุชููุนุงุช) | ุตูุฑุฉ ุงููุฏู ูุน ุงูุทููุฑ ๐ฆ (ูุณุงุฑ GTุ ูููู ุงูุชููุนุงุช) |
|:----------------------:|:----------------------:|
| ![000000459673](https://github.com/user-attachments/assets/678dc15a-dd3b-49d5-9287-6290da16aa6b) | ![000000407180](https://github.com/user-attachments/assets/fe306e48-af49-4d83-ac82-76fac6c456d1) |

| ุตูุฑุฉ ุงููุฏู ูุน ุงูููุงุฑุจ ูุงูุทููุฑ โต๐ฆ (ูุณุงุฑ GTุ ูููู ุงูุชููุนุงุช) | ุตูุฑุฉ ุงููุฏู ุจุฏูู ููุงุฑุจ ุฃู ุทููุฑ ๐ซ (ูุณุงุฑ GTุ ูููู ุงูุชููุนุงุช) |
|:---------------------------------:|:----------------------------------:|
| ![000000517410](https://github.com/user-attachments/assets/9849b227-7f43-43d7-81ea-58010a623ad5) | ![000000460598](https://github.com/user-attachments/assets/7587700c-e09d-4cf6-8590-3df129c2568e) |


## ๐ ุงูุงูุชุจุงุณ

ุฅุฐุง ุงุณุชุฎุฏูุช ูุฐุง ุงูุนููุ ูุฑุฌู ุงูุงุณุชุดูุงุฏ ุจูุง:


```bibtex
@article{espinosa2025notimetotrain,
  title={No time to train! Training-Free Reference-Based Instance Segmentation},
  author={Miguel Espinosa and Chenhongyi Yang and Linus Ericsson and Steven McDonagh and Elliot J. Crowley},
  journal={arXiv preprint arXiv:2507.02798},
  year={2025},
  primaryclass={cs.CV}
}
```


---

Tranlated By [Open Ai Tx](https://github.com/OpenAiTx/OpenAiTx) | Last indexed: 2025-07-23

---