[
  {
    "Id": 1,
    "Content": "<img src=\"https://raw.githubusercontent.com/franbarbalopez/mirror/master/art/logo.png\" alt=\"Mirror Logo\">\n\n<div align=\"center\">\n    <img alt=\"Latest Version on Packagist\" src=\"https://img.shields.io/packagist/v/franbarbalopez/mirror.svg\">\n    <img alt=\"GitHub Tests Action Status\" src=\"https://img.shields.io/github/actions/workflow/status/franbarbalopez/mirror/tests.yml?label=tests\">\n    <img alt=\"Total Downloads\" src=\"https://img.shields.io/packagist/dt/franbarbalopez/mirror.svg\">\n    <img alt=\"License\" src=\"https://img.shields.io/packagist/l/franbarbalopez/mirror.svg\">\n</div>\n\n# Mirror\n\nMirror is an elegant user impersonation package for Laravel. It allows administrators to seamlessly log in as other users to troubleshoot issues, provide support, or test user experiences. Mirror handles session integrity with cryptographic verification, automatic expiration, multi-guard support, flexible middleware, and lifecycle events for audit logging. Perfect for production applications that need reliable and secure user impersonation.\n\n## Features\n\n- HMAC-SHA256 session integrity to prevent tampering\n- Configurable TTL expiration\n- Middleware for access control and TTL enforcement\n- Multi-guard support\n- Flexible URL redirection\n- Lifecycle events for audit logging\n\n## Requirements\n\n- PHP 8.2+\n- Laravel 11+\n\n## Installation\n",
    "ContentSha": "7LmVpMW9pnsPfshvU9JxUVAbZMxnOTRmz/2s46WQu5E=",
    "SectionType": "",
    "StartLine": 0,
    "EndLine": 0,
    "Translation": "<img src=\"https://raw.githubusercontent.com/franbarbalopez/mirror/master/art/logo.png\" alt=\"Logo Mirror\">\n\n<div align=\"center\">\n    <img alt=\"Dernière version sur Packagist\" src=\"https://img.shields.io/packagist/v/franbarbalopez/mirror.svg\">\n    <img alt=\"Statut des tests GitHub Actions\" src=\"https://img.shields.io/github/actions/workflow/status/franbarbalopez/mirror/tests.yml?label=tests\">\n    <img alt=\"Nombre total de téléchargements\" src=\"https://img.shields.io/packagist/dt/franbarbalopez/mirror.svg\">\n    <img alt=\"Licence\" src=\"https://img.shields.io/packagist/l/franbarbalopez/mirror.svg\">\n</div>\n\n# Mirror\n\nMirror est un package d'usurpation d'utilisateur élégant pour Laravel. Il permet aux administrateurs de se connecter facilement en tant qu'autres utilisateurs pour résoudre des problèmes, fournir du support ou tester l'expérience utilisateur. Mirror gère l'intégrité des sessions avec une vérification cryptographique, une expiration automatique, un support multi-gardes, un middleware flexible et des événements de cycle de vie pour la journalisation d'audit. Parfait pour les applications en production nécessitant une usurpation d'utilisateur fiable et sécurisée.\n\n## Fonctionnalités\n\n- Intégrité de session HMAC-SHA256 pour prévenir toute falsification\n- Expiration TTL configurable\n- Middleware pour le contrôle d'accès et l'application du TTL\n- Support multi-gardes\n- Redirection d'URL flexible\n- Événements de cycle de vie pour la journalisation d'audit\n\n## Exigences\n\n- PHP 8.2+\n- Laravel 11+\n\n## Installation\n",
    "Status": "ok",
    "RowTranslations": [],
    "IsCodeBlock": false
  },
  {
    "Id": 2,
    "Content": "```bash\ncomposer require franbarbalopez/mirror\n```",
    "ContentSha": "+kuTQlRdLDFnVHqho/SoLEut1a98Lo0znBj/7Q0wgVQ=",
    "SectionType": "",
    "StartLine": 0,
    "EndLine": 0,
    "Translation": "```bash\ncomposer require franbarbalopez/mirror\n```",
    "Status": "ok",
    "RowTranslations": [],
    "IsCodeBlock": true
  },
  {
    "Id": 3,
    "Content": "\nOptional - publish the config file:\n",
    "ContentSha": "GG2SVLOw4OtgRtVbhhPGZjECQXWLHBi2HHj+UGCQuXs=",
    "SectionType": "",
    "StartLine": 0,
    "EndLine": 0,
    "Translation": "Optionnel - publier le fichier de configuration :\n\n",
    "Status": "ok",
    "RowTranslations": [],
    "IsCodeBlock": false
  },
  {
    "Id": 4,
    "Content": "```bash\nphp artisan vendor:publish --tag=mirror\n```",
    "ContentSha": "pR0SHWOgiIM9DfSS/TUZ+ql4g9mFDgefCW56lC6iorY=",
    "SectionType": "",
    "StartLine": 0,
    "EndLine": 0,
    "Translation": "```bash\nphp artisan vendor:publish --tag=mirror\n```",
    "Status": "ok",
    "RowTranslations": [],
    "IsCodeBlock": true
  },
  {
    "Id": 5,
    "Content": "\n## Quick Start\n\n### 1. Add Trait to User Model\n",
    "ContentSha": "6aY3oGtDJuGCFvU5orW+5rwLS6mSCGqGFyRQXGM52ng=",
    "SectionType": "",
    "StartLine": 0,
    "EndLine": 0,
    "Translation": "\n## Démarrage rapide\n\n### 1. Ajouter un Trait au Modèle Utilisateur\n",
    "Status": "ok",
    "RowTranslations": [],
    "IsCodeBlock": false
  },
  {
    "Id": 6,
    "Content": "```php\nuse Illuminate\\Foundation\\Auth\\User as Authenticatable;\nuse Mirror\\Concerns\\Impersonatable;\n\nclass User extends Authenticatable\n{\n    use Impersonatable;\n\n    public function canImpersonate(): bool\n    {\n        return $this->hasRole('admin');\n    }\n\n    public function canBeImpersonated(): bool\n    {\n        return ! $this->hasRole('super-admin');\n    }\n}\n```",
    "ContentSha": "M4v8f1J7TLa54KEy7nKYSa7reflo9xxOxQk2qtK/9Bw=",
    "SectionType": "",
    "StartLine": 0,
    "EndLine": 0,
    "Translation": "```php\nuse Illuminate\\Foundation\\Auth\\User as Authenticatable;\nuse Mirror\\Concerns\\Impersonatable;\n\nclass User extends Authenticatable\n{\n    use Impersonatable;\n\n    public function canImpersonate(): bool\n    {\n        return $this->hasRole('admin');\n    }\n\n    public function canBeImpersonated(): bool\n    {\n        return ! $this->hasRole('super-admin');\n    }\n}\n```",
    "Status": "ok",
    "RowTranslations": [],
    "IsCodeBlock": true
  },
  {
    "Id": 7,
    "Content": "\n**Important:** If you don't implement `canImpersonate()`, everyone can impersonate everyone. The trait returns `true` by default.\n\n### 2. Start Impersonating\n",
    "ContentSha": "cq79T8NQhG9OSzX79X8F07Te94w/4gvKVOnd3XmWtrE=",
    "SectionType": "",
    "StartLine": 0,
    "EndLine": 0,
    "Translation": "\n**Important :** Si vous n’implémentez pas `canImpersonate()`, tout le monde peut se faire passer pour n’importe qui. Le trait retourne `true` par défaut.\n\n### 2. Commencer à usurper l’identité\n",
    "Status": "ok",
    "RowTranslations": [],
    "IsCodeBlock": false
  },
  {
    "Id": 8,
    "Content": "```php\nuse Mirror\\Facades\\Mirror;\n\npublic function impersonate(User $user)\n{\n    Mirror::start($user);\n\n    return redirect()->route('dashboard');\n}\n```",
    "ContentSha": "XUK/r93xJMP07fRmHsIfYUx7Vzr1zNXrGDhRZzXt7DM=",
    "SectionType": "",
    "StartLine": 0,
    "EndLine": 0,
    "Translation": "```php\nuse Mirror\\Facades\\Mirror;\n\npublic function impersonate(User $user)\n{\n    Mirror::start($user);\n\n    return redirect()->route('dashboard');\n}\n```",
    "Status": "ok",
    "RowTranslations": [],
    "IsCodeBlock": true
  },
  {
    "Id": 9,
    "Content": "\n### 3. Stop Impersonating\n",
    "ContentSha": "XLaRv8CSeqNv9YzF3a9ujQFDo07UsWSu0+a7QLK0yPk=",
    "SectionType": "",
    "StartLine": 0,
    "EndLine": 0,
    "Translation": "\n### 3. Cessez d'usurper l'identité\n",
    "Status": "ok",
    "RowTranslations": [],
    "IsCodeBlock": false
  },
  {
    "Id": 10,
    "Content": "```php\npublic function leave()\n{\n    Mirror::stop();\n\n    return redirect()->route('admin.users.index');\n}\n```",
    "ContentSha": "LX9xVHjaRRA+feJTklq8p7d9iPLyFsFRNxO0cgTMJrk=",
    "SectionType": "",
    "StartLine": 0,
    "EndLine": 0,
    "Translation": "```php\npublic function leave()\n{\n    Mirror::stop();\n\n    return redirect()->route('admin.users.index');\n}\n```",
    "Status": "ok",
    "RowTranslations": [],
    "IsCodeBlock": true
  },
  {
    "Id": 11,
    "Content": "\n## Security\n\nImpersonation sessions are protected with HMAC-SHA256 hashes using your app key. The hash covers the impersonator ID, guard name, start time, and redirect URL. On every `stop()` call, Mirror verifies this hash - if someone's tampered with the session, it throws an exception and clears everything.\n\nConfigure TTL in `config/mirror.php` to automatically expire sessions after a set time.\n\n## API Reference\n\n### Starting Impersonation\n\nBy user instance:\n",
    "ContentSha": "pgVLuyaKM1D9NHPygL1AWYFRRROTHBRQP7IYprB3vBI=",
    "SectionType": "",
    "StartLine": 0,
    "EndLine": 0,
    "Translation": "\n## Sécurité\n\nLes sessions d'usurpation sont protégées par des hachages HMAC-SHA256 utilisant la clé de votre application. Le hachage couvre l'ID de l'usurpateur, le nom du garde, l'heure de début et l'URL de redirection. À chaque appel de `stop()`, Mirror vérifie ce hachage - si quelqu'un a altéré la session, il lance une exception et efface tout.\n\nConfigurez le TTL dans `config/mirror.php` pour expirer automatiquement les sessions après un temps défini.\n\n## Référence API\n\n### Démarrer une usurpation\n\nPar instance utilisateur :\n",
    "Status": "ok",
    "RowTranslations": [],
    "IsCodeBlock": false
  },
  {
    "Id": 12,
    "Content": "```php\nMirror::start($user);\n\n// With redirect URLs\n$redirectUrl = Mirror::start(\n    user: $targetUser,\n    leaveRedirectUrl: route('admin.users.index'),\n    startRedirectUrl: route('dashboard')\n);\n\nreturn redirect($redirectUrl);\n```",
    "ContentSha": "6JHdBsxeX4Cnvt4q5NerJYf8/CrTKtD/gYy1U2l0wtU=",
    "SectionType": "",
    "StartLine": 0,
    "EndLine": 0,
    "Translation": "```php\nMirror::start($user);\n\n// With redirect URLs\n$redirectUrl = Mirror::start(\n    user: $targetUser,\n    leaveRedirectUrl: route('admin.users.index'),\n    startRedirectUrl: route('dashboard')\n);\n\nreturn redirect($redirectUrl);\n```",
    "Status": "ok",
    "RowTranslations": [],
    "IsCodeBlock": true
  },
  {
    "Id": 13,
    "Content": "\nBy primary key (works with int, UUID, ULID, etc.):\n",
    "ContentSha": "3I43GlfuiWp8dXwy7mgg+iuGj1TQ4aZzyZzFhmoDpkE=",
    "SectionType": "",
    "StartLine": 0,
    "EndLine": 0,
    "Translation": "\nPar clé primaire (fonctionne avec int, UUID, ULID, etc.) :\n",
    "Status": "ok",
    "RowTranslations": [],
    "IsCodeBlock": false
  },
  {
    "Id": 14,
    "Content": "```php\nMirror::startByKey(123);\n\nMirror::startByKey('550e8400-e29b-41d4-a716-446655440000');\n```",
    "ContentSha": "eDd0a0R+4SRidDPauS1hI9HTG+raR5dEa+qHjc+cKbQ=",
    "SectionType": "",
    "StartLine": 0,
    "EndLine": 0,
    "Translation": "```php\nMirror::startByKey(123);\n\nMirror::startByKey('550e8400-e29b-41d4-a716-446655440000');\n```",
    "Status": "ok",
    "RowTranslations": [],
    "IsCodeBlock": true
  },
  {
    "Id": 15,
    "Content": "\nBy email:\n",
    "ContentSha": "PTi7YxhS3yAvLPU0wKznu6uG2wL3lNPuMxZj5YKS6s8=",
    "SectionType": "",
    "StartLine": 0,
    "EndLine": 0,
    "Translation": "Par courriel :\n\n",
    "Status": "ok",
    "RowTranslations": [],
    "IsCodeBlock": false
  },
  {
    "Id": 16,
    "Content": "```php\nMirror::startByEmail('user@example.com');\n```",
    "ContentSha": "ysAdp+uNezGuz0BzXac1kiX4gwvn2ZSK8px3k9ysElE=",
    "SectionType": "",
    "StartLine": 0,
    "EndLine": 0,
    "Translation": "```php\nMirror::startByEmail('user@example.com');\n```",
    "Status": "ok",
    "RowTranslations": [],
    "IsCodeBlock": true
  },
  {
    "Id": 17,
    "Content": "\n### Stopping Impersonation\n",
    "ContentSha": "FmhFId2IvTAnZS1Xxw/QHdnGjRL62jSB97HQhCT5AaY=",
    "SectionType": "",
    "StartLine": 0,
    "EndLine": 0,
    "Translation": "\n### Arrêt de l'usurpation d'identité\n",
    "Status": "ok",
    "RowTranslations": [],
    "IsCodeBlock": false
  },
  {
    "Id": 18,
    "Content": "```php\nMirror::stop();\n\n// Force stop - bypasses TTL check but still verifies integrity\nMirror::forceStop();\n```",
    "ContentSha": "KOmB2zdzOt3wjQ65lAT+3v+V32K9noz/4cswD5F1kWc=",
    "SectionType": "",
    "StartLine": 0,
    "EndLine": 0,
    "Translation": "```php\nMirror::stop();\n\n// Force stop - bypasses TTL check but still verifies integrity\nMirror::forceStop();\n```",
    "Status": "ok",
    "RowTranslations": [],
    "IsCodeBlock": true
  },
  {
    "Id": 19,
    "Content": "\nUse `forceStop()` when you need to end impersonation from admin actions or cleanup scripts - it skips the TTL check but still throws if the session's been tampered with.\n\n### Checking State\n",
    "ContentSha": "XahYJCRR0yxYsTORbnoJdMUCRcWPy1OJ6t5qG/wVETQ=",
    "SectionType": "",
    "StartLine": 0,
    "EndLine": 0,
    "Translation": "\nUtilisez `forceStop()` lorsque vous devez mettre fin à l'usurpation depuis des actions d'administration ou des scripts de nettoyage - cela ignore la vérification TTL mais génère toujours une erreur si la session a été altérée.\n\n### Vérification de l'état\n",
    "Status": "ok",
    "RowTranslations": [],
    "IsCodeBlock": false
  },
  {
    "Id": 20,
    "Content": "```php\nMirror::isImpersonating(): bool\nMirror::getImpersonator(): ?Authenticatable\nMirror::impersonatorId(): int|string|null\nMirror::getLeaveRedirectUrl(): ?string\n```",
    "ContentSha": "ASbdrE3zTSUSJXugp93RT9CQhljnnMqSjoPRvOS23KE=",
    "SectionType": "",
    "StartLine": 0,
    "EndLine": 0,
    "Translation": "```php\nMirror::isImpersonating(): bool\nMirror::getImpersonator(): ?Authenticatable\nMirror::impersonatorId(): int|string|null\nMirror::getLeaveRedirectUrl(): ?string\n```",
    "Status": "ok",
    "RowTranslations": [],
    "IsCodeBlock": true
  },
  {
    "Id": 21,
    "Content": "\n### Aliases\n",
    "ContentSha": "NfnHseIEEp9zNEPc7mzK7W+ACdGYqEIXbwE/W7Dn32A=",
    "SectionType": "",
    "StartLine": 0,
    "EndLine": 0,
    "Translation": "\n### Alias\n",
    "Status": "ok",
    "RowTranslations": [],
    "IsCodeBlock": false
  },
  {
    "Id": 22,
    "Content": "```php\nMirror::as($user);           // same as start()\nMirror::leave();             // same as stop()\nMirror::impersonating();     // same as isImpersonating()\nMirror::impersonator();      // same as getImpersonator()\n```",
    "ContentSha": "ugKWV5kbnBEJ197QurHpy+ERjL6iJONJbUoiasiUnUQ=",
    "SectionType": "",
    "StartLine": 0,
    "EndLine": 0,
    "Translation": "```php\nMirror::as($user);           // same as start()\nMirror::leave();             // same as stop()\nMirror::impersonating();     // same as isImpersonating()\nMirror::impersonator();      // same as getImpersonator()\n```",
    "Status": "ok",
    "RowTranslations": [],
    "IsCodeBlock": true
  },
  {
    "Id": 23,
    "Content": "\n## Middleware\n\n### `mirror.ttl`\n\nChecks if the impersonation session has expired and automatically calls `stop()` if needed:\n",
    "ContentSha": "+2xVKhtUZDjZ/PJh/Uc/g+eywgN4VIbMYKgby99lCvI=",
    "SectionType": "",
    "StartLine": 0,
    "EndLine": 0,
    "Translation": "\n## Middleware\n\n### `mirror.ttl`\n\nVérifie si la session d'usurpation a expiré et appelle automatiquement `stop()` si nécessaire :\n",
    "Status": "ok",
    "RowTranslations": [],
    "IsCodeBlock": false
  },
  {
    "Id": 24,
    "Content": "```php\nRoute::middleware('mirror.ttl')->group(function () {\n    Route::get('/admin/users', [UserController::class, 'index']);\n    Route::get('/admin/users/{user}', [UserController::class, 'show']);\n});\n```",
    "ContentSha": "h6hb9zKnnF5a9b5IOzVVvVmAU+jHnqfhXXVET2sC38o=",
    "SectionType": "",
    "StartLine": 0,
    "EndLine": 0,
    "Translation": "```php\nRoute::middleware('mirror.ttl')->group(function () {\n    Route::get('/admin/users', [UserController::class, 'index']);\n    Route::get('/admin/users/{user}', [UserController::class, 'show']);\n});\n```",
    "Status": "ok",
    "RowTranslations": [],
    "IsCodeBlock": true
  },
  {
    "Id": 25,
    "Content": "\nGood for protecting sensitive admin areas where you want expired sessions to exit gracefully. Note that when TTL expires, this middleware will end the impersonation and redirect, so make sure your session cleanup is set up properly.\n\n### `mirror.require`\n\nOnly allows access if actively impersonating:\n",
    "ContentSha": "IX9vJB6g7lcCAZnafGDuH8wdZ/Qt/TWo9+vN6CDrMoI=",
    "SectionType": "",
    "StartLine": 0,
    "EndLine": 0,
    "Translation": "\nUtile pour protéger les zones d'administration sensibles où vous souhaitez que les sessions expirées se terminent proprement. Notez que lorsque le TTL expire, ce middleware met fin à l'usurpation d'identité et redirige, assurez-vous donc que le nettoyage de votre session est correctement configuré.\n\n### `mirror.require`\n\nN'autorise l'accès que si une usurpation d'identité est active :\n",
    "Status": "ok",
    "RowTranslations": [],
    "IsCodeBlock": false
  },
  {
    "Id": 26,
    "Content": "```php\nRoute::middleware('mirror.require')->group(function () {\n    Route::get('/impersonation/banner', function () {\n        return view('impersonation.banner');\n    });\n});\n```",
    "ContentSha": "x9Z65zTxeMwNrHxK4r6wtTjxOAEEuD7RkPaguyBol5E=",
    "SectionType": "",
    "StartLine": 0,
    "EndLine": 0,
    "Translation": "```php\nRoute::middleware('mirror.require')->group(function () {\n    Route::get('/impersonation/banner', function () {\n        return view('impersonation.banner');\n    });\n});\n```",
    "Status": "ok",
    "RowTranslations": [],
    "IsCodeBlock": true
  },
  {
    "Id": 27,
    "Content": "\nUseful for special UI components that only make sense during impersonation - like a banner showing who you're impersonating.\n\n### `mirror.prevent`\n\nBlocks access while impersonating:\n",
    "ContentSha": "WyowtQ5bEE74iSpPjMPBjxt3AdnJ4vC6wkEaD2SqHeE=",
    "SectionType": "",
    "StartLine": 0,
    "EndLine": 0,
    "Translation": "Utile pour les composants UI spéciaux qui n'ont de sens que lors de l'usurpation d'identité - comme une bannière indiquant qui vous usurpez.\n\n### `mirror.prevent`\n\nBloque l'accès pendant l'usurpation d'identité :\n\n",
    "Status": "ok",
    "RowTranslations": [],
    "IsCodeBlock": false
  },
  {
    "Id": 28,
    "Content": "```php\nRoute::middleware('mirror.prevent')->group(function () {\n    Route::post('/admin/users/{user}/delete', [UserController::class, 'destroy']);\n    Route::get('/admin/settings', [SettingsController::class, 'edit']);\n});\n```",
    "ContentSha": "5kNNOUnRro4ZK1PSuWXNKYOQsgYiMKxlEhGpNjAhUXg=",
    "SectionType": "",
    "StartLine": 0,
    "EndLine": 0,
    "Translation": "```php\nRoute::middleware('mirror.prevent')->group(function () {\n    Route::post('/admin/users/{user}/delete', [UserController::class, 'destroy']);\n    Route::get('/admin/settings', [SettingsController::class, 'edit']);\n});\n```",
    "Status": "ok",
    "RowTranslations": [],
    "IsCodeBlock": true
  },
  {
    "Id": 29,
    "Content": "\nProtects destructive actions or sensitive settings that should only be accessed as the original user, not while impersonating someone else.\n\n## Authorization\n\nThe `Impersonatable` trait provides two methods that both return `true` by default. Override them to add your own logic:\n",
    "ContentSha": "8YJyPOMZf/ZiCfKXHmgxw2c62Auyd+rqD246tD5A+QU=",
    "SectionType": "",
    "StartLine": 0,
    "EndLine": 0,
    "Translation": "\nProtège les actions destructrices ou les paramètres sensibles qui ne doivent être accessibles qu'en tant qu'utilisateur original, et non lors de l'usurpation d'identité d'une autre personne.\n\n## Autorisation\n\nLe trait `Impersonatable` fournit deux méthodes qui retournent toutes deux `true` par défaut. Surchargez-les pour ajouter votre propre logique :\n",
    "Status": "ok",
    "RowTranslations": [],
    "IsCodeBlock": false
  },
  {
    "Id": 30,
    "Content": "```php\nuse Mirror\\Concerns\\Impersonatable;\n\nclass User extends Authenticatable\n{\n    use Impersonatable;\n\n    public function canImpersonate(): bool\n    {\n        return $this->hasRole('admin');\n    }\n\n    public function canBeImpersonated(): bool\n    {\n        return ! $this->hasRole('super-admin');\n    }\n}\n```",
    "ContentSha": "Y+nhMbRTgKtqM+GzNhpeaDCbaV8Uh3uyTd4iLS3R68w=",
    "SectionType": "",
    "StartLine": 0,
    "EndLine": 0,
    "Translation": "```php\nuse Mirror\\Concerns\\Impersonatable;\n\nclass User extends Authenticatable\n{\n    use Impersonatable;\n\n    public function canImpersonate(): bool\n    {\n        return $this->hasRole('admin');\n    }\n\n    public function canBeImpersonated(): bool\n    {\n        return ! $this->hasRole('super-admin');\n    }\n}\n```",
    "Status": "ok",
    "RowTranslations": [],
    "IsCodeBlock": true
  },
  {
    "Id": 31,
    "Content": "\nYou don't need the trait - Mirror will look for these methods on your user model regardless:\n",
    "ContentSha": "6UsRGVCG60iGnVaVvtGSK/ieJ0GDsSD+VOSpKtXGCmY=",
    "SectionType": "",
    "StartLine": 0,
    "EndLine": 0,
    "Translation": "\nVous n'avez pas besoin du trait - Mirror recherchera ces méthodes sur votre modèle utilisateur quoi qu'il arrive :\n",
    "Status": "ok",
    "RowTranslations": [],
    "IsCodeBlock": false
  },
  {
    "Id": 32,
    "Content": "```php\nclass User extends Authenticatable\n{\n    public function canImpersonate(): bool\n    {\n        return $this->hasPermission('impersonate-users');\n    }\n\n    public function canBeImpersonated(): bool\n    {\n        return ! $this->is_system_account;\n    }\n}\n```",
    "ContentSha": "iS5HWjwBNJD0YrZ3FY+P+ciGSL8EPKH/gVXfEBjeMtc=",
    "SectionType": "",
    "StartLine": 0,
    "EndLine": 0,
    "Translation": "```php\nclass User extends Authenticatable\n{\n    public function canImpersonate(): bool\n    {\n        return $this->hasPermission('impersonate-users');\n    }\n\n    public function canBeImpersonated(): bool\n    {\n        return ! $this->is_system_account;\n    }\n}\n```",
    "Status": "ok",
    "RowTranslations": [],
    "IsCodeBlock": true
  },
  {
    "Id": 33,
    "Content": "\n## URL Redirection\n\nYou can control where users go when starting and stopping impersonation:\n",
    "ContentSha": "f+VijkxHpCdAn+RkT7InUCV9MB1F+p8/3dKR/HDixzg=",
    "SectionType": "",
    "StartLine": 0,
    "EndLine": 0,
    "Translation": "\n## Redirection d’URL\n\nVous pouvez contrôler où les utilisateurs vont lorsqu’ils commencent et arrêtent l’usurpation d’identité :\n",
    "Status": "ok",
    "RowTranslations": [],
    "IsCodeBlock": false
  },
  {
    "Id": 34,
    "Content": "```php\npublic function impersonate(User $user)\n{\n    $redirectUrl = Mirror::start(\n        user: $user,\n        leaveRedirectUrl: route('admin.users.index'),  // where to go when they stop\n        startRedirectUrl: route('dashboard')            // where to go right now\n    );\n\n    return redirect($redirectUrl);\n}\n\npublic function leave()\n{\n    Mirror::stop();\n\n    return redirect(Mirror::getLeaveRedirectUrl());\n}\n```",
    "ContentSha": "w2geuZiNCm7fasmuRjL1y2ocFxubAkQfJhZBLsGrDcw=",
    "SectionType": "",
    "StartLine": 0,
    "EndLine": 0,
    "Translation": "```php\npublic function impersonate(User $user)\n{\n    $redirectUrl = Mirror::start(\n        user: $user,\n        leaveRedirectUrl: route('admin.users.index'),  // where to go when they stop\n        startRedirectUrl: route('dashboard')            // where to go right now\n    );\n\n    return redirect($redirectUrl);\n}\n\npublic function leave()\n{\n    Mirror::stop();\n\n    return redirect(Mirror::getLeaveRedirectUrl());\n}\n```",
    "Status": "ok",
    "RowTranslations": [],
    "IsCodeBlock": true
  },
  {
    "Id": 35,
    "Content": "\nIf you don't specify `leaveRedirectUrl`, it defaults to the current URL where `start()` was called.\n\n## Events\n\nMirror dispatches two events you can listen to:\n\n- `Mirror\\Events\\ImpersonationStarted`\n- `Mirror\\Events\\ImpersonationStopped`\n\nBoth events contain the impersonator, the target user, and the guard name. Good for audit logs or triggering workflows.\n\nEvents are dispatched **after the response** is sent to the client, ensuring that critical impersonation operations complete without delay. This is especially important for middleware like `mirror.ttl` that may run on every request.\n",
    "ContentSha": "aaRCBpIWnFWtgZGwnEYZN4PjyTAnlC1rMVss7DD3iqY=",
    "SectionType": "",
    "StartLine": 0,
    "EndLine": 0,
    "Translation": "\nSi vous ne spécifiez pas `leaveRedirectUrl`, il prend par défaut l'URL actuelle où `start()` a été appelé.\n\n## Événements\n\nMirror déclenche deux événements auxquels vous pouvez vous abonner :\n\n- `Mirror\\Events\\ImpersonationStarted`\n- `Mirror\\Events\\ImpersonationStopped`\n\nLes deux événements contiennent l'utilisateur usurpateur, l'utilisateur cible, et le nom du garde. Utile pour les journaux d'audit ou le déclenchement de workflows.\n\nLes événements sont déclenchés **après que la réponse** a été envoyée au client, garantissant que les opérations critiques d'usurpation se terminent sans délai. Ceci est particulièrement important pour les middlewares comme `mirror.ttl` qui peuvent s'exécuter à chaque requête.\n",
    "Status": "ok",
    "RowTranslations": [],
    "IsCodeBlock": false
  },
  {
    "Id": 36,
    "Content": "```php\nuse Mirror\\Events\\ImpersonationStarted;\n\nEvent::listen(ImpersonationStarted::class, function (ImpersonationStarted $event) {\n    // Log the activity to your audit system of choice\n    Log::info('User impersonation started', [\n        'impersonator_id' => $event->impersonator->id,\n        'impersonated_id' => $event->impersonated->id,\n        'guard' => $event->guardName,\n    ]);\n});\n```",
    "ContentSha": "evZB+xwnGqxRuWPRnOKqYtlGajmi1uB1LaD+HjeOxpQ=",
    "SectionType": "",
    "StartLine": 0,
    "EndLine": 0,
    "Translation": "```php\nuse Mirror\\Events\\ImpersonationStarted;\n\nEvent::listen(ImpersonationStarted::class, function (ImpersonationStarted $event) {\n    // Log the activity to your audit system of choice\n    Log::info('User impersonation started', [\n        'impersonator_id' => $event->impersonator->id,\n        'impersonated_id' => $event->impersonated->id,\n        'guard' => $event->guardName,\n    ]);\n});\n```",
    "Status": "ok",
    "RowTranslations": [],
    "IsCodeBlock": true
  },
  {
    "Id": 37,
    "Content": "\n## Performance & Optimization\n\nMirror is optimized for high-performance applications:\n\n### Request-Scoped Caching\n\nThe impersonator model is cached within a single request to avoid redundant database queries:\n",
    "ContentSha": "/AAKpN1jGOF5hFrcB8qYCytVSzDMxpbMvAvbnQ34hsM=",
    "SectionType": "",
    "StartLine": 0,
    "EndLine": 0,
    "Translation": "\n## Performance et optimisation\n\nMirror est optimisé pour les applications à haute performance :\n\n### Mise en cache à l’échelle de la requête\n\nLe modèle d’usurpation est mis en cache au sein d’une seule requête pour éviter les requêtes redondantes à la base de données :\n",
    "Status": "ok",
    "RowTranslations": [],
    "IsCodeBlock": false
  },
  {
    "Id": 38,
    "Content": "```php\n// This first call will query the database\n$impersonator = Mirror::getImpersonator();\n\n// Subsequent calls in the same request use the cached instance, therefore this one will not:\n$impersonator = Mirror::getImpersonator();\n```",
    "ContentSha": "FK5F4fpZdKZkL+plPAb51gExZavW/NjYs7Sunot4hOM=",
    "SectionType": "",
    "StartLine": 0,
    "EndLine": 0,
    "Translation": "```php\n// This first call will query the database\n$impersonator = Mirror::getImpersonator();\n\n// Subsequent calls in the same request use the cached instance, therefore this one will not:\n$impersonator = Mirror::getImpersonator();\n```",
    "Status": "ok",
    "RowTranslations": [],
    "IsCodeBlock": true
  },
  {
    "Id": 39,
    "Content": "\nThis is particularly beneficial for middleware like `mirror.ttl` that run on every request.\n\n### Deferred Event Dispatching\n\nImpersonation events are dispatched after the response is sent to the client, ensuring that event listeners don't impact response time. This keeps your request cycle fast while still allowing audit logging and other background tasks.\n\n## Multi-Guard Support\n\nMirror automatically detects which guard you're using:\n",
    "ContentSha": "9gNUlx5MJkIFcxtk5razZ8HKRi1TwyELiQ/EiPaX1MM=",
    "SectionType": "",
    "StartLine": 0,
    "EndLine": 0,
    "Translation": "\nCela est particulièrement bénéfique pour les middlewares comme `mirror.ttl` qui s'exécutent à chaque requête.\n\n### Diffusion différée des événements\n\nLes événements d'usurpation d'identité sont diffusés après l'envoi de la réponse au client, garantissant que les écouteurs d'événements n'impactent pas le temps de réponse. Cela maintient votre cycle de requête rapide tout en permettant la journalisation d'audit et d'autres tâches en arrière-plan.\n\n## Support Multi-Guard\n\nMirror détecte automatiquement quel garde vous utilisez :\n",
    "Status": "ok",
    "RowTranslations": [],
    "IsCodeBlock": false
  },
  {
    "Id": 40,
    "Content": "```php\nAuth::guard('admin')->login($admin);\n\nMirror::start($user); // uses 'admin' guard\n\nMirror::stop(); // restores to 'admin' guard\n```",
    "ContentSha": "H1LHC2b41fDfPASL2P/QFKNK3YVPPjODM87qo5v1EEY=",
    "SectionType": "",
    "StartLine": 0,
    "EndLine": 0,
    "Translation": "```php\nAuth::guard('admin')->login($admin);\n\nMirror::start($user); // uses 'admin' guard\n\nMirror::stop(); // restores to 'admin' guard\n```",
    "Status": "ok",
    "RowTranslations": [],
    "IsCodeBlock": true
  },
  {
    "Id": 41,
    "Content": "\nYou don't need to specify the guard manually - it figures it out from the current auth context.\n\n## Blade Directives\n\n**@impersonating**\n",
    "ContentSha": "efsoDftxNeswwJcWLtg8mJtgTa1laHvArynWdlReOTc=",
    "SectionType": "",
    "StartLine": 0,
    "EndLine": 0,
    "Translation": "\nVous n'avez pas besoin de spécifier manuellement le garde - il le déduit du contexte d'authentification actuel.\n\n## Directives Blade\n\n**@impersonating**\n",
    "Status": "ok",
    "RowTranslations": [],
    "IsCodeBlock": false
  },
  {
    "Id": 42,
    "Content": "```blade\n@impersonating\n    <div class=\"alert\">\n        You're impersonating {{ auth()->user()->name }}.\n        <a href=\"{{ route('impersonation.leave') }}\">Exit</a>\n    </div>\n@endimpersonating\n\n{{-- Check specific guard --}}\n@impersonating('admin')\n    <div>Impersonating via admin guard</div>\n@endimpersonating\n```",
    "ContentSha": "sFMJejVcAl8nAN3eSdkWRnNOTxKjUxXneJzUoPmu98Q=",
    "SectionType": "",
    "StartLine": 0,
    "EndLine": 0,
    "Translation": "```blade\n@impersonating\n    <div class=\"alert\">\n        You're impersonating {{ auth()->user()->name }}.\n        <a href=\"{{ route('impersonation.leave') }}\">Exit</a>\n    </div>\n@endimpersonating\n\n{{-- Check specific guard --}}\n@impersonating('admin')\n    <div>Impersonating via admin guard</div>\n@endimpersonating\n```",
    "Status": "ok",
    "RowTranslations": [],
    "IsCodeBlock": true
  },
  {
    "Id": 43,
    "Content": "\n**@canImpersonate**\n",
    "ContentSha": "x8mymTlzoPTZpZoBhPN4zkN5GEJDchnyUvj+3OqFeAU=",
    "SectionType": "",
    "StartLine": 0,
    "EndLine": 0,
    "Translation": "\n**@peuxJeUsurper**\n",
    "Status": "ok",
    "RowTranslations": [],
    "IsCodeBlock": false
  },
  {
    "Id": 44,
    "Content": "```blade\n@canImpersonate\n    <a href=\"{{ route('admin.users.index') }}\">Manage Users</a>\n@endcanImpersonate\n\n{{-- With guard --}}\n@canImpersonate('admin')\n    <div>Admin tools</div>\n@endcanImpersonate\n```",
    "ContentSha": "2jIsL2qpARJuo3otgj5yduqV2v1i3HdnU6Pu8yI3m7I=",
    "SectionType": "",
    "StartLine": 0,
    "EndLine": 0,
    "Translation": "```blade\n@canImpersonate\n    <a href=\"{{ route('admin.users.index') }}\">Manage Users</a>\n@endcanImpersonate\n\n{{-- With guard --}}\n@canImpersonate('admin')\n    <div>Admin tools</div>\n@endcanImpersonate\n```",
    "Status": "ok",
    "RowTranslations": [],
    "IsCodeBlock": true
  },
  {
    "Id": 45,
    "Content": "\n**@canBeImpersonated**\n",
    "ContentSha": "Rq1g9K5PpkX6OdosGb0k7qfPn9+1oyhz27bvOiDGCzc=",
    "SectionType": "",
    "StartLine": 0,
    "EndLine": 0,
    "Translation": "\n**@peutÊtreUsurpé**\n",
    "Status": "ok",
    "RowTranslations": [],
    "IsCodeBlock": false
  },
  {
    "Id": 46,
    "Content": "```blade\n{{-- Check current user --}}\n@canBeImpersonated\n    <span>Available for support</span>\n@endcanBeImpersonated\n\n{{-- Check specific user --}}\n@canBeImpersonated($user)\n    <form method=\"POST\" action=\"{{ route('impersonation.start', $user) }}\">\n        @csrf\n        <button>Impersonate</button>\n    </form>\n@endcanBeImpersonated\n\n{{-- With guard --}}\n@canBeImpersonated($user, 'admin')\n    <button>Login as this user</button>\n@endcanBeImpersonated\n```",
    "ContentSha": "7ndu5CtcqO9hBoTTas3wUlc7kmXEpQMMVyvMGFpVEcU=",
    "SectionType": "",
    "StartLine": 0,
    "EndLine": 0,
    "Translation": "```blade\n{{-- Check current user --}}\n@canBeImpersonated\n    <span>Available for support</span>\n@endcanBeImpersonated\n\n{{-- Check specific user --}}\n@canBeImpersonated($user)\n    <form method=\"POST\" action=\"{{ route('impersonation.start', $user) }}\">\n        @csrf\n        <button>Impersonate</button>\n    </form>\n@endcanBeImpersonated\n\n{{-- With guard --}}\n@canBeImpersonated($user, 'admin')\n    <button>Login as this user</button>\n@endcanBeImpersonated\n```",
    "Status": "ok",
    "RowTranslations": [],
    "IsCodeBlock": true
  },
  {
    "Id": 47,
    "Content": "\n## License\n\nMIT. See [LICENSE.md](https://raw.githubusercontent.com/franbarbalopez/mirror/master/LICENSE.md).\n\n## Credits\n\nDeveloped by [franbarbalopez](https://github.com/franbarbalopez).\n",
    "ContentSha": "DH814T/nBcO8J0FB8M4be/xnNAId1T4y4K9gplO7WKw=",
    "SectionType": "",
    "StartLine": 0,
    "EndLine": 0,
    "Translation": "\n## Licence\n\nMIT. Voir [LICENSE.md](https://raw.githubusercontent.com/franbarbalopez/mirror/master/LICENSE.md).\n\n## Crédits\n\nDéveloppé par [franbarbalopez](https://github.com/franbarbalopez).\n",
    "Status": "ok",
    "RowTranslations": [],
    "IsCodeBlock": false
  }
]