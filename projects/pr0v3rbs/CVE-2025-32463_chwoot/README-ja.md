
# CVE-2025-32463 – sudo chroot ("chwoot") PoC

このリポジトリは、`sudo` の chroot 機能における **CVE‑2025‑32463** 権限昇格脆弱性を示すための最小限の再現環境を提供します。
- この脆弱性は、[Rich Mirch](https://www.stratascale.com/team/rich-mirch)（Xの[@0xm1rch](https://x.com/0xm1rch)）が [Stratascale](https://www.stratascale.com/) にて報告しました。
- オリジナル投稿: [脆弱性アドバイザリ: Sudo chroot 権限昇格](https://www.stratascale.com/vulnerability-alert-CVE-2025-32463-sudo-chroot)
- NVD: [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)（CVSS 9.3）

---

## 影響を受けるバージョン

> ほとんどのLinuxディストリビューションにおける **sudo 1.9.14** から **1.9.17** （全てのpリビジョン）が影響を受けます。

セキュリティページ
- [Ubuntu](https://ubuntu.com/security/CVE-2025-32463)（CVSS 9.3）
- [Redhat](https://access.redhat.com/security/cve/cve-2025-32463)（CVSS 7.8）
- [SUSE](https://www.suse.com/security/cve/CVE-2025-32463.html)（CVSS 7.8）
- [Debian](https://security-tracker.debian.org/tracker/CVE-2025-32463)

---

## 内容

| ファイル名          | 目的                                                                             |
| ------------------ | -------------------------------------------------------------------------------- |
| **Dockerfile**     | 脆弱な **sudo 1.9.16p2** とビルドツールを含む Ubuntu 24.04 イメージを作成       |
| **sudo‑chwoot.sh** | chroot 内に root シェルを生成するプルーフ・オブ・コンセプトエクスプロイト          |
| **run.sh**         | イメージのビルド（必要な場合）とエクスプロイトコンテナの起動を補助するスクリプト   |

---

## 簡易脆弱性チェック

```bash
# Vulnerable sudo
pwn ~ $ sudo -R woot woot
sudo: woot: No such file or directory

# Patched sudo
pwn ~ $ sudo -R woot woot
[sudo] password for pwn:
sudo: you are not permitted to use the -R option with woot
```
## Dockerコンテナ内でのテストエクスプロイト


```bash
# 1 – clone repo
$ git clone https://github.com/pr0v3rbs/CVE-2025-32463_chwoot.git
$ cd CVE-2025-32463_chwoot

# 2 – build and run Docker image (tagged "sudo-chwoot")
$ ./run.sh

# 3 – run exploit in container (runs root command directly or drops you into a root shell)
pwn@f722d9182d1f:~$ ./sudo-chwoot.sh id
woot!
uid=0(root) gid=0(root) groups=0(root),1001(pwn)
pwn@f722d9182d1f:~$ ./sudo-chwoot.sh
woot!
root@f722d9182d1f:/# id
uid=0(root) gid=0(root) groups=0(root),1001(pwn)
root@f722d9182d1f:/#
```
`run.sh` は Docker に `--privileged` と `--rm` を渡すので、終了時にコンテナが自動的にクリーンアップされます。

---

## クリーンアップ

作業が終わったらイメージを削除してください:


```bash
docker rmi sudo-chwoot
```
---

## 参考文献

- Stratascale CRU 脆弱性ノート: [脆弱性アドバイザリ: Sudo chroot 権限昇格](https://www.stratascale.com/vulnerability-alert-CVE-2025-32463-sudo-chroot)



---

Tranlated By [Open Ai Tx](https://github.com/OpenAiTx/OpenAiTx) | Last indexed: 2025-07-16

---