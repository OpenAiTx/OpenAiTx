# BookHaven

![BookHaven Home](https://raw.githubusercontent.com/HrBingR/BookHaven/master/./bookhaven_home.png)

## 目次
1. [アプリケーションの機能](#what-the-application-does)
2. [特徴](#features)
3. [デプロイ](#deployment)
   - [Docker](#docker)
   - [開発](#development)
4. [アプリケーションのビルド](#building-the-application)
5. [変更履歴](#change-log)


## アプリケーションの機能
BookHavenは、ローカルのEPUB電子書籍ライブラリをスキャンして管理し、洗練されたモダンでレスポンシブなインターフェースで、どのデバイスでも電子書籍を読んだりダウンロードしたりできます。

## 特徴
- **ブラウザで電子書籍を読む**
  ユーザーは追加のソフトウェアなしでEPUB形式の電子書籍に直接アクセスし読書できます。
- **電子書籍のダウンロード**
  コレクション内の任意の電子書籍を簡単にデバイスにダウンロードできます。
- **非破壊的なメタデータ編集**
  電子書籍のメタデータ（例：タイトル、著者、シリーズ）への変更はデータベースに保存され、元のEPUBファイルは変更されません。
- **自動または手動のライブラリスキャン**
  デプロイ後は設定可能な間隔で定期的にライブラリの変更をスキャンし、手動スキャンも可能です。
- **アルファベット順に並べ替えられたホームページ**
  書籍はまず著者名でアルファベット順に、次にシリーズ順に並べ替えられ、すっきりと直感的なブラウジングを提供します。
- **強力な検索機能**
  ホームページの検索機能で著者、書籍タイトル、シリーズ別にライブラリをフィルターでき、特定のコンテンツを素早く見つけられます。
- **フィルター**
  お気に入り、読了済み、未読了の書籍をフィルタリングする基本的なフィルターが利用可能です。
- **直感的なナビゲーションを備えた著者ページ**
  専用の著者ページは著者をクリック可能なアルファベットグリッドで整理。文字をクリックして著者リストを展開し、著者ページに移動、シリーズや単独タイトルごとにアルファベット順に並べられた書籍を閲覧できます。
- **CloudFlare Access対応**
  CloudFlare Access使用時にログイン画面をバイパスするフラグがあります。詳細は`.env.example`を参照してください。
- **OIDCサポート**
  新規ユーザー登録および既存ユーザー向けにOIDCの設定が可能です。
- **OPDSサポート**
  お気に入りのOPDS対応電子書籍リーダーやアプリを使って、ライブラリから書籍の閲覧、ダウンロード、読書ができます。
- **アップロード機能**  
  ユーザーはユーザーインターフェースを通じて電子書籍を直接アップロードできるようになり、アップロード後にメタデータを修正するフォームが提供されます。  
- **基本的なRBACサポート**  
  管理者はユーザーに異なるアクセスレベルの異なる役割を割り当てることができるようになりました。  
- **書籍リクエスト**  
  ユーザーはサイトに掲載してほしい特定の書籍をリクエストできるようになりました。管理者や編集者はこれらのリクエストを閲覧し、アップロードまたは追加後に対応できます。  

## デプロイメント  

### 要件  

アプリケーションを実行するための最低限の要件は次の通りです:  

- データベース（MySQL、SQLite、PostgreSQL）  
- Redisインスタンス  

簡単かつ迅速なデプロイのために、`.compose.yml.example`にはこれらが既に定義されています。  

### Docker  
Docker Composeでアプリケーションをデプロイする手順は以下の通りです:  
1. **設定ファイルのダウンロード**  
`compose.yml.example`および`.env.example`を入手するためにリポジトリをダウンロードまたはクローンします。  

2. **サンプルファイルのリネーム**
``` bash
   mv compose.yml.example compose.yml
   mv .env.example .env
```
3. **`.env` ファイルのカスタマイズ**

重要な設定を構成するために `.env` を編集します。

4. **アプリケーションの起動**

次のコマンドを実行します：
``` bash
   docker compose up -d
```
これで `BookHaven`、Redis、および MySQL コンテナが起動します。  
5. **アプリケーションへのアクセス**  

ブラウザを開き、設定した `BASE_URL`:`APP_PORT` にアクセスします（デフォルトは `http://localhost:5000`）。  

6. **アプリケーションの停止**

``` bash
   docker compose down
```

### 開発
開発用のデプロイ手順は以下の通りです:
1. **リポジトリをクローンする**:
``` bash
   git clone https://github.com/HrBingR/BookHaven.git
   cd BookHaven
```

2. **例のファイル名を変更する**:
```bash
   mv compose.exmaple.yml compose.yml
   mv .env.example .env
```

3. **`.env`ファイルのカスタマイズ**:

`.env`を編集して、基本設定を構成します。

4. **`compose.yml`ファイルの修正**:

次のように変更します：

```yaml
    epub-reader:
       image: hrbingr/bookhaven:latest
```

To:

```yaml
  epub-reader:
     build:
        context: .
        dockerfile: Dockerfile
```

5. **コンテナをビルドする**:
```bash
   docker compose up --build -d
```

6. **アプリにアクセスする**：

`.env` ファイルで定義された `BASE_URL` と `APP_PORT` でアプリにアクセスします。

## アプリケーションのビルド
本番用にアプリケーションをビルドするには：
1. **フロントエンドをビルドする**：
``` bash
   cd frontend
   npm run build:dev
```
2. **Dockerイメージのビルド**：

ルートプロジェクトディレクトリ（BookHaven）で次を実行します：
``` bash
   docker build -t tag:version .
```
`tag:version` を、お好みのイメージ名とバージョン（例：`bookhaven:1.0.0`）に置き換えてください。

## 変更履歴：

詳細な変更履歴は [CHANGELOG](https://raw.githubusercontent.com/HrBingR/BookHaven/master/CHANGELOG.md) をご覧ください。

- v1.0.x
  - 初期リリース
- v1.1.0 - v1.1.1
  - OIDCサポートを追加
  - OIDCが無効でもOIDCフロントエンドコンポーネントがレンダリングされるバグを修正
- v1.2.0 - v1.2.2
  - メタデータをデータベースだけでなくePubファイルにもオプションで書き込むサポートを追加
  - Celeryが明示的に定義されたPERIODIC_SCAN_INTERVALを文字列として検出し例外を投げる問題を修正
  - Postgresユーザーがデータベースを正常に初期化できない問題を引き起こすマイグレーションとDBモデルのロジックを修正
- v1.3.0 - v1.3.5
  - 基本的なOPDSサポートを追加
  - OPDS機能を改善
  - 著者ページのUI問題を修正
  - ホームページのスクロールに関するUX問題をいくつか修正
  - フロントエンドでの表紙画像の読み込みを改善
  - デフォルトのAPIレート制限を引き上げ、カスタマイズ可能に
  - スキャンプロセスのロックを実装し、一度に一つのスキャンのみ実行可能に
  - スキャンロジックのDBコンポーネントを改善
  - 「著者」ページのモバイルで展開された著者リストのレンダリングを修正
  - スキャンロジックを更新し、起動時に自動でライブラリがスキャンされるように
- v1.4.0 - v1.4.1
  - アップロード機能を追加 - 有効化と使用方法は .env.example を参照
  - スキャナのフォールバック識別子を相対パスからファイル名に更新
  - 既存のフォールバック識別子を更新するマイグレーションを作成
  - アップロードパフォーマンス向上のためgunicornのsyncからgthreadへ切り替え
  - 予定スキャン用のceleryタスクのインポートを修正
  - アップロード機能が無効時にアップロードボタンを非表示にする問題を修正
- v1.5.0 - v1.5.2
  - ロールベースアクセス制御（RBAC）を追加。管理者は以下のようにユーザーに異なるロールを付与可能に：
    - ユーザー：アップロード、メタデータ編集、ユーザー管理を除く基本機能にアクセス可能
    - 編集者：アップロードとメタデータ編集にアクセス可能
    - 管理者：他ユーザーの管理にアクセス可能
  - Cloudflare Access経由のログイン時のロジックを改善
  - 削除されていなかったレガシーカラムに影響する軽微なバグを修正
  - マイグレーションスクリプトの耐障害性を向上させました。
- v.1.6.0
  - ユーザーが新しい書籍の追加をサイトにリクエストできる機能を追加しました。

## TODO:

- 最新の追加機能に合わせてテストを更新する
- 他のフォーマットのサポートを検討する
- 編集用のメタデータフィールドをさらに追加することを検討する

---

Tranlated By [Open Ai Tx](https://github.com/OpenAiTx/OpenAiTx) | Last indexed: 2025-09-22

---