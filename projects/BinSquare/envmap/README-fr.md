<p align="center">
  <img src="https://raw.githubusercontent.com/BinSquare/envmap/main/./logo.svg" alt="logo envmap" width="280">
</p>

<p align="center">
  <a href="https://github.com/binsquare/envmap/stargazers">
    <img src="https://img.shields.io/github/stars/binsquare/envmap?style=social" alt="Étoiles GitHub">
  </a>
  <a href="https://github.com/binsquare/envmap/actions/workflows/release.yml">
    <img src="https://img.shields.io/github/actions/workflow/status/binsquare/envmap/release.yml?branch=main&event=push&label=release" alt="Statut du workflow de release">
  </a>
  <a href="https://pkg.go.dev/github.com/binsquare/envmap">
    <img src="https://pkg.go.dev/badge/github.com/binsquare/envmap" alt="Référence Go pkg">
  </a>
  <a href="https://goreportcard.com/report/github.com/binsquare/envmap">
    <img src="https://goreportcard.com/badge/github.com/binsquare/envmap" alt="Carte de rapport Go">
  </a>
  <a href="https://github.com/binsquare/envmap/blob/main/LICENSE">
    <img src="https://img.shields.io/github/license/binsquare/envmap" alt="Licence : Apache-2.0">
  </a>
</p>

# envmap

`envmap` est un gestionnaire local d'environnement qui vous aide à :

1.  Garder les variables d'environnement locales synchronisées avec les magasins de secrets distants, par projet.
2.  Faire du fichier `.env` un artefact éphémère, pour que les fournisseurs de secrets restent la source de vérité. c’est-à-dire "envmap --sync" pour produire un fichier `.env` nouvellement mis à jour.
3.  Fournir des métadonnées sur chaque clé stockée afin d’indiquer quand ces clés ont été modifiées/créées pour faciliter les rotations régulières.
4.  Offrir potentiellement une meilleure sécurité puisque vous n’êtes pas obligé de stocker les secrets dans un fichier `.env` en texte clair.
5.  Fonctionner entièrement en local + être open source pour les audits.

### À qui cela s’adresse-t-il ?

- Aux ingénieurs travaillant avec plusieurs variantes de `.env` comme `.env.prod, .env.dev, .env.staging`. Cela vous aidera à consolider et à changer d’environnement avec une seule commande. Voici un exemple de ce workflow : 

```
(base) binsquare@mac.lan:~/Documents/envMap (main*) $ ./envmap sync --env prod
Wrote .env (1 secrets)
(base) binsquare@mac.lan:~/Documents/envMap (main*) $ cat .env
# generated by envmap sync 2025-12-01T07:49:20Z
testkey=apishofih123
(base) binsquare@mac.lan:~/Documents/envMap (main*) $ ./envmap sync --env dev
Wrote .env (1 secrets)
(base) binsquare@mac.lan:~/Documents/envMap (main*) $ cat .env
# generated by envmap sync 2025-12-01T07:50:07Z
testkey=test123
```

- Les ingénieurs travaillant avec une longue liste de variables d'environnement veulent simplement un outil qui les aide à gérer cela et augmente la vitesse de développement en s'assurant que vous disposez des métadonnées  
- Les ingénieurs travaillant sur plusieurs projets veulent consolider et suivre les variables d'environnement à l'échelle globale.  

## Installation  

### Option 1 : Chaîne d'outils Go

```sh
go install github.com/binsquare/envmap@latest
```

### Option 2 : Binaire précompilé (bash)

```sh
# install into /usr/local/bin (requires sudo)
curl -sSfL "https://github.com/binsquare/envmap/releases/latest/download/envmap_$(uname -s)_$(uname -m).tar.gz" \
  | sudo tar -xz -C /usr/local/bin envmap

# or install into ~/.local/bin (no sudo; ensure it's on PATH)
mkdir -p ~/.local/bin
curl -sSfL "https://github.com/binsquare/envmap/releases/latest/download/envmap_$(uname -s)_$(uname -m).tar.gz" \
  | tar -xz -C ~/.local/bin envmap

# (optional) verify checksum (adjust path if using ~/.local/bin)
curl -sSfL "https://github.com/binsquare/envmap/releases/latest/download/envmap_$(uname -s)_$(uname -m).tar.gz.sha256" \
  | sha256sum --check -
```

Si vous utilisez l’option `~/.local/bin`, assurez-vous que votre shell la charge (la plupart des shells modernes le font déjà ; sinon, ajoutez `export PATH="$HOME/.local/bin:$PATH"` à votre profil).

Redémarrez le shell (ou rechargez le profil) et exécutez `envmap --help` pour vérifier.

## Démarrage rapide (fournisseur local)

```sh
# 1. Generate encryption key (writes to ~/.envmap/key)
envmap keygen

# 2. Configure global provider (wizard; runs keygen if needed)
envmap init --global

# 3. Create project config (wizard)
envmap init

# 4. Add secrets
envmap set --env dev DATABASE_URL --prompt
envmap set --env dev STRIPE_KEY --prompt

# 5. Inspect/export/run
envmap get --env dev --all
eval $(envmap export --env dev)
envmap run --env dev -- npm start
```

Préférez les assistants, mais la configuration manuelle est prise en charge. Utilisez des chemins absolus (Go n'étend pas `~` ni `${HOME}`).

<details>
<summary>Référence de configuration manuelle</summary>

### Configuration globale (`~/.envmap/config.yaml`)

```yaml
providers:
  local-dev:
    type: local-file
    path: /Users/<you>/.envmap/secrets.db
    encryption:
      key_file: /Users/<you>/.envmap/key
```

### Configuration du projet (`.envmap.yaml`)

```yaml
project: demo
default_env: dev
envs:
  dev:
    provider: local-dev
    prefix: demo/dev/
```

</details>

## Utilisation

- `envmap run [--env <name>] -- <commande>` – récupérer les secrets et exécuter la commande avec ces derniers injectés comme variables d’environnement (le disque ne les voit jamais).
- `envmap export [--env <name>] [--format plain|json]` – sortie adaptée pour `eval`, direnv, ou outils.
- `envmap get --env <name> KEY [--raw]` – lire des secrets individuels.
- `envmap get --env <name> --all [--raw] [--global]` – lister tous les secrets (masqués par défaut) ; `--global` parcourt tous les environnements.
- `envmap set --env <name> KEY (--prompt | --file PATH)` – écrire/modifier des secrets sans historique shell.
- `envmap import PATH --env <name> [--delete]` – importer des fichiers `.env` existants.
- `envmap sync --env <name> [--out .env] [--merge] [--keep-local] [--force] [--backup=false]` – écrire un fichier .env à partir des secrets du fournisseur. Le fournisseur gagne par défaut ; merge conserve les clés locales supplémentaires ; keep-local préserve les valeurs locales en cas de conflit ; backup écrit d'abord un .bak.
- `envmap sync --env <name> --check` – signaler les écarts entre fournisseur et .env sans écrire.
- `envmap keygen [-o PATH]` – créer une clé 256 bits pour le fournisseur local.
- `envmap validate` – confirmer que `.envmap.yaml` et la config globale référencent des fournisseurs définis.
- `envmap init` / `envmap init --global` – configuration interactive projet/globale.

### Utilisation avec direnv

```sh
# .envrc
eval "$(envmap export --env dev)"
```

Puis exécutez `direnv allow`. Chaque fois que vous entrez dans le répertoire, direnv relancera `envmap export` et remplira le shell avec des secrets récents sans toucher au disque.

## Configuration

### Configuration globale (`~/.envmap/config.yaml`)

```yaml
providers:
  aws-dev:
    type: aws-ssm
    region: us-west-2
    profile: dev # optional, uses default credential chain

  vault-prod:
    type: vault
    address: https://vault.internal:8200
    mount: secret # default: secret

  local:
    type: local-file
    path: ~/.envmap/secrets.db
    encryption:
      key_file: ~/.envmap/key # must be chmod 600
      # or: key_env: ENVMAP_KEY
```

### Configuration du projet (`.envmap.yaml`)

```yaml
project: myapp
default_env: dev

envs:
  dev:
    provider: aws-dev
    path_prefix: /myapp/dev/

  staging:
    provider: aws-dev
    path_prefix: /myapp/staging/

  local:
    provider: local
    prefix: myapp/
```

## Fournisseurs intégrés (WIP)

| Type                 | Auth                       | Notes                                                    |
| -------------------- | -------------------------- | -------------------------------------------------------- |
| `aws-ssm`            | IAM (profil/env/instance)  | Nécessite `path_prefix`. Utilise SecureString.           |
| `aws-secretsmanager` | IAM                        | Noms complets des secrets. Secrets JSON décomposés en `name/key`. |
| `gcp-secretmanager`  | ADC ou compte de service   | Lit la dernière version. Ajoute la version lors de l’écriture. |
| `vault`              | Jeton (env/config)         | KV v2. Chemin de montage et namespace configurables.    |
| `onepassword`        | Serveur Connect            | Nécessite `connect_host`. Éléments appariés par titre.   |
| `doppler`            | Jeton de service           | Lecture seule ; écritures nécessitent le CLI Doppler.   |
| `local-file`         | AES-256-GCM                | Clé depuis fichier (0600) ou variable env. Pour dev local. |

## Modèle de sécurité

- Les secrets ne touchent jamais le disque en fonctionnement normal. (sauf si vous choisissez d’utiliser localstore pour stocker toutes vos variables d’environnement)
- Nous avons seulement `set --prompt` et `set --file` pour éviter de sauvegarder les secrets dans l’historique du shell.
- Les valeurs sont masquées par défaut dans les sorties `env` et `get`

## Contributions

Les contributions et rapports de bugs sont les bienvenus—ouvrez un problème ou soumettez une PR si vous trouvez un bug.

## Licence

Sous licence Apache License, Version 2.0. Voir [LICENSE](./LICENSE) pour plus de détails.


---

Tranlated By [Open Ai Tx](https://github.com/OpenAiTx/OpenAiTx) | Last indexed: 2026-01-21

---