
<div align="right">
  <details>
    <summary >ğŸŒ èªè¨€</summary>
    <div>
      <div align="center">
        <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=en">English</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=zh-CN">ç°¡é«”ä¸­æ–‡</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=zh-TW">ç¹é«”ä¸­æ–‡</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=ja">æ—¥æœ¬èª</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=ko">í•œêµ­ì–´</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=hi">à¤¹à¤¿à¤¨à¥à¤¦à¥€</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=th">à¹„à¸—à¸¢</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=fr">FranÃ§ais</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=de">Deutsch</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=es">EspaÃ±ol</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=it">Itapano</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=ru">Ğ ÑƒÑÑĞºĞ¸Ğ¹</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=pt">PortuguÃªs</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=nl">Nederlands</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=pl">Polski</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=ar">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=fa">ÙØ§Ø±Ø³ÛŒ</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=tr">TÃ¼rkÃ§e</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=vi">Tiáº¿ng Viá»‡t</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=id">Bahasa Indonesia</a>
      </div>
    </div>
  </details>
</div>

<div align="center">

# s3 - é€éå¼·åŒ–å­¸ç¿’è¨“ç·´é«˜æ•ˆä¸”æœ‰æ•ˆçš„æœå°‹ä»£ç†äºº
***ä½ ä¸éœ€è¦å¤§é‡è³‡æ–™ä¾†è¨“ç·´æœå°‹ä»£ç†äºº***

<p align="center">

  <a href="https://arxiv.org/abs/2505.14146">
    <img src="https://img.shields.io/badge/arXiv-2505.14146-b31b1b.svg" alt="arXiv">
  </a>
</p>
</div>

**æ•ˆèƒ½æ¦‚è¦½ï¼š**

<img src="https://raw.githubusercontent.com/pat-jj/s3/main/images/performance_overview.png" alt="performance_overview" width="800">



## ä»€éº¼æ˜¯ s3ï¼Ÿ

<div align="center">
<img src="https://raw.githubusercontent.com/pat-jj/s3/main/images/framework.png" alt="framework" width="800">

**s3 æ¡†æ¶**
</div>

`s3` æ˜¯ä¸€å€‹ç°¡æ½”ä¸”å¼·å¤§çš„æ¡†æ¶ï¼Œç”¨æ–¼è¨“ç·´æœå°‹ä»£ç†æ–¼æª¢ç´¢å¢å¼·ç”Ÿæˆï¼ˆRAGï¼‰ä¸­ã€‚å®ƒæ•™å°èªè¨€æ¨¡å‹å¦‚ä½•æ›´æœ‰æ•ˆåœ°æœå°‹â€”â€”è€Œä¸éœ€è¦æ”¹è®Šç”Ÿæˆå™¨æœ¬èº«ã€‚é€šéåªå°ˆæ³¨æ–¼æœå°‹çµ„ä»¶ï¼Œ`s3` èƒ½ä»¥é å°‘æ–¼å…ˆå‰æ–¹æ³•æ‰€éœ€è³‡æ–™é‡ï¼Œåœ¨å•ç­”ä»»å‹™ä¸­å–å¾—å“è¶Šè¡¨ç¾ã€‚å®ƒæ¨¡çµ„åŒ–ã€é«˜æ•ˆèƒ½ï¼Œä¸¦è¨­è¨ˆå¯ç„¡ç¸«æ­é…ä»»ä½•é»‘ç®± LLM ä½¿ç”¨ã€‚



## ç›®éŒ„

- [ğŸ“¦ å®‰è£](#-installation)
- [ğŸ’¡ æº–å‚™](#-preparation)
- [ğŸ‹ï¸ åŸ·è¡Œè¨“ç·´](https://github.com/pat-jj/s3?tab=readme-ov-file#%EF%B8%8F-run-training)
- [ğŸ” åŸ·è¡Œæœå°‹ï¼æª¢ç´¢](https://github.com/pat-jj/s3?tab=readme-ov-file#-run-searchretrieval)
- [ğŸ“ˆ åŸ·è¡Œè©•ä¼°](#-run-evaluation)

## ğŸ“¦ å®‰è£

**æœå°‹å™¨èˆ‡ç”Ÿæˆå™¨ç’°å¢ƒ**
```bash
conda create -n s3 python=3.9
# install torch [or you can skip this step and let vllm to install the correct version for you]
pip install torch==2.4.0 --index-url https://download.pytorch.org/whl/cu121
# install vllm
pip3 install vllm==0.6.3 # or you can install 0.5.4, 0.4.2 and 0.3.1
pip3 install ray

# verl
# cd code
pip install -e .

# flash attention 2
pip3 install flash-attn --no-build-isolation

# we use pyserini for efficient retrieval and evaluation
pip install pyserini    # the version we used is 0.22.1

# quality of life
pip install wandb IPython matplotlib huggingface_hub
```
**æª¢ç´¢å™¨ç’°å¢ƒ**

```bash
conda create -n ret python=3.10
conda activate ret

conda install pytorch==2.4.0 torchvision==0.19.0 torchaudio==2.4.0 pytorch-cuda=12.1 -c pytorch -c nvidia
pip install transformers datasets pyserini
conda install -c pytorch -c nvidia faiss-gpu=1.8.0
pip install uvicorn fastapi
```




## ğŸ’¡ æº–å‚™
***ä¸‹è¼‰ç´¢å¼•èˆ‡èªæ–™åº«***

```bash
python scripts/download.py --save_path $save_path
cat $save_path/part_* > $save_path/e5_Flat.index
gzip -d $save_path/wiki-18.jsonl.gz
```

***é å…ˆè¨ˆç®— NaÃ¯ve RAG åˆå§‹åŒ–***ï¼ˆæˆ–è€…ä½ å¯ä»¥åœ¨é€™è£¡ä¸‹è¼‰æˆ‘å€‘è™•ç†éçš„è³‡æ–™ï¼š[huggingface](https://huggingface.co/datasets/pat-jj/s3_processed_data)ï¼‰

```bash
# deploy retriever
bash scripts/deploy_retriever/retrieval_launch.sh # or scripts/deploy_retriever/retrieval_launch_mirage.sh for MedCorp corpus.
# deploy generator
bash generator_llms/host.sh # modify tensor-parallel-size to the number of GPUs you use
# run precompute
bash scripts/precompute.sh # this step will take a while, as it will precompute the naÃ¯ve RAG Cache for training
```
## ğŸ‹ï¸ åŸ·è¡Œè¨“ç·´
***æ­¤æ­¥é©Ÿç”¨æ–¼ S3 çš„è¨“ç·´***



```bash
# deploy retriever
bash scripts/deploy_retriever/retrieval_launch.sh 
# deploy generator
bash generator_llms/host.sh
# run training
bash scripts/train/train_s3.sh
```
## ğŸ” åŸ·è¡Œæœå°‹/æª¢ç´¢
***æ­¤æ­¥é©Ÿç”¨æ–¼ s3 / åŸºç·šçš„å…§å®¹æ”¶é›†***

**s3**


```bash
# deploy retriever
bash scripts/deploy_retriever/retrieval_launch.sh 
# run s3 inference
bash scripts/s3_inference/evaluate-8-3-3.sh
```
<details>
<summary>åŸºç·š</summary>

**RAG**

```bash
bash scripts/deploy_retriever/retrieval_launch.sh # or retrieval_launch_bm25.sh # deploy retriever
bash scripts/baselines/rag.sh # run RAG 
```
**DeepRetrieval**
**æ·±åº¦æª¢ç´¢ï¼ˆDeepRetrievalï¼‰**
```bash
bash retrieval_launch_bm25.sh # deploy BM25 Model
bash generator_llms/deepretrieval.sh # deploy DeepRetrieval Model
bash scripts/baselines/deepretrieval.sh # run DeepRetrieval Query Rewriting + Retrieval
```
**æœå°‹-R1**

```bash
bash retrieval_launch.sh # deploy e5 retriever
bash scripts/baselines/search_r1.sh # run Search-R1
```
**IRCoT**
**IRCoT**
```bash
bash retrieval_launch.sh # deploy e5 retriever
python scripts/baselines/ircot.py
```
**Search-o1**
**æœå°‹-o1**
```bash
bash retrieval_launch.sh # deploy e5 retriever
bash scripts/baselines/search_o1.sh # run Search-o1
```
</details>


## ğŸ“ˆ åŸ·è¡Œè©•ä¼°
***æ­¤æ­¥é©Ÿç”¨æ–¼ s3 / åŸºç·šæ¨¡å‹çš„è©•ä¼°***



```bash
bash scripts/evaluation/run.sh
```

## å•ç­”é›†
### è‡ªè¨‚è³‡æ–™ï¼Ÿ
å¦‚æœæ‚¨æƒ³åœ¨è‡ªå·±çš„èªæ–™åº«/è³‡æ–™é›†ä¸Šæ¸¬è©¦ s3ï¼Œæ‚¨å¯ä»¥åƒè€ƒæ­¤æäº¤è¨˜éŒ„ä¾†ç­è§£å»ºç«‹è‡ªå·±çš„æµç¨‹éœ€è¦åšä»€éº¼ï¼š[commit 8420538](https://github.com/pat-jj/s3/commit/8420538836febbe59d5bcbe41187f16908c9c36c)

### çµæœå¾©ç¾ï¼Ÿ
å·²æœ‰å¤šä½é–‹ç™¼è€…æˆåŠŸå¾©ç¾äº†æˆ‘å€‘çš„çµæœã€‚å¦‚æœæ‚¨æœ‰ä»»ä½•ç–‘å•æˆ–é‡åˆ°å•é¡Œï¼Œæ­¡è¿[æäº¤å•é¡Œ](https://github.com/pat-jj/s3/issues)â€”â€”æˆ‘å€‘å¾ˆæ¨‚æ„æä¾›å¯¦éš›æŒ‡å°ï¼ˆå¯åƒè€ƒ[æ­¤ç¯„ä¾‹](https://github.com/pat-jj/s3/issues/20)ï¼‰ã€‚

é›–ç„¶è‡ªè¡Œå¾©ç¾æ¨¡å‹å¾ˆç°¡å–®â€”â€”è€Œä¸”æˆ‘å€‘å¯¦éš›ä¸Š**æ¨è–¦å¾é›¶é–‹å§‹è¨“ç·´**ï¼Œå› ç‚ºè©•ä¼°é€šå¸¸æ¯”è¨“ç·´æ›´è€—æ™‚â€”â€”æˆ‘å€‘ä¹Ÿæä¾›äº†ä¸€å€‹åƒè€ƒæª¢æŸ¥é»ï¼š[s3-8-3-3-20steps](https://huggingface.co/pat-jj/s3-8-3-3-20steps)ï¼Œç´„ä¸€å°æ™‚å³å¯è¨“ç·´å®Œæˆã€‚



## å¼•ç”¨
```bibtex
@article{jiang2025s3,
  title={s3: You Don't Need That Much Data to Train a Search Agent via RL},
  author={Jiang, Pengcheng and Xu, Xueqiang and Lin, Jiacheng and Xiao, Jinfeng and Wang, Zifeng and Sun, Jimeng and Han, Jiawei},
  journal={arXiv preprint arXiv:2505.14146},
  year={2025}
}
```
æ„Ÿè¬æ‚¨å°æˆ‘å€‘å·¥ä½œçš„é—œæ³¨ï¼






---

Tranlated By [Open Ai Tx](https://github.com/OpenAiTx/OpenAiTx) | Last indexed: 2025-12-30

---