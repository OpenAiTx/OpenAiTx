<div align="right">
  <details>
    <summary >ЁЯМР ржнрж╛рж╖рж╛</summary>
    <div>
      <div align="center">
        <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=en">ржЗржВрз░рж╛ржЬрзА</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=zh-CN">рж╕рз░рж▓ ржЪрзАржирзА</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=zh-TW">ржЬржЯрж┐рж▓ ржЪрзАржирзА</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=ja">ржЬрж╛ржкрж╛ржирзА</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=ko">ржХрзЛрз░рж┐рзЯрж╛ржи</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=hi">рж╣рж┐ржирзНржжрзА</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=th">ржерж╛ржЗ</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=fr">ржлрзНрз░рзЗржЮрзНржЪ</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=de">ржЬрж╛рз░рзНржорж╛ржи</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=es">рж╕рзНржкрзЗржирзА</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=it">ржЗржЯрж╛рж▓рж┐рзЯрж╛ржи</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=ru">рз░рж╛ржЫрж┐рзЯрж╛ржи</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=pt">ржкрз░рзНрждрзБржЧрзАржЬ</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=nl">ржбрж╛ржЪ</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=pl">ржкрзЛрж▓рж┐рж╢</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=ar">ржЖрз░ржмрзА</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=fa">ржлрж╛рз░рзНржЫрзА</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=tr">рждрзБрз░рзНржХрзА</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=vi">ржнрж┐рзЯрзЗржЯржирж╛ржорзА</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=id">ржЗржгрзНржбрзЛржирзЗржЪрж┐рзЯрж╛ржи</a>
      </div>
    </div>
  </details>
</div>

<div align="center">

# s3 - ржЖрз░ржПрж▓ ржжрзНржмрж╛рз░рж╛ ржжржХрзНрж╖ ржЖрз░рзБ ржлрж▓ржкрзНрз░рж╕рзВ рж╕ржирзНржзрж╛ржи ржПржЬрзЗржирзНржЯ ржкрзНрз░рж╢рж┐ржХрзНрж╖ржг
***ржПржЯрж╛ рж╕ржирзНржзрж╛ржи ржПржЬрзЗржирзНржЯ ржкрзНрз░рж╢рж┐ржХрзНрж╖ржгрз░ ржмрж╛ржмрзЗ ржЖржкрзБржирж┐ ржЗржорж╛ржи ржбрж╛ржЯрж╛ рж▓рж╛ржЧрж┐ржм ржирж╛рж▓рж╛ржЧрзЗ***

<p align="center">

  <a href="https://arxiv.org/abs/2505.14146">
    <img src="https://img.shields.io/badge/arXiv-2505.14146-b31b1b.svg" alt="arXiv">

  </a>
</p>
</div>

**ржХрж╛рз░рзНржпржХрзНрж╖ржорждрж╛рз░ рж╕рж╛ржоржЧрзНрз░рж┐ржХ ржкрз░рзНржпрж╛рж▓рзЛржЪржирж╛:**

<img src="https://raw.githubusercontent.com/pat-jj/s3/main/images/performance_overview.png" alt="performance_overview" width="800">



## s3 ржХрж┐?

<div align="center">
<img src="https://raw.githubusercontent.com/pat-jj/s3/main/images/framework.png" alt="framework" width="800">

**s3 ржлрзНрз░рзЗржорз▒рз░рзНржХ**
</div>

`s3` рж╣рзИржЫрзЗ ржЕржирзБрж╕ржирзНржзрж╛ржи ржПржЬрзЗржирзНржЯ ржкрзНрз░рж╢рж┐ржХрзНрж╖ржгрз░ ржмрж╛ржмрзЗ ржПржЯрж╛ рж╕рж╣ржЬ ржХрж┐ржирзНрждрзБ рж╢ржХрзНрждрж┐рж╢рж╛рж▓рзА ржлрзНрз░рзЗржорз▒рз░рзНржХ, ржпрж┐ retrieval-augmented generation (RAG)ржд ржмрзНржпрз▒рж╣рж╛рз░ рж╣рзЯред ржЗ ржнрж╛рж╖рж╛ ржоржбрзЗрж▓рж╕ржорзВрж╣ржХ ржЕржзрж┐ржХ ржХрж╛рж░рзНржпржХрз░рзАржнрж╛рз▒рзЗ рж╕ржирзНржзрж╛ржи ржХрз░рж┐ржмрж▓рзИ рж╢рж┐ржХрж╛рзЯтАФржЙрзОржкрж╛ржжржХржХ ржкрз░рж┐ржмрз░рзНрждржи ржиржХрз░рж╛ржХрзИред ржХрзЗрз▒рж▓ ржЕржирзБрж╕ржирзНржзрж╛ржи ржЕржВрж╢ржд ржХрзЗржирзНржжрзНрз░рж┐ржд рж╣рзИ, `s3` ржЖржЧрз░ ржкржжрзНржзрждрж┐ржд ржмрзНржпрз▒рж╣рзГржд рждржерзНржпрз░ ржЕрждрж┐ ржХржо ржЕржВрж╢ ржмрзНржпрз▒рж╣рж╛рз░ ржХрз░рж┐ QA ржХрж╛ржоржд рж╢ржХрзНрждрж┐рж╢рж╛рж▓рзА ржХрж╛рз░рзНржпржХрзНрж╖ржорждрж╛ ржжрзЗржЦрзБрз▒рж╛ржЗред ржЗ ржоржбрзБрж▓рж╛рз░, ржжржХрзНрж╖, ржЖрз░рзБ ржпрж┐ржХрзЛржирзЛ ржмрзНрж▓рзЗржХ-ржмржХрзНрж╕ LLMрз░ рж╕рзИрждрзЗ ржирж┐рз░рз▒рж┐ржЪрзНржЫрж┐ржирзНржиржнрж╛рз▒рзЗ ржХрж╛ржо ржХрз░рж╛рз░ ржмрж╛ржмрзЗ ржбрж┐ржЬрж╛ржЗржи ржХрз░рж╛ред




## ржмрж┐рж╖ржпрж╝ржмрж╕рзНрждрзБ рж╕рзВржЪрзА

- [ЁЯУж ржЗржирж╖рзНржЯрж▓рзЗрж╢рзНржмржи](#-installation)
- [ЁЯТб ржкрзНрз░рж╕рзНрждрзБрждрж┐](#-preparation)
- [ЁЯПЛя╕П ржкрзНрз░рж╢рж┐ржХрзНрж╖ржг ржЪрж▓рж╛ржУ](https://github.com/pat-jj/s3?tab=readme-ov-file#%EF%B8%8F-run-training)
- [ЁЯФН рж╕ржирзНржзрж╛ржи/ржкрзБржирз░рзБржжрзНржзрж╛рз░ ржЪрж▓рж╛ржУ](https://github.com/pat-jj/s3?tab=readme-ov-file#-run-searchretrieval)
- [ЁЯУИ ржорзВрж▓рзНржпрж╛рзЯржи ржЪрж▓рж╛ржУ](#-run-evaluation)

## ЁЯУж ржЗржирж╖рзНржЯрж▓рзЗрж╢рзНржмржи

**рж╕рж╛рз░рзНржЪрж╛рз░ & ржЬрзЗржирж╛рз░рзЗржЯрз░ ржкрз░рж┐рз▒рзЗрж╢**
```bash
conda create -n s3 python=3.9
# install torch [or you can skip this step and let vllm to install the correct version for you]
pip install torch==2.4.0 --index-url https://download.pytorch.org/whl/cu121
# install vllm
pip3 install vllm==0.6.3 # or you can install 0.5.4, 0.4.2 and 0.3.1
pip3 install ray

# verl
# cd code
pip install -e .

# flash attention 2
pip3 install flash-attn --no-build-isolation

# we use pyserini for efficient retrieval and evaluation
pip install pyserini    # the version we used is 0.22.1

# quality of life
pip install wandb IPython matplotlib huggingface_hub
```

**рз░рж┐ржЯрзНрз░рж┐ржнрж╛рз░ ржкрз░рж┐рз▒рзЗрж╢**
```bash
conda create -n ret python=3.10
conda activate ret

conda install pytorch==2.4.0 torchvision==0.19.0 torchaudio==2.4.0 pytorch-cuda=12.1 -c pytorch -c nvidia
pip install transformers datasets pyserini
conda install -c pytorch -c nvidia faiss-gpu=1.8.0
pip install uvicorn fastapi
```



## ЁЯТб ржкрзНрж░рж╕рзНрждрзБрждрж┐
***рж╕рзВржЪрзА ржЖрз░рзБ ржХрзЛрз░рзНржкрж╛ржЫ ржбрж╛ржЙржирж▓рзЛржб ржХрз░ржХ***
```bash
python scripts/download.py --save_path $save_path
cat $save_path/part_* > $save_path/e5_Flat.index
gzip -d $save_path/wiki-18.jsonl.gz
```

***ржкрзНрз░рж╛ржХ-ржЧржгржирж╛ ржХрз░рж╛ Na├пve RAG Initialization*** (ржЕржержмрж╛ ржЖржкрзБржирж┐ ржЖржорж╛рз░ ржкрзНрз░ржХрзНрз░рж┐ржпрж╝рж╛ржХрзГржд ржбрж╛ржЯрж╛ ржЗржпрж╝рж╛ржд ржбрж╛ржЙржирж▓рзЛржб ржХрз░рж┐ржм ржкрж╛рз░рзЗ: [huggingface](https://huggingface.co/datasets/pat-jj/s3_processed_data))

```bash
# deploy retriever
bash scripts/deploy_retriever/retrieval_launch.sh # or scripts/deploy_retriever/retrieval_launch_mirage.sh for MedCorp corpus.
# deploy generator
bash generator_llms/host.sh # modify tensor-parallel-size to the number of GPUs you use
# run precompute
bash scripts/precompute.sh # this step will take a while, as it will precompute the na├пve RAG Cache for training
```


## ЁЯПЛя╕П ржкрзНрз░рж╢рж┐ржХрзНрж╖ржг ржЪрж▓рж╛ржУ
***ржПржЗ ржЦрзЛржЬржЯрзЛ S3-рз░ ржкрзНрз░рж╢рж┐ржХрзНрж╖ржгрз░ ржмрж╛ржмрзЗ***

```bash
# deploy retriever
bash scripts/deploy_retriever/retrieval_launch.sh 
# deploy generator
bash generator_llms/host.sh
# run training
bash scripts/train/train_s3.sh
```


## ЁЯФН рж╕ржирзНржзрж╛ржи/ржкрзБржиржГржкрзНрз░рж╛ржкрзНрждрж┐ ржЪрж▓рж╛ржУ
***ржПржЗ ржкржжржХрзНрж╖рзЗржкржЯрзЛ s3 / ржмрзЗржЫрж▓рж╛ржЗржирж╕ржорзВрж╣рз░ ржкрзНрз░рж╕ржВржЧ рж╕ржВржЧрзНрз░рж╣рз░ ржмрж╛ржмрзЗ***

**s3**
```bash
# deploy retriever
bash scripts/deploy_retriever/retrieval_launch.sh 
# run s3 inference
bash scripts/s3_inference/evaluate-8-3-3.sh
```

<details>
<summary>ржмрзЗржЫрж▓рж╛ржЗржирж╕ржорзВрж╣</summary>

**RAG**
```bash
bash scripts/deploy_retriever/retrieval_launch.sh # or retrieval_launch_bm25.sh # deploy retriever
bash scripts/baselines/rag.sh # run RAG 
```

**DeepRetrieval**
```bash
bash retrieval_launch_bm25.sh # deploy BM25 Model
bash generator_llms/deepretrieval.sh # deploy DeepRetrieval Model
bash scripts/baselines/deepretrieval.sh # run DeepRetrieval Query Rewriting + Retrieval
```

**рж╕ржирзНржзрж╛ржи-R1**
```bash
bash retrieval_launch.sh # deploy e5 retriever
bash scripts/baselines/search_r1.sh # run Search-R1
```

**IRCoT**
```bash
bash retrieval_launch.sh # deploy e5 retriever
python scripts/baselines/ircot.py
```

**рж╕ржирзНржзрж╛ржи-o1**
```bash
bash retrieval_launch.sh # deploy e5 retriever
bash scripts/baselines/search_o1.sh # run Search-o1
```

</details>


## ЁЯУИ ржорзВрж▓рзНржпрж╛ржпрж╝ржи ржЪрж▓рж╛ржУ
***ржПржЗ ржкржжржХрзНрж╖рзЗржкржЯрзЛ s3 / ржорзВрж▓ ржорж╛ржиржжржгрзНржбрз░ ржорзВрж▓рзНржпрж╛ржпрж╝ржирз░ ржмрж╛ржмрзЗ***


```bash
bash scripts/evaluation/run.sh
```

## ржкрзНрз░рж╢рзНржи-ржЙрждрзНрждрз░
### ржХрж╛рж╖рзНржЯржорж╛ржЗржЬржб ржбрж╛ржЯрж╛?
ржЖржкрзБржирж┐ ржпржжрж┐ ржирж┐ржЬрз░ ржХрз░рзНржкрж╛ржЫ/ржбрзЗржЯрж╛рж╕рзЗржЯржд s3 ржкрз░рзАржХрзНрж╖рж╛ ржХрз░рж┐ржм ржмрж┐ржЪрж╛рз░рзЗ, рждрзЗржирзНрждрзЗ ржПржЗ ржХржорж┐ржЯржЯрзЛ ржЪрж╛ржм ржкрж╛рз░рзЗ ржпрж╛рждрзЗ ржЖржкрзБржирж┐ ржирж┐ржЬрз░ ржкрж╛ржЗржкрж▓рж╛ржЗржи ржмржирж╛ржмрж▓рзИ ржХрж┐ ржХрз░рж┐ржм рж▓рж╛ржЧрж┐ржм рждрж╛ржХ ржмрзБржЬрж┐ржм ржкрж╛рз░рж┐ржм: [commit 8420538](https://github.com/pat-jj/s3/commit/8420538836febbe59d5bcbe41187f16908c9c36c)

### ржлрж▓рж╛ржлрж▓ ржкрзБржирз░рзБрждрзНржкрж╛ржжржи?
ржмрж╣рзБ ржмрж┐ржХрж╛рж╢ржХрж╛рз░рзА рж╕ржХрж▓рзЗ ржЖржорж╛рз░ ржлрж▓рж╛ржлрж▓ рж╕ржлрж▓ржнрж╛рз▒рзЗ ржкрзБржирз░рзБрждрзНржкрж╛ржжржи ржХрз░рж┐ржЫрзЗред ржпржжрж┐ ржЖржкрзЛржирж╛рз░ ржкрзНрз░рж╢рзНржи ржерж╛ржХрзЗ ржмрж╛ рж╕ржорж╕рзНржпрж╛ ржжрзЗржЦрж╛ ржпрж╛рзЯ, ржЕржирзБржЧрзНрз░рж╣ ржХрз░рж┐ [open an issue](https://github.com/pat-jj/s3/issues) тАФ ржЖржорж┐ рж╣рж╛рждрзЗ-ржХрж▓ржорзЗ рж╕рж╣рж╛рзЯ ржХрз░рж┐ржмрж▓рзИ рж╕ржжрж╛рзЯ рж╕рж╛ржЬрзБ (ржЪрж╛ржУржХ [this example](https://github.com/pat-jj/s3/issues/20))ред

ржпржжрж┐ржУ ржирж┐ржЬрзЗржЗ ржоржбрзЗрж▓ржЯрзЛ ржкрзБржирз░рзБрждрзНржкрж╛ржжржи ржХрз░рж╛ рж╕рж╣ржЬ тАФ ржЖрз░рзБ ржЖржорж┐ рж╕ржБржЪрж╛ржХрзИрзЯрзЗ **рж╢рзВржирзНржпрз░ ржкрз░рж╛ ржкрзНрз░рж╢рж┐ржХрзНрж╖ржг ржжрж┐рзЯрж╛рз░ ржкрз░рж╛ржорз░рзНрж╢ ржжрж┐ржЫрзЛржБ**, ржХрж╛рз░ржг ржорзВрж▓рзНржпрж╛рзЯржи рж╕рж╛ржзрж╛рз░ржгрждрзЗ ржкрзНрз░рж╢рж┐ржХрзНрж╖ржгрждржХрзИ ржЕржзрж┐ржХ рж╕ржорзЯ рж▓рж╛ржЧрзЗ тАФ ржЖржорж┐ ржПржЯрж╛ рз░рзЗржлрж╛рз░рзЗржЮрзНржЪ ржЪрзЗржХржкржЗржгрзНржЯрзЛ ржкрзНрз░ржжрж╛ржи ржХрз░рж┐ржЫрзЛржБ: [s3-8-3-3-20steps](https://huggingface.co/pat-jj/s3-8-3-3-20steps), ржкрзНрз░рж╛рзЯ ржПржЯрж╛ ржШржгрзНржЯрж╛ржд ржкрзНрз░рж╢рж┐ржХрзНрж╖рж┐рждред



## ржХрзГрждржЬрзНржЮрждрж╛
ржЖржорж┐ рждрж▓ржд ржжрж┐рзЯрж╛ ржкрзНрз░ржХрж▓рзНржкрж╕ржорзВрж╣ржХ ржзржирзНржпржмрж╛ржж ржЬржирж╛ржЗржЫрзЛржБ:
[verl](https://github.com/volcengine/verl), [RAGEN](https://github.com/RAGEN-AI/RAGEN), [Search-R1](https://github.com/PeterGriffinJin/Search-R1), [DeepRetrieval](https://github.com/pat-jj/DeepRetrieval), [PySerini](https://github.com/castorini/pySerini)ред
 

## ржЙржжрзНржзрзГрждрж┐
```bibtex
@article{jiang2025s3,
  title={s3: You Don't Need That Much Data to Train a Search Agent via RL},
  author={Jiang, Pengcheng and Xu, Xueqiang and Lin, Jiacheng and Xiao, Jinfeng and Wang, Zifeng and Sun, Jimeng and Han, Jiawei},
  journal={arXiv preprint arXiv:2505.14146},
  year={2025}
}
```

Thanks for your interest in our work!





---

Tranlated By [Open Ai Tx](https://github.com/OpenAiTx/OpenAiTx) | Last indexed: 2025-10-06

---