
<div align="right">
  <details>
    <summary >ğŸŒ NgÃ´n ngá»¯</summary>
    <div>
      <div align="center">
        <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=en">English</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=zh-CN">ç®€ä½“ä¸­æ–‡</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=zh-TW">ç¹é«”ä¸­æ–‡</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=ja">æ—¥æœ¬èª</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=ko">í•œêµ­ì–´</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=hi">à¤¹à¤¿à¤¨à¥à¤¦à¥€</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=th">à¹„à¸—à¸¢</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=fr">FranÃ§ais</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=de">Deutsch</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=es">EspaÃ±ol</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=it">Itapano</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=ru">Ğ ÑƒÑÑĞºĞ¸Ğ¹</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=pt">PortuguÃªs</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=nl">Nederlands</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=pl">Polski</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=ar">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=fa">ÙØ§Ø±Ø³ÛŒ</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=tr">TÃ¼rkÃ§e</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=vi">Tiáº¿ng Viá»‡t</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=id">Bahasa Indonesia</a>
      </div>
    </div>
  </details>
</div>

<div align="center">

# s3 - ÄÃ o Táº¡o TÃ¡c NhÃ¢n TÃ¬m Kiáº¿m Hiá»‡u Quáº£ Báº±ng RL
***Báº¡n KhÃ´ng Cáº§n QuÃ¡ Nhiá»u Dá»¯ Liá»‡u Äá»ƒ ÄÃ o Táº¡o Má»™t TÃ¡c NhÃ¢n TÃ¬m Kiáº¿m***

<p align="center">

  <a href="https://arxiv.org/abs/2505.14146">
    <img src="https://img.shields.io/badge/arXiv-2505.14146-b31b1b.svg" alt="arXiv">
  </a>
</p>
</div>

**Tá»•ng quan Hiá»‡u suáº¥t:**

<img src="https://raw.githubusercontent.com/pat-jj/s3/main/images/performance_overview.png" alt="performance_overview" width="800">



## S3 lÃ  gÃ¬?

<div align="center">
<img src="https://raw.githubusercontent.com/pat-jj/s3/main/images/framework.png" alt="framework" width="800">

**Khung s3**
</div>

`s3` lÃ  má»™t khung Ä‘Æ¡n giáº£n nhÆ°ng máº¡nh máº½ Ä‘á»ƒ huáº¥n luyá»‡n cÃ¡c tÃ¡c nhÃ¢n tÃ¬m kiáº¿m trong há»‡ thá»‘ng táº¡o ná»™i dung cÃ³ há»— trá»£ truy xuáº¥t thÃ´ng tin (RAG). NÃ³ dáº¡y cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ cÃ¡ch tÃ¬m kiáº¿m hiá»‡u quáº£ hÆ¡nâ€”mÃ  khÃ´ng cáº§n thay Ä‘á»•i bá»™ táº¡o ná»™i dung. Báº±ng cÃ¡ch chá»‰ táº­p trung vÃ o thÃ nh pháº§n tÃ¬m kiáº¿m, `s3` Ä‘áº¡t hiá»‡u suáº¥t cao trong cÃ¡c tÃ¡c vá»¥ há»i Ä‘Ã¡p vá»›i chá»‰ má»™t pháº§n nhá» dá»¯ liá»‡u so vá»›i cÃ¡c phÆ°Æ¡ng phÃ¡p trÆ°á»›c Ä‘Ã³. Khung nÃ y cÃ³ tÃ­nh mÃ´-Ä‘un, hiá»‡u quáº£, vÃ  Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ tÃ­ch há»£p mÆ°á»£t mÃ  vá»›i báº¥t ká»³ LLM há»™p Ä‘en nÃ o.



## Má»¥c lá»¥c

- [ğŸ“¦ CÃ i Ä‘áº·t](#-installation)
- [ğŸ’¡ Chuáº©n bá»‹](#-preparation)
- [ğŸ‹ï¸ Cháº¡y Huáº¥n luyá»‡n](https://github.com/pat-jj/s3?tab=readme-ov-file#%EF%B8%8F-run-training)
- [ğŸ” Cháº¡y TÃ¬m kiáº¿m/Truy xuáº¥t](https://github.com/pat-jj/s3?tab=readme-ov-file#-run-searchretrieval)
- [ğŸ“ˆ Cháº¡y ÄÃ¡nh giÃ¡](#-run-evaluation)

## ğŸ“¦ CÃ i Ä‘áº·t

**MÃ´i trÆ°á»ng Searcher & Generator**
```bash
conda create -n s3 python=3.9
# install torch [or you can skip this step and let vllm to install the correct version for you]
pip install torch==2.4.0 --index-url https://download.pytorch.org/whl/cu121
# install vllm
pip3 install vllm==0.6.3 # or you can install 0.5.4, 0.4.2 and 0.3.1
pip3 install ray

# verl
# cd code
pip install -e .

# flash attention 2
pip3 install flash-attn --no-build-isolation

# we use pyserini for efficient retrieval and evaluation
pip install pyserini    # the version we used is 0.22.1

# quality of life
pip install wandb IPython matplotlib huggingface_hub
```
**MÃ´i trÆ°á»ng Retriever**

```bash
conda create -n ret python=3.10
conda activate ret

conda install pytorch==2.4.0 torchvision==0.19.0 torchaudio==2.4.0 pytorch-cuda=12.1 -c pytorch -c nvidia
pip install transformers datasets pyserini
conda install -c pytorch -c nvidia faiss-gpu=1.8.0
pip install uvicorn fastapi
```
## ğŸ’¡ Chuáº©n bá»‹
***Táº£i xuá»‘ng Chá»‰ má»¥c & Táº­p dá»¯ liá»‡u***



```bash
python scripts/download.py --save_path $save_path
cat $save_path/part_* > $save_path/e5_Flat.index
gzip -d $save_path/wiki-18.jsonl.gz
```

***Tiá»n xá»­ lÃ½ Khá»Ÿi táº¡o RAG ÄÆ¡n giáº£n*** (hoáº·c báº¡n cÃ³ thá»ƒ táº£i xuá»‘ng dá»¯ liá»‡u Ä‘Ã£ xá»­ lÃ½ cá»§a chÃºng tÃ´i táº¡i Ä‘Ã¢y: [huggingface](https://huggingface.co/datasets/pat-jj/s3_processed_data))

```bash
# deploy retriever
bash scripts/deploy_retriever/retrieval_launch.sh # or scripts/deploy_retriever/retrieval_launch_mirage.sh for MedCorp corpus.
# deploy generator
bash generator_llms/host.sh # modify tensor-parallel-size to the number of GPUs you use
# run precompute
bash scripts/precompute.sh # this step will take a while, as it will precompute the naÃ¯ve RAG Cache for training
```
## ğŸ‹ï¸ Cháº¡y Huáº¥n Luyá»‡n
***BÆ°á»›c nÃ y dÃ nh cho viá»‡c huáº¥n luyá»‡n S3***



```bash
# deploy retriever
bash scripts/deploy_retriever/retrieval_launch.sh 
# deploy generator
bash generator_llms/host.sh
# run training
bash scripts/train/train_s3.sh
```
## ğŸ” Cháº¡y TÃ¬m kiáº¿m/Truy xuáº¥t
***BÆ°á»›c nÃ y dÃ¹ng Ä‘á»ƒ thu tháº­p ngá»¯ cáº£nh cá»§a s3 / cÃ¡c Ä‘Æ°á»ng cÆ¡ sá»Ÿ***

**s3**


```bash
# deploy retriever
bash scripts/deploy_retriever/retrieval_launch.sh 
# run s3 inference
bash scripts/s3_inference/evaluate-8-3-3.sh
```
<details>
<summary>CÃ¡c Ä‘Æ°á»ng cÆ¡ sá»Ÿ</summary>

**RAG**

```bash
bash scripts/deploy_retriever/retrieval_launch.sh # or retrieval_launch_bm25.sh # deploy retriever
bash scripts/baselines/rag.sh # run RAG 
```
**DeepRetrieval**
**DeepRetrieval**
```bash
bash retrieval_launch_bm25.sh # deploy BM25 Model
bash generator_llms/deepretrieval.sh # deploy DeepRetrieval Model
bash scripts/baselines/deepretrieval.sh # run DeepRetrieval Query Rewriting + Retrieval
```
**TÃ¬m kiáº¿m-R1**

```bash
bash retrieval_launch.sh # deploy e5 retriever
bash scripts/baselines/search_r1.sh # run Search-R1
```
**IRCoT**
**IRCoT**
```bash
bash retrieval_launch.sh # deploy e5 retriever
python scripts/baselines/ircot.py
```
**TÃ¬m kiáº¿m-o1**

```bash
bash retrieval_launch.sh # deploy e5 retriever
bash scripts/baselines/search_o1.sh # run Search-o1
```
</details>


## ğŸ“ˆ Cháº¡y ÄÃ¡nh GiÃ¡
***BÆ°á»›c nÃ y dÃ nh cho viá»‡c Ä‘Ã¡nh giÃ¡ s3 / cÃ¡c Ä‘Æ°á»ng cÆ¡ sá»Ÿ***



```bash
bash scripts/evaluation/run.sh
```

## Há»i & ÄÃ¡p
### Dá»¯ liá»‡u TÃ¹y chá»‰nh?
Náº¿u báº¡n muá»‘n thá»­ nghiá»‡m s3 trÃªn táº­p dá»¯ liá»‡u/corpus cá»§a riÃªng mÃ¬nh, báº¡n cÃ³ thá»ƒ tham kháº£o commit nÃ y Ä‘á»ƒ xem báº¡n cáº§n lÃ m gÃ¬ Ä‘á»ƒ xÃ¢y dá»±ng pipeline riÃªng: [commit 8420538](https://github.com/pat-jj/s3/commit/8420538836febbe59d5bcbe41187f16908c9c36c)

### TÃ¡i táº¡o Káº¿t quáº£?
Má»™t sá»‘ nhÃ  phÃ¡t triá»ƒn Ä‘Ã£ tÃ¡i táº¡o thÃ nh cÃ´ng káº¿t quáº£ cá»§a chÃºng tÃ´i. Náº¿u báº¡n cÃ³ cÃ¢u há»i hoáº·c gáº·p sá»± cá»‘, cá»© thoáº£i mÃ¡i [má»Ÿ má»™t issue](https://github.com/pat-jj/s3/issues) â€” chÃºng tÃ´i sáºµn sÃ ng hÆ°á»›ng dáº«n thá»±c táº¿ (xem [vÃ­ dá»¥ nÃ y](https://github.com/pat-jj/s3/issues/20)).

Máº·c dÃ¹ viá»‡c tá»± mÃ¬nh tÃ¡i táº¡o mÃ´ hÃ¬nh khÃ¡ Ä‘Æ¡n giáº£n â€” vÃ  thá»±c ra chÃºng tÃ´i **khuyÃªn báº¡n nÃªn huáº¥n luyá»‡n tá»« Ä‘áº§u**, vÃ¬ Ä‘Ã¡nh giÃ¡ thÆ°á»ng tá»‘n nhiá»u thá»i gian hÆ¡n huáº¥n luyá»‡n â€” chÃºng tÃ´i cÅ©ng cung cáº¥p má»™t checkpoint tham kháº£o: [s3-8-3-3-20steps](https://huggingface.co/pat-jj/s3-8-3-3-20steps), Ä‘Æ°á»£c huáº¥n luyá»‡n trong khoáº£ng má»™t giá».



## TrÃ­ch dáº«n
```bibtex
@article{jiang2025s3,
  title={s3: You Don't Need That Much Data to Train a Search Agent via RL},
  author={Jiang, Pengcheng and Xu, Xueqiang and Lin, Jiacheng and Xiao, Jinfeng and Wang, Zifeng and Sun, Jimeng and Han, Jiawei},
  journal={arXiv preprint arXiv:2505.14146},
  year={2025}
}
```
Cáº£m Æ¡n báº¡n Ä‘Ã£ quan tÃ¢m Ä‘áº¿n cÃ´ng viá»‡c cá»§a chÃºng tÃ´i!






---

Tranlated By [Open Ai Tx](https://github.com/OpenAiTx/OpenAiTx) | Last indexed: 2025-12-30

---