<div align="right">
  <details>
    <summary >ЁЯМР рднрд╛рд╖рд╛</summary>
    <div>
      <div align="center">
        <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=en">English</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=zh-CN">чоАф╜Уф╕нцЦЗ</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=zh-TW">ч╣БщлФф╕нцЦЗ</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=ja">цЧецЬмшкЮ</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=ko">эХЬъ╡ньЦ┤</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=hi">рд╣рд┐рдиреНрджреА</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=th">р╣Др╕Чр╕в</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=fr">Fran├зais</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=de">Deutsch</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=es">Espa├▒ol</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=it">Itapano</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=ru">╨а╤Г╤Б╤Б╨║╨╕╨╣</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=pt">Portugu├кs</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=nl">Nederlands</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=pl">Polski</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=ar">╪з┘Д╪╣╪▒╪и┘К╪й</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=fa">┘Б╪з╪▒╪│█М</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=tr">T├╝rk├зe</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=vi">Tiс║┐ng Viс╗Зt</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=id">Bahasa Indonesia</a>
      </div>
    </div>
  </details>
</div>

<div align="center">

# s3 - рдЖрд░рдПрд▓ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХреБрд╢рд▓ рд▓реЗрдХрд┐рди рдкреНрд░рднрд╛рд╡реА рдЦреЛрдЬ рдПрдЬреЗрдВрдЯ рдкреНрд░рд╢рд┐рдХреНрд╖рдг
***рдЦреЛрдЬ рдПрдЬреЗрдВрдЯ рдХреЛ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рдЗрддрдиреА рдЕрдзрд┐рдХ рдбреЗрдЯрд╛ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ***

<p align="center">

  <a href="https://arxiv.org/abs/2505.14146">
    <img src="https://img.shields.io/badge/arXiv-2505.14146-b31b1b.svg" alt="arXiv">

  </a>
</p>
</div>

**рдкреНрд░рджрд░реНрд╢рди рдЕрд╡рд▓реЛрдХрди:**

<img src="https://raw.githubusercontent.com/pat-jj/s3/main/images/performance_overview.png" alt="performance_overview" width="800">



## s3 рдХреНрдпрд╛ рд╣реИ?

<div align="center">
<img src="https://raw.githubusercontent.com/pat-jj/s3/main/images/framework.png" alt="framework" width="800">

**s3 рдлреНрд░реЗрдорд╡рд░реНрдХ**
</div>

`s3` рдПрдХ рд╕рд░рд▓ рд▓реЗрдХрд┐рди рд╢рдХреНрддрд┐рд╢рд╛рд▓реА рдлреНрд░реЗрдорд╡рд░реНрдХ рд╣реИ рдЬреЛ рд░рд┐рдЯреНрд░реАрд╡рд▓-рдСрдЧрдореЗрдВрдЯреЗрдб рдЬреЗрдирд░реЗрд╢рди (RAG) рдореЗрдВ рдЦреЛрдЬ рдПрдЬреЗрдВрдЯреНрд╕ рдХреЛ рдЯреНрд░реЗрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рд╣реИред рдпрд╣ рднрд╛рд╖рд╛ рдореЙрдбрд▓реНрд╕ рдХреЛ рдЕрдзрд┐рдХ рдкреНрд░рднрд╛рд╡реА рдврдВрдЧ рд╕реЗ рдЦреЛрдЬ рдХрд░рдирд╛ рд╕рд┐рдЦрд╛рддрд╛ рд╣реИтАФрдмрд┐рдирд╛ рдЬрдирд░реЗрдЯрд░ рдХреЛ рдмрджрд▓реЗред рдХреЗрд╡рд▓ рдЦреЛрдЬ рдШрдЯрдХ рдкрд░ рдзреНрдпрд╛рди рдХреЗрдВрджреНрд░рд┐рдд рдХрд░рдХреЗ, `s3` рдХрдо рдбреЗрдЯрд╛ рдореЗрдВ рднреА рдкрд┐рдЫрд▓реЗ рддрд░реАрдХреЛрдВ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ QA рдХрд╛рд░реНрдпреЛрдВ рдореЗрдВ рдордЬрдмреВрдд рдкреНрд░рджрд░реНрд╢рди рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИред рдпрд╣ рдореЙрдбреНрдпреВрд▓рд░, рдХреБрд╢рд▓ рдФрд░ рдХрд┐рд╕реА рднреА рдмреНрд▓реИрдХ-рдмреЙрдХреНрд╕ LLM рдХреЗ рд╕рд╛рде рд╕рд╣рдЬрддрд╛ рд╕реЗ рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред



## рд╡рд┐рд╖рдп рд╕реВрдЪреА

- [ЁЯУж рдЗрдВрд╕реНрдЯреЙрд▓реЗрд╢рди](#-installation)
- [ЁЯТб рддреИрдпрд╛рд░реА](#-preparation)
- [ЁЯПЛя╕П рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдЪрд▓рд╛рдПрдБ](https://github.com/pat-jj/s3?tab=readme-ov-file#%EF%B8%8F-run-training)
- [ЁЯФН рдЦреЛрдЬ/рд░рд┐рдЯреНрд░реАрд╡рд▓ рдЪрд▓рд╛рдПрдБ](https://github.com/pat-jj/s3?tab=readme-ov-file#-run-searchretrieval)
- [ЁЯУИ рдореВрд▓реНрдпрд╛рдВрдХрди рдЪрд▓рд╛рдПрдБ](#-run-evaluation)

## ЁЯУж рдЗрдВрд╕реНрдЯреЙрд▓реЗрд╢рди

**рд╕рд░реНрдЪрд░ рдФрд░ рдЬрдирд░реЗрдЯрд░ рд╡рд╛рддрд╛рд╡рд░рдг**
```bash
conda create -n s3 python=3.9
# install torch [or you can skip this step and let vllm to install the correct version for you]
pip install torch==2.4.0 --index-url https://download.pytorch.org/whl/cu121
# install vllm
pip3 install vllm==0.6.3 # or you can install 0.5.4, 0.4.2 and 0.3.1
pip3 install ray

# verl
# cd code
pip install -e .

# flash attention 2
pip3 install flash-attn --no-build-isolation

# we use pyserini for efficient retrieval and evaluation
pip install pyserini    # the version we used is 0.22.1

# quality of life
pip install wandb IPython matplotlib huggingface_hub
```
**рд░рд┐рдЯреНрд░реАрд╡рд░ рдПрдирд╡рд╛рдпрд░рдирдореЗрдВрдЯ**

```bash
conda create -n ret python=3.10
conda activate ret

conda install pytorch==2.4.0 torchvision==0.19.0 torchaudio==2.4.0 pytorch-cuda=12.1 -c pytorch -c nvidia
pip install transformers datasets pyserini
conda install -c pytorch -c nvidia faiss-gpu=1.8.0
pip install uvicorn fastapi
```
## ЁЯТб рддреИрдпрд╛рд░реА
***рдЗрдВрдбреЗрдХреНрд╕ рдФрд░ рдХреЙрд░реНрдкрд╕ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ***



```bash
python scripts/download.py --save_path $save_path
cat $save_path/part_* > $save_path/e5_Flat.index
gzip -d $save_path/wiki-18.jsonl.gz
```

***рдкреВрд░реНрд╡рдЧрдгрдирд╛ рд╕рд╛рдорд╛рдиреНрдп RAG рдкреНрд░рд╛рд░рдВрднрд┐рдХрд░рдг*** (рдпрд╛ рдЖрдк рд╣рдорд╛рд░рд╛ рд╕рдВрд╕рд╛рдзрд┐рдд рдбреЗрдЯрд╛ рдпрд╣рд╛рдБ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: [huggingface](https://huggingface.co/datasets/pat-jj/s3_processed_data))

```bash
# deploy retriever
bash scripts/deploy_retriever/retrieval_launch.sh # or scripts/deploy_retriever/retrieval_launch_mirage.sh for MedCorp corpus.
# deploy generator
bash generator_llms/host.sh # modify tensor-parallel-size to the number of GPUs you use
# run precompute
bash scripts/precompute.sh # this step will take a while, as it will precompute the na├пve RAG Cache for training
```
## ЁЯПЛя╕П рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдЪрд▓рд╛рдПрдБ
***рдпрд╣ рдЪрд░рдг S3 рдХреЗ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рд▓рд┐рдП рд╣реИ***



```bash
# deploy retriever
bash scripts/deploy_retriever/retrieval_launch.sh 
# deploy generator
bash generator_llms/host.sh
# run training
bash scripts/train/train_s3.sh
```
## ЁЯФН рдЦреЛрдЬ/рдкреБрдирдГ рдкреНрд░рд╛рдкреНрддрд┐ рдЪрд▓рд╛рдПрдБ
***рдпрд╣ рдЪрд░рдг s3 / рдмреЗрд╕рд▓рд╛рдЗрди рдХреА рд╕рдВрджрд░реНрдн рд╕рдВрдЧреНрд░рд╣рдг рдХреЗ рд▓рд┐рдП рд╣реИ***

**s3**


```bash
# deploy retriever
bash scripts/deploy_retriever/retrieval_launch.sh 
# run s3 inference
bash scripts/s3_inference/evaluate-8-3-3.sh
```
<details>
<summary>рдореВрд▓ рд░реЗрдЦрд╛рдПрдБ</summary>

**RAG**

```bash
bash scripts/deploy_retriever/retrieval_launch.sh # or retrieval_launch_bm25.sh # deploy retriever
bash scripts/baselines/rag.sh # run RAG 
```
**рдбреАрдкрд░реАрдЯреНрд░реАрд╡рд▓**

```bash
bash retrieval_launch_bm25.sh # deploy BM25 Model
bash generator_llms/deepretrieval.sh # deploy DeepRetrieval Model
bash scripts/baselines/deepretrieval.sh # run DeepRetrieval Query Rewriting + Retrieval
```
**рд╕рд░реНрдЪ-R1**

```bash
bash retrieval_launch.sh # deploy e5 retriever
bash scripts/baselines/search_r1.sh # run Search-R1
```
**рдЖрдИрдЖрд░рдХреЛрдЯреА**

```bash
bash retrieval_launch.sh # deploy e5 retriever
python scripts/baselines/ircot.py
```
**рд╕рд░реНрдЪ-o1**

```bash
bash retrieval_launch.sh # deploy e5 retriever
bash scripts/baselines/search_o1.sh # run Search-o1
```
</details>


## ЁЯУИ рдореВрд▓реНрдпрд╛рдВрдХрди рдЪрд▓рд╛рдПрдБ
***рдпрд╣ рдЪрд░рдг s3 / рдмреЗрд╕рд▓рд╛рдЗрди рдХреЗ рдореВрд▓реНрдпрд╛рдВрдХрди рдХреЗ рд▓рд┐рдП рд╣реИ***



```bash
bash scripts/evaluation/run.sh
```

## рдкреНрд░рд╢реНрдиреЛрддреНрддрд░
### рдЕрдиреБрдХреВрд▓рд┐рдд рдбреЗрдЯрд╛?
рдпрджрд┐ рдЖрдк рдЕрдкрдиреЗ рд╕реНрд╡рдпрдВ рдХреЗ рдХреЙрд░реНрдкрд╕/рдбреЗрдЯрд╛рд╕реЗрдЯ рдкрд░ s3 рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рдЗрд╕ рдХрдорд┐рдЯ рдХрд╛ рд╕рдВрджрд░реНрдн рд▓реЗ рд╕рдХрддреЗ рд╣реИрдВ рдпрд╣ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдЕрдкрдиреА рд╕реНрд╡рдпрдВ рдХреА рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рдХреНрдпрд╛ рдХрд░рдирд╛ рд╣реЛрдЧрд╛: [commit 8420538](https://github.com/pat-jj/s3/commit/8420538836febbe59d5bcbe41187f16908c9c36c)

### рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреА рдкреБрдирд░реБрддреНрдкрддреНрддрд┐?
рдХрдИ рдбреЗрд╡рд▓рдкрд░реНрд╕ рдиреЗ рдкрд╣рд▓реЗ рд╣реА рд╣рдорд╛рд░реЗ рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреЛ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рдкреБрдирд░реБрддреНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рд╣реИред рдпрджрд┐ рдЖрдкрдХреЗ рдХреЛрдИ рдкреНрд░рд╢реНрди рд╣реИрдВ рдпрд╛ рдХрд┐рд╕реА рд╕рдорд╕реНрдпрд╛ рдХрд╛ рд╕рд╛рдордирд╛ рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рддреЛ рдмреЗрдЭрд┐рдЭрдХ [issue рдЦреЛрд▓реЗрдВ](https://github.com/pat-jj/s3/issues) тАФ рд╣рдо рд╡реНрдпрд╛рд╡рд╣рд╛рд░рд┐рдХ рдорд╛рд░реНрдЧрджрд░реНрд╢рди рджреЗрдиреЗ рдореЗрдВ рдЦреБрд╢ рд╣реИрдВ (рджреЗрдЦреЗрдВ [рдпрд╣ рдЙрджрд╛рд╣рд░рдг](https://github.com/pat-jj/s3/issues/20))ред

рд╣рд╛рд▓рд╛рдВрдХрд┐ рд╕реНрд╡рдпрдВ рдореЙрдбрд▓ рдХреЛ рдкреБрдирд░реБрддреНрдкрд╛рджрд┐рдд рдХрд░рдирд╛ рд╕реАрдзрд╛ рд╣реИ тАФ рдФрд░ рд╣рдо рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ **рд╢реБрд░реБрдЖрдд рд╕реЗ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреА рд╕рд▓рд╛рд╣ рджреЗрддреЗ рд╣реИрдВ**, рдХреНрдпреЛрдВрдХрд┐ рдореВрд▓реНрдпрд╛рдВрдХрди рдЕрдХреНрд╕рд░ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдЕрдзрд┐рдХ рд╕рдордп рд▓реЗрддрд╛ рд╣реИ тАФ рд╣рдо рдПрдХ рд╕рдВрджрд░реНрдн рдЪреЗрдХрдкреЙрдЗрдВрдЯ рднреА рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВ: [s3-8-3-3-20steps](https://huggingface.co/pat-jj/s3-8-3-3-20steps), рдЬрд┐рд╕реЗ рд▓рдЧрднрдЧ рдПрдХ рдШрдВрдЯреЗ рдореЗрдВ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред



## рд╕рдВрджрд░реНрдн
```bibtex
@article{jiang2025s3,
  title={s3: You Don't Need That Much Data to Train a Search Agent via RL},
  author={Jiang, Pengcheng and Xu, Xueqiang and Lin, Jiacheng and Xiao, Jinfeng and Wang, Zifeng and Sun, Jimeng and Han, Jiawei},
  journal={arXiv preprint arXiv:2505.14146},
  year={2025}
}
```
рд╣рдорд╛рд░реЗ рдХрд╛рдо рдореЗрдВ рдЖрдкрдХреА рд░реБрдЪрд┐ рдХреЗ рд▓рд┐рдП рдзрдиреНрдпрд╡рд╛рдж!






---

Tranlated By [Open Ai Tx](https://github.com/OpenAiTx/OpenAiTx) | Last indexed: 2025-12-30

---