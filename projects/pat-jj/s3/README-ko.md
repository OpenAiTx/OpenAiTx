
<div align="right">
  <details>
    <summary >ğŸŒ ì–¸ì–´</summary>
    <div>
      <div align="center">
        <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=en">English</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=zh-CN">ç®€ä½“ä¸­æ–‡</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=zh-TW">ç¹é«”ä¸­æ–‡</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=ja">æ—¥æœ¬èª</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=ko">í•œêµ­ì–´</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=hi">à¤¹à¤¿à¤¨à¥à¤¦à¥€</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=th">à¹„à¸—à¸¢</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=fr">FranÃ§ais</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=de">Deutsch</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=es">EspaÃ±ol</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=it">ì´íƒˆë¦¬ì•„ì–´</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=ru">ëŸ¬ì‹œì•„ì–´</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=pt">í¬ë¥´íˆ¬ê°ˆì–´</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=nl">ë„¤ëœë€ë“œì–´</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=pl">í´ë€ë“œì–´</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=ar">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=fa">ÙØ§Ø±Ø³ÛŒ</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=tr">í„°í‚¤ì–´</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=vi">ë² íŠ¸ë‚¨ì–´</a>
        | <a href="https://openaitx.github.io/view.html?user=pat-jj&project=s3&lang=id">ì¸ë„ë„¤ì‹œì•„ì–´</a>
      </div>
    </div>
  </details>
</div>

<div align="center">

# s3 - íš¨ìœ¨ì ì´ë©´ì„œ íš¨ê³¼ì ì¸ ê²€ìƒ‰ ì—ì´ì „íŠ¸ RL ê¸°ë°˜ í•™ìŠµ
***ê²€ìƒ‰ ì—ì´ì „íŠ¸ë¥¼ í•™ìŠµì‹œí‚¤ëŠ” ë° ê·¸ë ‡ê²Œ ë§ì€ ë°ì´í„°ê°€ í•„ìš”í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤***

<p align="center">

  <a href="https://arxiv.org/abs/2505.14146">
    <img src="https://img.shields.io/badge/arXiv-2505.14146-b31b1b.svg" alt="arXiv">
  </a>
</p>
</div>

**ì„±ëŠ¥ ê°œìš”:**

<img src="https://raw.githubusercontent.com/pat-jj/s3/main/images/performance_overview.png" alt="performance_overview" width="800">



## s3ë€ ë¬´ì—‡ì¸ê°€ìš”?

<div align="center">
<img src="https://raw.githubusercontent.com/pat-jj/s3/main/images/framework.png" alt="framework" width="800">

**s3 í”„ë ˆì„ì›Œí¬**
</div>

`s3`ëŠ” ê²€ìƒ‰ ì—ì´ì „íŠ¸ë¥¼ í›ˆë ¨í•˜ê¸° ìœ„í•œ ê°„ë‹¨í•˜ë©´ì„œë„ ê°•ë ¥í•œ í”„ë ˆì„ì›Œí¬ë¡œ, ê²€ìƒ‰ ê¸°ë°˜ ìƒì„±(RAG)ì— ì‚¬ìš©ë©ë‹ˆë‹¤. ì´ í”„ë ˆì„ì›Œí¬ëŠ” ìƒì„±ê¸°ë¥¼ ë³€ê²½í•˜ì§€ ì•Šê³ ë„ ì–¸ì–´ ëª¨ë¸ì´ ë” íš¨ê³¼ì ìœ¼ë¡œ ê²€ìƒ‰í•˜ëŠ” ë°©ë²•ì„ í•™ìŠµí•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤. `s3`ëŠ” ê²€ìƒ‰ ì»´í¬ë„ŒíŠ¸ì—ë§Œ ì§‘ì¤‘í•¨ìœ¼ë¡œì¨, ê¸°ì¡´ ë°©ë²•ë³´ë‹¤ í›¨ì”¬ ì ì€ ë°ì´í„°ë§Œìœ¼ë¡œë„ QA ì‘ì—…ì—ì„œ ê°•ë ¥í•œ ì„±ëŠ¥ì„ ë‹¬ì„±í•©ë‹ˆë‹¤. ëª¨ë“ˆì‹ êµ¬ì¡°ë¡œ íš¨ìœ¨ì ì´ë©°, ëª¨ë“  ë¸”ë™ë°•ìŠ¤ LLMê³¼ ì™„ë²½í•˜ê²Œ í˜¸í™˜ë˜ë„ë¡ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤.



## ëª©ì°¨

- [ğŸ“¦ ì„¤ì¹˜](#-installation)
- [ğŸ’¡ ì¤€ë¹„](#-preparation)
- [ğŸ‹ï¸ í›ˆë ¨ ì‹¤í–‰](https://github.com/pat-jj/s3?tab=readme-ov-file#%EF%B8%8F-run-training)
- [ğŸ” ê²€ìƒ‰/ê²€ìƒ‰ ì‹¤í–‰](https://github.com/pat-jj/s3?tab=readme-ov-file#-run-searchretrieval)
- [ğŸ“ˆ í‰ê°€ ì‹¤í–‰](#-run-evaluation)

## ğŸ“¦ ì„¤ì¹˜

**ê²€ìƒ‰ê¸° & ìƒì„±ê¸° í™˜ê²½**
```bash
conda create -n s3 python=3.9
# install torch [or you can skip this step and let vllm to install the correct version for you]
pip install torch==2.4.0 --index-url https://download.pytorch.org/whl/cu121
# install vllm
pip3 install vllm==0.6.3 # or you can install 0.5.4, 0.4.2 and 0.3.1
pip3 install ray

# verl
# cd code
pip install -e .

# flash attention 2
pip3 install flash-attn --no-build-isolation

# we use pyserini for efficient retrieval and evaluation
pip install pyserini    # the version we used is 0.22.1

# quality of life
pip install wandb IPython matplotlib huggingface_hub
```
**ê²€ìƒ‰ê¸° í™˜ê²½**

```bash
conda create -n ret python=3.10
conda activate ret

conda install pytorch==2.4.0 torchvision==0.19.0 torchaudio==2.4.0 pytorch-cuda=12.1 -c pytorch -c nvidia
pip install transformers datasets pyserini
conda install -c pytorch -c nvidia faiss-gpu=1.8.0
pip install uvicorn fastapi
```




## ğŸ’¡ ì¤€ë¹„í•˜ê¸°
***ìƒ‰ì¸ ë° ë§ë­‰ì¹˜ ë‹¤ìš´ë¡œë“œ***

```bash
python scripts/download.py --save_path $save_path
cat $save_path/part_* > $save_path/e5_Flat.index
gzip -d $save_path/wiki-18.jsonl.gz
```

***NaÃ¯ve RAG ì´ˆê¸°í™” ì‚¬ì „ ê³„ì‚°*** (ë˜ëŠ” ì €í¬ê°€ ì²˜ë¦¬í•œ ë°ì´í„°ë¥¼ ì—¬ê¸°ì—ì„œ ë‹¤ìš´ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤: [huggingface](https://huggingface.co/datasets/pat-jj/s3_processed_data))

```bash
# deploy retriever
bash scripts/deploy_retriever/retrieval_launch.sh # or scripts/deploy_retriever/retrieval_launch_mirage.sh for MedCorp corpus.
# deploy generator
bash generator_llms/host.sh # modify tensor-parallel-size to the number of GPUs you use
# run precompute
bash scripts/precompute.sh # this step will take a while, as it will precompute the naÃ¯ve RAG Cache for training
```



## ğŸ‹ï¸ í›ˆë ¨ ì‹¤í–‰
***ì´ ë‹¨ê³„ëŠ” S3 í›ˆë ¨ì„ ìœ„í•œ ê²ƒì…ë‹ˆë‹¤***


```bash
# deploy retriever
bash scripts/deploy_retriever/retrieval_launch.sh 
# deploy generator
bash generator_llms/host.sh
# run training
bash scripts/train/train_s3.sh
```



## ğŸ” ê²€ìƒ‰/ê²€ìƒ‰ ì‹¤í–‰
***ì´ ë‹¨ê³„ëŠ” s3 / ê¸°ì¤€ì„ ì˜ ì»¨í…ìŠ¤íŠ¸ ìˆ˜ì§‘ì„ ìœ„í•œ ê²ƒì…ë‹ˆë‹¤***

**s3**

```bash
# deploy retriever
bash scripts/deploy_retriever/retrieval_launch.sh 
# run s3 inference
bash scripts/s3_inference/evaluate-8-3-3.sh
```


<details>
<summary>ê¸°ì¤€ì„ </summary>

**RAG**

```bash
bash scripts/deploy_retriever/retrieval_launch.sh # or retrieval_launch_bm25.sh # deploy retriever
bash scripts/baselines/rag.sh # run RAG 
```


**ë”¥ë¦¬íŠ¸ë¦¬ë²Œ**

```bash
bash retrieval_launch_bm25.sh # deploy BM25 Model
bash generator_llms/deepretrieval.sh # deploy DeepRetrieval Model
bash scripts/baselines/deepretrieval.sh # run DeepRetrieval Query Rewriting + Retrieval
```
**ê²€ìƒ‰-R1**

```bash
bash retrieval_launch.sh # deploy e5 retriever
bash scripts/baselines/search_r1.sh # run Search-R1
```
**IRCoT**

```bash
bash retrieval_launch.sh # deploy e5 retriever
python scripts/baselines/ircot.py
```
**ê²€ìƒ‰-o1**

```bash
bash retrieval_launch.sh # deploy e5 retriever
bash scripts/baselines/search_o1.sh # run Search-o1
```


</details>


## ğŸ“ˆ ì‹¤í–‰ í‰ê°€
***ì´ ë‹¨ê³„ëŠ” s3 / ê¸°ì¤€ì„  í‰ê°€ë¥¼ ìœ„í•œ ë‹¨ê³„ì…ë‹ˆë‹¤***



```bash
bash scripts/evaluation/run.sh
```

## Q&A
### ë§ì¶¤í˜• ë°ì´í„°?
ìì‹ ë§Œì˜ ë§ë­‰ì¹˜/ë°ì´í„°ì…‹ì—ì„œ s3ë¥¼ í…ŒìŠ¤íŠ¸í•˜ê³  ì‹¶ë‹¤ë©´, ì´ ì»¤ë°‹ì„ ì°¸ê³ í•˜ì—¬ ì§ì ‘ íŒŒì´í”„ë¼ì¸ì„ êµ¬ì¶•í•˜ëŠ” ë° í•„ìš”í•œ ì‚¬í•­ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤: [commit 8420538](https://github.com/pat-jj/s3/commit/8420538836febbe59d5bcbe41187f16908c9c36c)

### ê²°ê³¼ ì¬í˜„?
ì—¬ëŸ¬ ê°œë°œìê°€ ì´ë¯¸ ì„±ê³µì ìœ¼ë¡œ ê²°ê³¼ë¥¼ ì¬í˜„í–ˆìŠµë‹ˆë‹¤. ì§ˆë¬¸ì´ ìˆê±°ë‚˜ ë¬¸ì œê°€ ë°œìƒí•˜ë©´ ì–¸ì œë“ ì§€ [ì´ìŠˆë¥¼ ë“±ë¡](https://github.com/pat-jj/s3/issues)í•˜ì„¸ìš” â€” ì§ì ‘ì ì¸ ì•ˆë‚´ë¥¼ ê¸°êº¼ì´ ì œê³µí•´ë“œë¦½ë‹ˆë‹¤ (ì˜ˆì‹œëŠ” [ì—¬ê¸°](https://github.com/pat-jj/s3/issues/20)ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤).

ëª¨ë¸ì„ ì§ì ‘ ì¬í˜„í•˜ëŠ” ê³¼ì •ì€ ê°„ë‹¨í•˜ë©° â€” ì‹¤ì œë¡œ **ì²˜ìŒë¶€í„° í•™ìŠµí•˜ëŠ” ê²ƒì„ ì¶”ì²œ**í•©ë‹ˆë‹¤, í‰ê°€ê°€ ì¢…ì¢… í•™ìŠµë³´ë‹¤ í›¨ì”¬ ë” ì‹œê°„ì´ ë§ì´ ì†Œìš”ë˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤ â€” ì°¸ê³  ì²´í¬í¬ì¸íŠ¸ë„ ì œê³µí•©ë‹ˆë‹¤: [s3-8-3-3-20steps](https://huggingface.co/pat-jj/s3-8-3-3-20steps), ì•½ 1ì‹œê°„ ì •ë„ í•™ìŠµë˜ì—ˆìŠµë‹ˆë‹¤.



## ê°ì‚¬ì˜ ë§ì”€
ë‹¤ìŒ í”„ë¡œì íŠ¸ì— ê°ì‚¬ë“œë¦½ë‹ˆë‹¤:
[verl](https://github.com/volcengine/verl), [RAGEN](https://github.com/RAGEN-AI/RAGEN), [Search-R1](https://github.com/PeterGriffinJin/Search-R1), [DeepRetrieval](https://github.com/pat-jj/DeepRetrieval), [PySerini](https://github.com/castorini/pySerini).
 

## ì¸ìš©
```bibtex
@article{jiang2025s3,
  title={s3: You Don't Need That Much Data to Train a Search Agent via RL},
  author={Jiang, Pengcheng and Xu, Xueqiang and Lin, Jiacheng and Xiao, Jinfeng and Wang, Zifeng and Sun, Jimeng and Han, Jiawei},
  journal={arXiv preprint arXiv:2505.14146},
  year={2025}
}
```


ìš°ë¦¬ ì‘ì—…ì— ê´€ì‹¬ì„ ê°€ì ¸ ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤!






---

Tranlated By [Open Ai Tx](https://github.com/OpenAiTx/OpenAiTx) | Last indexed: 2025-10-06

---