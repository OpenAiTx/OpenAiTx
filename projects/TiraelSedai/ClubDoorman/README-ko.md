## 텔레그램용 안티스팸

원래는 바스트릭 클럽 채팅의 스패머 문제를 해결하기 위해 개발되었지만, 다른 포크 채팅이나 단순히 큰 채팅방 어디서나 사용할 수 있습니다.

### 작동 원리
- 봇이 연결된 클럽 사용자는 자동으로 신뢰 목록에 추가됩니다.
- "사용자가 채팅에 입장함" 이벤트 시 간단한 캡차가 발급됩니다.
- 사용자가 이미 신뢰 목록에 있으면 모든 검사가 생략됩니다.
- 사용자가 알려진 스패머 목록에 있으면 차단됩니다.
- 메시지에 이모지가 너무 많으면 차단됩니다.
- 메시지에 러시아어처럼 보이지만 영어 문자가 섞인 단어가 있으면 차단됩니다. 이 부분은 주로 러시아어 채팅에 맞춰 조정되었으며, 키릴 문자로 쓰인 정상 단어에 오작동할 수 있으나 알려진 모든 사례는 테스트에 포함되어 있습니다.
- "온라인 수입"과 같은 스팸 단어가 있으면 차단됩니다.
- 이후 메시지에서 이모지, 구두점, 발음 구별 부호를 제거하고 ML에 입력합니다. ML이 스팸으로 판단하면 차단됩니다.
- 사용자가 여러 정상 메시지를 작성하면 신뢰 목록에 추가됩니다. 스패머는 거의 신뢰를 얻지 못하며 보통 첫두 메시지에서 드러납니다.
- 봇은 자동으로 메시지만 삭제하며, 사용자는 관리 패널에서 수동으로 차단하여 오탐 피해를 줄입니다.
- - 블랙리스트 제외. 블랙리스트 사용자는 즉시 차단되며, 이 기능은 비활성화할 수 있습니다.
- 봇이 아닌 누군가 채팅에서 사용자를 차단하면, 관리 패널에 알림이 오며 봇이 스팸을 놓쳤을 수 있어 데이터셋에 추가할 수 있습니다.

### 관리자 명령어
모든 명령어는 다른 메시지에 답글로 호출됩니다.
- /spam - 메시지를 스팸 데이터셋에 추가합니다.
- /ham - 메시지를 비스팸 데이터셋에 추가합니다.
- /check - 메시지를 모든 검사에 통과시킵니다.

### 설정
관리자 채팅을 만들고 ID를 기억합니다.
환경 변수:
- DOORMAN_BOT_API: 텔레그램 봇 토큰. 필수
- DOORMAN_ADMIN_CHAT: 관리자 채팅 ID. 필수
- DOORMAN_CLUB_SERVICE_TOKEN: 클럽 서비스 토큰, https://vas3k.club/apps/ 에서 생성. 설정하지 않으면 클럽 사용자의 자동 승인 생략됨.
- DOORMAN_CLUB_URL: 클럽 포크의 기본 URL, 예: https://rationalanswer.club/
- DOORMAN_BLACKLIST_AUTOBAN_DISABLE: true 또는 1로 설정하면 봇이 블랙리스트(클럽 비회원, 승인 안 된 사용자) 사용자 즉시 차단하지 않음.
- DOORMAN_LOW_CONFIDENCE_HAM_ENABLE: true 또는 1로 설정하면 ML 신뢰도 낮은 비스팸 메시지를 관리자에게 보냄. 스패머가 ML 품질을 테스트하는 채팅에 유용.
- DOORMAN_CHANNELS_AUTOBAN_DISABLE: true 또는 1로 설정하면 현재 그룹에 연결된 채널 제외하고 채널 메시지를 차단하지 않음.
- DOORMAN_APPROVE_BUTTON: true 또는 1로 설정하면 삭제된 메시지마다 "이 사람은 아는 사람, 단골" 옵션이 추가됨.
- DOORMAN_LOOKALIKE_AUTOBAN_DISABLE: true 또는 1로 설정하면 러시아어처럼 보이는 단어가 있어도 차단하지 않음.
- DOORMAN_BUTTON_AUTOBAN_DISABLE: true 또는 1로 설정하면 버튼이 포함된 메시지를 차단하지 않음.
- DOORMAN_HIGH_CONFIDENCE_AUTOBAN_DISABLE: true 또는 1로 설정하면 ML 분류기가 스팸으로 매우 확신하는 메시지도 차단하지 않음.
- DOORMAN_CHANNEL_AUTOBAN_EXCLUSION: 채널이 차단되지 않는 그룹을 쉼표로 구분하여 설정.

#### 감사합니다
- 스패머와의 싸움과 밴 목록 API 제공에 https://lols.bot/ 에 감사드립니다
- 일부 아이디어와 데이터셋 4분의 3 제공에 https://github.com/umputun/tg-spam/ 에 감사드립니다

### 번역
이 봇의 모든 텍스트를 다른 언어로 번역하는 어려운 작업을 기꺼이 하실 경우, 무턱대고 PR을 생성하기 전에 먼저 알려주시기 바랍니다.



---

Tranlated By [Open Ai Tx](https://github.com/OpenAiTx/OpenAiTx) | Last indexed: 2025-10-02

---