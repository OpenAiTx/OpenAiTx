# wmproxy
[![crates.io](https://img.shields.io/crates/v/wmproxy.svg)](https://crates.io/crates/wmproxy)
[![rustc 1.70.0](https://img.shields.io/badge/rust-1.70%2B-orange.svg)](https://img.shields.io/badge/rust-1.70%2B-orange.svg)
[![Released API docs](https://docs.rs/wmproxy/badge.svg)](https://docs.rs/wmproxy)

`wmproxy` рдХреЛ `Rust` рдореЗрдВ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдЬреЛ `http/https` рдкреНрд░реЙрдХреНрд╕реА, `socks5` рдкреНрд░реЙрдХреНрд╕реА, рд░рд┐рд╡рд░реНрд╕ рдкреНрд░реЙрдХреНрд╕реА, рд▓реЛрдб рдмреИрд▓реЗрдВрд╕рд┐рдВрдЧ, рд╕реНрдЯреИрдЯрд┐рдХ рдлрд╛рдЗрд▓ рд╕рд░реНрд╡рд░, `websocket` рдкреНрд░реЙрдХреНрд╕реА, рд▓реЗрдпрд░ 4 TCP/UDP рдлреЙрд░рд╡рд░реНрдбрд┐рдВрдЧ, рдЗрдирд░рдиреЗрдЯ рдкреЗрдирд┐рдЯреНрд░реЗрд╢рди рдЖрджрд┐ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИред

## ЁЯУж рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░реЗрдВ & ЁЯПГ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ

### рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░реЗрдВ

```bash
cargo install wmproxy
```

рдпрд╛

```bash
git clone https://github.com/tickbh/wmproxy
cd wmproxy
cargo install --path .
```

```docker
docker pull dreamwhat/wmproxy
docker run -p 8090:8090 --name proxy_bash dreamwhat/wmproxy /bin/./wmproxy proxy -b 0.0.0.0:8090
```

### рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ
рдбрд┐рдлреЙрд▓реНрдЯ рдкреЛрд░реНрдЯ 8090 рд╣реИ, рдбрд┐рдлреЙрд▓реНрдЯ рд▓рд┐рд╕рди рдкрддрд╛ 127.0.0.1 рд╣реИ
```bash
# рд╕реАрдзреЗ рдбрд┐рдлреЙрд▓реНрдЯ рдкреИрд░рд╛рдореАрдЯрд░ рд╕реЗ рдЪрд▓рд╛рдПрдБ
wmproxy proxy

# рдпреВрдЬрд░рдиреЗрдо рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рд╕реЗрдЯ рдХрд░реЗрдВ
wmproxy proxy -b 0.0.0.0:8090 --user wmproxy --pass wmproxy

# рдЕрдиреНрдп рдХрдорд╛рдВрдб
wmproxy --help

#рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓ рдХреЗ рд╕рд╛рде рд╕реНрдЯрд╛рд░реНрдЯ рдХрд░реЗрдВ
wmproxy config -c config/client.toml
```

##### рджреНрд╡рд┐рддреАрдпрдХ рдкреНрд░реЙрдХреНрд╕реА рдкреНрд░рд╛рд░рдВрдн рдХрд░реЗрдВ
1. рд▓реЛрдХрд▓ рдореЗрдВ рдкреНрд░реЙрдХреНрд╕реА рдкреНрд░рд╛рд░рдВрдн рдХрд░реЗрдВ
```bash
wmproxy proxy -b 127.0.0.1:8090 -S 127.0.0.1:8091 --ts
```
рдпрд╛
```bash
wmproxy config -c config/client.toml
```
рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╣реИ:
```toml
[proxy]
# рд╕рд░реНрд╡рд░ рдХрд╛ рдкрддрд╛ рдХрдиреЗрдХреНрдЯ рдХрд░реЗрдВ
#server = "127.0.0.1:8091"
bind_addr = "0.0.0.0:8090"
flag = "http https socks5"
# рд╕рд░реНрд╡рд░ рдХрдиреЗрдХреНрд╢рди рдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб рд╣реИ рдпрд╛ рдирд╣реАрдВ
ts = true
two_way_tls = true
# username = "wmproxy"
# password = "wmproxy"

# рдЗрдирд░рдиреЗрдЯ рдореИрдкрд┐рдВрдЧ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреА рд╕реВрдЪреА

  #localhost рдХрд╛ рдбреЛрдореЗрди рдирд╛рдо 127.0.0.1:8080 рдкрд░ рдлреЙрд░рд╡рд░реНрдб рдХрд░реЗрдВ
[[proxy.mappings]]
name = "web"
mode = "http"
local_addr = "127.0.0.1:8080"
domain = "localhost"

headers = [
  "proxy x-forward-for {client_ip}",
  "proxy + from $url",
  "+ last-modified 'from proxy'",
  "- etag",
]

#tcp рдЯреНрд░реИрдлрд┐рдХ рдХреЛ рдмрд┐рдирд╛ рд╢рд░реНрдд 127.0.0.1:8080 рдкрд░ рдлреЙрд░рд╡рд░реНрдб рдХрд░реЗрдВ
[[proxy.mappings]]
name = "tcp"
mode = "tcp"
local_addr = "127.0.0.1:8080"
domain = ""
```

рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдХреЗрд╡рд▓ рдлреЙрд░рд╡рд░реНрдбрд┐рдВрдЧ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╡рд░реНрддрдорд╛рди рдиреЛрдб рдкрд░ рдпреВрдЬрд░рдиреЗрдо рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рд╕реЗрдЯ рдХрд░рдирд╛ рдмреЗрдХрд╛рд░ рд╣реИред `-S` рдХрд╛ рдЕрд░реНрде рд╣реИ рджреНрд╡рд┐рддреАрдпрдХ рдкреНрд░реЙрдХреНрд╕реА рдХрд╛ рдкрддрд╛ рдЬрд┐рд╕рд╕реЗ рдХрдиреЗрдХреНрдЯ рд╣реЛрдирд╛ рд╣реИ, **рдпрджрд┐ рдпрд╣ рдкреИрд░рд╛рдореАрдЯрд░ рдореМрдЬреВрдж рд╣реИ рддреЛ рдпрд╣ рд░рд┐рд▓реЗ рдкреНрд░реЙрдХреНрд╕реА рд╣реИ, рдЕрдиреНрдпрдерд╛ рдпрд╣ рдЕрдВрддрд┐рдо рдкреНрд░реЙрдХреНрд╕реА рд╣реИред** ```--ts``` рдХрд╛ рдЕрд░реНрде рд╣реИ рдкреИрд░реЗрдВрдЯ рдкреНрд░реЙрдХреНрд╕реА рд╕реЗ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб рдХрдиреЗрдХреНрд╢рди рдмрдирд╛рдирд╛ред

2. рд░рд┐рдореЛрдЯ рдореЗрдВ рдкреНрд░реЙрдХреНрд╕реА рдкреНрд░рд╛рд░рдВрдн рдХрд░реЗрдВ
```bash
wmproxy proxy --user proxy --pass proxy -b 0.0.0.0:8091 --tc
```
рдпрд╛
```bash
wmproxy config -c config/server.toml
```
рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╣реИ:
```toml
[proxy]
#рдмрд╛рдЙрдВрдб ip рдкрддрд╛
bind_addr = "127.0.0.1:8091"

#рдкреНрд░реЙрдХреНрд╕реА рджреНрд╡рд╛рд░рд╛ рд╕рдорд░реНрдерд┐рдд рдХрд╛рд░реНрдп, 1=http, 2=https, 4=socks5
# flag = "7"
username = "wmproxy"
password = "wmproxy"

#рдЗрдирд░рдиреЗрдЯ рдореИрдкрд┐рдВрдЧ http рдмрд╛рдЗрдВрдб рдкрддрд╛
map_http_bind = "127.0.0.1:8001"
#рдЗрдирд░рдиреЗрдЯ рдореИрдкрд┐рдВрдЧ tcp рдмрд╛рдЗрдВрдб рдкрддрд╛
map_tcp_bind = "127.0.0.1:8002"
#рдЗрдирд░рдиреЗрдЯ рдореИрдкрд┐рдВрдЧ https рдмрд╛рдЗрдВрдб рдкрддрд╛
map_https_bind = "127.0.0.1:8003"
#рдЗрдирд░рдиреЗрдЯ рдореИрдкрд┐рдВрдЧ рдХрд╛ рдкрдмреНрд▓рд┐рдХ рдХреА рд╕рд░реНрдЯрд┐рдлрд┐рдХреЗрдЯ, рдЦрд╛рд▓реА рд╣реЛрдиреЗ рдкрд░ рдбрд┐рдлреЙрд▓реНрдЯ рд╕рд░реНрдЯрд┐рдлрд┐рдХреЗрдЯ
# map_cert = 
#рдЗрдирд░рдиреЗрдЯ рдореИрдкрд┐рдВрдЧ рдХрд╛ рдкреНрд░рд╛рдЗрд╡реЗрдЯ рдХреА рд╕рд░реНрдЯрд┐рдлрд┐рдХреЗрдЯ, рдЦрд╛рд▓реА рд╣реЛрдиреЗ рдкрд░ рдбрд┐рдлреЙрд▓реНрдЯ рд╕рд░реНрдЯрд┐рдлрд┐рдХреЗрдЯ
# map_key =
# рджреНрд╡рд┐-рджрд┐рд╢рд╛ рдкреНрд░рдорд╛рдгреАрдХрд░рдг
two_way_tls = true
#рдХреНрдпрд╛ рдХреНрд▓рд╛рдЗрдВрдЯ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб рдХреНрд▓рд╛рдЗрдВрдЯ рд╣реИ, рдЗрд╕реЗ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░реЗрдВ
tc = true
#рд╡рд░реНрддрдорд╛рди рд╕реЗрд╡рд╛ рдореЛрдб, server=рд╕рд░реНрд╡рд░, client=рдХреНрд▓рд╛рдЗрдВрдЯ
mode = "server"
```

```--tc``` рдХрд╛ рдЕрд░реНрде рд╣реИ рд╕рдм-рдкреНрд░реЙрдХреНрд╕реА рд╕реЗ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб рдХрдиреЗрдХреНрд╢рди рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рдирд╛ред рдЖрдк ```--cert``` рд╕реЗ рд╕рд░реНрдЯрд┐рдлрд┐рдХреЗрдЯ рдХрд╛ рдкрдмреНрд▓рд┐рдХ рдХреА, ```--key``` рд╕реЗ рдкреНрд░рд╛рдЗрд╡реЗрдЯ рдХреА, ```--domain``` рд╕реЗ рдбреЛрдореЗрди рд╕реЗрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдпрджрд┐ рд╕реЗрдЯ рдирд╣реАрдВ рдХрд┐рдпрд╛, рддреЛ рдбрд┐рдлреЙрд▓реНрдЯ рд╕рд░реНрдЯрд┐рдлрд┐рдХреЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рд╣реЛрдЧрд╛ред
> рдЗрд╕ рдмрд┐рдВрджреБ рдкрд░ рдкреНрд░реЙрдХреНрд╕реА рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкрд╣реБрдБрдЪрдиреЗ рдкрд░, рд╣рдо рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдЕрдиреБрд░реЛрдз рдХрд╛ рдкрддрд╛ рдкреНрд░рд╛рдкреНрдд рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ, рдХреЗрд╡рд▓ рдкреНрд░реЙрдХреНрд╕реА рдХреЗ рд╢реБрд░реВ рдХрд┐рдП рдЧрдП рдЕрдиреБрд░реЛрдз рдХрд╛ рдкрддрд╛ рдорд┐рд▓реЗрдЧрд╛ред

### рдкреНрд░реЙрдХреНрд╕реА рдХреЗ рдмреАрдЪ рдкреНрд░рдорд╛рдгреАрдХрд░рдг
> рд╡рд░реНрддрдорд╛рди рдореЗрдВ рджреЛ рдкреНрд░рдХрд╛рд░ рдХреЗ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдЙрдкрд▓рдмреНрдз рд╣реИрдВ, ```two_way_tls``` рдХреНрд▓рд╛рдЗрдВрдЯ рд╕рд░реНрдЯрд┐рдлрд┐рдХреЗрдЯ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╕рдХреНрд╖рдо рдХрд░рддрд╛ рд╣реИ, рджреВрд╕рд░рд╛ рд╕рд░реНрд╡рд░ рдкрд░ ```username``` рдФрд░ ```password``` рд╕реЗрдЯ рдХрд░рдиреЗ рдкрд░ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЛ рд╡рд╣реА рдпреВрдЬрд╝рд░-рдкрд╛рд╕рд╡рд░реНрдб рджреЗрдирд╛ рд╣реЛрдЧрд╛ред рджреЛрдиреЛрдВ рдХреЛ рдПрдХ рд╕рд╛рде рдпрд╛ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
> рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдЬреЛрдбрд╝реЗрдВ:

```yaml
proxy:
  two_way_tls: true
  username: wmproxy
  password: wmproxy
```

# ЁЯЪе рд░реЛрдбрдореИрдк
### socks5

- [x] IPV6 рд╕рдорд░реНрдерди
- [x] `SOCKS5` рдкреНрд░рдорд╛рдгреАрдХрд░рдг
  - [x] `NOAUTH`
  - [x] `USERPASS`
- [x] `SOCKS5` рдХрдорд╛рдВрдбреНрд╕
  - [x] `CONNECT`
  - [x] `UDP ASSOCIATE`

### http/https

- [x] IPV6 рд╕рдорд░реНрдерди

### рдЗрдирд░рдиреЗрдЯ рдкреЗрдирд┐рдЯреНрд░реЗрд╢рди

- [x] Http рд╕рдорд░реНрдерди
- [x] Https рд╕рдорд░реНрдерди
- [x] Tcp рд╕рдорд░реНрдерди

### рд░рд┐рд╡рд░реНрд╕ рдкреНрд░реЙрдХреНрд╕реА

- [x] рд╕реНрдЯреИрдЯрд┐рдХ рдлрд╛рдЗрд▓ рд╕рд░реНрд╡рд░
- [x] рдкреИрд╕рд┐рд╡ рд╣реЗрд▓реНрде рдЪреЗрдХ
- [x] рдПрдХреНрдЯрд┐рд╡ рд╣реЗрд▓реНрде рдЪреЗрдХ
- [x] рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╣реЙрдЯ рд▓реЛрдбрд┐рдВрдЧ
- [x] рд▓реЛрдб рдмреИрд▓реЗрдВрд╕рд┐рдВрдЧ
- [x] рд▓реЗрдпрд░ 4 TCP рд▓реЛрдб
- [x] рд▓реЗрдпрд░ 4 UDP рд▓реЛрдб
- [x] рдЯреНрд░реИрдлрд┐рдХ рдХрдВрдЯреНрд░реЛрд▓
- [x] websocket рдлреЙрд░рд╡рд░реНрдбрд┐рдВрдЧ

### рдмреЗрд╕рд┐рдХ рдХреНрд╖рдорддрд╛рдПрдБ
- [x] рд▓реЙрдЧрд┐рдВрдЧ

#### рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреНрд╖рдорддрд╛рдПрдБ

- [x] рдЕрдиреБрд░реЛрдз рдЧрддрд┐ рд╕реАрдорд╛ (limit_req)
- [x] HTTP рдЕрдиреБрд░реЛрдз рд╣реЗрдбрд░ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░реЗрдВ
- [x] HTTP2 рдЗрдирд░рдиреЗрдЯ рдкреЗрдирд┐рдЯреНрд░реЗрд╢рди рд╕рдорд░реНрдерди
- [x] рдорд╛рдЗрдХреНрд░реЛ рдХреНрд▓рд╛рдЗрдВрдЯ рдирд┐рдпрдВрддреНрд░рдг
- [x] try_paths
- [x] tcp рд╕реЗ websocket
- [x] websocket рд╕реЗ tcp


## Star History

[![Star History Chart](https://api.star-history.com/svg?repos=tickbh/wmproxy&type=Date)](https://star-history.com/#tickbh/wmproxy&Date)


---

Tranlated By [Open Ai Tx](https://github.com/OpenAiTx/OpenAiTx) | Last indexed: 2025-06-09

---