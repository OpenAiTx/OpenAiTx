
<div align="right">
  <details>
    <summary >üåê –Ø–∑—ã–∫</summary>
    <div>
      <div align="center">
        <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=en">English</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=zh-CN">ÁÆÄ‰Ωì‰∏≠Êñá</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=zh-TW">ÁπÅÈ´î‰∏≠Êñá</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=ja">Êó•Êú¨Ë™û</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=ko">ÌïúÍµ≠Ïñ¥</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=th">‡πÑ‡∏ó‡∏¢</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=fr">Fran√ßais</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=de">Deutsch</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=es">Espa√±ol</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=it">Italiano</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=ru">–†—É—Å—Å–∫–∏–π</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=pt">Portugu√™s</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=nl">Nederlands</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=pl">Polski</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=ar">ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=fa">ŸÅÿßÿ±ÿ≥€å</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=tr">T√ºrk√ße</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=vi">Ti·∫øng Vi·ªát</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=id">Bahasa Indonesia</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=as">‡¶Ö‡¶∏‡¶Æ‡ßÄ‡¶Ø‡¶º‡¶æ</
      </div>
    </div>
  </details>
</div>

# –°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ç–æ–∫–æ–≤ –≤ PyTorch

–≠—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–æ—Å—Ç—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –Ω–∞ PyTorch —Å—Ç–∞—Ç—å–∏ [Flow Matching for Generative Modeling](https://arxiv.org/abs/2210.02747).

## –ü—Ä–∏–º–µ—Ä —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –ø–æ—Ç–æ–∫–∞ –≤ 2D

–ù–∏–∂–µ –ø–æ–∫–∞–∑–∞–Ω gif, –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—â–∏–π –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ–¥–Ω–æ–º–µ—Ä–Ω–æ–≥–æ –≥–∞—É—Å—Å–æ–≤—Å–∫–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≤ —à–∞—Ö–º–∞—Ç–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π –≤–µ–∫—Ç–æ—Ä–Ω–æ–≥–æ –ø–æ–ª—è.

<p align="center">
<img align="middle" src="https://raw.githubusercontent.com/keishihara/flow-matching/main/./outputs/cfm/checkerboard/vector_field_and_samples_checkerboard.gif" height="400" />
</p>

–ê –≤–æ—Ç –µ—â–µ –æ–¥–∏–Ω –ø—Ä–∏–º–µ—Ä —Å –Ω–∞–±–æ—Ä–æ–º –¥–∞–Ω–Ω—ã—Ö "–ª—É–Ω—ã".

<p align="center">
<img align="middle" src="https://raw.githubusercontent.com/keishihara/flow-matching/main/./outputs/cfm/moons/vector_field_and_samples_moons.gif" height="400" />
</p>

## –ù–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã

–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ python-–æ–∫—Ä—É–∂–µ–Ω–∏–µ.

```bash
git clone https://github.com/keishihara/flow-matching.git
cd flow-matching
```

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Python –≤–µ—Ä—Å–∏–∏ 3.12 –∏–ª–∏ –≤—ã—à–µ.
–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `uv`:

```bash
curl -LsSf https://astral.sh/uv/install.sh | sh
```

–ó–∞—Ç–µ–º –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ —Å—Ä–µ–¥—É:

```bash
uv sync
```

## Conditional Flow Matching [Lipman+ 2023]

–≠—Ç–æ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç–∞—Ç—å–∏ CFM [1]. –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∫–æ–¥–∞ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω—ã –∏–∑ [2] –∏ [3].

### 2D –∏–≥—Ä—É—à–µ—á–Ω—ã–µ –¥–∞—Ç–∞—Å–µ—Ç—ã

–í—ã –º–æ–∂–µ—Ç–µ –æ–±—É—á–∞—Ç—å –º–æ–¥–µ–ª–∏ CFM –Ω–∞ 2D —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç–∞—Ö, —Ç–∞–∫–∏—Ö –∫–∞–∫ `checkerboard` –∏ `moons`. –£–∫–∞–∂–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –¥–∞—Ç–∞—Å–µ—Ç–∞ —Å –ø–æ–º–æ—â—å—é –æ–ø—Ü–∏–∏ `--dataset`. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–±—É—á–µ–Ω–∏—è –∑–∞—Ä–∞–Ω–µ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤ —Å–∫—Ä–∏–ø—Ç–µ, –∞ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –æ–±—É—á–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `outputs/`. –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏ –º–æ–¥–µ–ª–∏ –Ω–µ –≤–∫–ª—é—á–µ–Ω—ã, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ –ª–µ–≥–∫–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º—ã —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.

```bash
uv run scripts/train_flow_matching_2d.py --dataset checkerboard
```

–í–µ–∫—Ç–æ—Ä–Ω—ã–µ –ø–æ–ª—è –∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ–±—Ä–∞–∑—Ü—ã, —Ç–∞–∫–∏–µ –∫–∞–∫ —Ç–µ, —á—Ç–æ –ø–æ–∫–∞–∑–∞–Ω—ã –≤ GIF-—Ñ–∞–π–ª–∞—Ö –≤ –≤–µ—Ä—Ö–Ω–µ–π —á–∞—Å—Ç–∏ —ç—Ç–æ–≥–æ README, —Ç–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `outputs/cfm/`.

### –ù–∞–±–æ—Ä—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

–í—ã —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç–µ –æ–±—É—á–∞—Ç—å –∫–ª–∞—Å—Å–æ–≤–æ-—É—Å–ª–æ–≤–Ω—ã–µ –º–æ–¥–µ–ª–∏ CFM –Ω–∞ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –Ω–∞–±–æ—Ä–∞—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π. –ö–∞–∫ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ–±—Ä–∞–∑—Ü—ã, —Ç–∞–∫ –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏ –º–æ–¥–µ–ª–∏ –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `outputs/cfm`. –î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–¥—Ä–æ–±–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –æ–±—É—á–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É `uv run scripts/train_flow_matching_on_image.py --help`.

–ß—Ç–æ–±—ã –æ–±—É—á–∏—Ç—å –∫–ª–∞—Å—Å–æ–≤–æ-—É—Å–ª–æ–≤–Ω—É—é CFM –Ω–∞ –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö MNIST, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
uv run scripts/train_flow_matching_on_image.py --do_train --dataset mnist
```
–ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è –≤—ã —Ç–µ–ø–µ—Ä—å –º–æ–∂–µ—Ç–µ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –æ–±—Ä–∞–∑—Ü—ã —Å –ø–æ–º–æ—â—å—é:


```bash
uv run scripts/train_flow_matching_on_image.py --do_sample --dataset mnist
```
–¢–µ–ø–µ—Ä—å –≤—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ–±—Ä–∞–∑—Ü—ã –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `outputs/cfm/mnist/`.

<p align="center">
<img align="middle" src="https://raw.githubusercontent.com/keishihara/flow-matching/main/./outputs/cfm/mnist/trajectory.gif" height="400" />
</p>

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –ø–æ—Ç–æ–∫ [Liu+ 2023]

–≠—Ç–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥–µ–ª–∏ Reflow (–∞ –∏–º–µ–Ω–Ω–æ 2-Rectified Flow) –∏–∑ —Å—Ç–∞—Ç—å–∏ Rectified Flow [2].

### 2D —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ

–ú—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–ª–∏ Reflow –Ω–∞ 2d —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö –Ω–∞–±–æ—Ä–∞—Ö –¥–∞–Ω–Ω—ã—Ö, –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ CFM. –î–ª—è –æ–±—É—á–µ–Ω–∏—è reflow –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É–∫–∞–∑–∞—Ç—å –∑–∞—Ä–∞–Ω–µ–µ –æ–±—É—á–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏ CFM, —Ç–∞–∫ –∫–∞–∫ reflow —è–≤–ª—è–µ—Ç—Å—è –º–æ–¥–µ–ª—å—é –¥–∏—Å—Ç–∏–ª–ª—è—Ü–∏–∏.

–ù–∞–ø—Ä–∏–º–µ—Ä, —á—Ç–æ–±—ã –æ–±—É—á–∏—Ç—å –Ω–∞ –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö `checkerboard` —Å –∑–∞—Ä–∞–Ω–µ–µ –æ–±—É—á–µ–Ω–Ω–æ–π –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–π —Ç–æ—á–∫–æ–π CFM:


```bash
uv run scripts/train_reflow_2d.py --dataset checkerboard
```

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—É—á–µ–Ω–∏—è, –≤–∫–ª—é—á–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –≤–µ–∫—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ª–µ–π –∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ–±—Ä–∞–∑—Ü—ã, —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ø–∞–ø–∫–µ `outputs/reflow/`.

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å–µ–º–ø–ª–∏—Ä–æ–≤–∞–Ω–∏—è –º–µ–∂–¥—É CFM –∏ Reflow

–î–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è CFM –∏ Reflow –Ω–∞ –¥–≤—É–º–µ—Ä–Ω—ã—Ö –¥–∞—Ç–∞—Å–µ—Ç–∞—Ö –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
uv run scripts/plot_comparison_2d.py --dataset checkerboard
```

–ü–æ–ª—É—á–∏–≤—à–∏–µ—Å—è GIF-—Ñ–∞–π–ª—ã –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤ –ø–∞–ø–∫–µ `outputs/comparisons/`. –ù–∏–∂–µ –ø—Ä–∏–≤–µ–¥–µ–Ω –ø—Ä–∏–º–µ—Ä —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –¥–≤—É—Ö –º–µ—Ç–æ–¥–æ–≤ –Ω–∞ –¥–∞—Ç–∞—Å–µ—Ç–µ `checkerboard`:

<p align="center">
<img align="middle" src="https://raw.githubusercontent.com/keishihara/flow-matching/main/./outputs/comparisons/cfm_reflow_checkerboard.gif" height="400" />
</p>

## –°—Å—ã–ª–∫–∏

- [1] –õ–∏–ø–º–∞–Ω, –Ø—Ä–æ–Ω –∏ –¥—Ä. "Flow Matching for Generative Modeling." [arXiv:2210.02747](https://arxiv.org/abs/2210.02747)
- [2] –õ—é, –°–∏–Ω—á–∞–æ –∏ –¥—Ä. "Flow Straight and Fast: Learning to Generate and Transfer Data with Rectified Flow." [arXiv:2209.03003](https://arxiv.org/abs/2209.03003)
- [3] [facebookresearch/flow_matching](https://github.com/facebookresearch/flow_matching)
- [4] [atong01/conditional-flow-matching](https://github.com/atong01/conditional-flow-matching)


---

Tranlated By [Open Ai Tx](https://github.com/OpenAiTx/OpenAiTx) | Last indexed: 2026-01-19

---