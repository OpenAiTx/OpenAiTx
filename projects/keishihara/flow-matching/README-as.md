
<div align="right">
  <details>
    <summary >ЁЯМР ржнрж╛рж╖рж╛</summary>
    <div>
      <div align="center">
        <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=en">English</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=zh-CN">чоАф╜Уф╕нцЦЗ</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=zh-TW">ч╣БщлФф╕нцЦЗ</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=ja">цЧецЬмшкЮ</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=ko">эХЬъ╡ньЦ┤</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=hi">рд╣рд┐рдиреНрджреА</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=th">р╣Др╕Чр╕в</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=fr">Fran├зais</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=de">Deutsch</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=es">Espa├▒ol</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=it">Italiano</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=ru">╨а╤Г╤Б╤Б╨║╨╕╨╣</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=pt">Portugu├кs</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=nl">Nederlands</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=pl">Polski</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=ar">╪з┘Д╪╣╪▒╪и┘К╪й</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=fa">┘Б╪з╪▒╪│█М</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=tr">T├╝rk├зe</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=vi">Tiс║┐ng Viс╗Зt</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=id">Bahasa Indonesia</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=as">ржЕрж╕ржорзАржпрж╝рж╛</
      </div>
    </div>
  </details>
</div>

# PyTorch-ржд Flow Matching

ржПржЗ рз░рж┐ржк'ржЬрж┐ржЯ'рз░рж┐ржЯрзЛржд [Flow Matching for Generative Modeling](https://arxiv.org/abs/2210.02747) ржирж╛ржорз░ ржХрж╛ржЧржЬржЦржирз░ ржПржЯрж╛ рж╕рж╛ржзрж╛рз░ржг PyTorch ржЕржирзБржХрз░ржг ржЕржирзНрждрз░рзНржнрзБржХрзНржд ржЖржЫрзЗред

## 2D Flow Matching ржЙржжрж╛рж╣рз░ржг

рждрж▓рз░ gif ржЦржирзЗ ржПржЯрж╛ ржПржХржХ ржЧрж╛ржЙржЪрж┐ржпрж╝рж╛ржи ржмрж┐рждрз░ржгржХ ржПржЯрж╛ ржЪрзЗржХрж╛рз░ржмрзЛрж░рзНржб ржмрж┐рждрз░ржгрж▓рзИ ржорж╛ржиржЪрж┐рждрзНрз░ржг ржжрзЗржЦрзБрз▒рж╛ржЗржЫрзЗ, ржп'ржд ржнрзЗржХрзНржЯрз░ ржХрзНрж╖рзЗрждрзНрз░ржЯрзЛ ржжрзГрж╢рзНржпрж╛ржпрж╝рж┐ржд ржХрз░рж╛ рж╣рзИржЫрзЗред

<p align="center">
<img align="middle" src="https://raw.githubusercontent.com/keishihara/flow-matching/main/./outputs/cfm/checkerboard/vector_field_and_samples_checkerboard.gif" height="400" />
</p>

ржЖрз░рзБ, ржЗржпрж╝рж╛ржд moons ржбрзЗржЯрж╛ржЪрзЗржЯрз░ ржЖржи ржПржЯрж╛ ржЙржжрж╛рж╣рз░ржг ржжрж┐ржпрж╝рж╛ рж╣рзИржЫрзЗред

<p align="center">
<img align="middle" src="https://raw.githubusercontent.com/keishihara/flow-matching/main/./outputs/cfm/moons/vector_field_and_samples_moons.gif" height="400" />
</p>

## ржЖрз░ржорзНржнржгрж┐

рз░рж┐ржкржЬрж┐ржЯрз░рж┐ржЯрзЛ ржХрзНрж▓рзЛржи ржХрз░ржХ ржЖрз░рзБ ржкрж╛ржЗржержи ржкрз░рж┐рз▒рзЗрж╢ржЯрзЛ рж╕рж╛ржЬрзБ ржХрз░ржХред

```bash
git clone https://github.com/keishihara/flow-matching.git
cd flow-matching
```

ржирж┐рж╢рзНржЪрж┐ржд ржХрз░ржХ ржпрзЗ ржЖржкрзЛржирж╛рз░ Python 3.12+ рж╕ржВрж╕рзНржерж╛ржкрж┐ржд ржЖржЫрзЗред
`uv` рж╕ржВрж╕рзНржерж╛ржкржи ржХрз░ржХ:

```bash
curl -LsSf https://astral.sh/uv/install.sh | sh
```
рждрж╛рз░ ржкрж╛ржЫржд, ржкрз░рж┐рз▒рзЗрж╢ржЯрзЛ ржЫрзЗржЯ ржЖржк ржХрз░ржХ:


```bash
uv sync
```

## ржХржгрзНржбрж┐ржЪржирзЗрж▓ ржлрзНрж▓' ржорзЗржЪрж┐ржВ [Lipman+ 2023]

ржПржЗржЯрзЛ рж╣рзИржЫрзЗ ржорзВрж▓ CFM ржкрзЗржкрж╛рз░рз░ ржмрж╛рж╕рзНрждрз▒рж╛ржпрж╝ржи [1]ред ржХрзЛржбрз░ ржХрж┐ржЫрзБржорж╛ржи ржЕржВрж╢ [2] ржЖрз░рзБ [3] рз░ ржкрз░рж╛ ржЧрзНрз░рж╣ржг ржХрз░рж╛ рж╣рзИржЫрзЗред

### 2D ржЦрзЗрж▓рзБрз▒рзИ ржбрзЗржЯрж╛ ржЫрзЗржЯрж╕ржорзВрж╣

ржЖржкрзБржирж┐ `checkerboard` ржЖрз░рзБ `moons` ржпрзЗржирзЗ 2D ржЫрж┐ржирзНржерзЗржЯрж┐ржХ ржбрзЗржЯрж╛ ржЫрзЗржЯрж╕ржорзВрж╣ржд CFM ржоржбрзЗрж▓рж╕ржорзВрж╣ ржкрзНрз░рж╢рж┐ржХрзНрж╖ржг ржХрз░рж┐ржм ржкрж╛рз░рж┐ржмред `--dataset` ржмрж┐ржХрж▓рзНржк ржмрзНржпрз▒рж╣рж╛рз░ ржХрз░рж┐ ржбрзЗржЯрж╛ ржЫрзЗржЯрз░ ржирж╛ржо ржирж┐рз░рзНржжрзЗрж╢ ржХрз░ржХред ржкрзНрз░рж╢рж┐ржХрзНрж╖ржгрз░ ржкрз░рж╛ржорж┐рждрж┐рж╕ржорзВрж╣ рж╕рзНржХрзНрз░рж┐ржкрзНржЯржд ржкрзВрз░рзНржмржирж┐рз░рзНржзрж╛рз░рж┐ржд, ржЖрз░рзБ ржкрзНрз░рж╢рж┐ржХрзНрж╖ржг ржлрж▓рж╛ржлрж▓рз░ ржнрж┐ржЬрзБрз▒рж╛рж▓рж╛ржЗржЬрзЗржЪржирж╕ржорзВрж╣ `outputs/` ржбрж╛ржЗрз░рзЗржХрзНржЯрз░рж┐ржд рж╕ржВрз░ржХрзНрж╖ржг ржХрз░рж╛ рж╣ржпрж╝ред ржоржбрзЗрж▓ ржЪрзЗржХржкржЗржгрзНржЯрж╕ржорзВрж╣ рж╕ржВрж▓ржЧрзНржи ржирж╣ржпрж╝ ржХрж╛рз░ржг рж╕рж┐рж╣ржБржд ржбрж┐ржл'рж▓рзНржЯ ржЫрзЗржЯрж┐ржЩрз░ рж╕рзИрждрзЗ рж╕рж╣ржЬрзЗ ржкрзБржирз░ ржЙрзОржкрж╛ржжржи ржХрз░рж┐ржм ржкрз░рж╛ ржпрж╛ржпрж╝ред

```bash
uv run scripts/train_flow_matching_2d.py --dataset checkerboard
```
ржнрзЗржХрзНржЯрз░ ржХрзНрж╖рзЗрждрзНрз░рж╕ржорзВрж╣ ржЖрз░рзБ ржЙрзОржкржирзНржи ржиржорзБржирж╛рж╕ржорзВрж╣, ржпрж┐ржмрзЛрз░ ржПржЗ README-рз░ ржУржкрз░ржд GIF рж╣рж┐ржЪрж╛ржкрзЗ ржкрзНрз░ржжрз░рзНрж╢рж┐ржд рж╣рзИржЫрзЗ, ржПрждрж┐ржпрж╝рж╛ `outputs/cfm/` ржбрж╛ржЗрз░рзЗржХрзНржЯрз░рзАржд ржкрзЛрз▒рж╛ ржпрж╛ржмред

### ржЪрж┐рждрзНрз░ ржбрзЗржЯрж╛ ржЫрзЗржЯрж╕ржорзВрж╣

ржЖржкрзБржирж┐ ржЬржиржкрзНрз░рж┐ржпрж╝ ржЪрж┐рждрзНрз░ рж╢рзНрз░рзЗржгрзАржмрж┐ржнрж╛ржЬржи ржбрзЗржЯрж╛ ржЫрзЗржЯрж╕ржорзВрж╣ржд ржХрзНрж▓рж╛ржЫ-рж╕ржирзНржзрж╛ржирзА CFM ржоржбрзЗрж▓ржмрзЛрз░рзЛ ржкрзНрз░рж╢рж┐ржХрзНрж╖ржг ржжрж┐ржм ржкрж╛рз░рзЗред ржЙрзОржкржирзНржи ржиржорзБржирж╛ ржЖрз░рзБ ржоржбрзЗрж▓ ржЪрзЗржХржкржЗржгрзНржЯ ржжрзБржпрж╝рзЛржЯрж╛ `outputs/cfm` ржбрж╛ржЗрз░рзЗржХрзНржЯрз░рзАржд рж╕ржВрз░ржХрзНрж╖ржг ржХрз░рж╛ рж╣'ржмред ржкрзНрз░рж╢рж┐ржХрзНрж╖ржг ржкрз░рж╛ржорж┐рждрж┐рж╕ржорзВрж╣рз░ ржмрж┐рж╕рзНрждрж╛рж░рж┐ржд рждрж╛рж▓рж┐ржХрж╛рз░ ржмрж╛ржмрзЗ, `uv run scripts/train_flow_matching_on_image.py --help` ржЪрж▓рж╛ржУржХред

MNIST ржбрзЗржЯрж╛ ржЫрзЗржЯржд ржХрзНрж▓рж╛ржЫ-рж╕ржирзНржзрж╛ржирзА CFM ржкрзНрз░рж╢рж┐ржХрзНрж╖ржг ржжрж┐ржмрз░ ржмрж╛ржмрзЗ, рждрж▓рз░ржЯрзЛ ржЪрж▓рж╛ржУржХ:


```bash
uv run scripts/train_flow_matching_on_image.py --do_train --dataset mnist
```
ржкрзНрз░рж╢рж┐ржХрзНрж╖ржгрз░ ржкрж╛ржЫржд, ржЖржкрзЛржирж┐рзЯрзЗ ржПрждрж┐рзЯрж╛ ржиржорзБржирж╛ ржЙрждрзНржкржирзНржи ржХрз░рж┐ржм ржкрж╛рз░рзЗ:


```bash
uv run scripts/train_flow_matching_on_image.py --do_sample --dataset mnist
```

ржПрждрж┐ржпрж╝рж╛, ржЖржкрзБржирж┐ `outputs/cfm/mnist/` ржбрж╛ржЗрз░рзЗржХрзНржЯрз░рзАржд ржЙрзОржкржирзНржи рж╣рзЛрз▒рж╛ ржиржорзБржирж╛рж╕ржорзВрж╣ ржжрзЗржЦрж┐ржмрж▓рзИ рж╕ржХрзНрж╖ржо рж╣тАЩржмред

<p align="center">
<img align="middle" src="https://raw.githubusercontent.com/keishihara/flow-matching/main/./outputs/cfm/mnist/trajectory.gif" height="400" />
</p>

## рз░рзЗржХрзНржЯрж┐ржлрж╛ржЗржб ржлрзНрж▓тАЩ [Liu+ 2023]

ржПржЗржЯрзЛ рж╣рзИржЫрзЗ рз░рзЗржХрзНржЯрж┐ржлрж╛ржЗржб ржлрзНрж▓тАЩ ржкрзЗржкрж╛рз░рз░ ржкрз░рж╛ Reflow ржоржбрзЗрж▓рз░ (2-Rectified Flow) ржПржЦржи ржЗржоржкрзНрж▓рж┐ржорзЗржгрзНржЯрзЗрж╢рзНржмржи [2]ред

### 2D ржХрзГрждрзНрз░рж┐ржо рждржерзНржп

ржЖржорж╛рз░рзЗ 2D ржХрзГрждрзНрз░рж┐ржо ржбрзЗржЯрж╛ржЫрзЗржЯрж╕ржорзВрж╣ржд Reflow ржЗржоржкрзНрж▓рж┐ржорзЗржгрзНржЯ ржХрз░рж╛ рж╣рзИржЫрзЗ, ржпрж┐ржЯрзЛ CFM-рз░ ржжрз░рзЗред Reflow-ржЯрзНрз░рзЗржЗржи ржХрз░рж┐ржмрж▓рзИ, ржЖржкрзЛржирж┐ржпрж╝рзЗ CFM-рз░ ржкрзНрз░рж┐ржЯрзНрз░рзЗржЗржиржб ржЪрзЗржХржкржЗржгрзНржЯ ржирж┐рз░рзНржжрзЗрж╢ ржХрз░рж┐ржм рж▓рж╛ржЧрж┐ржм, ржХрж╛рз░ржг reflow рж╣рзИржЫрзЗ ржПржЦржи ржбрж┐рж╕рзНржЯрж┐рж▓рзЗрж╢рзНржмржи ржоржбрзЗрж▓ред

ржЙржжрж╛рж╣рз░ржгрж╕рзНржмрз░рзВржкрзЗ, ржпржжрж┐ ржЖржкрзБржирж┐ `checkerboard` ржбрзЗржЯрж╛ржЫрзЗржЯржд ржкрзНрз░рж┐ржЯрзНрз░рзЗржЗржиржб CFM ржЪрзЗржХржкржЗржгрзНржЯ ржмрзНржпрз▒рж╣рж╛рз░ ржХрз░рж┐ ржЯрзНрз░рзЗржЗржи ржХрз░рзЗ:

```bash
uv run scripts/train_reflow_2d.py --dataset checkerboard
```

ржкрзНрз░рж╢рж┐ржХрзНрж╖ржг ржлрж▓рж╛ржлрж▓рж╕ржорзВрж╣, ржпрж╛рз░ ржнрж┐рждрз░ржд ржнрзЗржХрзНржЯрз░ ржХрзНрж╖рзЗрждрзНрз░рз░ ржнрж┐ржЬрзБрз▒рзЗрж▓рж╛ржЗржЬрзЗржЪржи ржЖрз░рзБ рж╕рзГрж╖рзНржЯрж┐ ржХрз░рж╛ ржиржорзБржирж╛рж╕ржорзВрж╣ ржЖржЫрзЗ, рж╕рзЗржЗржмрзЛрз░ `outputs/reflow/` ржлрзЛрж▓рзНржбрж╛рз░ржд рж╕ржВрз░ржХрзНрж╖ржг ржХрз░рж╛ рж╣рзЯред

### CFM ржЖрз░рзБ Reflow-рз░ ржорж╛ржЬржд ржиржорзБржирж╛ ржкрзНрз░ржХрзНрз░рж┐ржпрж╝рж╛рз░ рждрзБрж▓ржирж╛

2d ржбрзЗржЯрж╛рж╕рзЗржЯрж╕ржорзВрж╣ржд CFM ржЖрз░рзБ Reflow-рз░ рждрзБрж▓ржирж╛ ржХрз░рж┐ржмрж▓рзИ, ржПржЗржЯрзЛ ржЪрж▓рж╛ржУ:

```bash
uv run scripts/plot_comparison_2d.py --dataset checkerboard
```
ржЙрзОржкржирзНржи рж╣рзЛрз▒рж╛ GIF рж╕ржорзВрж╣ `outputs/comparisons/` ржлрзЛрж▓рзНржбрж╛рз░ржд ржкрзЛрз▒рж╛ ржпрж╛ржмред рждрж▓ржд `checkerboard` ржбрзЗржЯрж╛рж╕рзЗржЯржд ржжрзБржЗржЯрж╛ ржкржжрзНржзрждрж┐рз░ рждрзБрж▓ржирж╛рз░ ржПржЯрж╛ ржЙржжрж╛рж╣рз░ржг ржжрж┐ржпрж╝рж╛ рж╣рзИржЫрзЗ:

<p align="center">
<img align="middle" src="https://raw.githubusercontent.com/keishihara/flow-matching/main/./outputs/comparisons/cfm_reflow_checkerboard.gif" height="400" />
</p>

## ржЙрзОрж╕рж╕ржорзВрж╣

- [1] рж▓рж┐ржкржорж╛ржи, ржЗржпрж╝рж╛рз░ржи, ржЖржжрж┐ред "Generative Modeling рз░ ржмрж╛ржмрзЗ Flow Matching." [arXiv:2210.02747](https://arxiv.org/abs/2210.02747)
- [2] рж▓рж┐ржЙ, рж╢рж┐ржВржЪрж╛ржУ, ржЖржжрж┐ред "Flow Straight and Fast: Learning to Generate and Transfer Data with Rectified Flow." [arXiv:2209.03003](https://arxiv.org/abs/2209.03003)
- [3] [facebookresearch/flow_matching](https://github.com/facebookresearch/flow_matching)
- [4] [atong01/conditional-flow-matching](https://github.com/atong01/conditional-flow-matching)



---

Tranlated By [Open Ai Tx](https://github.com/OpenAiTx/OpenAiTx) | Last indexed: 2026-01-19

---