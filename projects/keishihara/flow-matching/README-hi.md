
<div align="right">
  <details>
    <summary >ЁЯМР рднрд╛рд╖рд╛</summary>
    <div>
      <div align="center">
        <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=en">English</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=zh-CN">чоАф╜Уф╕нцЦЗ</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=zh-TW">ч╣БщлФф╕нцЦЗ</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=ja">цЧецЬмшкЮ</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=ko">эХЬъ╡ньЦ┤</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=hi">рд╣рд┐рдиреНрджреА</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=th">р╣Др╕Чр╕в</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=fr">Fran├зais</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=de">Deutsch</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=es">Espa├▒ol</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=it">Italiano</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=ru">╨а╤Г╤Б╤Б╨║╨╕╨╣</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=pt">Portugu├кs</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=nl">Nederlands</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=pl">Polski</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=ar">╪з┘Д╪╣╪▒╪и┘К╪й</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=fa">┘Б╪з╪▒╪│█М</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=tr">T├╝rk├зe</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=vi">Tiс║┐ng Viс╗Зt</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=id">Bahasa Indonesia</a>
        | <a href="https://openaitx.github.io/view.html?user=keishihara&project=flow-matching&lang=as">ржЕрж╕ржорзАржпрж╝рж╛</
      </div>
    </div>
  </details>
</div>

# рдкрд╛рдпрдЯреЙрд░реНрдЪ рдореЗрдВ рдлреНрд▓реЛ рдореИрдЪрд┐рдВрдЧ

рдпрд╣ рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдкреЗрдкрд░ [Flow Matching for Generative Modeling](https://arxiv.org/abs/2210.02747) рдХрд╛ рдПрдХ рд╕рд░рд▓ рдкрд╛рдпрдЯреЙрд░реНрдЪ рдЗрдореНрдкреНрд▓реАрдореЗрдВрдЯреЗрд╢рди рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИред

## 2D рдлреНрд▓реЛ рдореИрдЪрд┐рдВрдЧ рдЙрджрд╛рд╣рд░рдг

рдиреАрдЪреЗ рджрд┐рдпрд╛ рдЧрдпрд╛ gif рдПрдХ рдПрдХрд▓ рдЧреЙрд╕рд┐рдпрди рд╡рд┐рддрд░рдг рдХреЛ рдПрдХ рдЪреЗрдХрд░рдмреЛрд░реНрдб рд╡рд┐рддрд░рдг рдореЗрдВ рдореИрдк рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рджрд░реНрд╢рди рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рд╡реЗрдХреНрдЯрд░ рдлреАрд▓реНрдб рдХреЛ рд╡рд┐рдЬрд╝реБрдЕрд▓рд╛рдЗрдЬрд╝ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред

<p align="center">
<img align="middle" src="https://raw.githubusercontent.com/keishihara/flow-matching/main/./outputs/cfm/checkerboard/vector_field_and_samples_checkerboard.gif" height="400" />
</p>

рдФрд░, рдпрд╣рд╛рдБ moons рдбреЗрдЯрд╛рд╕реЗрдЯ рдХрд╛ рдПрдХ рдФрд░ рдЙрджрд╛рд╣рд░рдг рд╣реИред

<p align="center">
<img align="middle" src="https://raw.githubusercontent.com/keishihara/flow-matching/main/./outputs/cfm/moons/vector_field_and_samples_moons.gif" height="400" />
</p>

## рд╢реБрд░реБрдЖрдд рдХреИрд╕реЗ рдХрд░реЗрдВ

рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдХреЛ рдХреНрд▓реЛрди рдХрд░реЗрдВ рдФрд░ python рд╡рд╛рддрд╛рд╡рд░рдг рд╕реЗрдЯрдЕрдк рдХрд░реЗрдВред

```bash
git clone https://github.com/keishihara/flow-matching.git
cd flow-matching
```

рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ Python 3.12+ рд╕реНрдерд╛рдкрд┐рдд рд╣реИред
`uv` рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░реЗрдВ:

```bash
curl -LsSf https://astral.sh/uv/install.sh | sh
```
рдлрд┐рд░, рдкрд░рд┐рд╡реЗрд╢ рд╕реЗрдЯ рдХрд░реЗрдВ:


```bash
uv sync
```

## рдХрдВрдбреАрд╢рдирд▓ рдлреНрд▓реЛ рдореИрдЪрд┐рдВрдЧ [рд▓рд┐рдкрдореИрди+ 2023]

рдпрд╣ рдореВрд▓ CFM рдкреЗрдкрд░ рдЗрдореНрдкреНрд▓реАрдореЗрдВрдЯреЗрд╢рди рд╣реИ [1]ред рдХреЛрдб рдХреЗ рдХреБрдЫ рдШрдЯрдХ [2] рдФрд░ [3] рд╕реЗ рдЕрдиреБрдХреВрд▓рд┐рдд рдХрд┐рдП рдЧрдП рд╣реИрдВред

### 2рдбреА рдЯреЙрдп рдбреЗрдЯрд╛рд╕реЗрдЯреНрд╕

рдЖрдк 2рдбреА рд╕рд┐рдВрдереЗрдЯрд┐рдХ рдбреЗрдЯрд╛рд╕реЗрдЯреНрд╕ рдЬреИрд╕реЗ `рдЪреЗрдХрд░рдмреЛрд░реНрдб` рдФрд░ `рдореВрдиреНрд╕` рдкрд░ CFM рдореЙрдбрд▓реНрд╕ рдХреЛ рдЯреНрд░реЗрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдбреЗрдЯрд╛рд╕реЗрдЯ рдХрд╛ рдирд╛рдо `--dataset` рд╡рд┐рдХрд▓реНрдк рдХреЗ рджреНрд╡рд╛рд░рд╛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░реЗрдВред рдЯреНрд░реЗрдирд┐рдВрдЧ рдкреИрд░рд╛рдореАрдЯрд░реНрд╕ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдореЗрдВ рдкреВрд░реНрд╡рдирд┐рд░реНрдзрд╛рд░рд┐рдд рд╣реИрдВ, рдФрд░ рдЯреНрд░реЗрдирд┐рдВрдЧ рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреЗ рд╡рд┐рдЬрд╝реБрдЕрд▓рд╛рдЗрдЬрд╝реЗрд╢рди `outputs/` рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рдореЗрдВ рд╕реНрдЯреЛрд░ рд╣реЛрддреЗ рд╣реИрдВред рдореЙрдбрд▓ рдЪреЗрдХрдкреЙрдЗрдВрдЯреНрд╕ рд╢рд╛рдорд┐рд▓ рдирд╣реАрдВ рд╣реИрдВ рдХреНрдпреЛрдВрдХрд┐ рд╡реЗ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХреЗ рд╕рд╛рде рдЖрд╕рд╛рдиреА рд╕реЗ рджреЛрдмрд╛рд░рд╛ рдмрдирд╛рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред

```bash
uv run scripts/train_flow_matching_2d.py --dataset checkerboard
```

рд╡реЗрдХреНрдЯрд░ рдлреАрд▓реНрдбреНрд╕ рдФрд░ рдЬреЗрдирд░реЗрдЯреЗрдб рд╕реИрдореНрдкрд▓реНрд╕, рдЬреИрд╕реЗ рдХрд┐ рдЗрд╕ README рдХреЗ рдКрдкрд░ GIFs рдХреЗ рд░реВрдк рдореЗрдВ рджрд┐рдЦрд╛рдП рдЧрдП рд╣реИрдВ, рдЕрдм `outputs/cfm/` рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рдореЗрдВ рдкрд╛рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред

### рдЗрдореЗрдЬ рдбреЗрдЯрд╛рд╕реЗрдЯреНрд╕

рдЖрдк рд▓реЛрдХрдкреНрд░рд┐рдп рдЗрдореЗрдЬ рдХреНрд▓рд╛рд╕рд┐рдлрд┐рдХреЗрд╢рди рдбреЗрдЯрд╛рд╕реЗрдЯреНрд╕ рдкрд░ рдХреНрд▓рд╛рд╕-рдХрдВрдбреАрд╢рдирд▓ CFM рдореЙрдбрд▓реНрд╕ рднреА рдЯреНрд░реЗрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рджреЛрдиреЛрдВ, рдЬреЗрдирд░реЗрдЯреЗрдб рд╕реИрдореНрдкрд▓реНрд╕ рдФрд░ рдореЙрдбрд▓ рдЪреЗрдХрдкреЙрдЗрдВрдЯреНрд╕, `outputs/cfm` рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рдореЗрдВ рд╕реНрдЯреЛрд░ рдХрд┐рдП рдЬрд╛рдПрдВрдЧреЗред рдЯреНрд░реЗрдирд┐рдВрдЧ рдкреИрд░рд╛рдореАрдЯрд░реНрд╕ рдХреА рд╡рд┐рд╕реНрддреГрдд рд╕реВрдЪреА рдХреЗ рд▓рд┐рдП, `uv run scripts/train_flow_matching_on_image.py --help` рдЪрд▓рд╛рдПрдВред

MNIST рдбреЗрдЯрд╛рд╕реЗрдЯ рдкрд░ рдХреНрд▓рд╛рд╕-рдХрдВрдбреАрд╢рдирд▓ CFM рдЯреНрд░реЗрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдЪрд▓рд╛рдПрдВ:

```bash
uv run scripts/train_flow_matching_on_image.py --do_train --dataset mnist
```
рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рдмрд╛рдж, рдЕрдм рдЖрдк рдирдореВрдиреЗ рдЙрддреНрдкрдиреНрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:


```bash
uv run scripts/train_flow_matching_on_image.py --do_sample --dataset mnist
```
рдЕрдм, рдЖрдк `outputs/cfm/mnist/` рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рдореЗрдВ рдЬреЗрдирд░реЗрдЯ рдХрд┐рдП рдЧрдП рдирдореВрдиреЛрдВ рдХреЛ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред

<p align="center">
<img align="middle" src="https://raw.githubusercontent.com/keishihara/flow-matching/main/./outputs/cfm/mnist/trajectory.gif" height="400" />
</p>

## рд░реЗрдХреНрдЯрд┐рдлрд╛рдЗрдб рдлреНрд▓реЛ [Liu+ 2023]

рдпрд╣ рд░реЗрдХреНрдЯрд┐рдлрд╛рдЗрдб рдлреНрд▓реЛ рдкреЗрдкрд░ [2] рд╕реЗ Reflow рдореЙрдбрд▓ (рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ 2-Rectified Flow) рдХрд╛ рдПрдХ рдЗрдореНрдкреНрд▓реАрдореЗрдВрдЯреЗрд╢рди рд╣реИред

### 2D рд╕рд┐рдВрдереЗрдЯрд┐рдХ рдбреЗрдЯрд╛

рд╣рдордиреЗ Reflow рдХреЛ 2D рд╕рд┐рдВрдереЗрдЯрд┐рдХ рдбреЗрдЯрд╛рд╕реЗрдЯреНрд╕ рдкрд░ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рд╣реИ, рдареАрдХ рдЙрд╕реА рддрд░рд╣ рдЬреИрд╕реЗ CFM рдкрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред Reflow рдХреЛ рдЯреНрд░реЗрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рдкреНрд░реА-рдЯреНрд░реЗрдВрдб CFM рдЪреЗрдХрдкреЙрдЗрдВрдЯреНрд╕ рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдХреНрдпреЛрдВрдХрд┐ Reflow рдПрдХ рдбрд┐рд╕реНрдЯрд┐рд▓реЗрд╢рди рдореЙрдбрд▓ рд╣реИред

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, `checkerboard` рдбреЗрдЯрд╛рд╕реЗрдЯ рдкрд░ рдкреНрд░реА-рдЯреНрд░реЗрдВрдб CFM рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдХреЗ рд╕рд╛рде рдЯреНрд░реЗрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП:


```bash
uv run scripts/train_reflow_2d.py --dataset checkerboard
```

рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдкрд░рд┐рдгрд╛рдо, рдЬрд┐рд╕рдореЗрдВ рд╡реЗрдХреНрдЯрд░ рдХреНрд╖реЗрддреНрд░ рджреГрд╢реНрдпрд╛рд╡рд▓реЛрдХрди рдФрд░ рдЙрддреНрдкрдиреНрди рдирдореВрдиреЗ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ, `outputs/reflow/` рдлрд╝реЛрд▓реНрдбрд░ рдХреЗ рдЕрдВрддрд░реНрдЧрдд рд╕рд╣реЗрдЬреЗ рдЬрд╛рддреЗ рд╣реИрдВред

### CFM рдФрд░ Reflow рдХреЗ рдмреАрдЪ рд╕реИрдВрдкрд▓рд┐рдВрдЧ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреА рддреБрд▓рдирд╛

CFM рдФрд░ Reflow рдХреА рддреБрд▓рдирд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП 2d рдбреЗрдЯрд╛рд╕реЗрдЯреНрд╕ рдкрд░, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЪрд▓рд╛рдПрдБ:

```bash
uv run scripts/plot_comparison_2d.py --dataset checkerboard
```
рдЙрддреНрдкрдиреНрди GIFs рдХреЛ `outputs/comparisons/` рдлреЛрд▓реНрдбрд░ рдореЗрдВ рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдиреАрдЪреЗ `checkerboard` рдбреЗрдЯрд╛рд╕реЗрдЯ рдореЗрдВ рджреЛ рд╡рд┐рдзрд┐рдпреЛрдВ рдХреА рддреБрд▓рдирд╛ рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ:

<p align="center">
<img align="middle" src="https://raw.githubusercontent.com/keishihara/flow-matching/main/./outputs/comparisons/cfm_reflow_checkerboard.gif" height="400" />
</p>

## рд╕рдВрджрд░реНрдн

- [1] рд▓рд┐рдкрдореИрди, рдпрд╛рд░реЛрди, рдЖрджрд┐ред "Flow Matching for Generative Modeling." [arXiv:2210.02747](https://arxiv.org/abs/2210.02747)
- [2] рд▓рд┐рдпреВ, рд╢рд┐рдВрдЧрдЪрд╛рдУ, рдЖрджрд┐ред "Flow Straight and Fast: Learning to Generate and Transfer Data with Rectified Flow." [arXiv:2209.03003](https://arxiv.org/abs/2209.03003)
- [3] [facebookresearch/flow_matching](https://github.com/facebookresearch/flow_matching)
- [4] [atong01/conditional-flow-matching](https://github.com/atong01/conditional-flow-matching)



---

Tranlated By [Open Ai Tx](https://github.com/OpenAiTx/OpenAiTx) | Last indexed: 2026-01-19

---