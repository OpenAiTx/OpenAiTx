# ì—”í„°í”„ë¼ì´ì¦ˆ ìŠ¹ì¸ ì—”ì§„

[![en](https://img.shields.io/badge/lang-en-blue.svg)](README.md)
[![es](https://img.shields.io/badge/lang-es-yellow.svg)](ES/README.md)

ì—”í„°í”„ë¼ì´ì¦ˆê¸‰ GitHub ì•¡ì…˜ìœ¼ë¡œ, ê·¸ë£¹ë³„ ì„ê³„ê°’(X of N), ê·¸ë£¹ ê°„ OR ë…¼ë¦¬, ìë™ semver íƒœê·¸ ìƒì„±ì´ ê°€ëŠ¥í•œ ì •ì±… ê¸°ë°˜ ìŠ¹ì¸ ì›Œí¬í”Œë¡œìš°ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

## íŠ¹ì§•

- **ìœ ì—°í•œ ìŠ¹ì¸ ë…¼ë¦¬**: ê·¸ë£¹ ë‚´ì—ì„œ AND(ëª¨ë‘ ìŠ¹ì¸í•´ì•¼ í•¨) ë° ì„ê³„ê°’(X of N) ë…¼ë¦¬ë¥¼ ì§€ì›
- **ê·¸ë£¹ ê°„ OR ë…¼ë¦¬**: ë‹¤ì¤‘ ìŠ¹ì¸ ê²½ë¡œ - í•˜ë‚˜ì˜ ê·¸ë£¹ì´ ìš”êµ¬ì‚¬í•­ì„ ì¶©ì¡±í•˜ë©´ ìš”ì²­ ìŠ¹ì¸
- **í˜¼í•© ìŠ¹ì¸ì**: ë™ì¼ ê·¸ë£¹ ë‚´ ê°œì¸ ì‚¬ìš©ìì™€ GitHub íŒ€ì„ ê²°í•© ê°€ëŠ¥
- **ì ì§„ì  ë°°í¬ íŒŒì´í”„ë¼ì¸**: ë‹¨ì¼ ì´ìŠˆë¡œ ì—¬ëŸ¬ í™˜ê²½(dev â†’ qa â†’ stage â†’ prod) ì¶”ì 
- **íŒŒì´í”„ë¼ì¸ ì‹œê°í™”**: ë°°í¬ ì§„í–‰ ìƒí™©ì„ ë³´ì—¬ì£¼ëŠ” ìƒ‰ìƒ ì½”ë“œ ë¨¸ë©”ì´ë“œ í”Œë¡œìš°ì°¨íŠ¸ ë‹¤ì´ì–´ê·¸ë¨
- **í•˜ìœ„ ì´ìŠˆ ìŠ¹ì¸**: ê° ë‹¨ê³„ë³„ ì „ìš© ìŠ¹ì¸ í•˜ìœ„ ì´ìŠˆ ìƒì„± - ë‹«ìœ¼ë©´ ìŠ¹ì¸
- **í–¥ìƒëœ ëŒ“ê¸€ UX**: ìŠ¹ì¸ ëŒ“ê¸€ì— ì´ëª¨ì§€ ë°˜ì‘, ëª…ë ¹ì–´ ì°¸ì¡°ê°€ í¬í•¨ëœ ë¹ ë¥¸ ì‘ì—… ì„¹ì…˜
- **ì´ìŠˆ ë‹«ê¸° ë³´í˜¸**: ìŠ¹ì¸ ì´ìŠˆë¥¼ ë¹„ì¸ê°€ ì‚¬ìš©ìê°€ ë‹«ëŠ” ê²ƒì„ ë°©ì§€(ìë™ ì¬ì˜¤í”ˆ)
- **í•˜ì´ë¸Œë¦¬ë“œ ìŠ¹ì¸ ëª¨ë“œ**: ì›Œí¬í”Œë¡œìš°ë‚˜ ë‹¨ê³„ë³„ë¡œ ëŒ“ê¸€ ê¸°ë°˜ê³¼ í•˜ìœ„ ì´ìŠˆ ìŠ¹ì¸ì„ í˜¼í•©
- **PR ë° ì»¤ë°‹ ì¶”ì **: ë°°í¬ ì´ìŠˆì— PR ë° ì»¤ë°‹ ìë™ ëª©ë¡í™”ë¡œ ë¦´ë¦¬ìŠ¤ ê´€ë¦¬ ì§€ì›
- **Semver íƒœê·¸ ìƒì„±**: ìŠ¹ì¸ ì‹œ git íƒœê·¸ ìë™ ìƒì„±
- **ì •ì±… ê¸°ë°˜ êµ¬ì„±**: YAMLë¡œ ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ìŠ¹ì¸ ì •ì±… ì •ì˜
- **ì´ìŠˆ ê¸°ë°˜ ì›Œí¬í”Œë¡œìš°**: GitHub ì´ìŠˆë¥¼ í†µí•œ íˆ¬ëª…í•œ ê°ì‚¬ ì¶”ì 
- **Jira í†µí•©**: ì»¤ë°‹ì—ì„œ ì´ìŠˆ í‚¤ ì¶”ì¶œ, ìŠ¹ì¸ ì´ìŠˆì— í‘œì‹œ, Fix Versions ì—…ë°ì´íŠ¸
- **ë°°í¬ ì¶”ì **: ë°°í¬ ëŒ€ì‹œë³´ë“œì— ê°€ì‹œì„±ì„ ìœ„í•œ GitHub ë°°í¬ ìƒì„±
- **ì™¸ë¶€ êµ¬ì„±**: ê³µìœ  ì €ì¥ì†Œì— ìŠ¹ì¸ ì •ì±… ì¤‘ì•™ ì§‘ì¤‘í™”
- **ì†ë„ ì œí•œ ì²˜ë¦¬**: GitHub API ì†ë„ ì œí•œì— ëŒ€í•œ ì§€ìˆ˜ ë°±ì˜¤í”„ ìë™ ì¬ì‹œë„
- **GitHub ì—”í„°í”„ë¼ì´ì¦ˆ ì„œë²„**: GHES í™˜ê²½ ì™„ì „ ì§€ì›
- **ì™¸ë¶€ ì¢…ì†ì„± ì—†ìŒ**: ìˆœìˆ˜ GitHub Actions, ì™¸ë¶€ ì„œë¹„ìŠ¤ ë¶ˆí•„ìš”

ğŸ“‹ **ì‹¤ì œ ì‚¬ìš© ì˜ˆ:** [ìŠ¹ì¸ ì´ìŠˆ ì˜ˆì œ](https://github.com/jamengual/enterprise-approval-engine/issues/7)

## ëª©ì°¨

- [ë¹ ë¥¸ ì‹œì‘](#quick-start)
- [ì•¡ì…˜ ì°¸ì¡°](#action-reference)
  - [ì•¡ì…˜](#actions)
  - [ì…ë ¥ê°’](#inputs)
  - [ì¶œë ¥ê°’](#outputs)
- [êµ¬ì„± ì°¸ì¡°](#configuration-reference)
  - [ì •ì±…](#policies)
  - [ì›Œí¬í”Œë¡œìš°](#workflows)
  - [íƒœê¹…](#tagging-configuration)
  - [ì»¤ìŠ¤í…€ í…œí”Œë¦¿](#custom-issue-templates)
  - [ê¸°ë³¸ê°’](#defaults)
  - [Semver](#semver)
- [ì™„ì „í•œ êµ¬ì„± ì°¸ì¡°](#complete-configuration-reference)
- [ê¸°ëŠ¥ ì„¸ë¶€ì‚¬í•­](#feature-details)
  - [ìŠ¹ì¸ í‚¤ì›Œë“œ](#approval-keywords)
  - [íŒ€ ì§€ì›](#team-support)
  - [ì ì§„ì  ë°°í¬ íŒŒì´í”„ë¼ì¸](#progressive-deployment-pipelines)
  - [ë¦´ë¦¬ìŠ¤ í›„ë³´ ì „ëµ](#release-candidate-strategies)
  - [ì§€ë¼ í†µí•©](#jira-integration)
  - [ë°°í¬ ì¶”ì ](#deployment-tracking)
  - [ì™¸ë¶€ êµ¬ì„± ì €ì¥ì†Œ](#external-config-repository)
  - [ì°¨ë‹¨ ìŠ¹ì¸](#blocking-approvals)
  - [ì´ìŠˆ ì¢…ë£Œ ì‹œ íƒœê·¸ ì‚­ì œ](#tag-deletion-on-issue-close)
- [ì™„ì „í•œ ì˜ˆì œ](#complete-examples)
- [ìŠ¤í‚¤ë§ˆ ê²€ì¦](#schema-validation)
- [GitHub ì—”í„°í”„ë¼ì´ì¦ˆ ì„œë²„](#github-enterprise-server)

## ë¹ ë¥¸ ì‹œì‘

### 1. êµ¬ì„± ìƒì„±

ë ˆí¬ì§€í† ë¦¬ì— `.github/approvals.yml` íŒŒì¼ì„ ìƒì„±í•˜ì„¸ìš”:

```yaml
version: 1

policies:
  dev-team:
    approvers: [alice, bob, charlie]
    min_approvals: 2

  platform-team:
    approvers: [team:platform-engineers]
    require_all: true

workflows:
  production-deploy:
    require:
      # OR logic: either path satisfies approval
      - policy: dev-team        # 2 of 3 developers
      - policy: platform-team   # ALL platform engineers
    on_approved:
      create_tag: true
      close_issue: true
```

### 2. ìš”ì²­ ìŠ¹ì¸ ì›Œí¬í”Œë¡œìš°

`.github/workflows/request-approval.yml` íŒŒì¼ì„ ìƒì„±í•˜ì„¸ìš”:

```yaml
name: Request Deployment Approval

on:
  workflow_dispatch:
    inputs:
      version:
        description: 'Version to deploy (e.g., v1.2.3)'
        required: true
        type: string

jobs:
  request:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: jamengual/enterprise-approval-engine@v1
        id: approval
        with:
          action: request
          workflow: production-deploy
          version: ${{ inputs.version }}
          token: ${{ secrets.GITHUB_TOKEN }}

      - name: Output Results
        run: |
          echo "Issue: ${{ steps.approval.outputs.issue_url }}"
          echo "Status: ${{ steps.approval.outputs.status }}"
```

### 3. ìŠ¹ì¸ ì½”ë©˜íŠ¸ ì²˜ë¦¬

`.github/workflows/handle-approval.yml` ìƒì„±:

```yaml
name: Handle Approval Comments

on:
  issue_comment:
    types: [created]

jobs:
  process:
    if: contains(github.event.issue.labels.*.name, 'approval-required')
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: jamengual/enterprise-approval-engine@v1
        id: process
        with:
          action: process-comment
          issue_number: ${{ github.event.issue.number }}
          token: ${{ secrets.GITHUB_TOKEN }}

      - name: Trigger Deployment
        if: steps.process.outputs.status == 'approved'
        run: |
          echo "Approved by: ${{ steps.process.outputs.approvers }}"
          echo "Tag created: ${{ steps.process.outputs.tag }}"
```

---

## ì‘ì—… ì°¸ì¡°

### ì‘ì—…ë“¤

ì‘ì—…ì€ `action` ì…ë ¥ì„ í†µí•´ ë„¤ ê°€ì§€ ë™ì‘ ëª¨ë“œë¥¼ ì§€ì›í•©ë‹ˆë‹¤:

| ì‘ì—… | ì„¤ëª… | ì‚¬ìš© ì‹œì  |
|--------|-------------|-------------|
| `request` | ìƒˆë¡œìš´ ìŠ¹ì¸ ìš”ì²­ ì´ìŠˆ ìƒì„± | ë°°í¬/ë¦´ë¦¬ìŠ¤ ì›Œí¬í”Œë¡œ ì‹œì‘ ì‹œ |
| `process-comment` | ìŠ¹ì¸/ê±°ë¶€ ëŒ“ê¸€ ì²˜ë¦¬ | `issue_comment` ì´ë²¤íŠ¸ ë°œìƒ ì‹œ |
| `check` | í˜„ì¬ ìŠ¹ì¸ ìƒíƒœ í™•ì¸ | ìŠ¹ì¸ ì™„ë£Œë¥¼ í´ë§í•  ë•Œ |
| `close-issue` | ì´ìŠˆ ì¢…ë£Œ ì´ë²¤íŠ¸ ì²˜ë¦¬ | `issues: [closed]` ì´ë²¤íŠ¸ ì‹œ |

### ì…ë ¥ ê°’

#### í•µì‹¬ ì…ë ¥ ê°’

| ì…ë ¥ | ì„¤ëª… | í•„ìˆ˜ | ê¸°ë³¸ê°’ |
|-------|-------------|----------|---------|
| `action` | ìˆ˜í–‰í•  ì‘ì—…: `request`, `check`, `process-comment`, `close-issue` | ì˜ˆ | - |
| `workflow` | ì„¤ì •ì—ì„œ ì›Œí¬í”Œë¡œ ì´ë¦„ (`request` ì‘ì—…ìš©) | `request` ì‘ì—… ì‹œ | - |
| `version` | íƒœê·¸ ìƒì„±ìš© ì„¸ë©˜í‹± ë²„ì „ (ì˜ˆ: `1.2.3` ë˜ëŠ” `v1.2.3`) | ì•„ë‹ˆìš” | - |
| `issue_number` | ì´ìŠˆ ë²ˆí˜¸ (`check`, `process-comment`, `close-issue` ì‘ì—…ìš©) | `check`/`process`/`close` ì‘ì—… ì‹œ | - |
| `token` | API ì‘ì—…ìš© GitHub í† í° | ì˜ˆ | - |

#### êµ¬ì„± ì…ë ¥ ê°’

| ì…ë ¥ | ì„¤ëª… | í•„ìˆ˜ | ê¸°ë³¸ê°’ |
|-------|-------------|----------|---------|
| `config_path` | approvals.yml êµ¬ì„± íŒŒì¼ ê²½ë¡œ | ì•„ë‹ˆìš” | `.github/approvals.yml` |
| `config_repo` | ê³µìœ  êµ¬ì„±ì„ ìœ„í•œ ì™¸ë¶€ ë¦¬í¬ì§€í† ë¦¬ (ì˜ˆ: `org/.github`) | ì•„ë‹ˆìš” | - |

#### í´ë§ ì…ë ¥ ê°’ (`check` ì‘ì—…ìš©)

| ì…ë ¥ | ì„¤ëª… | í•„ìˆ˜ | ê¸°ë³¸ê°’ |
|-------|-------------|----------|---------|
| `wait` | ì¦‰ì‹œ ë°˜í™˜í•˜ì§€ ì•Šê³  ìŠ¹ì¸ ëŒ€ê¸°(í´ë§) ì—¬ë¶€ | ì•„ë‹ˆìš” | `false` |
| `timeout` | ëŒ€ê¸° ì‹œê°„ ì œí•œ (ì˜ˆ: `24h`, `1h30m`, `30m`) | ì•„ë‹ˆìš” | `72h` |

#### íŒ€ ì§€ì› ì…ë ¥ê°’

| ì…ë ¥ | ì„¤ëª… | í•„ìˆ˜ | ê¸°ë³¸ê°’ |
|-------|-------------|----------|---------|
| `app_id` | íŒ€ ë©¤ë²„ì‹­ í™•ì¸ìš© GitHub ì•± ID | ì•„ë‹ˆìš” | - |
| `app_private_key` | íŒ€ ë©¤ë²„ì‹­ í™•ì¸ìš© GitHub ì•± ê°œì¸ í‚¤ | ì•„ë‹ˆìš” | - |

#### Jira í†µí•© ì…ë ¥ê°’

| ì…ë ¥ | ì„¤ëª… | í•„ìˆ˜ | ê¸°ë³¸ê°’ |
|-------|-------------|----------|---------|
| `jira_base_url` | Jira í´ë¼ìš°ë“œ ê¸°ë³¸ URL (ì˜ˆ: `https://yourcompany.atlassian.net`) | ì•„ë‹ˆìš” | - |
| `jira_user_email` | API ì¸ì¦ìš© Jira ì‚¬ìš©ì ì´ë©”ì¼ | ì•„ë‹ˆìš” | - |
| `jira_api_token` | ì¸ì¦ìš© Jira API í† í° | ì•„ë‹ˆìš” | - |
| `jira_update_fix_version` | ìŠ¹ì¸ ì‹œ Jira ì´ìŠˆì— Fix Version ì—…ë°ì´íŠ¸ | ì•„ë‹ˆìš” | `true` |
| `include_jira_issues` | ìŠ¹ì¸ ìš”ì²­ ë³¸ë¬¸ì— Jira ì´ìŠˆ í¬í•¨ | ì•„ë‹ˆìš” | `true` |

#### ë°°í¬ ì¶”ì  ì…ë ¥ê°’

| ì…ë ¥ | ì„¤ëª… | í•„ìˆ˜ | ê¸°ë³¸ê°’ |
|-------|-------------|----------|---------|
| `create_deployment` | ì¶”ì ì„ ìœ„í•œ GitHub ë°°í¬ ìƒì„± | ì•„ë‹ˆìš” | `true` |
| `deployment_environment` | ëŒ€ìƒ í™˜ê²½ (ì˜ˆ: `production`, `staging`) | ì•„ë‹ˆìš” | `production` |
| `deployment_environment_url` | ë°°í¬ëœ í™˜ê²½ì˜ URL | ì•„ë‹ˆìš” | - |

#### ê¸°íƒ€ ì…ë ¥ê°’

| ì…ë ¥ | ì„¤ëª… | í•„ìˆ˜ | ê¸°ë³¸ê°’ |
|-------|-------------|----------|---------|
| `issue_action` | `close-issue`ìš© ì´ìŠˆ ì´ë²¤íŠ¸ ì•¡ì…˜ (`closed`, `reopened`) | ì•„ë‹ˆìš” | - |
| `previous_tag` | ì»¤ë°‹ ë¹„êµìš© ì´ì „ íƒœê·¸ (ì§€ì •í•˜ì§€ ì•Šìœ¼ë©´ ìë™ ê°ì§€) | ì•„ë‹ˆìš” | - |

### ì¶œë ¥ê°’

#### í•µì‹¬ ì¶œë ¥ê°’

| ì¶œë ¥ | ì„¤ëª… | ì‚¬ìš© ê°€ëŠ¥ ëŒ€ìƒ |
|--------|-------------|---------------|
| `status` | ìŠ¹ì¸ ìƒíƒœ: `pending`, `approved`, `denied`, `timeout`, `tag_deleted`, `skipped` | ëª¨ë“  ì‘ì—… |
| `issue_number` | ìƒì„±ë˜ê±°ë‚˜ í™•ì¸ëœ ì´ìŠˆ ë²ˆí˜¸ | ëª¨ë“  ì‘ì—… |
| `issue_url` | ìŠ¹ì¸ ì´ìŠˆì˜ URL | ëª¨ë“  ì‘ì—… |

#### ìŠ¹ì¸ ì¶œë ¥ê°’

| ì¶œë ¥ê°’ | ì„¤ëª… | ì‚¬ìš© ê°€ëŠ¥ ì‘ì—… |
|--------|-------------|---------------|
| `approvers` | ìŠ¹ì¸í•œ ì‚¬ìš©ìë“¤ì˜ ì‰¼í‘œë¡œ êµ¬ë¶„ëœ ëª©ë¡ | `process-comment`, `check` |
| `denier` | ìš”ì²­ì„ ê±°ë¶€í•œ ì‚¬ìš©ì | `process-comment`, `check` |
| `satisfied_group` | ìŠ¹ì¸ì„ ë§Œì¡±ì‹œí‚¨ ê·¸ë£¹ ì´ë¦„ | `process-comment`, `check` |
| `tag` | ìƒì„±ëœ íƒœê·¸ ì´ë¦„ | `process-comment` (ìŠ¹ì¸ ì‹œ) |
| `tag_deleted` | ì‚­ì œëœ íƒœê·¸ | `close-issue` |

#### Jira ì¶œë ¥ê°’

| ì¶œë ¥ê°’ | ì„¤ëª… | ì‚¬ìš© ê°€ëŠ¥ ì‘ì—… |
|--------|-------------|---------------|
| `jira_issues` | ì´ë²ˆ ë¦´ë¦¬ìŠ¤ì˜ Jira ì´ìŠˆ í‚¤ ì‰¼í‘œë¡œ êµ¬ë¶„ëœ ëª©ë¡ | `request` |
| `jira_issues_json` | Jira ì´ìŠˆ ì„¸ë¶€ì •ë³´(JSON ë°°ì—´, í‚¤, ìš”ì•½, ìœ í˜•, ìƒíƒœ) | `request` |

#### ë°°í¬ ì¶œë ¥ê°’

| ì¶œë ¥ê°’ | ì„¤ëª… | ì‚¬ìš© ê°€ëŠ¥ ì‘ì—… |
|--------|-------------|---------------|
| `deployment_id` | ìƒíƒœ ì—…ë°ì´íŠ¸ìš© GitHub ë°°í¬ ID | `request` |
| `deployment_url` | GitHub ë‚´ ë°°í¬ URL | `request` |

#### ë¦´ë¦¬ìŠ¤ ë…¸íŠ¸ ì¶œë ¥ê°’

| ì¶œë ¥ê°’ | ì„¤ëª… | ì‚¬ìš© ê°€ëŠ¥ ì‘ì—… |
|--------|-------------|---------------|
| `release_notes` | ì»¤ë°‹ ë° Jira ì´ìŠˆë¡œë¶€í„° ìë™ ìƒì„±ëœ ë¦´ë¦¬ìŠ¤ ë…¸íŠ¸ | `request` |
| `commits_count` | ì´ë²ˆ ë¦´ë¦¬ìŠ¤ì˜ ì»¤ë°‹ ìˆ˜ | `request` |

---

## êµ¬ì„± ì°¸ì¡°

### ì •ì±…ë“¤
ì •ì±…ì€ ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ìŠ¹ì¸ì ê·¸ë£¹ì„ ì •ì˜í•©ë‹ˆë‹¤. ë‘ ê°€ì§€ í˜•ì‹ì´ ìˆìŠµë‹ˆë‹¤:

#### ê°„ë‹¨í•œ í˜•ì‹


```yaml
policies:
  # Threshold-based: X of N must approve
  dev-team:
    approvers: [alice, bob, charlie]
    min_approvals: 2

  # All must approve (AND logic)
  security:
    approvers: [team:security, security-lead]
    require_all: true

  # Mixed teams and individuals
  production:
    approvers:
      - team:sre
      - tech-lead
      - product-owner
    min_approvals: 2
```

#### ê³ ê¸‰ í˜•ì‹ (ì†ŒìŠ¤ë³„ ì„ê³„ê°’)

"í”Œë«í¼ì—ì„œ 2ê°œ AND ë³´ì•ˆì—ì„œ 1ê°œ"ì™€ ê°™ì€ ë³µì¡í•œ ìš”êµ¬ì‚¬í•­ì˜ ê²½ìš°:

```yaml
policies:
  # Complex AND gate
  production-gate:
    from:
      - team: platform-engineers
        min_approvals: 2        # 2 of the platform team
      - team: security
        min_approvals: 1        # 1 of the security team
      - user: alice             # alice must also approve
    logic: and                  # ALL sources must be satisfied

  # Flexible OR gate
  flexible-review:
    from:
      - team: security
        require_all: true       # All security team
      - team: platform
        min_approvals: 2        # OR 2 platform members
    logic: or                   # ANY source is enough

  # Executive approval: any one exec
  exec-approval:
    from:
      - user: ceo
      - user: cto
      - user: vp-engineering
    logic: or

  # User list with threshold
  leads:
    from:
      - users: [tech-lead, product-lead, design-lead]
        min_approvals: 2
```

**ì¶œì²˜ ìœ í˜•:**

- `team: slug` - GitHub íŒ€ (ì•± í† í° í•„ìš”)
- `user: username` - ë‹¨ì¼ ì‚¬ìš©ì (ì•”ë¬µì  require_all)
- `users: [a, b, c]` - ì‚¬ìš©ì ëª©ë¡

**ì •ì±… ìˆ˜ì¤€ ë…¼ë¦¬:**

- `logic: and` - ëª¨ë“  ì¶œì²˜ê°€ ì¶©ì¡±ë˜ì–´ì•¼ í•¨ (ê¸°ë³¸ê°’)
- `logic: or` - ì–´ëŠ í•˜ë‚˜ì˜ ì¶œì²˜ê°€ ì¶©ì¡±ë˜ë©´ ì¶©ë¶„

#### ì¸ë¼ì¸ ë…¼ë¦¬ (AND/OR í˜¼í•©)

ë³µì¡í•œ í‘œí˜„ì‹ì˜ ê²½ìš°, ê° ì¶œì²˜ì— `logic:`ì„ ì‚¬ìš©í•˜ì—¬ ë‹¤ìŒê³¼ ì–´ë–»ê²Œ ì—°ê²°ë˜ëŠ”ì§€ ì§€ì •:

```yaml
policies:
  # (2 security AND 2 platform) OR alice
  complex-gate:
    from:
      - team: security
        min_approvals: 2
        logic: and              # AND with next source
      - team: platform
        min_approvals: 2
        logic: or               # OR with next source
      - user: alice            # alice alone can satisfy

  # (security AND platform) OR (alice AND bob) OR manager
  multi-path:
    from:
      - team: security
        min_approvals: 1
        logic: and
      - team: platform
        min_approvals: 1
        logic: or               # End first AND group
      - user: alice
        logic: and
      - user: bob
        logic: or               # End second AND group
      - user: manager          # Third path
```

**ì—°ì‚°ì ìš°ì„ ìˆœìœ„:** ANDëŠ” ORë³´ë‹¤ ê²°í•©ë ¥ì´ ë” ê°•í•©ë‹ˆë‹¤ (í‘œì¤€ ë¶ˆ ëŒ€ìˆ˜ ë…¼ë¦¬).

ì‹ `A and B or C and D`ëŠ” `(A AND B) OR (C AND D)`ë¡œ í‰ê°€ë©ë‹ˆë‹¤.

### ì›Œí¬í”Œë¡œìš°

ì›Œí¬í”Œë¡œìš°ëŠ” ìŠ¹ì¸ ìš”êµ¬ ì‚¬í•­ê³¼ ì‘ì—…ì„ ì •ì˜í•©ë‹ˆë‹¤:

```yaml
workflows:
  my-workflow:
    description: "Optional description"

    # Trigger conditions (for filtering)
    trigger:
      environment: production

    # Approval requirements (OR logic between items)
    require:
      - policy: dev-team
      - policy: security
      # Or inline approvers:
      - approvers: [alice, bob]
        require_all: true

    # Issue configuration
    issue:
      title: "Approval: {{version}}"
      body: |                          # Inline custom template (optional)
        ## My Custom Approval Issue
        Version: {{.Version}}
        Requested by: @{{.Requestor}}
        {{.GroupsTable}}
      body_file: "templates/my-template.md"  # Or load from file
      labels: [production, deploy]
      assignees_from_policy: true

    # Actions on approval
    on_approved:
      create_tag: true
      tag_prefix: "v"  # Creates v1.2.3
      close_issue: true
      comment: "Approved! Tag {{version}} created."

    # Actions on denial
    on_denied:
      close_issue: true
      comment: "Denied by {{denier}}."

    # Actions when issue is manually closed
    on_closed:
      delete_tag: true   # Delete the tag if issue is closed
      comment: "Deployment cancelled. Tag {{tag}} deleted."
```

### íƒœê¹… êµ¬ì„±

ì›Œí¬í”Œë¡œìš°ë³„ë¡œ íƒœê·¸ê°€ ìƒì„±ë˜ëŠ” ë°©ì‹ì„ ì œì–´í•©ë‹ˆë‹¤:

```yaml
workflows:
  dev-deploy:
    require:
      - policy: dev-team
    on_approved:
      tagging:
        enabled: true
        start_version: "0.1.0"      # No 'v' prefix, start at 0.1.0
        auto_increment: patch        # Auto-bump: 0.1.0 -> 0.1.1 -> 0.1.2
        env_prefix: "dev-"           # Creates: dev-0.1.0, dev-0.1.1

  staging-deploy:
    require:
      - policy: qa-team
    on_approved:
      tagging:
        enabled: true
        start_version: "v1.0.0"     # 'v' prefix (inferred from start_version)
        auto_increment: minor        # v1.0.0 -> v1.1.0 -> v1.2.0
        env_prefix: "staging-"       # Creates: staging-v1.0.0

  production-deploy:
    require:
      - policy: prod-team
    on_approved:
      tagging:
        enabled: true
        start_version: "v1.0.0"     # Manual version required (no auto_increment)
```

**íƒœê¹… ì˜µì…˜:**

| ì˜µì…˜ | ì„¤ëª… |
|--------|-------------|
| `enabled` | íƒœê·¸ ìƒì„± í™œì„±í™” |
| `start_version` | ì‹œì‘ ë²„ì „ ë° í˜•ì‹ (ì˜ˆ: "v1.0.0" ë˜ëŠ” "1.0.0") |
| `prefix` | ë²„ì „ ì ‘ë‘ì‚¬ (`start_version`ì—ì„œ ì¶”ë¡ , ì„¤ì •í•˜ì§€ ì•Šìœ¼ë©´) |
| `auto_increment` | ìë™ ì¦ê°€: `major`, `minor`, `patch` ë˜ëŠ” ìˆ˜ë™ ìƒëµ |
| `env_prefix` | í™˜ê²½ ì ‘ë‘ì‚¬ (ì˜ˆ: "dev-"ëŠ” "dev-v1.0.0" ìƒì„±) |

### ë§ì¶¤ ì´ìŠˆ í…œí”Œë¦¿

Go í…œí”Œë¦¿ì„ ì‚¬ìš©í•˜ì—¬ ì´ìŠˆ ë³¸ë¬¸ì„ ì™„ì „íˆ ì‚¬ìš©ì ì •ì˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì¸ë¼ì¸ í…œí”Œë¦¿ì€ `body`ë¥¼, íŒŒì¼ì—ì„œ ë¶ˆëŸ¬ì˜¤ë ¤ë©´ `body_file`ì„ ì‚¬ìš©í•˜ì„¸ìš”.

**ì‚¬ìš© ê°€ëŠ¥í•œ í…œí”Œë¦¿ ë³€ìˆ˜:**

| ë³€ìˆ˜ | ì„¤ëª… |
|----------|-------------|
| `{{.Title}}` | ì´ìŠˆ ì œëª© |
| `{{.Description}}` | ì›Œí¬í”Œë¡œìš° ì„¤ëª… |
| `{{.Version}}` | ì„¸ë©˜í‹± ë²„ì „ |
| `{{.Requestor}}` | ìš”ì²­í•œ GitHub ì‚¬ìš©ìëª… |
| `{{.Environment}}` | í™˜ê²½ ì´ë¦„ |
| `{{.RunURL}}` | ì›Œí¬í”Œë¡œìš° ì‹¤í–‰ ë§í¬ |
| `{{.RepoURL}}` | ì €ì¥ì†Œ URL |
| `{{.CommitSHA}}` | ì „ì²´ ì»¤ë°‹ SHA |
| `{{.CommitURL}}` | ì»¤ë°‹ ë§í¬ |
| `{{.Branch}}` | ë¸Œëœì¹˜ ì´ë¦„ |
| `{{.GroupsTable}}` | ì‚¬ì „ ë Œë”ë§ëœ ìŠ¹ì¸ ìƒíƒœ í‘œ |
| `{{.Timestamp}}` | ìš”ì²­ íƒ€ì„ìŠ¤íƒ¬í”„ |
| `{{.PreviousVersion}}` | ì´ì „ ë²„ì „/íƒœê·¸ |
| `{{.CommitsCount}}` | ì´ë²ˆ ë¦´ë¦¬ìŠ¤ì˜ ì»¤ë°‹ ìˆ˜ |
| `{{.HasJiraIssues}}` | ë¶ˆë¦¬ì–¸ - Jira ì´ìŠˆ ì¡´ì¬ ì—¬ë¶€ |
| `{{.JiraIssues}}` | Jira ì´ìŠˆ ë°ì´í„° ë°°ì—´ |
| `{{.JiraIssuesTable}}` | ì‚¬ì „ ë Œë”ë§ëœ Jira ì´ìŠˆ í‘œ |
| `{{.PipelineTable}}` | ì‚¬ì „ ë Œë”ë§ëœ ë°°í¬ íŒŒì´í”„ë¼ì¸ í‘œ |
| `{{.PipelineMermaid}}` | ì‚¬ì „ ë Œë”ë§ëœ Mermaid í”Œë¡œìš°ì°¨íŠ¸ ë‹¤ì´ì–´ê·¸ë¨ |
| `{{.Vars.key}}` | ì‚¬ìš©ì ì •ì˜ ë³€ìˆ˜ |

**í…œí”Œë¦¿ í•¨ìˆ˜:**

| í•¨ìˆ˜ | ì˜ˆì œ | ì„¤ëª… |
|----------|---------|-------------|
| `slice` | `{{slice .CommitSHA 0 7}}` | ë¶€ë¶„ ë¬¸ìì—´ (ì§§ì€ SHA) |
| `title` | `{{.Environment \| title}}` | ì œëª© ëŒ€ë¬¸ì |
| `upper` | `{{.Version \| upper}}` | ëŒ€ë¬¸ì |
| `lower` | `{{.Version \| lower}}` | ì†Œë¬¸ì |
| `join` | `{{join .Groups ","}}` | ë°°ì—´ ì—°ê²° |
| `contains` | `{{if contains .Branch "feature"}}` | ë¶€ë¶„ ë¬¸ìì—´ í™•ì¸ |
| `replace` | `{{replace .Version "v" ""}}` | ë¬¸ìì—´ ì¹˜í™˜ |
| `default` | `{{default "N/A" .Environment}}` | ê¸°ë³¸ê°’ |

**ì˜ˆì œ ì‚¬ìš©ì ì •ì˜ í…œí”Œë¦¿ íŒŒì¼** (`.github/templates/deploy.md`):

```markdown
## {{.Title}}

### Release Information

- **Version:** `{{.Version}}`
- **Requested by:** @{{.Requestor}}
{{- if .CommitSHA}}
- **Commit:** [{{slice .CommitSHA 0 7}}](https://raw.githubusercontent.com/jamengual/enterprise-approval-engine/main/{{.CommitURL}})
{{- end}}
{{- if .CommitsCount}}
- **Changes:** {{.CommitsCount}} commits since {{.PreviousVersion}}
{{- end}}

{{if .HasJiraIssues}}
### Jira Issues

{{.JiraIssuesTable}}
{{end}}

### Approval Status

{{.GroupsTable}}

---

**Approve:** Comment `approve` | **Deny:** Comment `deny`
```

### ê¸°ë³¸ê°’

ëª¨ë“  ì›Œí¬í”Œë¡œì— ì ìš©ë˜ëŠ” ì „ì—­ ê¸°ë³¸ê°’:

```yaml
defaults:
  timeout: 72h                    # Default approval timeout
  allow_self_approval: false      # Whether requestors can approve their own requests
  issue_labels:                   # Labels added to all approval issues
    - approval-required
```

### Semver

ë²„ì „ ì²˜ë¦¬ êµ¬ì„±:

```yaml
semver:
  prefix: "v"              # Tag prefix (v1.2.3)
  strategy: input          # Use version from input
  validate: true           # Validate semver format
  allow_prerelease: true   # Allow prerelease versions (e.g., v1.0.0-beta.1)
  auto:                    # Label-based auto-increment (when strategy: auto)
    major_labels: [breaking, major]
    minor_labels: [feature, minor]
    patch_labels: [fix, patch, bug]
```

---

## ì „ì²´ êµ¬ì„± ì°¸ì¡°

ì´ ì„¹ì…˜ì—ì„œëŠ” `approvals.yml`ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” **ëª¨ë“  êµ¬ì„± ì˜µì…˜**ì„ ë¬¸ì„œí™”í•©ë‹ˆë‹¤.

### ìµœìƒìœ„ êµ¬ì¡°

```yaml
version: 1                    # Required: config version (always 1)
defaults: { ... }             # Optional: global defaults
policies: { ... }             # Required: reusable approval policies
workflows: { ... }            # Required: approval workflows
semver: { ... }               # Optional: version handling settings
```
### `defaults` ì˜µì…˜

| í‚¤ | íƒ€ì… | ê¸°ë³¸ê°’ | ì„¤ëª… |
|-----|------|---------|-------------|
| `timeout` | duration | `72h` | `wait: true`ì¸ `check` ì‘ì—…ì˜ ì°¨ë‹¨ íƒ€ì„ì•„ì›ƒ. ì‹œê°„ ë‹¨ìœ„ ì‚¬ìš© (ì˜ˆ: 1ì£¼ì¼ì€ `168h`). ì´ë²¤íŠ¸ ê¸°ë°˜ ì›Œí¬í”Œë¡œìš°ì—ëŠ” í•„ìš” ì—†ìŒ. |
| `allow_self_approval` | bool | `false` | ìš”ì²­ìê°€ ìì‹ ì˜ ìš”ì²­ì„ ìŠ¹ì¸í•  ìˆ˜ ìˆëŠ”ì§€ ì—¬ë¶€ |
| `issue_labels` | string[] | `[]` | ëª¨ë“  ìŠ¹ì¸ ì´ìŠˆì— ì¶”ê°€ë˜ëŠ” ë¼ë²¨ |

### `policies.<name>` ì˜µì…˜ (ê°„ë‹¨í•œ í˜•ì‹)

| í‚¤ | íƒ€ì… | ê¸°ë³¸ê°’ | ì„¤ëª… |
|-----|------|---------|-------------|
| `approvers` | string[] | - | ì‚¬ìš©ìëª… ë˜ëŠ” `team:slug` ì°¸ì¡° ëª©ë¡ |
| `min_approvals` | int | 0 | í•„ìš”í•œ ìŠ¹ì¸ ìˆ˜ (0 = `require_all` ì‚¬ìš©) |
| `require_all` | bool | `false` | ì°¸ì´ë©´, ëª¨ë“  ìŠ¹ì¸ìê°€ ìŠ¹ì¸í•´ì•¼ í•¨ |

### `policies.<name>` ì˜µì…˜ (ê³ ê¸‰ í˜•ì‹)

| í‚¤ | íƒ€ì… | ê¸°ë³¸ê°’ | ì„¤ëª… |
|-----|------|---------|-------------|
| `from` | source[] | - | ê°œë³„ ì„ê³„ê°’ì´ ìˆëŠ” ìŠ¹ì¸ì ì†ŒìŠ¤ ëª©ë¡ |
| `logic` | string | `"and"` | ì†ŒìŠ¤ ê²°í•© ë°©ì‹: `"and"` ë˜ëŠ” `"or"` |

**ìŠ¹ì¸ì ì†ŒìŠ¤ ì˜µì…˜ (`from[]`):**

| í‚¤ | íƒ€ì… | ê¸°ë³¸ê°’ | ì„¤ëª… |
|-----|------|---------|-------------|
| `team` | string | - | íŒ€ ìŠ¬ëŸ¬ê·¸ (ì˜ˆ: `"platform"` ë˜ëŠ” `"org/platform"`) |
| `user` | string | - | ë‹¨ì¼ ì‚¬ìš©ìëª… |
| `users` | string[] | - | ì‚¬ìš©ìëª… ëª©ë¡ |
| `min_approvals` | int | 1 | ì´ ì†ŒìŠ¤ì—ì„œ í•„ìš”í•œ ìŠ¹ì¸ ìˆ˜ |
| `require_all` | bool | `false` | ì´ ì†ŒìŠ¤ì˜ ëª¨ë“  ì‚¬ìš©ìê°€ ìŠ¹ì¸í•´ì•¼ í•¨ |
| `logic` | string | - | ë‹¤ìŒ ì†ŒìŠ¤ë¡œ ê°€ëŠ” ë…¼ë¦¬: `"and"` ë˜ëŠ” `"or"` |

### `workflows.<name>` ì˜µì…˜

| í‚¤ | íƒ€ì… | ê¸°ë³¸ê°’ | ì„¤ëª… |
|-----|------|---------|-------------|
| `description` | string | - | ì‚¬ëŒì´ ì½ì„ ìˆ˜ ìˆëŠ” ì„¤ëª… |

| `trigger` | map | - | íŠ¸ë¦¬ê±° ì¡°ê±´ (í•„í„°ë§ìš©) |
| `require` | requirement[] | - | **í•„ìˆ˜:** ìŠ¹ì¸ ìš”êµ¬ì‚¬í•­ (í•­ëª© ê°„ OR ë…¼ë¦¬) |
| `issue` | object | - | ì´ìŠˆ ìƒì„± ì„¤ì • |
| `on_approved` | object | - | ìŠ¹ì¸ ì‹œ ë™ì‘ |
| `on_denied` | object | - | ê±°ë¶€ ì‹œ ë™ì‘ |
| `on_closed` | object | - | ìˆ˜ë™ìœ¼ë¡œ ì´ìŠˆê°€ ë‹«í ë•Œ ë™ì‘ |
| `pipeline` | object | - | ì ì§„ì  ë°°í¬ íŒŒì´í”„ë¼ì¸ êµ¬ì„± |

### `workflows.<name>.require[]` ì˜µì…˜

| Key | Type | Default | Description |
|-----|------|---------|-------------|
| `policy` | string | - | ì •ì˜ëœ ì •ì±… ì°¸ì¡° |
| `approvers` | string[] | - | ì¸ë¼ì¸ ìŠ¹ì¸ì (ì •ì±… ëŒ€ì²´) |
| `min_approvals` | int | - | ì •ì±…ì˜ min_approvals ì¬ì •ì˜ |
| `require_all` | bool | - | ì •ì±…ì˜ require_all ì¬ì •ì˜ |

### `workflows.<name>.issue` ì˜µì…˜

| Key | Type | Default | Description |
|-----|------|---------|-------------|
| `title` | string | `"Approval Required: {workflow}"` | ì´ìŠˆ ì œëª© (`{{version}}`, `{{environment}}`, `{{workflow}}` ì§€ì›) |
| `body` | string | - | ì»¤ìŠ¤í…€ ì´ìŠˆ ë³¸ë¬¸ í…œí”Œë¦¿ (Go í…œí”Œë¦¿ ë¬¸ë²•) |
| `body_file` | string | - | í…œí”Œë¦¿ íŒŒì¼ ê²½ë¡œ (`.github/` ìƒëŒ€ ê²½ë¡œ) |
| `labels` | string[] | `[]` | í•´ë‹¹ ì›Œí¬í”Œë¡œìš°ì— ì¶”ê°€í•  ë¼ë²¨ |
| `assignees_from_policy` | bool | `false` | ì •ì±…ì—ì„œ ê°œë³„ ì‚¬ìš©ì ìë™ í• ë‹¹ (ìµœëŒ€ 10ëª…) |

### `workflows.<name>.on_approved` ì˜µì…˜

| Key | Type | Default | Description |
|-----|------|---------|-------------|
| `create_tag` | bool | `false` | git íƒœê·¸ ìƒì„± (ì…ë ¥ëœ ë²„ì „ ì‚¬ìš©) |
| `close_issue` | bool | `false` | ìŠ¹ì¸ í›„ ì´ìŠˆ ë‹«ê¸° |
| `comment` | string | - | ê²Œì‹œí•  ì½”ë©˜íŠ¸ (`{{version}}`, `{{satisfied_group}}` ì§€ì›) |
| `tagging` | object | - | ê³ ê¸‰ íƒœê¹… êµ¬ì„± |

### `workflows.<name>.on_approved.tagging` ì˜µì…˜

| Key | Type | Default | Description |
|-----|------|---------|-------------|
| `enabled` | bool | `false` | íƒœê·¸ ìƒì„± í™œì„±í™” |
| `start_version` | string | `"0.0.0"` | ì´ˆê¸° ë²„ì „ (ì˜ˆ: `"v1.0.0"` ë˜ëŠ” `"1.0.0"`) |
| `prefix` | string | (ì¶”ë¡ ë¨) | ë²„ì „ ì ‘ë‘ì‚¬ (`start_version`ì—ì„œ ì¶”ë¡ ) |
| `auto_increment` | string | - | ìë™ ì¦ê°€: `"major"`, `"minor"`, `"patch"` ë˜ëŠ” ìˆ˜ë™ ìƒëµ |
| `env_prefix` | string | - | í™˜ê²½ ì ‘ë‘ì‚¬ (ì˜ˆ: `"dev-"`ëŠ” `"dev-v1.0.0"` ìƒì„±) |

### `workflows.<name>.on_denied` ì˜µì…˜

| í‚¤ | íƒ€ì… | ê¸°ë³¸ê°’ | ì„¤ëª… |
|-----|------|---------|-------------|
| `close_issue` | bool | `false` | ê±°ë¶€ í›„ ì´ìŠˆ ë‹«ê¸° |
| `comment` | string | - | ê²Œì‹œí•  ëŒ“ê¸€ (`{{denier}}` ì§€ì›) |

### `workflows.<name>.on_closed` ì˜µì…˜

| í‚¤ | íƒ€ì… | ê¸°ë³¸ê°’ | ì„¤ëª… |
|-----|------|---------|-------------|
| `delete_tag` | bool | `false` | ì´ìŠˆê°€ ë‹«í ë•Œ ê´€ë ¨ íƒœê·¸ ì‚­ì œ |
| `comment` | string | - | ê²Œì‹œí•  ëŒ“ê¸€ (`{{tag}}`, `{{version}}` ì§€ì›) |

### `workflows.<name>.pipeline` ì˜µì…˜

| í‚¤ | íƒ€ì… | ê¸°ë³¸ê°’ | ì„¤ëª… |
|-----|------|---------|-------------|
| `stages` | stage[] | - | **í•„ìˆ˜:** ë°°í¬ ë‹¨ê³„ì˜ ìˆœì„œ ìˆëŠ” ëª©ë¡ |
| `track_prs` | bool | `false` | ë³‘í•©ëœ PRì„ ì´ìŠˆ ë³¸ë¬¸ì— í¬í•¨ |
| `track_commits` | bool | `false` | ì»¤ë°‹ì„ ì´ìŠˆ ë³¸ë¬¸ì— í¬í•¨ |
| `compare_from_tag` | string | - | ë¹„êµí•  íƒœê·¸ íŒ¨í„´ (ì˜ˆ: `"v*"`) |
| `show_mermaid_diagram` | bool | `true` | íŒŒì´í”„ë¼ì¸ ë‹¨ê³„ì˜ Mermaid ì‹œê° íë¦„ë„ í‘œì‹œ |
| `release_strategy` | object | - | ë¦´ë¦¬ìŠ¤ í›„ë³´ ì„ íƒ ì „ëµ |

### `workflows.<name>.pipeline.stages[]` ì˜µì…˜

| í‚¤ | íƒ€ì… | ê¸°ë³¸ê°’ | ì„¤ëª… |
|-----|------|---------|-------------|
| `name` | string | - | **í•„ìˆ˜:** ë‹¨ê³„ ì´ë¦„ (ì˜ˆ: `"dev"`, `"prod"`) |
| `environment` | string | - | GitHub í™˜ê²½ ì´ë¦„ |
| `policy` | string | - | ì´ ë‹¨ê³„ì˜ ìŠ¹ì¸ ì •ì±… |
| `approvers` | string[] | - | ì¸ë¼ì¸ ìŠ¹ì¸ì (ì •ì±… ëŒ€ì•ˆ) |
| `on_approved` | string | - | ë‹¨ê³„ ìŠ¹ì¸ ì‹œ ê²Œì‹œí•  ëŒ“ê¸€ |
| `create_tag` | bool | `false` | ì´ ë‹¨ê³„ì—ì„œ git íƒœê·¸ ìƒì„± |
| `is_final` | bool | `false` | ì´ ë‹¨ê³„ í›„ ì´ìŠˆ ì¢…ë£Œ |
| `auto_approve` | bool | `false` | ì‚¬ëŒ ê°œì… ì—†ì´ ìë™ ìŠ¹ì¸ |

### `workflows.<name>.pipeline.release_strategy` ì˜µì…˜

| Key | Type | Default | Description |
|-----|------|---------|-------------|
| `type` | string | `"tag"` | ì „ëµ: `"tag"`, `"branch"`, `"label"`, `"milestone"` |
| `branch` | object | - | ë¸Œëœì¹˜ ì „ëµ ì„¤ì • |
| `label` | object | - | ë¼ë²¨ ì „ëµ ì„¤ì • |
| `milestone` | object | - | ë§ˆì¼ìŠ¤í†¤ ì „ëµ ì„¤ì • |
| `auto_create` | object | - | ë‹¤ìŒ ë¦´ë¦¬ìŠ¤ ì•„í‹°íŒ©íŠ¸ ìë™ ìƒì„± |

### `release_strategy.branch` ì˜µì…˜

| Key | Type | Default | Description |
|-----|------|---------|-------------|
| `pattern` | string | `"release/{{version}}"` | ë¸Œëœì¹˜ ëª…ëª… íŒ¨í„´ |
| `base_branch` | string | `"main"` | ë¹„êµ ëŒ€ìƒ ë¸Œëœì¹˜ |
| `delete_after_release` | bool | `false` | í”„ë¡œë•ì…˜ ë°°í¬ í›„ ë¸Œëœì¹˜ ì‚­ì œ |

### `release_strategy.label` ì˜µì…˜

| Key | Type | Default | Description |
|-----|------|---------|-------------|
| `pattern` | string | `"release:{{version}}"` | ë¼ë²¨ ëª…ëª… íŒ¨í„´ |
| `pending_label` | string | - | ë¦´ë¦¬ìŠ¤ í• ë‹¹ ëŒ€ê¸° PRìš© ë¼ë²¨ |
| `remove_after_release` | bool | `false` | í”„ë¡œë•ì…˜ ë°°í¬ í›„ ë¼ë²¨ ì œê±° |

### `release_strategy.milestone` ì˜µì…˜

| Key | Type | Default | Description |
|-----|------|---------|-------------|
| `pattern` | string | `"v{{version}}"` | ë§ˆì¼ìŠ¤í†¤ ëª…ëª… íŒ¨í„´ |
| `close_after_release` | bool | `false` | í”„ë¡œë•ì…˜ ë°°í¬ í›„ ë§ˆì¼ìŠ¤í†¤ ì¢…ë£Œ |

### `release_strategy.auto_create` ì˜µì…˜

| Key | Type | Default | Description |
|-----|------|---------|-------------|
| `enabled` | bool | `false` | ìµœì¢… ë‹¨ê³„ ì™„ë£Œ ì‹œ ìë™ ìƒì„± í™œì„±í™” |
| `next_version` | string | `"patch"` | ë²„ì „ ì¦ê°€: `"patch"`, `"minor"`, `"major"` |
| `create_issue` | bool | `false` | ë‹¤ìŒ ë¦´ë¦¬ìŠ¤ë¥¼ ìœ„í•œ ìƒˆ ìŠ¹ì¸ ì´ìŠˆ ìƒì„± |
| `comment` | string | - | ë‹¤ìŒ ë¦´ë¦¬ìŠ¤ì— ëŒ€í•œ ëŒ“ê¸€ ì‘ì„± |

### `semver` ì˜µì…˜

| Key | Type | Default | Description |
|-----|------|---------|-------------|
| `prefix` | string | `"v"` | íƒœê·¸ ì ‘ë‘ì‚¬ |
| `strategy` | string | `"input"` | ë²„ì „ ì „ëµ: `"input"`, `"auto"` |
| `validate` | bool | `false` | semver í˜•ì‹ ê²€ì¦ |
| `allow_prerelease` | bool | `false` | í”„ë¦¬ë¦´ë¦¬ìŠ¤ ë²„ì „ í—ˆìš© (ì˜ˆ: `v1.0.0-beta.1`) |
| `auto` | object | - | ë¼ë²¨ ê¸°ë°˜ ìë™ ì¦ê°€ ì„¤ì • |

### `semver.auto` ì˜µì…˜

| Key | Type | Default | Description |
|-----|------|---------|-------------|
| `major_labels` | string[] | `[]` | ë©”ì´ì € ë²„ì „ ì¦ê°€ë¥¼ íŠ¸ë¦¬ê±°í•˜ëŠ” PR ë¼ë²¨ |
| `minor_labels` | string[] | `[]` | ë§ˆì´ë„ˆ ë²„ì „ ì¦ê°€ë¥¼ íŠ¸ë¦¬ê±°í•˜ëŠ” PR ë¼ë²¨ |
| `patch_labels` | string[] | `[]` | íŒ¨ì¹˜ ë²„ì „ ì¦ê°€ë¥¼ íŠ¸ë¦¬ê±°í•˜ëŠ” PR ë¼ë²¨ |

---

## ê¸°ëŠ¥ ì„¸ë¶€ì‚¬í•­

### ìŠ¹ì¸ í‚¤ì›Œë“œ

ì‚¬ìš©ìëŠ” ì´ìŠˆì— ëŒ“ê¸€ì„ ë‹¬ì•„ ìš”ì²­ì„ ìŠ¹ì¸í•˜ê±°ë‚˜ ê±°ë¶€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

**ìŠ¹ì¸ í‚¤ì›Œë“œ:** `approve`, `approved`, `lgtm`, `yes`, `/approve`

**ê±°ë¶€ í‚¤ì›Œë“œ:** `deny`, `denied`, `reject`, `rejected`, `no`, `/deny`

### íŒ€ ì§€ì›

GitHub íŒ€ ê¸°ë°˜ ìŠ¹ì¸ìë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ ê¶Œí•œ ìƒìŠ¹ì´ í•„ìš”í•©ë‹ˆë‹¤. ê¸°ë³¸ `GITHUB_TOKEN`ì€ íŒ€ ë©¤ë²„ ëª©ë¡ì„ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. GitHub ì•± í† í°ì„ ì‚¬ìš©í•˜ì„¸ìš”:

```yaml
jobs:
  process:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      # Generate GitHub App token
      - uses: actions/create-github-app-token@v2
        id: app-token
        with:
          app-id: ${{ vars.APP_ID }}
          private-key: ${{ secrets.APP_PRIVATE_KEY }}

      # Use the app token for team membership checks
      - uses: jamengual/enterprise-approval-engine@v1
        with:
          action: process-comment
          issue_number: ${{ github.event.issue.number }}
          token: ${{ steps.app-token.outputs.token }}
```

**í•„ìˆ˜ GitHub ì•± ê¶Œí•œ:**

- `Organization > Members: Read` - íŒ€ êµ¬ì„±ì› ëª©ë¡ ì¡°íšŒë¥¼ ìœ„í•´

### ì ì§„ì  ë°°í¬ íŒŒì´í”„ë¼ì¸

ë‹¨ì¼ ìŠ¹ì¸ ì´ìŠˆë¡œ ì—¬ëŸ¬ í™˜ê²½ì— ê±¸ì¹œ ë°°í¬ë¥¼ ì¶”ì í•©ë‹ˆë‹¤. ê° ë‹¨ê³„ê°€ ìŠ¹ì¸ë˜ë©´ ì´ìŠˆê°€ ì§„í–‰ ìƒí™©ì„ í‘œì‹œí•˜ë„ë¡ ì—…ë°ì´íŠ¸ë˜ê³  ìë™ìœ¼ë¡œ ë‹¤ìŒ ë‹¨ê³„ë¡œ ì§„í–‰í•©ë‹ˆë‹¤.

#### íŒŒì´í”„ë¼ì¸ êµ¬ì„±

```yaml
# .github/approvals.yml or external config
version: 1

policies:
  developers:
    approvers: [dev1, dev2, dev3]
    min_approvals: 1

  qa-team:
    approvers: [qa1, qa2]
    min_approvals: 1

  tech-leads:
    approvers: [lead1, lead2]
    min_approvals: 1

  production-approvers:
    approvers: [sre1, sre2, security-lead]
    require_all: true

workflows:
  deploy:
    description: "Deploy through all environments (dev â†’ qa â†’ stage â†’ prod)"
    require:
      - policy: developers  # Initial approval to start pipeline
    pipeline:
      track_prs: true       # Include PRs in the issue body
      track_commits: true   # Include commits in the issue body
      stages:
        - name: dev
          environment: development
          policy: developers
          on_approved: "âœ… **DEV** deployment approved! Proceeding to QA..."
        - name: qa
          environment: qa
          policy: qa-team
          on_approved: "âœ… **QA** deployment approved! Proceeding to STAGING..."
        - name: stage
          environment: staging
          policy: tech-leads
          on_approved: "âœ… **STAGING** deployment approved! Ready for PRODUCTION..."
        - name: prod
          environment: production
          policy: production-approvers
          on_approved: "ğŸš€ **PRODUCTION** deployment complete!"
          create_tag: true   # Create tag when PROD is approved
          is_final: true     # Close issue after this stage
    on_approved:
      close_issue: true
      comment: |
        ğŸ‰ **Deployment Complete!**

        Version `{{version}}` has been deployed to all environments.
```

#### íŒŒì´í”„ë¼ì¸ ì›Œí¬í”Œë¡œìš° ì˜ˆì‹œ

```yaml
# .github/workflows/request-pipeline.yml
name: Request Pipeline Deployment

on:
  workflow_dispatch:
    inputs:
      version:
        description: 'Version to deploy'
        required: true
        type: string

permissions:
  contents: write
  issues: write
  pull-requests: read  # Required for PR tracking

jobs:
  request:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0  # Needed for commit/PR comparison

      - uses: jamengual/enterprise-approval-engine@v1
        id: approval
        with:
          action: request
          workflow: deploy
          version: ${{ inputs.version }}
          token: ${{ secrets.GITHUB_TOKEN }}

      - name: Output Results
        run: |
          echo "## Pipeline Deployment Started" >> $GITHUB_STEP_SUMMARY
          echo "- **Issue:** #${{ steps.approval.outputs.issue_number }}" >> $GITHUB_STEP_SUMMARY
          echo "- **URL:** ${{ steps.approval.outputs.issue_url }}" >> $GITHUB_STEP_SUMMARY
```

#### ì‘ë™ ë°©ì‹

1. **ì´ìŠˆ ìƒì„±**: íŠ¸ë¦¬ê±°ë˜ë©´, ëª¨ë“  ë‹¨ê³„ë¥¼ ì‹œê°ì ì¸ Mermaid ë‹¤ì´ì–´ê·¸ë¨ê³¼ ì§„í–‰ í‘œë¡œ ë³´ì—¬ì£¼ëŠ” ë‹¨ì¼ ì´ìŠˆë¥¼ ìƒì„±í•©ë‹ˆë‹¤:

```markdown
## ğŸš€ ë°°í¬ íŒŒì´í”„ë¼ì¸: v1.2.0

### íŒŒì´í”„ë¼ì¸ íë¦„

â€‹```mermaid
flowchart LR
    DEV(â³ ê°œë°œ)
    QA(â¬œ QA)
    STAGE(â¬œ ìŠ¤í…Œì´ì§€)
    PROD(â¬œ ìš´ì˜)
    DEV --> QA --> STAGE --> PROD

    classDef completed fill:#28a745,stroke:#1e7e34,color:#fff
    classDef current fill:#ffc107,stroke:#d39e00,color:#000
    classDef pending fill:#6c757d,stroke:#545b62,color:#fff
    class DEV current
    class QA,STAGE,PROD pending
â€‹```

### Deployment Progress

| Stage | Status | Approver | Time |
|-------|--------|----------|------|
| DEV | â³ Awaiting | - | - |
| QA | â¬œ Pending | - | - |
| STAGE | â¬œ Pending | - | - |
| PROD | â¬œ Pending | - | - |

**Current Stage:** DEV
```
ë¨¸ë©”ì´ë“œ ë‹¤ì´ì–´ê·¸ë¨ì€ ìƒ‰ìƒìœ¼ë¡œ êµ¬ë¶„ëœ ë…¸ë“œë¥¼ í†µí•´ í•œëˆˆì— ìƒíƒœë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤:
- ğŸŸ¢ **ì´ˆë¡ìƒ‰** - ì™„ë£Œëœ ë‹¨ê³„
- ğŸŸ¡ **ë…¸ë€ìƒ‰** - ìŠ¹ì¸ ëŒ€ê¸° ì¤‘ì¸ í˜„ì¬ ë‹¨ê³„
- âšª **íšŒìƒ‰** - ëŒ€ê¸° ì¤‘ì¸ ë‹¨ê³„
- ğŸ”µ **ì²­ë¡ìƒ‰** - ìë™ ìŠ¹ì¸ ë‹¨ê³„

ë¨¸ë©”ì´ë“œ ë‹¤ì´ì–´ê·¸ë¨ì„ ë¹„í™œì„±í™”í•˜ë ¤ë©´ íŒŒì´í”„ë¼ì¸ ì„¤ì •ì—ì„œ `show_mermaid_diagram: false`ë¡œ ì„¤ì •í•˜ì„¸ìš”.

2. **ë‹¨ê³„ ì§„í–‰**: ë‹¤ìŒ ë‹¨ê³„ë¡œ ì§„í–‰í•˜ë ¤ë©´ `approve` ëŒ“ê¸€ì„ ë‚¨ê¸°ì„¸ìš”. ë‹¤ì´ì–´ê·¸ë¨ê³¼ í‘œê°€ ìë™ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤:


```markdown
| Stage | Status | Approver | Time |
|-------|--------|----------|------|
| DEV | âœ… Deployed | @developer1 | Dec 9 10:30 |
| QA | âœ… Deployed | @qa-lead | Dec 9 14:15 |
| STAGE | â³ Awaiting | - | - |
| PROD | â¬œ Pending | - | - |

**Current Stage:** STAGE
```

3. **PR ë° ì»¤ë°‹ ì¶”ì **: ë¦´ë¦¬ìŠ¤ ê´€ë¦¬ìëŠ” ë°°í¬ë˜ëŠ” ë‚´ìš©ì„ ì •í™•íˆ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```markdown
### Pull Requests in this Release

| PR | Title | Author |
|----|-------|--------|
| [#42](https://...) | Add user authentication | @alice |
| [#45](https://...) | Fix payment processing bug | @bob |

### Commits

- [`abc1234`](https://...) feat: add OAuth2 support
- [`def5678`](https://...) fix: handle null payments
```
4. **ì™„ë£Œ**: ìµœì¢… ë‹¨ê³„ê°€ ìŠ¹ì¸ë˜ë©´:
   - íƒœê·¸ê°€ ìƒì„±ë©ë‹ˆë‹¤ (`create_tag: true`ì¸ ê²½ìš°)
   - ì™„ë£Œ ëŒ“ê¸€ì´ ê²Œì‹œë©ë‹ˆë‹¤
   - ì´ìŠˆê°€ ìë™ìœ¼ë¡œ ì¢…ë£Œë©ë‹ˆë‹¤

#### íŒŒì´í”„ë¼ì¸ ë‹¨ê³„ ì˜µì…˜

| ì˜µì…˜ | ì„¤ëª… |
|--------|-------------|
| `name` | ë‹¨ê³„ ì´ë¦„ (í‘œì— í‘œì‹œë¨) |
| `environment` | GitHub í™˜ê²½ ì´ë¦„ |
| `policy` | ì´ ë‹¨ê³„ì˜ ìŠ¹ì¸ ì •ì±… |
| `approvers` | ì¸ë¼ì¸ ìŠ¹ì¸ì (ì •ì±…ì˜ ëŒ€ì•ˆ) |
| `on_approved` | ë‹¨ê³„ê°€ ìŠ¹ì¸ë  ë•Œ ê²Œì‹œí•  ë©”ì‹œì§€ |
| `create_tag` | ì´ ë‹¨ê³„ì—ì„œ git íƒœê·¸ ìƒì„± |
| `is_final` | ì´ ë‹¨ê³„ í›„ ì´ìŠˆ ì¢…ë£Œ |
| `auto_approve` | ì‚¬ëŒ ê°œì… ì—†ì´ ì´ ë‹¨ê³„ë¥¼ ìë™ ìŠ¹ì¸ |
| `approval_mode` | ì´ ë‹¨ê³„ì˜ ì›Œí¬í”Œë¡œìš° ìŠ¹ì¸ ëª¨ë“œ ì¬ì •ì˜ |

#### ìŠ¹ì¸ ëª¨ë“œ

ìŠ¹ì¸ìê°€ ìŠ¹ì¸ ìš”ì²­ê³¼ ìƒí˜¸ì‘ìš©í•˜ëŠ” ë°©ì‹ì„ ì„ íƒí•˜ì„¸ìš”:

| ëª¨ë“œ | ì„¤ëª… |
|------|-------------|
| `comments` | (ê¸°ë³¸) ìŠ¹ì¸ìê°€ ì´ìŠˆì— `/approve` ë˜ëŠ” `approve` ëŒ“ê¸€ ì‘ì„± |
| `sub_issues` | ê° ë‹¨ê³„ë³„ í•˜ìœ„ ì´ìŠˆ ìƒì„± - ì¢…ë£Œ ì‹œ ìŠ¹ì¸ |
| `hybrid` | ë‹¨ê³„ë³„ë¡œ ëª¨ë“œ í˜¼í•© - ê° ë‹¨ê³„ì—ì„œ `approval_mode` ì‚¬ìš© |

**í•˜ìœ„ ì´ìŠˆ ìŠ¹ì¸ ì˜ˆì‹œ:**


```yaml
workflows:
  deploy:
    approval_mode: sub_issues
    sub_issue_settings:
      title_template: "â³ Approve: {{stage}} for {{version}}"  # Changes to âœ… when approved
      labels: [approval-stage]
      protection:
        only_assignee_can_close: true   # Prevents unauthorized approvals
        prevent_parent_close: true       # Parent can't close until all approved
    pipeline:
      stages:
        - name: dev
          policy: developers
        - name: prod
          policy: production-approvers
```

í•˜ìœ„ ì´ìŠˆê°€ ìˆëŠ” ê²½ìš°, ìƒìœ„ ì´ìŠˆëŠ” ìŠ¹ì¸ í•˜ìœ„ ì´ìŠˆì˜ í‘œë¥¼ í‘œì‹œí•©ë‹ˆë‹¤:

```markdown
### ğŸ“‹ Approval Sub-Issues

| Stage | Sub-Issue | Status | Assignees |
|-------|-----------|--------|----------|
| DEV | #124 | â³ Awaiting | @alice, @bob |
| PROD | #125 | â³ Awaiting | @sre1, @sre2 |
```

**í•˜ì´ë¸Œë¦¬ë“œ ëª¨ë“œ (ë‹¨ê³„ë³„ ì˜¤ë²„ë¼ì´ë“œ):**

```yaml
workflows:
  deploy:
    approval_mode: comments  # Default for this workflow
    pipeline:
      stages:
        - name: dev
          policy: developers
          # Uses comments (workflow default)
        - name: prod
          policy: production-approvers
          approval_mode: sub_issues  # Override for production only
```
#### í–¥ìƒëœ ëŒ“ê¸€ UX

ì´ ì‘ì—…ì—ëŠ” í–¥ìƒëœ ëŒ“ê¸€ ê¸°ë°˜ ìŠ¹ì¸ UXê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤:

- **ì´ëª¨ì§€ ë°˜ì‘**: ìŠ¹ì¸ ëŒ“ê¸€ì— ìë™ ë°˜ì‘
  - ğŸ‘ ìŠ¹ì¸ë¨
  - ğŸ‘ ê±°ë¶€ë¨
  - ğŸ‘€ í™•ì¸ë¨ (ì²˜ë¦¬ ì¤‘)

- **ë¹ ë¥¸ ì‘ì—… ì„¹ì…˜**: ì´ìŠˆ ë³¸ë¬¸ì— ëª…ë ¹ì–´ ì°¸ì¡° í‘œ í¬í•¨:


```markdown
### âš¡ Quick Actions

| Action | Command | Description |
|--------|---------|-------------|
| âœ… Approve | `/approve` | Approve the **DEV** stage |
| âŒ Deny | `/deny [reason]` | Deny with optional reason |
| ğŸ“Š Status | `/status` | Show current approval status |
```

**`comment_settings`ì„ í†µí•´ êµ¬ì„±:**

```yaml
workflows:
  deploy:
    comment_settings:
      react_to_comments: true     # Add emoji reactions (default: true)
      show_quick_actions: true    # Show Quick Actions section (default: true)
```

#### í•˜ìœ„ í™˜ê²½ì— ëŒ€í•œ ìë™ ìŠ¹ì¸

ì‚¬ëŒì˜ ê°œì… ì—†ì´ ìë™ìœ¼ë¡œ ìŠ¹ì¸ë˜ì–´ì•¼ í•˜ëŠ” íŒŒì´í”„ë¼ì¸ ë‹¨ê³„ì— `auto_approve: true`ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”. ì´ëŠ” `dev` ë˜ëŠ” `integration`ê³¼ ê°™ì€ í•˜ìœ„ í™˜ê²½ì—ì„œ íŒŒì´í”„ë¼ì¸ ì†ë„ë¥¼ ë†’ì´ë©´ì„œë„ í”„ë¡œë•ì…˜ì— ëŒ€í•œ ìŠ¹ì¸ ë¬¸í„±ì„ ìœ ì§€í•˜ëŠ” ë° ì´ìƒì ì…ë‹ˆë‹¤.

**ìë™ ìŠ¹ì¸ ì˜ˆì‹œ:**

```yaml
workflows:
  deploy:
    description: "Deploy through environments"
    pipeline:
      stages:
        - name: dev
          environment: development
          auto_approve: true              # Automatically approved
          on_approved: "ğŸ¤– DEV auto-deployed"
        - name: integration
          environment: integration
          auto_approve: true              # Automatically approved
          on_approved: "ğŸ¤– INTEGRATION auto-deployed"
        - name: staging
          environment: staging
          policy: qa-team                 # Requires manual approval
          on_approved: "âœ… STAGING approved"
        - name: production
          environment: production
          policy: production-approvers    # Requires manual approval
          create_tag: true
          is_final: true
```
**ì‘ë™ ì›ë¦¬:**

1. íŒŒì´í”„ë¼ì¸ ì´ìŠˆê°€ ìƒì„±ë˜ë©´, ëª¨ë“  ì´ˆê¸° `auto_approve: true` ë‹¨ê³„ê°€ ìë™ìœ¼ë¡œ ì™„ë£Œë©ë‹ˆë‹¤  
2. ë‹¨ê³„ê°€ ìˆ˜ë™ìœ¼ë¡œ ìŠ¹ì¸ë˜ë©´, ê·¸ ë‹¤ìŒì— ì´ì–´ì§€ëŠ” ëª¨ë“  `auto_approve: true` ë‹¨ê³„ë„ ìë™ìœ¼ë¡œ ì™„ë£Œë©ë‹ˆë‹¤  
3. ìë™ ìŠ¹ì¸ëœ ë‹¨ê³„ëŠ” íŒŒì´í”„ë¼ì¸ í…Œì´ë¸”ì— ğŸ¤– í‘œì‹œê°€ ë‚˜íƒ€ë‚©ë‹ˆë‹¤  
4. ìŠ¹ì¸ì€ ë‹¨ê³„ ê¸°ë¡ì— `[auto]`ë¡œ ê¸°ë¡ë©ë‹ˆë‹¤  

**ì‚¬ìš© ì‚¬ë¡€:**

- **ê°œë°œ í™˜ê²½**: ìŠ¹ì¸ ëŒ€ê¸° ì—†ì´ ì¦‰ì‹œ ë°°í¬  
- **í†µí•© í…ŒìŠ¤íŠ¸**: CI/CD íŒŒì´í”„ë¼ì¸ì´ í…ŒìŠ¤íŠ¸ í™˜ê²½ì„ ìë™ìœ¼ë¡œ ì§„í–‰í•˜ë„ë¡ ì„¤ì •  
- **ì¹´ë‚˜ë¦¬ ë°°í¬**: ì¹´ë‚˜ë¦¬ ë‹¨ê³„ëŠ” ìë™ ìŠ¹ì¸, ì „ì²´ ë¡¤ì•„ì›ƒì€ ìˆ˜ë™ ìŠ¹ì¸ í•„ìš”  

#### íŒŒì´í”„ë¼ì¸ êµ¬ì„± ì˜µì…˜

| ì˜µì…˜ | ê¸°ë³¸ê°’ | ì„¤ëª… |
|--------|---------|-------------|
| `track_prs` | `false` | ë³‘í•©ëœ PRì„ ì´ìŠˆ ë³¸ë¬¸ì— í¬í•¨ |
| `track_commits` | `false` | ë§ˆì§€ë§‰ íƒœê·¸ ì´í›„ ì»¤ë°‹ í¬í•¨ |
| `compare_from_tag` | - | ë¹„êµí•  ì‚¬ìš©ì ì§€ì • íƒœê·¸ íŒ¨í„´ |
| `show_mermaid_diagram` | `true` | íŒŒì´í”„ë¼ì¸ ë‹¨ê³„ì˜ Mermaid ì‹œê°ì  íë¦„ë„ í‘œì‹œ |

**ì°¸ê³ :** PR ì¶”ì ì„ ìœ„í•´ì„œëŠ” ì›Œí¬í”Œë¡œìš°ì—ì„œ `pull-requests: read` ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤.  

### ë¦´ë¦¬ìŠ¤ í›„ë³´ ì „ëµ

ê¸°ì—… í™˜ê²½ì—ì„œ ë©”ì¸ìœ¼ë¡œ ë³‘í•©ëœ PRì´ í•­ìƒ ì¦‰ì‹œ ë¦´ë¦¬ìŠ¤ í›„ë³´ê°€ ë˜ëŠ” ê²ƒì€ ì•„ë‹™ë‹ˆë‹¤. ìŠ¹ì¸ ì—”ì§„ì€ ë¦´ë¦¬ìŠ¤ì— í¬í•¨ë  PRì„ ì„ íƒí•˜ê¸° ìœ„í•´ ì„¸ ê°€ì§€ ì „ëµì„ ì§€ì›í•©ë‹ˆë‹¤:  

#### ì „ëµ ìœ í˜•

| ì „ëµ | ì„¤ëª… | ì‚¬ìš© ì‚¬ë¡€ |
|----------|-------------|----------|
| `tag` | ë‘ git íƒœê·¸ ì‚¬ì´ì˜ PR (ê¸°ë³¸ê°’) | ê°„ë‹¨í•œ ë¦´ë¦¬ìŠ¤, íŠ¸ë í¬ ê¸°ë°˜ ê°œë°œ |
| `branch` | ë¦´ë¦¬ìŠ¤ ë¸Œëœì¹˜ì— ë³‘í•©ëœ PR | GitFlow, ë¦´ë¦¬ìŠ¤ ë¸Œëœì¹˜ |
| `label` | íŠ¹ì • ë¦´ë¦¬ìŠ¤ ë ˆì´ë¸”ì´ ë¶™ì€ PR | ìœ ì—°í•œ ì„ íƒ, ë°°ì¹˜ ë¦´ë¦¬ìŠ¤ |
| `milestone` | GitHub ë§ˆì¼ìŠ¤í†¤ì— í• ë‹¹ëœ PR | ë¡œë“œë§µì— ë§ì¶˜ ë¦´ë¦¬ìŠ¤ |

#### êµ¬ì„±


```yaml
# .github/approvals.yml
workflows:
  deploy:
    description: "Production deployment pipeline"
    pipeline:
      track_prs: true
      track_commits: true

      # Configure release selection strategy
      release_strategy:
        type: milestone  # or: tag, branch, label

        # Milestone strategy settings
        milestone:
          pattern: "v{{version}}"        # e.g., "v1.2.0"
          close_after_release: true       # Close milestone on prod completion

        # Auto-create next release artifact on completion
        auto_create:
          enabled: true
          next_version: patch             # or: minor, major
          create_issue: true              # Create new approval issue

      stages:
        - name: dev
          policy: developers
        - name: prod
          policy: production-approvers
          is_final: true
```
#### ë¸Œëœì¹˜ ì „ëµ

GitFlow ìŠ¤íƒ€ì¼ ê°œë°œì„ ìœ„í•´ ë¦´ë¦¬ìŠ¤ ë¸Œëœì¹˜ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”:


```yaml
release_strategy:
  type: branch
  branch:
    pattern: "release/{{version}}"  # Creates release/v1.2.0
    base_branch: main               # Compare against main
    delete_after_release: true      # Cleanup after prod deploy

  auto_create:
    enabled: true
    next_version: minor
```

**ì‘ë™ ë°©ì‹:**
1. ë¦´ë¦¬ì¦ˆ ë¸Œëœì¹˜ ìƒì„±: `release/v1.2.0`
2. ë¸Œëœì¹˜ì— ë³‘í•©ëœ PRì€ ë¦´ë¦¬ì¦ˆ í›„ë³´
3. í•´ë‹¹ ë²„ì „ì— ëŒ€í•œ ìŠ¹ì¸ ìš”ì²­
4. ìŠ¹ì¸ ì´ìŠˆì— ë¦´ë¦¬ì¦ˆ ë¸Œëœì¹˜ì˜ ëª¨ë“  PR í‘œì‹œ
5. í”„ë¡œë•ì…˜ í›„ ë¸Œëœì¹˜ ì‚­ì œ(ì„ íƒ ì‚¬í•­) ë° ë‹¤ìŒ ë¸Œëœì¹˜ ìƒì„±

#### ë¼ë²¨ ì „ëµ

ìœ ì—°í•œ PR ì„ íƒì„ ìœ„í•´ ë¼ë²¨ ì‚¬ìš©:

```yaml
release_strategy:
  type: label
  label:
    pattern: "release:{{version}}"      # e.g., "release:v1.2.0"
    pending_label: "pending-release"    # Applied to merged PRs awaiting release
    remove_after_release: true          # Remove label after prod deploy

  auto_create:
    enabled: true
    next_version: patch
```

**ì‘ë™ ë°©ì‹:**
1. mainì— ë³‘í•©ëœ PRì— `pending-release` ë¼ë²¨ì´ ë¶™ìŒ
2. ë¦´ë¦¬ìŠ¤ ê´€ë¦¬ìê°€ ì„ íƒëœ PRì— `release:v1.2.0` ë¼ë²¨ì„ ì ìš©í•¨
3. v1.2.0 ìŠ¹ì¸ì„ ìš”ì²­í•¨
4. ìŠ¹ì¸ ì´ìŠˆì—ëŠ” í•´ë‹¹ ë¼ë²¨ì´ ë¶™ì€ PRë§Œ í‘œì‹œë¨
5. ìš´ì˜ ë°°í¬ í›„ ë¼ë²¨ì´ ì œê±°ë˜ê³  ë‹¤ìŒ ë¦´ë¦¬ìŠ¤ ë¼ë²¨ì´ ìƒì„±ë¨

#### ë§ˆì¼ìŠ¤í†¤ ì „ëµ

ë¡œë“œë§µì— ë§ì¶˜ ë¦´ë¦¬ìŠ¤ë¥¼ ìœ„í•´ ë§ˆì¼ìŠ¤í†¤ì„ ì‚¬ìš©í•˜ì„¸ìš”:

```yaml
release_strategy:
  type: milestone
  milestone:
    pattern: "Release {{version}}"       # e.g., "Release 1.2.0"
    close_after_release: true            # Close milestone on completion

  auto_create:
    enabled: true
    next_version: minor
    create_issue: true                   # Auto-create next approval issue
```

**ì‘ë™ ë°©ì‹:**
1. ë§ˆì¼ìŠ¤í†¤ ìƒì„±: "Release 1.2.0"
2. ê°œë°œ ì¤‘ì— PRì„ ë§ˆì¼ìŠ¤í†¤ì— í• ë‹¹
3. v1.2.0 ìŠ¹ì¸ ìš”ì²­
4. ìŠ¹ì¸ ì´ìŠˆì— ë§ˆì¼ìŠ¤í†¤ ë‚´ ëª¨ë“  PR í‘œì‹œ
5. í”„ë¡œë•ì…˜ í›„ ë§ˆì¼ìŠ¤í†¤ ì¢…ë£Œ ë° ë‹¤ìŒ ë§ˆì¼ìŠ¤í†¤ ìƒì„±

#### ì™„ë£Œ ì‹œ ìë™ ìƒì„±

ìµœì¢… ë‹¨ê³„(í”„ë¡œë•ì…˜)ê°€ ìŠ¹ì¸ë˜ë©´ ë‹¤ìŒ ë¦´ë¦¬ìŠ¤ë¥¼ ìë™ìœ¼ë¡œ ì¤€ë¹„:

```yaml
auto_create:
  enabled: true
  next_version: patch      # Calculate next: patch, minor, or major
  create_issue: true       # Create new approval issue immediately
  comment: |               # Custom message (optional)
    ğŸš€ **Next release prepared:** {{version}}
```
ì´ê²ƒì€ ë‹¤ìŒì„ ìƒì„±í•©ë‹ˆë‹¤:
- **ë¸Œëœì¹˜ ì „ëµ:** ë©”ì¸ì—ì„œ ìƒˆ ë¦´ë¦¬ìŠ¤ ë¸Œëœì¹˜ ìƒì„±
- **ë ˆì´ë¸” ì „ëµ:** ìƒˆ ë¦´ë¦¬ìŠ¤ ë ˆì´ë¸”
- **ë§ˆì¼ìŠ¤í†¤ ì „ëµ:** ìƒˆ ë§ˆì¼ìŠ¤í†¤

#### ì •ë¦¬ ì˜µì…˜

ê° ì „ëµì—ëŠ” ìµœì¢… ë‹¨ê³„(í”„ë¡œë•ì…˜)ê°€ ìŠ¹ì¸ë  ë•Œ ì‹¤í–‰ë˜ëŠ” ì„ íƒì  ì •ë¦¬ ì‘ì—…ì´ ìˆìŠµë‹ˆë‹¤. **ëª¨ë“  ì •ë¦¬ ì˜µì…˜ì€ ê¸°ë³¸ê°’ì´ `false`ì…ë‹ˆë‹¤** - ì •ë¦¬ëŠ” ì„ íƒ ì‚¬í•­ì…ë‹ˆë‹¤:

| ì „ëµ | ì •ë¦¬ ì˜µì…˜ | ì„¤ëª… |
|----------|----------------|-------------|
| ë¸Œëœì¹˜ | `delete_after_release` | ë¦´ë¦¬ìŠ¤ ë¸Œëœì¹˜ ì‚­ì œ |
| ë ˆì´ë¸” | `remove_after_release` | PRì—ì„œ ë¦´ë¦¬ìŠ¤ ë ˆì´ë¸” ì œê±° |
| ë§ˆì¼ìŠ¤í†¤ | `close_after_release` | ë§ˆì¼ìŠ¤í†¤ ë‹«ê¸° |


```yaml
release_strategy:
  type: branch
  branch:
    pattern: "release/{{version}}"
    delete_after_release: false   # Keep branch for reference (default)

  type: milestone
  milestone:
    pattern: "v{{version}}"
    close_after_release: true     # Close milestone when done
```
#### ê¸´ê¸‰ ìˆ˜ì • ë°°í¬

ì •ìƒ ë¦´ë¦¬ìŠ¤ ì›Œí¬í”Œë¡œë¥¼ ìš°íšŒí•´ì•¼ í•˜ëŠ” ê¸´ê¸‰ ìˆ˜ì •ì˜ ê²½ìš°, ë³„ë„ì˜ ì›Œí¬í”Œë¡œë¥¼ ë§Œë“­ë‹ˆë‹¤:


```yaml
# .github/approvals.yml
workflows:
  # Standard releases - full pipeline with milestone tracking
  deploy:
    description: "Standard release pipeline (dev â†’ qa â†’ stage â†’ prod)"
    pipeline:
      release_strategy:
        type: milestone
        milestone:
          pattern: "v{{version}}"
          close_after_release: true
        auto_create:
          enabled: true
          next_version: minor
      stages:
        - name: dev
          policy: developers
        - name: qa
          policy: qa-team
        - name: stage
          policy: tech-leads
        - name: prod
          policy: production-approvers
          is_final: true

  # Hotfixes - skip stages, direct to prod
  hotfix:
    description: "Emergency hotfix - direct to production"
    pipeline:
      release_strategy:
        type: tag              # Simple tag-based, no cleanup needed
        # No auto_create - hotfixes are one-off
      stages:
        - name: prod
          policy: production-approvers
          create_tag: true
          is_final: true
    on_approved:
      close_issue: true
      comment: "ğŸš¨ Hotfix {{version}} deployed to production"
```

**í•«í”½ìŠ¤ íŠ¸ë¦¬ê±° vs ì •ê·œ ë¦´ë¦¬ìŠ¤:**

```bash
# Regular release - goes through all stages
gh workflow run request-approval.yml -f workflow_name=deploy -f version=v1.3.0

# Hotfix - goes straight to prod
gh workflow run request-approval.yml -f workflow_name=hotfix -f version=v1.2.1
```
**í•«í”½ìŠ¤ íŒ¨í„´:**

| ì‹œë‚˜ë¦¬ì˜¤ | ì „ëµ | ì •ë¦¬ | ìë™ ìƒì„± |
|----------|----------|---------|-------------|
| ê¸´ê¸‰ ìˆ˜ì • | `tag` | ì—†ìŒ | ë¹„í™œì„±í™” |
| íŒ¨ì¹˜ ë¦´ë¦¬ìŠ¤ | `milestone` | `close_after_release: false` | ë¹„í™œì„±í™” |
| ë‹¤ì¤‘ í•«í”½ìŠ¤ | `branch` | `delete_after_release: false` | ë¹„í™œì„±í™” |

#### ë¦´ë¦¬ìŠ¤ ì „ëµ ì¥ì 

| ì „ëµ | ì¥ì  | ë‹¨ì  |
|----------|------|------|
| **Tag** | ê°„ë‹¨í•˜ë©° ì¶”ê°€ ì›Œí¬í”Œë¡œìš° ì—†ìŒ | ëª¨ë“  ë³‘í•©ëœ PR í¬í•¨ |
| **Branch** | ëª…í™•í•œ ë¦´ë¦¬ìŠ¤ ë²”ìœ„, ê²©ë¦¬ | ë¸Œëœì¹˜ ê´€ë¦¬ ì˜¤ë²„í—¤ë“œ |
| **Label** | ìœ ì—°í•œ ì„ íƒ, ë³€ê²½ ìš©ì´ | ìˆ˜ë™ ë¼ë²¨ë§ í•„ìš” |
| **Milestone** | ë¡œë“œë§µ ê°€ì‹œì„±, ê³„íš í†µí•© | ë§ˆì¼ìŠ¤í†¤ ê·œìœ¨ í•„ìš” |

**ê¶Œì¥ ì‚¬í•­:**

- ì—°ì† ë°°í¬ê°€ í•„ìš”í•œ ë‹¨ìˆœ í”„ë¡œì íŠ¸ì—ëŠ” **tag** ì‚¬ìš©
- ë¦´ë¦¬ìŠ¤ ê²©ë¦¬ê°€ í•„ìš”í•œ ê·œì œ í™˜ê²½ì—ëŠ” **branch** ì‚¬ìš©
- ìœ ì—°í•œ ë²”ìœ„ì˜ ì¼ê´„ ë¦´ë¦¬ìŠ¤ì—ëŠ” **label** ì‚¬ìš©
- ëª…í™•í•œ ë¦´ë¦¬ìŠ¤ ê³„íšì´ ìˆëŠ” ë¡œë“œë§µ ê¸°ë°˜ ê°œë°œì—ëŠ” **milestone** ì‚¬ìš©

### Jira í†µí•©

ì»¤ë°‹ ë° ë¸Œëœì¹˜ ì´ë¦„ì—ì„œ Jira ì´ìŠˆë¥¼ ìë™ìœ¼ë¡œ ì¶”ì¶œí•©ë‹ˆë‹¤. ì´ ì•¡ì…˜ì€ ë‘ ê°€ì§€ ëª¨ë“œë¥¼ ì§€ì›í•©ë‹ˆë‹¤:

#### ë§í¬ ì „ìš© ëª¨ë“œ (ì¸ì¦ ë¶ˆí•„ìš”)

`jira_base_url`ë§Œ ì œê³µí•˜ë©´ ì´ìŠˆ í‚¤ë¥¼ ì¶”ì¶œí•˜ì—¬ í´ë¦­ ê°€ëŠ¥í•œ ë§í¬ë¡œ í‘œì‹œí•©ë‹ˆë‹¤:


```yaml
- uses: jamengual/enterprise-approval-engine@v1
  with:
    action: request
    workflow: production-deploy
    version: v1.2.0
    token: ${{ secrets.GITHUB_TOKEN }}
    jira_base_url: https://yourcompany.atlassian.net  # That's it!
```

ì´ê²ƒì€ ì»¤ë°‹ ë©”ì‹œì§€ì™€ ë¸Œëœì¹˜ ì´ë¦„ì—ì„œ ì´ìŠˆ í‚¤(ì˜ˆ: `PROJ-123`)ë¥¼ ì¶”ì¶œí•˜ì—¬ ìŠ¹ì¸ ì´ìŠˆì— ë§í¬ë¡œ í‘œì‹œí•©ë‹ˆë‹¤:

```markdown
### Jira Issues
- [PROJ-123](https://yourcompany.atlassian.net/browse/PROJ-123)
- [PROJ-456](https://yourcompany.atlassian.net/browse/PROJ-456)
```

#### ì „ì²´ ëª¨ë“œ (API ì ‘ê·¼ í¬í•¨)

ì´ìŠˆ ì„¸ë¶€ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ê³  ìˆ˜ì • ë²„ì „ì„ ì—…ë°ì´íŠ¸í•˜ê¸° ìœ„í•´ ìê²© ì¦ëª…ì„ ì¶”ê°€í•˜ì„¸ìš”:

```yaml
- uses: jamengual/enterprise-approval-engine@v1
  with:
    action: request
    workflow: production-deploy
    version: v1.2.0
    token: ${{ secrets.GITHUB_TOKEN }}
    # Jira configuration
    jira_base_url: https://yourcompany.atlassian.net
    jira_user_email: ${{ secrets.JIRA_EMAIL }}
    jira_api_token: ${{ secrets.JIRA_API_TOKEN }}
    jira_update_fix_version: 'true'
```
ì´ê²ƒì€ ìì„¸í•œ ì´ìŠˆ ì •ë³´ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤:


```markdown
### Jira Issues in this Release

| Key | Summary | Type | Status |
|-----|---------|------|--------|
| [PROJ-123](https://...) | Fix login bug | Bug | Done |
| [PROJ-456](https://...) | Add dark mode | Feature | In Progress |
```

**ëª¨ë“œ ë¹„êµ:**

| ëª¨ë“œ | ì¸ì¦ í•„ìš” | ê¸°ëŠ¥ |
|------|-----------|------|
| ë§í¬ ì „ìš© | ì•„ë‹ˆìš” | í´ë¦­ ê°€ëŠ¥í•œ ë§í¬ë¡œ ì´ìŠˆ í‚¤ ì œê³µ |
| ì „ì²´ | ì˜ˆ | ë§í¬ + ìš”ì•½, ìƒíƒœ, ìœ í˜• ì´ëª¨ì§€, Fix Version ì—…ë°ì´íŠ¸ |

**Jira ì¶œë ¥:**

```yaml
- name: Use Jira Outputs
  run: |
    echo "Issues: ${{ steps.approval.outputs.jira_issues }}"
    # Output: PROJ-123,PROJ-456

    echo "Details: ${{ steps.approval.outputs.jira_issues_json }}"
    # Output: [{"key":"PROJ-123","summary":"Fix login bug",...}]
```

### ë°°í¬ ì¶”ì 

GitHubì˜ ë°°í¬ ëŒ€ì‹œë³´ë“œì—ì„œ ê°€ì‹œì„±ì„ ìœ„í•´ GitHub ë°°í¬ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. ì´ê²ƒì€ ì›Œí¬í”Œë¡œìš° YAMLì˜ `environment:` í‚¤ì™€ëŠ” ë…ë¦½ì ìœ¼ë¡œ ì‘ë™í•©ë‹ˆë‹¤.

```yaml
- uses: jamengual/enterprise-approval-engine@v1
  id: approval
  with:
    action: request
    workflow: production-deploy
    version: v1.2.0
    token: ${{ secrets.GITHUB_TOKEN }}
    # Deployment tracking
    create_deployment: 'true'
    deployment_environment: production
    deployment_environment_url: https://myapp.example.com

- name: Update Deployment Status
  if: steps.approval.outputs.status == 'approved'
  run: |
    # Use the deployment_id to update status after actual deployment
    echo "Deployment ID: ${{ steps.approval.outputs.deployment_id }}"
```

**ë°°í¬ê°€ í‘œì‹œë˜ëŠ” ìœ„ì¹˜:**

- ì €ì¥ì†Œì˜ **ë°°í¬(Deployments)** íƒ­
- ì €ì¥ì†Œ í˜ì´ì§€ì˜ í™˜ê²½ ìƒíƒœ ë°°ì§€
- GitHub for Jira í†µí•©(êµ¬ì„±ëœ ê²½ìš°)
- CI/CD ë„êµ¬ìš© GitHub API

**ì°¸ê³ :** ì´ëŠ” GitHubì˜ ê¸°ë³¸ í™˜ê²½ ë³´í˜¸ ê·œì¹™ê³¼ ë³„ê°œì¸ GitHub ë°°í¬ APIë¥¼ í†µí•´ ë°°í¬ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. ë‘ ê°€ì§€ë¥¼ í•¨ê»˜ ë˜ëŠ” ë…ë¦½ì ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ì™¸ë¶€ êµ¬ì„± ì €ì¥ì†Œ

ì¤‘ì•™ ì§‘ì¤‘ì‹ ì •ì±… ê´€ë¦¬ë¥¼ ìœ„í•´ ìŠ¹ì¸ê°€ êµ¬ì„±ì„ ê³µìœ  ì €ì¥ì†Œì— ì €ì¥:

```yaml
- uses: jamengual/enterprise-approval-engine@v1
  with:
    action: request
    workflow: production-deploy
    token: ${{ secrets.GITHUB_TOKEN }}
    config_repo: myorg/.github  # Shared config repo
```

**êµ¬ì„± í•´ì„ ìˆœì„œ:**

1. ì™¸ë¶€ ì €ì¥ì†Œì˜ `{repo-name}_approvals.yml` (ì˜ˆ: `myapp_approvals.yml`)
2. ì™¸ë¶€ ì €ì¥ì†Œì˜ `approvals.yml` (ê³µìœ  ê¸°ë³¸ê°’)
3. í˜„ì¬ ì €ì¥ì†Œì˜ `.github/approvals.yml` (ë¡œì»¬ ëŒ€ì²´)

**ì˜ˆì‹œ ì¡°ì§ êµ¬ì¡°:**

```text
myorg/.github/
â”œâ”€â”€ myapp_approvals.yml      # App-specific config
â”œâ”€â”€ backend_approvals.yml    # Backend repos config
â””â”€â”€ approvals.yml            # Default for all repos
```

### ìŠ¹ì¸ ì°¨ë‹¨

ìŠ¹ì¸ ëŒ€ê¸° í›„ ì§„í–‰í•´ì•¼ í•˜ëŠ” ì›Œí¬í”Œë¡œìš°ì˜ ê²½ìš°:

```yaml
name: Deploy with Blocking Approval

on:
  workflow_dispatch:
    inputs:
      version:
        required: true
        type: string

jobs:
  request-approval:
    runs-on: ubuntu-latest
    outputs:
      issue_number: ${{ steps.request.outputs.issue_number }}
    steps:
      - uses: actions/checkout@v4
      - uses: jamengual/enterprise-approval-engine@v1
        id: request
        with:
          action: request
          workflow: production-deploy
          version: ${{ inputs.version }}
          token: ${{ secrets.GITHUB_TOKEN }}

  wait-for-approval:
    needs: request-approval
    runs-on: ubuntu-latest
    outputs:
      status: ${{ steps.check.outputs.status }}
      tag: ${{ steps.check.outputs.tag }}
    steps:
      - uses: actions/checkout@v4
      - uses: jamengual/enterprise-approval-engine@v1
        id: check
        with:
          action: check
          issue_number: ${{ needs.request-approval.outputs.issue_number }}
          wait: 'true'           # Poll until approved/denied
          timeout: '4h'          # Max wait time
          token: ${{ secrets.GITHUB_TOKEN }}

  deploy:
    needs: [request-approval, wait-for-approval]
    if: needs.wait-for-approval.outputs.status == 'approved'
    runs-on: ubuntu-latest
    steps:
      - name: Deploy
        run: |
          echo "Deploying ${{ needs.wait-for-approval.outputs.tag }}"
```

**ì°¸ê³ :** ì°¨ë‹¨ ì›Œí¬í”Œë¡œìš°ëŠ” ëŸ¬ë„ˆë¥¼ í™œì„± ìƒíƒœë¡œ ìœ ì§€í•˜ì—¬ GitHub Actions ì‚¬ìš© ì‹œê°„ì„ ì†Œëª¨í•©ë‹ˆë‹¤. ë¹„ìš©ì— ë¯¼ê°í•œ ì‹œë‚˜ë¦¬ì˜¤ì—ì„œëŠ” ì´ë²¤íŠ¸ ê¸°ë°˜ ì ‘ê·¼ ë°©ì‹(ë³„ë„ì˜ `process-comment` ì›Œí¬í”Œë¡œìš°)ì„ ì‚¬ìš©í•˜ì„¸ìš”.

### ì´ìŠˆ ì¢…ë£Œ ì‹œ íƒœê·¸ ì‚­ì œ

ìŠ¹ì¸ ì´ìŠˆê°€ ìˆ˜ë™ìœ¼ë¡œ ì¢…ë£Œë  ë•Œ ì„ íƒì ìœ¼ë¡œ íƒœê·¸ë¥¼ ì‚­ì œí•©ë‹ˆë‹¤:

```yaml
workflows:
  dev-deploy:
    on_closed:
      delete_tag: true   # Delete tag when issue is closed
      comment: "Cancelled. Tag {{tag}} deleted."

  production-deploy:
    on_closed:
      delete_tag: false  # NEVER delete production tags
```

**ë‹«ê¸° ì´ë²¤íŠ¸ ì²˜ë¦¬:**

```yaml
# .github/workflows/handle-close.yml
name: Handle Issue Close

on:
  issues:
    types: [closed]

jobs:
  handle:
    if: contains(github.event.issue.labels.*.name, 'approval-required')
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: jamengual/enterprise-approval-engine@v1
        id: close
        with:
          action: close-issue
          issue_number: ${{ github.event.issue.number }}
          issue_action: ${{ github.event.action }}
          token: ${{ secrets.GITHUB_TOKEN }}

      - name: Report
        run: |
          echo "Status: ${{ steps.close.outputs.status }}"
          echo "Deleted tag: ${{ steps.close.outputs.tag_deleted }}"
```

---

## Complete Examples

### Full-Featured Request Workflow

```yaml
name: Request Production Deployment

on:
  workflow_dispatch:
    inputs:
      version:
        description: 'Version to deploy'
        required: true
        type: string
      environment:
        description: 'Target environment'
        required: true
        type: choice
        options: [staging, production]

permissions:
  contents: write
  issues: write
  deployments: write

jobs:
  request:
    runs-on: ubuntu-latest
    outputs:
      issue_number: ${{ steps.approval.outputs.issue_number }}
      issue_url: ${{ steps.approval.outputs.issue_url }}
      deployment_id: ${{ steps.approval.outputs.deployment_id }}
      jira_issues: ${{ steps.approval.outputs.jira_issues }}
    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0  # Needed for commit comparison

      - uses: jamengual/enterprise-approval-engine@v1
        id: approval
        with:
          action: request
          workflow: ${{ inputs.environment }}-deploy
          version: ${{ inputs.version }}
          token: ${{ secrets.GITHUB_TOKEN }}
          # Jira integration
          jira_base_url: https://mycompany.atlassian.net
          jira_user_email: ${{ secrets.JIRA_EMAIL }}
          jira_api_token: ${{ secrets.JIRA_API_TOKEN }}
          # Deployment tracking
          create_deployment: 'true'
          deployment_environment: ${{ inputs.environment }}
          deployment_environment_url: https://${{ inputs.environment }}.myapp.com

      - name: Summary
        run: |
          echo "## Approval Request Created" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "- **Issue:** #${{ steps.approval.outputs.issue_number }}" >> $GITHUB_STEP_SUMMARY
          echo "- **URL:** ${{ steps.approval.outputs.issue_url }}" >> $GITHUB_STEP_SUMMARY
          echo "- **Jira Issues:** ${{ steps.approval.outputs.jira_issues }}" >> $GITHUB_STEP_SUMMARY
          echo "- **Commits:** ${{ steps.approval.outputs.commits_count }}" >> $GITHUB_STEP_SUMMARY
```

### íŒ€ ì§€ì›ê³¼ í•¨ê»˜ í”„ë¡œì„¸ìŠ¤ ì˜ê²¬ ì²˜ë¦¬

```yaml
name: Handle Approval Comments

on:
  issue_comment:
    types: [created]

permissions:
  contents: write
  issues: write

jobs:
  process:
    if: |
      github.event.issue.pull_request == null &&
      contains(github.event.issue.labels.*.name, 'approval-required')
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      # Generate GitHub App token for team membership checks
      - uses: actions/create-github-app-token@v2
        id: app-token
        with:
          app-id: ${{ vars.APP_ID }}
          private-key: ${{ secrets.APP_PRIVATE_KEY }}

      - uses: jamengual/enterprise-approval-engine@v1
        id: process
        with:
          action: process-comment
          issue_number: ${{ github.event.issue.number }}
          token: ${{ steps.app-token.outputs.token }}
          # Jira integration to update Fix Version on approval
          jira_base_url: https://mycompany.atlassian.net
          jira_user_email: ${{ secrets.JIRA_EMAIL }}
          jira_api_token: ${{ secrets.JIRA_API_TOKEN }}

      - name: Trigger Deployment
        if: steps.process.outputs.status == 'approved'
        uses: actions/github-script@v7
        with:
          script: |
            await github.rest.actions.createWorkflowDispatch({
              owner: context.repo.owner,
              repo: context.repo.repo,
              workflow_id: 'deploy.yml',
              ref: 'main',
              inputs: { version: '${{ steps.process.outputs.tag }}' }
            });
```

### ë‹¤ì¤‘ í™˜ê²½ í”„ë¡œëª¨ì…˜

```yaml
# .github/approvals.yml
version: 1

policies:
  dev-team:
    approvers: [dev1, dev2, dev3]
    min_approvals: 1

  qa-team:
    approvers: [qa1, qa2]
    min_approvals: 1

  prod-team:
    approvers: [team:sre, tech-lead]
    min_approvals: 2

workflows:
  dev-deploy:
    require:
      - policy: dev-team
    on_approved:
      tagging:
        enabled: true
        auto_increment: patch
        env_prefix: "dev-"
      close_issue: true

  staging-deploy:
    require:
      - policy: qa-team
    on_approved:
      tagging:
        enabled: true
        auto_increment: minor
        env_prefix: "staging-"
      close_issue: true

  production-deploy:
    require:
      - policy: prod-team
    on_approved:
      create_tag: true
      close_issue: true
    on_closed:
      delete_tag: false  # Never delete production tags
```

### í›„ì† ì‘ì—…ì—ì„œ ì¶œë ¥ë¬¼ ì‚¬ìš©í•˜ê¸°

```yaml
name: Deploy with Approval

on:
  workflow_dispatch:
    inputs:
      version:
        required: true

jobs:
  approval:
    runs-on: ubuntu-latest
    outputs:
      status: ${{ steps.check.outputs.status }}
      tag: ${{ steps.check.outputs.tag }}
      approvers: ${{ steps.check.outputs.approvers }}
      jira_issues: ${{ steps.request.outputs.jira_issues }}
    steps:
      - uses: actions/checkout@v4

      - uses: jamengual/enterprise-approval-engine@v1
        id: request
        with:
          action: request
          workflow: production-deploy
          version: ${{ inputs.version }}
          token: ${{ secrets.GITHUB_TOKEN }}
          jira_base_url: https://mycompany.atlassian.net

      - uses: jamengual/enterprise-approval-engine@v1
        id: check
        with:
          action: check
          issue_number: ${{ steps.request.outputs.issue_number }}
          wait: 'true'
          timeout: '2h'
          token: ${{ secrets.GITHUB_TOKEN }}

  deploy:
    needs: approval
    if: needs.approval.outputs.status == 'approved'
    runs-on: ubuntu-latest
    environment: production
    steps:
      - name: Deploy
        run: |
          echo "Deploying ${{ needs.approval.outputs.tag }}"
          echo "Approved by: ${{ needs.approval.outputs.approvers }}"
          echo "Jira Issues: ${{ needs.approval.outputs.jira_issues }}"

  notify:
    needs: [approval, deploy]
    if: always()
    runs-on: ubuntu-latest
    steps:
      - name: Notify Slack
        run: |
          if [ "${{ needs.approval.outputs.status }}" == "approved" ]; then
            echo "Deployment of ${{ needs.approval.outputs.tag }} completed!"
          else
            echo "Deployment was ${{ needs.approval.outputs.status }}"
          fi
```

---

## Schema Validation

Validate your configuration using the JSON schema:

```yaml
# .github/approvals.yml
# yaml-language-server: $schema=https://raw.githubusercontent.com/jamengual/enterprise-approval-engine/main/schema.json

version: 1

policies:
  # ... your config
```

ë˜ëŠ” CIì—ì„œ ê²€ì¦:

```yaml
- name: Validate Config
  run: |
    npm install -g ajv-cli
    ajv validate -s schema.json -d .github/approvals.yml
```

---

## GitHub Enterprise Server

ì´ ì•¡ì…˜ì€ GitHub Enterprise Serverë¥¼ ì™„ë²½í•˜ê²Œ ì§€ì›í•©ë‹ˆë‹¤. `GITHUB_SERVER_URL` ë° `GITHUB_API_URL` í™˜ê²½ ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ GHES í™˜ê²½ì„ ìë™ìœ¼ë¡œ ê°ì§€í•©ë‹ˆë‹¤.

ì¶”ê°€ êµ¬ì„± ì—†ì´ë„ ì•¡ì…˜ì´ ìë™ìœ¼ë¡œ ì˜¬ë°”ë¥¸ API ì—”ë“œí¬ì¸íŠ¸ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

**ì†ë„ ì œí•œ:**

ì´ ì•¡ì…˜ì€ ì†ë„ ì œí•œ ì˜¤ë¥˜ì— ëŒ€í•´ ì§€ìˆ˜ ë°±ì˜¤í”„ë¥¼ ì‚¬ìš©í•˜ëŠ” ìë™ ì¬ì‹œë„ë¥¼ í¬í•¨í•©ë‹ˆë‹¤. êµ¬ì„±:

- ì´ˆê¸° ì§€ì—°: 1ì´ˆ
- ìµœëŒ€ ì§€ì—°: 60ì´ˆ
- ìµœëŒ€ ì¬ì‹œë„ íšŸìˆ˜: 5íšŒ
- ì§€í„°: ë¬´ì‘ìœ„ 0-500msë¥¼ ì¶”ê°€í•˜ì—¬ ë™ì‹œ í­ì£¼ ë°©ì§€

---

## ë¼ì´ì„ ìŠ¤

MIT ë¼ì´ì„ ìŠ¤


---

Tranlated By [Open Ai Tx](https://github.com/OpenAiTx/OpenAiTx) | Last indexed: 2025-12-22

---