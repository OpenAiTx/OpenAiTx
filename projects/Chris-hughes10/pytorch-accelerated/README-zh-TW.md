<div align="right">
  <details>
    <summary >ğŸŒ èªè¨€</summary>
    <div>
      <div align="center">
        <a href="https://openaitx.github.io/view.html?user=Chris-hughes10&project=pytorch-accelerated&lang=en">English</a>
        | <a href="https://openaitx.github.io/view.html?user=Chris-hughes10&project=pytorch-accelerated&lang=zh-CN">ç°¡é«”ä¸­æ–‡</a>
        | <a href="https://openaitx.github.io/view.html?user=Chris-hughes10&project=pytorch-accelerated&lang=zh-TW">ç¹é«”ä¸­æ–‡</a>
        | <a href="https://openaitx.github.io/view.html?user=Chris-hughes10&project=pytorch-accelerated&lang=ja">æ—¥æœ¬èª</a>
        | <a href="https://openaitx.github.io/view.html?user=Chris-hughes10&project=pytorch-accelerated&lang=ko">éŸ“åœ‹èª</a>
        | <a href="https://openaitx.github.io/view.html?user=Chris-hughes10&project=pytorch-accelerated&lang=hi">å°åœ°èª</a>
        | <a href="https://openaitx.github.io/view.html?user=Chris-hughes10&project=pytorch-accelerated&lang=th">æ³°èª</a>
        | <a href="https://openaitx.github.io/view.html?user=Chris-hughes10&project=pytorch-accelerated&lang=fr">æ³•èª</a>
        | <a href="https://openaitx.github.io/view.html?user=Chris-hughes10&project=pytorch-accelerated&lang=de">å¾·èª</a>
        | <a href="https://openaitx.github.io/view.html?user=Chris-hughes10&project=pytorch-accelerated&lang=es">è¥¿ç­ç‰™èª</a>
        | <a href="https://openaitx.github.io/view.html?user=Chris-hughes10&project=pytorch-accelerated&lang=it">ç¾©å¤§åˆ©èª</a>
        | <a href="https://openaitx.github.io/view.html?user=Chris-hughes10&project=pytorch-accelerated&lang=ru">ä¿„èª</a>
        | <a href="https://openaitx.github.io/view.html?user=Chris-hughes10&project=pytorch-accelerated&lang=pt">è‘¡è„ç‰™èª</a>
        | <a href="https://openaitx.github.io/view.html?user=Chris-hughes10&project=pytorch-accelerated&lang=nl">è·è˜­èª</a>
        | <a href="https://openaitx.github.io/view.html?user=Chris-hughes10&project=pytorch-accelerated&lang=pl">æ³¢è˜­èª</a>
        | <a href="https://openaitx.github.io/view.html?user=Chris-hughes10&project=pytorch-accelerated&lang=ar">é˜¿æ‹‰ä¼¯èª</a>
        | <a href="https://openaitx.github.io/view.html?user=Chris-hughes10&project=pytorch-accelerated&lang=fa">æ³¢æ–¯èª</a>
        | <a href="https://openaitx.github.io/view.html?user=Chris-hughes10&project=pytorch-accelerated&lang=tr">åœŸè€³å…¶èª</a>
        | <a href="https://openaitx.github.io/view.html?user=Chris-hughes10&project=pytorch-accelerated&lang=vi">è¶Šå—èª</a>
        | <a href="https://openaitx.github.io/view.html?user=Chris-hughes10&project=pytorch-accelerated&lang=id">å°å°¼èª</a>
        | <a href="https://openaitx.github.io/view.html?user=Chris-hughes10&project=pytorch-accelerated&lang=as">é˜¿è–©å§†èª</
      </div>
    </div>
  </details>
</div>

# pytorch-accelerated

`pytorch-accelerated` æ˜¯ä¸€å€‹è¼•é‡ç´šçš„å‡½å¼åº«ï¼Œæ—¨åœ¨åŠ é€Ÿ PyTorch æ¨¡å‹è¨“ç·´æµç¨‹ï¼Œ
é€éæä¾›ä¸€å€‹æ¥µç°¡ä½†å¯æ“´å±•çš„è¨“ç·´è¿´åœˆ â€”â€” å°è£æ–¼å–®ä¸€ `Trainer`
ç‰©ä»¶ä¸­ â€”â€” é€™å€‹ç‰©ä»¶è¶³å¤ éˆæ´»ï¼Œèƒ½æ‡‰å°å¤§å¤šæ•¸ä½¿ç”¨æƒ…å¢ƒï¼Œä¸¦ä¸”èƒ½åœ¨ä¸åŒç¡¬é«”
é¸é …ä¸‹é‹è¡Œï¼Œç„¡éœ€ä¿®æ”¹ä»»ä½•ç¨‹å¼ç¢¼ã€‚
 
`pytorch-accelerated` æä¾›ç²¾ç°¡çš„åŠŸèƒ½é›†ï¼Œä¸¦æ¥µåº¦å¼·èª¿ **ç°¡æ½”** èˆ‡ **é€æ˜åº¦**ï¼Œ

è®“ä½¿ç”¨è€…èƒ½å¤ å®Œå…¨ç†è§£åº•å±¤ç™¼ç”Ÿäº†ä»€éº¼äº‹ï¼ŒåŒæ™‚ä¸éœ€è¦è‡ªå·±æ’°å¯«å’Œç¶­è­·æ¨£æ¿ç¨‹å¼ç¢¼ï¼
   
ä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼š
- ä¸€å€‹ç°¡å–®ä¸”å°é–‰ï¼Œä½†æ˜“æ–¼è‡ªè¨‚çš„è¨“ç·´è¿´åœˆï¼Œåœ¨ä¸€èˆ¬æƒ…æ³ä¸‹å¯ç›´æ¥ä½¿ç”¨ï¼›
  è¡Œç‚ºå¯é€éç¹¼æ‰¿å’Œ/æˆ–å›å‘¼å‡½å¼é€²è¡Œè‡ªè¨‚ã€‚
- è™•ç†è£ç½®éƒ¨ç½²ã€æ··åˆç²¾åº¦ã€DeepSpeedæ•´åˆã€å¤šGPUåŠåˆ†å¸ƒå¼è¨“ç·´ï¼Œç„¡éœ€æ›´å‹•ä»»ä½•ç¨‹å¼ç¢¼ã€‚
- æ¡ç”¨ç´” PyTorch çµ„ä»¶ï¼Œç„¡éœ€é¡å¤–ä¿®æ”¹æˆ–åŒ…è£ï¼Œä¸¦å¯è¼•é¬†èˆ‡å…¶ä»–ç†±é–€å‡½å¼åº«å¦‚ [timm](https://github.com/rwightman/pytorch-image-models)ã€ 
  [transformers](https://huggingface.co/transformers/) åŠ [torchmetrics](https://torchmetrics.readthedocs.io/en/latest/) äº’æ“ä½œã€‚
- ç²¾ç°¡çš„ API ç¢ºä¿ç¾æœ‰ PyTorch ä½¿ç”¨è€…å¹¾ä¹ç„¡éœ€å­¸ç¿’é–€æª»ã€‚

æˆ‘å€‘æŠ•å…¥å¤§é‡å¿ƒåŠ›ç¢ºä¿å‡½å¼åº«çš„æ¯å€‹éƒ¨åˆ†â€”â€”åŒ…æ‹¬å…§éƒ¨èˆ‡å¤–éƒ¨çµ„ä»¶â€”â€”éƒ½ç›¡å¯èƒ½æ¸…æ¥šä¸”ç°¡å–®ï¼Œ
ä½¿å…¶æ˜“æ–¼è‡ªè¨‚ã€é™¤éŒ¯ä¸¦èƒ½å®Œå…¨ç†è§£æ¯ä¸€æ­¥èƒŒå¾Œçš„é‹ä½œï¼›è¨“ç·´å™¨çš„ä¸»è¦è¡Œç‚ºéƒ½å°è£åœ¨å–®ä¸€é¡åˆ¥å…§ï¼
ç§‰æŒ Python ç²¾ç¥ï¼Œæ²’æœ‰ä»»ä½•æ±è¥¿è¢«éš±è—ï¼Œä¸€åˆ‡çš†å¯å­˜å–ã€‚

`pytorch-accelerated` å ‚å ‚æ­£æ­£ä¸”é€æ˜åœ°å»ºæ§‹æ–¼
[Hugging Face Accelerate](https://github.com/huggingface/accelerate) ä¹‹ä¸Šï¼Œè² è²¬
è£ç½®é–“è³‡æ–™ç§»å‹•åŠè¨“ç·´é…ç½®å•Ÿå‹•ã€‚ç•¶è‡ªè¨‚è¨“ç·´å™¨æˆ–å•Ÿå‹•è¨“ç·´æ™‚ï¼Œ
å»ºè­°ä½¿ç”¨è€…åƒè€ƒ [Accelerate æ–‡ä»¶](https://huggingface.co/docs/accelerate/)
ä»¥äº†è§£æ‰€æœ‰å¯ç”¨é¸é …ï¼›Accelerate æä¾›æ–¹ä¾¿çš„å‡½å¼ï¼Œå¦‚å¼µé‡æ”¶é›†åŠæ¢¯åº¦æˆªæ–·ï¼Œ
å…¶ä½¿ç”¨æ–¹å¼å¯æ–¼ `pytorch-accelerated`
[ç¯„ä¾‹](https://github.com/Chris-hughes10/pytorch-accelerated/tree/main/examples) è³‡æ–™å¤¾ä¸­çœ‹åˆ°ï¼

è‹¥æƒ³äº†è§£é€™å€‹å‡½å¼åº«èƒŒå¾Œçš„å‹•æ©Ÿï¼Œä»¥åŠè©³ç´°çš„å…¥é–€æŒ‡å—ï¼Œè«‹åƒé–± [é€™ç¯‡éƒ¨è½æ ¼æ–‡ç« ](https://medium.com/@chris.p.hughes10/introducing-pytorch-accelerated-6ba99530608c?source=friends_link&sk=868c2d2ec5229fdea42877c0bf82b968)ã€‚

## å®‰è£

å¯é€é pip ä½¿ç”¨ä»¥ä¸‹æŒ‡ä»¤å®‰è£ `pytorch-accelerated`ï¼š


```
pip install pytorch-accelerated
```
ç‚ºäº†ä½¿å¥—ä»¶ç›¡å¯èƒ½ç²¾ç°¡ï¼Œé è¨­æƒ…æ³ä¸‹ä¸æœƒåŒ…å«åŸ·è¡Œç¯„ä¾‹æ‰€éœ€çš„å¥—ä»¶ã€‚è‹¥è¦åŒ…å«é€™äº›å¥—ä»¶ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æŒ‡ä»¤ï¼š

```
pip install pytorch-accelerated[examples]
```

## å¿«é€Ÿå…¥é–€

è¦é–‹å§‹ä½¿ç”¨ï¼Œåªéœ€æŒ‰ç…§ä»¥ä¸‹ç¯„ä¾‹åŒ¯å…¥ä¸¦ä½¿ç”¨ pytorch-accelerated çš„ `Trainer`ï¼Œ
ç„¶å¾Œä½¿ç”¨ä¸‹æ–¹èªªæ˜çš„ 
[accelerate CLI](https://huggingface.co/docs/accelerate/quicktour.html#launching-your-distributed-script)
å•Ÿå‹•è¨“ç·´å³å¯ã€‚

```python
# examples/core/train_mnist.py
import os

from torch import nn, optim
from torch.utils.data import random_split
from torchvision import transforms
from torchvision.datasets import MNIST

from pytorch_accelerated import Trainer

class MNISTModel(nn.Module):
    def __init__(self):
        super().__init__()
        self.main = nn.Sequential(
            nn.Linear(in_features=784, out_features=128),
            nn.ReLU(),
            nn.Linear(in_features=128, out_features=64),
            nn.ReLU(),
            nn.Linear(in_features=64, out_features=10),
        )

    def forward(self, input):
        return self.main(input.view(input.shape[0], -1))

def main():
    dataset = MNIST(os.getcwd(), download=True, transform=transforms.ToTensor())
    train_dataset, validation_dataset, test_dataset = random_split(dataset, [50000, 5000, 5000])
    model = MNISTModel()
    optimizer = optim.SGD(model.parameters(), lr=0.001, momentum=0.9)
    loss_func = nn.CrossEntropyLoss()

    trainer = Trainer(
            model,
            loss_func=loss_func,
            optimizer=optimizer,
    )

    trainer.train(
        train_dataset=train_dataset,
        eval_dataset=validation_dataset,
        num_epochs=8,
        per_device_batch_size=32,
    )

    trainer.evaluate(
        dataset=test_dataset,
        per_device_batch_size=64,
    )
    
if __name__ == "__main__":
    main()
```
è¦ä½¿ç”¨ [accelerate CLI](https://huggingface.co/docs/accelerate/quicktour.html#launching-your-distributed-script) å•Ÿå‹•è¨“ç·´ï¼Œ
è«‹åœ¨æ‚¨çš„æ©Ÿå™¨ä¸ŠåŸ·è¡Œï¼š

` accelerate config --config_file accelerate_config.yaml`

ä¸¦å›ç­”æ‰€æå‡ºçš„å•é¡Œã€‚é€™å°‡ç”Ÿæˆä¸€å€‹é…ç½®æª”æ¡ˆï¼Œæœƒåœ¨åŸ·è¡Œä»¥ä¸‹æ“ä½œæ™‚ç”¨æ–¼æ­£ç¢ºè¨­ç½®é è¨­é¸é …ï¼š

`accelerate launch --config_file accelerate_config.yaml train.py [--training-args]`

*æ³¨æ„*ï¼šä½¿ç”¨ [accelerate CLI](https://huggingface.co/docs/accelerate/quicktour.html#launching-your-distributed-script) å®Œå…¨æ˜¯å¯é¸çš„ï¼Œè¨“ç·´ä¹Ÿå¯ä»¥ç”¨å¸¸è¦æ–¹å¼å•Ÿå‹•ï¼š

`python train.py` / `python -m torch.distributed ...`

æ ¹æ“šæ‚¨çš„åŸºç¤è¨­æ–½é…ç½®ï¼Œé©ç”¨æ–¼å¸Œæœ›æ›´ç´°ç·»æ§åˆ¶å•Ÿå‹•å‘½ä»¤çš„ä½¿ç”¨è€…ã€‚

æ›´è¤‡é›œçš„è¨“ç·´ç¯„ä¾‹å¯åœ¨ç¯„ä¾‹è³‡æ–™å¤¾
[é€™è£¡](https://github.com/Chris-hughes10/pytorch-accelerated/tree/main/examples) æ‰¾åˆ°ã€‚

å¦å¤–ï¼Œå¦‚æœæ‚¨å¸Œæœ›å…ˆäº†è§£æ ¸å¿ƒæ¦‚å¿µï¼Œå¯åƒé–± [æ–‡ä»¶](https://pytorch-accelerated.readthedocs.io/en/latest/)ã€‚

## ä½¿ç”¨æ–¹æ³•

### pytorch-accelerated é©åˆå“ªäº›äººï¼Ÿ

- ç†Ÿæ‚‰ PyTorch çš„ä½¿ç”¨è€…ï¼Œä½†å¸Œæœ›é¿å…æ’°å¯«å¸¸è¦‹çš„è¨“ç·´è¿´åœˆæ¨£æ¿ï¼Œå°ˆæ³¨æ–¼è¨“ç·´è¿´åœˆçš„æœ‰è¶£éƒ¨åˆ†ã€‚
- å–œæ­¡ä¸¦ç¿’æ…£è‡ªå·±é¸æ“‡åŠå‰µå»ºæ¨¡å‹ã€æå¤±å‡½æ•¸ã€å„ªåŒ–å™¨å’Œè³‡æ–™é›†çš„ä½¿ç”¨è€…ã€‚
- é‡è¦–ç°¡å–®ä¸”ç²¾ç°¡åŠŸèƒ½é›†ï¼Œè¡Œç‚ºå®¹æ˜“é™¤éŒ¯ã€ç†è§£å’Œæ¨ç†çš„ä½¿ç”¨è€…ï¼

### ä»€éº¼æƒ…æ³ä¸‹ä¸é©åˆä½¿ç”¨ pytorch-acceleratedï¼Ÿ

- å¦‚æœæ‚¨å°‹æ‰¾çš„æ˜¯ç«¯åˆ°ç«¯è§£æ±ºæ–¹æ¡ˆï¼Œæ¶µè“‹å¾è³‡æ–™è¼‰å…¥åˆ°æ¨è«–ï¼Œ
  ä¸¦å”åŠ©æ‚¨é¸æ“‡æ¨¡å‹ã€å„ªåŒ–å™¨æˆ–æå¤±å‡½æ•¸ï¼Œæ‚¨å¯èƒ½æœƒæ›´é©åˆ
  [fastai](https://github.com/fastai/fastai)ã€‚`pytorch-accelerated` åªå°ˆæ³¨æ–¼è¨“ç·´éç¨‹ï¼Œå…¶ä»–
  éƒ¨åˆ†å‰‡ç”±ä½¿ç”¨è€…è‡ªè¡Œè² è²¬ã€‚
- å¦‚æœæ‚¨æƒ³è‡ªå·±æ’°å¯«å®Œæ•´çš„è¨“ç·´è¿´åœˆï¼Œåªæ˜¯ä¸æƒ³è™•ç†è¨­å‚™ç®¡ç†çš„éº»ç…©ï¼Œ
æ‚¨å¯èƒ½æœƒæ›´é©åˆç›´æ¥ä½¿ç”¨ [Accelerate](https://github.com/huggingface/accelerate)ï¼å„˜ç®¡
å¯ä»¥è‡ªè¨‚ `Trainer` çš„æ¯å€‹éƒ¨åˆ†ï¼Œè¨“ç·´è¿´åœˆåŸºæœ¬ä¸Šè¢«æ‹†åˆ†ç‚ºæ•¸å€‹



ä½ éœ€è¦è¦†å¯«ä¸åŒçš„æ–¹æ³•ã€‚ä½†ï¼Œåœ¨ä½ é–‹å§‹ä¹‹å‰ï¼Œå¯«é‚£äº› `for` è¿´åœˆçœŸçš„é‡è¦åˆ°å€¼å¾—ä½ *å†æ¬¡*å¾é ­é–‹å§‹å— ğŸ˜‰ã€‚
- å¦‚æœä½ æ­£åœ¨è™•ç†ä¸€å€‹è‡ªè¨‚ä¸”é«˜åº¦è¤‡é›œçš„ç”¨ä¾‹ï¼Œç„¡æ³•å¥—ç”¨ä¸€èˆ¬è¨“ç·´è¿´åœˆçš„æ¨¡å¼ï¼Œä¸¦ä¸”å¸Œæœ›åœ¨æ‰€é¸ç¡¬é«”ä¸Šæ¦¨å–æ¯ä¸€åˆ†æ•ˆèƒ½ï¼Œé‚£éº¼ä½ å¾ˆå¯èƒ½æœ€å¥½é‚„æ˜¯å …æŒä½¿ç”¨åŸç”Ÿ PyTorchï¼›ä»»ä½•é«˜éš API åœ¨é«˜åº¦å°ˆæ¥­åŒ–çš„æƒ…å¢ƒä¸‹éƒ½æœƒè®Šæˆé¡å¤–è² æ“”ï¼


## è‡´è¬

`pytorch-accelerated` åœ¨è¨­è¨ˆèˆ‡åŠŸèƒ½ä¸Šï¼Œæ·±å—è¨±å¤šå„ªç§€å‡½å¼åº«èˆ‡æ¡†æ¶çš„å•Ÿç™¼ï¼Œä¾‹å¦‚ [fastai](https://github.com/fastai/fastai)ã€[timm](https://github.com/rwightman/pytorch-image-models)ã€[PyTorch-lightning](https://github.com/PyTorchLightning/pytorch-lightning) ä»¥åŠ [Hugging Face Accelerate](https://github.com/huggingface/accelerate)ã€‚é€™äº›å·¥å…·å°æœ¬å‡½å¼åº«åŠæ•´å€‹æ©Ÿå™¨å­¸ç¿’ç¤¾ç¾¤å¸¶ä¾†äº†å·¨å¤§å½±éŸ¿ï¼Œä»–å€‘çš„è²¢ç»ä¸å¯è¨€å–»ï¼

`pytorch-accelerated` åƒ…å¾é€™äº›å·¥å…·ä¸­ç²å–éˆæ„Ÿï¼Œæ‰€æœ‰åŠŸèƒ½çš†å¾é›¶é–‹å§‹å¯¦ä½œï¼Œä»¥æœ€å¤§åŒ–æœ¬å‡½å¼åº«çš„æ•ˆç›Šã€‚å”¯ä¸€çš„ä¾‹å¤–æ˜¯éƒ¨ä»½ä½æ–¼ [examples](https://github.com/Chris-hughes10/pytorch-accelerated/tree/main/examples) è³‡æ–™å¤¾ä¸­çš„è…³æœ¬ï¼Œé€™äº›è…³æœ¬å–è‡ªç¾æœ‰è³‡æºä¸¦ç¶“éä¿®æ”¹ï¼Œç”¨ä»¥å±•ç¤º `pytorch-accelerated` çš„ç‰¹è‰²ï¼›
é€™é¡æƒ…æ³çš†æœ‰æ˜ç¢ºæ¨™è¨»ï¼Œä¸¦å‘åŸä½œè€…è‡´ä¸Šè¬æ„ã€‚













---

Tranlated By [Open Ai Tx](https://github.com/OpenAiTx/OpenAiTx) | Last indexed: 2026-02-28

---