# Ventoy CPIO

[Ventoy](https://github.com/ventoy/Ventoy) の代替ラムディスク。

ドキュメントは[こちら](https://github.com/fnr1r/ventoy-meta/tree/main/docs)、
リリースは[こちら](https://github.com/fnr1r/ventoy-cpio/releases)から入手可能です。

注意：これはVentoyにまとも（に近い）なビルドシステムを追加しようとした試みの
ほんの一部です。私のVentoy関連プロジェクトのインデックスは
[こちら](https://github.com/fnr1r/ventoy-meta)にあります。

## 目標

Ventoyの代替ラムディスクを作成する

- [?] まとも（に近い）なビルドシステムで
- [x] ブート可能なもの
- [ ] 機能的に同等なもの  
  （つまり、上流と同じことができるもの）
- [x] より小さいもの

### 非目標

- ❌ 公式のものとバイナリが完全に同一のラムディスク
  - 指示通りに同一のバイナリをコンパイルするのはほぼ不可能で意味がない
  - しかし、このプロジェクトで作られたラムディスクは再現可能であるべき

### 将来的な変更の可能性

- バイナリのサフィックスを削除（単に面倒で一貫性がないため）  
  （上流の変更は不要）
- ラムディスクをx86 32ビットと64ビットに分割  
  （grubの変更が必要）
- ラムディスク内のシェルスクリプトの整理  
  （上流の変更は不要）

## 進捗

起動はしますが、一部機能が動作しない可能性があります。

### ventoy.cpio

100%、文字通りファイル群をxz圧縮しただけです。

サイズ比率：

- du - 1 (64 / 64)
- ls -l - 1 (62976 / 62976)

### ventoy_ARCH.cpio

約75%

ほとんどのツールが何らかの方法でコンパイル済みです。あとは最適化のみ。

サイズ比率（x86）：

- du - 0.8540245566166439 (2504 / 2932)
- ls -l - 0.8624375107740045 (2561536 / 2970112)

サイズ比率（arm64）：

- du - 0.8159806295399516 (1348 / 1652)
- ls -l - 0.8159490600363857 (1377792 / 1688576)

サイズ比率（mips64）：

- du - 0.9816849816849817 (1072 / 1092)
- ls -l - 0.981642955484167 (1095168 / 1115648)

### vtloopex.cpio

TODO: 追加予定

## 使い方

### ビルド方法



```sh
docker compose build
```

```sh
docker compose up
```

ヒント：

コンテナを再構築するたびにアーカイブを再ダウンロードしたくない場合は、
`docker/base/{dietlibc,musl,toolchains}` に移動し、セットアップスクリプトを確認して
手動でファイルを `wget` してください。

また、次のコマンドを実行してコンテナに入ることもできます：

```sh
docker run -it --rm \
  -v ".:/build" \
  ventoy-cpio-builder:latest \
  bash
```

### セットアップ

`ventoy*.cpio` ファイルが用意できたら：

1. Ventoy USBの第2パーティションをマウントします
1. !!! 元の `ventoy*.cpio` ファイルをバックアップしてください !!!
1. 試したいcpioファイルをコピーします。（ヒント：どれか分からない場合は、
  おそらく `ventoy_x86.cpio` です）

## ミニTODO

- 互換性のために古いバージョンのLinuxヘッダーでビルドする

## 注意事項

- [GCC用語で](https://gcc.gnu.org/onlinedocs/gccint/Configure-Terms.html)：
  - ビルドはx86_64 *nixを想定しています
  - ホスト（ventoyインストールツール用）はx86_64を想定しています
  - ターゲットはx86_64、i386、aarch64、mips64elです


---

Tranlated By [Open Ai Tx](https://github.com/OpenAiTx/OpenAiTx) | Last indexed: 2025-07-30

---