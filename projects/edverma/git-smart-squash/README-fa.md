# گیت اسمارت اسکوایش

دیگر وقت خود را صرف بازچینی دستی کامیت‌ها نکنید. اجازه دهید هوش مصنوعی این کار را برای شما انجام دهد.

## مشکل

احتمالاً برای شما هم پیش آمده است: ۱۵ کامیت برای یک فیچر، که نیمی از آن‌ها "fix"، "typo" یا "WIP" هستند. حالا باید برای بازبینی PR آن را پاک‌سازی کنید. اسکوایش و بازنویسی دستی کار خسته‌کننده‌ای است.

## راه حل

گیت اسمارت اسکوایش تغییرات شما را تحلیل کرده و آن‌ها را به کامیت‌های منطقی با پیام‌های مناسب بازچینی می‌کند:

```bash
# قبل: شاخه‌ی درهم‌ریخته شما
* fix tests
* typo  
* more auth changes
* WIP: working on auth
* update tests
* initial auth implementation
```
# بعد: کامیت‌های تمیز و منطقی
* feat: پیاده‌سازی سیستم احراز هویت JWT
* test: افزودن پوشش تست برای endpoint احراز هویت
```

## شروع سریع

### ۱. نصب

```bash
# با استفاده از pip
pip install git-smart-squash

# با استفاده از pipx (توصیه‌شده برای نصب ایزوله)
pipx install git-smart-squash

# با استفاده از uv (مدیر بسته سریع پایتون)
uv tool install git-smart-squash
```
### 2. راه‌اندازی هوش مصنوعی

**گزینه الف: محلی (رایگان، خصوصی)**
```bash
# نصب Ollama از https://ollama.com
ollama pull devstral  # مدل پیش‌فرض
```

**گزینه ب: ابری (نتایج بهتر)**
```bash
export OPENAI_API_KEY="your-key"
export ANTHROPIC_API_KEY="your-key"
export GEMINI_API_KEY="your-key"
```

### 3. اجرا

```bash
cd your-repo
git-smart-squash
```
همین است. طرح را مرور کرده و تأیید کنید.

## پارامترهای خط فرمان

| پارامتر | توضیح | پیش‌فرض |
|---------|-------|---------|
| `--base` | شاخه پایه برای مقایسه | فایل تنظیمات یا `main` |
| `--ai-provider` | ارائه‌دهنده هوش مصنوعی برای استفاده (openai، anthropic، local، gemini) | تنظیم‌شده در تنظیمات |
| `--model` | مدل هوش مصنوعی خاص برای استفاده (مدل‌های پیشنهادی را در زیر ببینید) | پیش‌فرض ارائه‌دهنده |
| `--config` | مسیر فایل پیکربندی سفارشی | `.git-smart-squash.yml` یا `~/.git-smart-squash.yml` |
| `--auto-apply` | اعمال طرح کامیت بدون درخواست تأیید | `false` |
| `--instructions`, `-i` | دستورالعمل‌های سفارشی برای هوش مصنوعی (مثلاً: "بر اساس ناحیه ویژگی گروه‌بندی کن") | هیچ‌کدام |
| `--no-attribution` | غیرفعال کردن پیام انتساب در کامیت‌ها | `false` |
| `--debug` | فعال‌سازی لاگ‌برداری اشکال‌زدایی برای اطلاعات جزئی | `false` |

## مدل‌های پیشنهادی

### مدل‌های پیش‌فرض
- **OpenAI**: `gpt-4.1` (پیش‌فرض)
- **Anthropic**: `claude-sonnet-4-20250514` (پیش‌فرض)
- **Gemini**: `gemini-2.5-pro` (پیش‌فرض)
- **Local/Ollama**: `devstral` (پیش‌فرض)
### انتخاب مدل
```bash
# مشخص کردن یک مدل متفاوت
git-smart-squash --ai-provider openai --model gpt-4.1-mini

# برای Ollama محلی
git-smart-squash --ai-provider local --model llama-3.1
```

## دستورالعمل‌های سفارشی

پارامتر `--instructions` به شما اجازه می‌دهد تا نحوه سازماندهی کامیت‌ها را کنترل کنید:

### مثال‌ها
```bash
# افزودن پیشوند تیکت
git-smart-squash -i "تمام کامیت‌ها را با [ABC-1234] پیشوندگذاری کن"

# جداسازی بر اساس نوع
git-smart-squash -i "تغییرات بک‌اند و فرانت‌اند را در کامیت‌های جداگانه نگه دار"
```
# محدود کردن تعداد کامیت‌ها
git-smart-squash -i "در مجموع حداکثر ۳ کامیت ایجاد کن"
```

### نکات برای نتایج بهتر
- **دقیق باشید**: "مهاجرت‌های دیتابیس را جداگانه گروه‌بندی کن" بهتر از "مرتب سازماندهی کن" عمل می‌کند
- **هر بار یک دستور**: دستورالعمل‌های پیچیده چندبخشی ممکن است به‌طور ناقص اجرا شوند
- **از مدل‌های بهتر استفاده کنید**: مدل‌های بزرگ‌تر دستورالعمل‌ها را قابل اعتمادتر دنبال می‌کنند تا مدل‌های کوچک‌تر

## موارد استفاده رایج

### "قبل از بررسی PR باید پاک‌سازی کنم"
```bash
git-smart-squash              # برنامه را نمایش داده و تأیید می‌خواهد
git-smart-squash --auto-apply # به‌صورت خودکار و بدون پرسش اجرا می‌کند
```

### "با شاخه اصلی متفاوتی کار می‌کنم"
```bash
git-smart-squash --base develop
```
### "می‌خواهم از یک ارائه‌دهنده هوش مصنوعی خاص استفاده کنم"
```bash
git-smart-squash --ai-provider openai
```

## ایمنی

**کد شما ایمن است:**
- قبل از اعمال تغییرات، طرح را نمایش می‌دهد
- شاخه پشتیبان خودکار ایجاد می‌کند
- نیاز به دایرکتوری کاری پاک دارد
- هرگز بدون فرمان شما پوش نمی‌کند

**اگر مشکلی پیش آمد:**
```bash
# یافتن پشتیبان
git branch | grep backup

# بازیابی
git reset --hard your-branch-backup-[timestamp]
```

## ارائه‌دهندگان هوش مصنوعی

| ارائه‌دهنده | هزینه | حریم خصوصی |
|--------------|-------|-------------|
| **Ollama**   | رایگان | محلی       |
| **OpenAI**   | ~۰.۰۱ دلار | ابری      |
| **Anthropic**| ~۰.۰۱ دلار | ابری      |
| **Gemini**   | ~۰.۰۱ دلار | ابری      |

## پیکربندی پیشرفته (اختیاری)

می‌خواهید سفارشی‌سازی کنید؟ یک فایل پیکربندی بسازید:

**مخصوص پروژه** (`.git-smart-squash.yml` در مخزن شما):
```yaml
ai:
  provider: openai  # استفاده از OpenAI برای این پروژه
base: develop       # استفاده از develop به عنوان شاخه مبنا برای این پروژه
```
**پیش‌فرض جهانی** (`~/.git-smart-squash.yml`):
```yaml
ai:
  provider: local   # همیشه به طور پیش‌فرض از AI محلی استفاده کن
base: main          # شاخه مبنای پیش‌فرض برای همه پروژه‌ها
```

## رفع اشکال

### خطای "JSON نامعتبر"
این معمولاً به این معناست که مدل AI نتوانسته پاسخ را به درستی قالب‌بندی کند:
- **در صورت استفاده از Ollama**: از `llama2` به `mistral` یا `mixtral` تغییر دهید
- **راه‌حل**: `ollama pull mistral` را اجرا کنید و مجدداً تلاش کنید
- **جایگزین**: از یک ارائه‌دهنده ابری با `--ai-provider openai` استفاده کنید

### مدل از دستورات پیروی نمی‌کند
برخی مدل‌ها در اجرای دستورالعمل‌های پیچیده مشکل دارند:
- **از مدل‌های بهتر استفاده کنید**: `--model gpt-4-turbo` یا `--model claude-3-opus`
- **دستورالعمل‌ها را ساده کنید**: یک دستور روشن بهتر از چندین دستور است
- **صراحت داشته باشید**: "با [ABC-123] پیشوند بزن" نه "شماره تیکت را اضافه کن"

### "Ollama پیدا نشد"
```bash
# نصب از https://ollama.com
ollama serve
ollama pull devstral  # مدل پیش‌فرض
```

### گروه‌بندی ضعیف کامیت‌ها
اگر هوش مصنوعی تعداد زیادی کامیت ایجاد می‌کند یا به خوبی گروه‌بندی نمی‌کند:
- **مدل ناکافی**: از یک مدل بزرگ‌تر استفاده کنید
- **افزودن دستورالعمل**: `-i "تغییرات مرتبط را گروه‌بندی کن، حداکثر ۳ کامیت"`
- **ارائه بازخورد**: یک issue در GitHub ایجاد کنید و به ما اطلاع دهید چه اتفاقی افتاده است

### مشکلات نصب (مک)
اگر pip ندارید یا نصب‌های ایزوله ترجیح می‌دهید:
```bash
# استفاده از pipx (توصیه‌شده)
brew install pipx
pipx install git-smart-squash
```
### "تغییری برای بازسازیش وجود ندارد"
```bash
git log --oneline main..HEAD  # بررسی کنید که کامیت دارید
git diff main                 # بررسی کنید که تغییر دارید
```

### تفاوت‌های بزرگ / محدودیت توکن
مدل‌های محلی دارای محدودیت حدود ۳۲ هزار توکن هستند. برای تغییرات بزرگ:
- از `--base` با یک کامیت جدیدتر استفاده کنید
- به فضای ابری سوئیچ کنید: `--ai-provider openai`
- به چند PR کوچکتر تقسیم کنید

### به کمک بیشتری نیاز دارید؟

[مستندات جامع ما](https://raw.githubusercontent.com/edverma/git-smart-squash/main/DOCUMENTATION.md) را بررسی کنید یا یک ایشو باز کنید!

## مجوز

مجوز MIT - برای جزییات به فایل [LICENSE](LICENSE) مراجعه کنید.


---

Tranlated By [Open Ai Tx](https://github.com/OpenAiTx/OpenAiTx) | Last indexed: 2025-07-12

---