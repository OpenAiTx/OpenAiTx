# پایانه پرداخت NFC

یک پایانه پرداخت NFC چندزنجیره‌ای که پرداخت‌های رمزارزی را در پنج شبکه بلاک‌چین پردازش می‌کند و دارای پایش تراکنش‌ها به صورت لحظه‌ای و ردیابی جامع تاریخچه است.

## 🌐 شبکه‌های پشتیبانی‌شده

- **اتریوم**
- **بیس**
- **آربیتروم**
- **آپتیمیسم**
- **پالیگان**

### 🎯 **اولویت پرداخت هوشمند**

به جای مذاکره درباره ترکیب زنجیره / توکن با پذیرنده، پایانه پرداخت این کار را به‌صورت خودکار انجام می‌دهد. ابتدا زنجیره‌ای که پذیرنده پشتیبانی می‌کند و شما نیز موجودی دارید را شناسایی می‌کند و سپس تراکنش را با ETH یا یک توکن ERC-20 با این اولویت ارسال می‌کند:

```
استیبل‌کوین لایه ۲ > سایر توکن‌های لایه ۲ > اتریوم لایه ۲ > استیبل‌کوین لایه ۱ > سایر توکن‌های لایه ۱ > اتریوم لایه ۱
```
## 🚀 شروع سریع

1. **نصب وابستگی‌ها:**
   ```bash
   npm install
   ```

2. **راه‌اندازی محیط:**
   ```bash
   echo "ALCHEMY_API_KEY=your_alchemy_api_key_here" > .env
   ```

3. **اجرای ترمینال:**
   ```bash
   npm start
   ```

4. **باز کردن رابط کاربری:**
   به آدرس `http://localhost:3000` بروید

## 🏗️ معماری

```
src/
├── server.ts                   # سرور اکسپرس و مدیریت WebSocket
├── app.ts                      # هماهنگ‌کننده اصلی برنامه
├── web/index.html              # رابط کاربری پایانه پرداخت
├── config/index.ts             # پیکربندی چندزنجیره‌ای
└── services/
    ├── nfcService.ts           # خوانش NFC و اسکن کیف پول
    ├── alchemyService.ts       # مانیتورینگ و موجودی چندزنجیره‌ای
    ├── paymentService.ts       # انتخاب پرداخت و تولید EIP-681
    ├── ethereumService.ts      # ابزارهای اعتبارسنجی آدرس
    └── addressProcessor.ts     # جلوگیری از پردازش تکراری
scripts/
└── rpi-deploy/
    ├── setup-build-environment.sh  # نصب وابستگی‌ها برای ساخت ایمیج Raspberry Pi
    └── build-pi-image-osx.sh       # ساخت ایمیج Raspberry Pi
```
## 💡 استفاده

### **پردازش پرداخت‌ها**
1. مبلغ را با استفاده از صفحه کلید وارد کنید (بر اساس سنت: "150" = ۱.۵۰ دلار)
2. برای شروع پرداخت روی "Charge" ضربه بزنید
3. مشتری دستگاه NFC خود را برای ارسال پرداخت نزدیک می‌کند
4. نظارت لحظه‌ای، تراکنش را تأیید می‌کند
5. پیام "تأیید شد" به همراه لینک مرورگر بلاک

### **تاریخچه تراکنش**
1. روی دکمه 📜 تاریخچه در صفحه کلید ضربه بزنید
2. همه تراکنش‌ها را مشاهده کنید یا برای تاریخچه خاص یک کیف پول را اسکن کنید
3. روی "📱 اسکن کیف پول برای تاریخچه" ضربه بزنید و از مشتری بخواهید دستگاه خود را نزدیک کند
4. تراکنش‌های فیلترشده برای همان کیف پول را مرور کنید


## 🔄 جریان پرداخت

1. **شناسایی NFC** → مشتری دستگاه را نزدیک می‌کند
2. **دریافت چندزنجیره‌ای** → تحلیل پرتفوی در میان هر ۶ زنجیره
3. **انتخاب هوشمند** → توکن پرداخت بهینه بر اساس سیستم اولویت
4. **تولید EIP-681** → درخواست پرداخت با شناسه زنجیره
5. **نظارت لحظه‌ای** → WebSocket/پولینگ برای تأیید تراکنش
6. **ثبت تاریخچه** → ذخیره تراکنش با تمام فراداده‌ها
## 🛡️ پایش تراکنش

- **پایش WebSocket** برای Ethereum، Base، Arbitrum، Optimism، Polygon
- **پایش مبتنی بر Polling** به عنوان جایگزین
- **اتمام خودکار زمان** پس از ۵ دقیقه
- **یکپارچه‌سازی با Block Explorer** برای تأیید تراکنش
- **ردیابی وضعیت**: شناسایی شده → تأیید شده → ناموفق

## 🍓 استقرار روی Raspberry Pi

این پایانه پرداخت NFC می‌تواند به عنوان یک **کیوسک Plug-and-Play** روی سخت‌افزار Raspberry Pi برای استفاده در محیط تولیدی مستقر شود.

### **نیازمندی‌های سخت‌افزاری**
- Raspberry Pi 4B (توصیه شده با ۴ گیگابایت رم یا بیشتر)
- صفحه نمایش لمسی ۷ اینچ رسمی Raspberry Pi
- **خوانشگر NFC مدل ACR1252U-M1** (به طور خاص پشتیبانی می‌شود)
- کارت MicroSD با ظرفیت ۳۲ گیگابایت یا بیشتر

### **ویژگی‌های استقرار**
- **ساخت با یک فرمان** برای ایجاد ایمیج قابل بوت روی SD کارت
- **WiFi و اعتبارنامه‌های API از پیش پیکربندی شده**
- **راه‌اندازی خودکار** با حالت کیوسک تمام‌صفحه
- **اعتبارسنجی ایمنی** برای جلوگیری از استقرار با آدرس‌های تستی
- **پشتیبانی ساخت برای macOS و لینوکس**
### **استقرار سریع**
```bash
# به اسکریپت‌های استقرار بروید
cd scripts/rpi-deploy

# پیکربندی استقرار خود را انجام دهید
cp build-config.env.template build-config.env
# فایل build-config.env را با اطلاعات WiFi، کلید API و آدرس پذیرنده ویرایش کنید

# ساخت تصویر بوتیبل (macOS)
./build-pi-image-osx.sh

# فایل nfc-terminal-<date>.img.gz تولیدشده را با استفاده از Raspberry Pi Imager روی کارت SD فلش کرده و بوت کنید!
```

📖 **[راهنمای کامل استقرار](https://raw.githubusercontent.com/FreePayPOS/merchant-app/main/README-DEPLOYMENT.md)**

---

Tranlated By [Open Ai Tx](https://github.com/OpenAiTx/OpenAiTx) | Last indexed: 2025-07-13

---